var eR=Object.defineProperty;var iR=(r,e,s)=>e in r?eR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var Qt=(r,e,s)=>(iR(r,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();function PT(r,e){const s=Object.create(null),o=r.split(",");for(let l=0;l<o.length;l++)s[o[l]]=!0;return e?l=>!!s[l.toLowerCase()]:l=>!!s[l]}const Me={},Zl=[],As=()=>{},sR=()=>!1,oR=/^on[^a-z]/,$p=r=>oR.test(r),BT=r=>r.startsWith("onUpdate:"),Ti=Object.assign,FT=(r,e)=>{const s=r.indexOf(e);s>-1&&r.splice(s,1)},nR=Object.prototype.hasOwnProperty,ae=(r,e)=>nR.call(r,e),Ht=Array.isArray,Ql=r=>Tp(r)==="[object Map]",Dw=r=>Tp(r)==="[object Set]",zt=r=>typeof r=="function",Ye=r=>typeof r=="string",_p=r=>typeof r=="symbol",Be=r=>r!==null&&typeof r=="object",xw=r=>(Be(r)||zt(r))&&zt(r.then)&&zt(r.catch),Pw=Object.prototype.toString,Tp=r=>Pw.call(r),rR=r=>Tp(r).slice(8,-1),Bw=r=>Tp(r)==="[object Object]",HT=r=>Ye(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Ld=PT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bp=r=>{const e=Object.create(null);return s=>e[s]||(e[s]=r(s))},lR=/-(\w)/g,go=bp(r=>r.replace(lR,(e,s)=>s?s.toUpperCase():"")),cR=/\B([A-Z])/g,bc=bp(r=>r.replace(cR,"-$1").toLowerCase()),Ep=bp(r=>r.charAt(0).toUpperCase()+r.slice(1)),I$=bp(r=>r?`on${Ep(r)}`:""),Pr=(r,e)=>!Object.is(r,e),S$=(r,e)=>{for(let s=0;s<r.length;s++)r[s](e)},Jd=(r,e,s)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value:s})},aR=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let ty;const __=()=>ty||(ty=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function UT(r){if(Ht(r)){const e={};for(let s=0;s<r.length;s++){const o=r[s],l=Ye(o)?pR(o):UT(o);if(l)for(const a in l)e[a]=l[a]}return e}else if(Ye(r)||Be(r))return r}const hR=/;(?![^(]*\))/g,uR=/:([^]+)/,dR=/\/\*[^]*?\*\//g;function pR(r){const e={};return r.replace(dR,"").split(hR).forEach(s=>{if(s){const o=s.split(uR);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function VT(r){let e="";if(Ye(r))e=r;else if(Ht(r))for(let s=0;s<r.length;s++){const o=VT(r[s]);o&&(e+=o+" ")}else if(Be(r))for(const s in r)r[s]&&(e+=s+" ");return e.trim()}const gR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",fR=PT(gR);function Fw(r){return!!r||r===""}const cs=r=>Ye(r)?r:r==null?"":Ht(r)||Be(r)&&(r.toString===Pw||!zt(r.toString))?JSON.stringify(r,Hw,2):String(r),Hw=(r,e)=>e&&e.__v_isRef?Hw(r,e.value):Ql(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[o,l])=>(s[`${o} =>`]=l,s),{})}:Dw(e)?{[`Set(${e.size})`]:[...e.values()]}:Be(e)&&!Ht(e)&&!Bw(e)?String(e):e;let ws;class mR{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ws,!e&&ws&&(this.index=(ws.scopes||(ws.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const s=ws;try{return ws=this,e()}finally{ws=s}}}on(){ws=this}off(){ws=this.parent}stop(e){if(this._active){let s,o;for(s=0,o=this.effects.length;s<o;s++)this.effects[s].stop();for(s=0,o=this.cleanups.length;s<o;s++)this.cleanups[s]();if(this.scopes)for(s=0,o=this.scopes.length;s<o;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!e){const l=this.parent.scopes.pop();l&&l!==this&&(this.parent.scopes[this.index]=l,l.index=this.index)}this.parent=void 0,this._active=!1}}}function $R(r,e=ws){e&&e.active&&e.effects.push(r)}function _R(){return ws}const GT=r=>{const e=new Set(r);return e.w=0,e.n=0,e},Uw=r=>(r.w&Rn)>0,Vw=r=>(r.n&Rn)>0,TR=({deps:r})=>{if(r.length)for(let e=0;e<r.length;e++)r[e].w|=Rn},bR=r=>{const{deps:e}=r;if(e.length){let s=0;for(let o=0;o<e.length;o++){const l=e[o];Uw(l)&&!Vw(l)?l.delete(r):e[s++]=l,l.w&=~Rn,l.n&=~Rn}e.length=s}},T_=new WeakMap;let ya=0,Rn=1;const b_=30;let ks;const Nr=Symbol(""),E_=Symbol("");class WT{constructor(e,s=null,o){this.fn=e,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,$R(this,o)}run(){if(!this.active)return this.fn();let e=ks,s=wn;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ks,ks=this,wn=!0,Rn=1<<++ya,ya<=b_?TR(this):ey(this),this.fn()}finally{ya<=b_&&bR(this),Rn=1<<--ya,ks=this.parent,wn=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ks===this?this.deferStop=!0:this.active&&(ey(this),this.onStop&&this.onStop(),this.active=!1)}}function ey(r){const{deps:e}=r;if(e.length){for(let s=0;s<e.length;s++)e[s].delete(r);e.length=0}}let wn=!0;const Gw=[];function Ec(){Gw.push(wn),wn=!1}function vc(){const r=Gw.pop();wn=r===void 0?!0:r}function Hi(r,e,s){if(wn&&ks){let o=T_.get(r);o||T_.set(r,o=new Map);let l=o.get(s);l||o.set(s,l=GT()),Ww(l)}}function Ww(r,e){let s=!1;ya<=b_?Vw(r)||(r.n|=Rn,s=!Uw(r)):s=!r.has(ks),s&&(r.add(ks),ks.deps.push(r))}function Fo(r,e,s,o,l,a){const h=T_.get(r);if(!h)return;let d=[];if(e==="clear")d=[...h.values()];else if(s==="length"&&Ht(r)){const p=Number(o);h.forEach((f,m)=>{(m==="length"||!_p(m)&&m>=p)&&d.push(f)})}else switch(s!==void 0&&d.push(h.get(s)),e){case"add":Ht(r)?HT(s)&&d.push(h.get("length")):(d.push(h.get(Nr)),Ql(r)&&d.push(h.get(E_)));break;case"delete":Ht(r)||(d.push(h.get(Nr)),Ql(r)&&d.push(h.get(E_)));break;case"set":Ql(r)&&d.push(h.get(Nr));break}if(d.length===1)d[0]&&v_(d[0]);else{const p=[];for(const f of d)f&&p.push(...f);v_(GT(p))}}function v_(r,e){const s=Ht(r)?r:[...r];for(const o of s)o.computed&&iy(o);for(const o of s)o.computed||iy(o)}function iy(r,e){(r!==ks||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const ER=PT("__proto__,__v_isRef,__isVue"),Xw=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(_p)),sy=vR();function vR(){const r={};return["includes","indexOf","lastIndexOf"].forEach(e=>{r[e]=function(...s){const o=ue(this);for(let a=0,h=this.length;a<h;a++)Hi(o,"get",a+"");const l=o[e](...s);return l===-1||l===!1?o[e](...s.map(ue)):l}}),["push","pop","shift","unshift","splice"].forEach(e=>{r[e]=function(...s){Ec();const o=ue(this)[e].apply(this,s);return vc(),o}}),r}function IR(r){const e=ue(this);return Hi(e,"has",r),e.hasOwnProperty(r)}class zw{constructor(e=!1,s=!1){this._isReadonly=e,this._shallow=s}get(e,s,o){const l=this._isReadonly,a=this._shallow;if(s==="__v_isReactive")return!l;if(s==="__v_isReadonly")return l;if(s==="__v_isShallow")return a;if(s==="__v_raw"&&o===(l?a?xR:Jw:a?jw:Kw).get(e))return e;const h=Ht(e);if(!l){if(h&&ae(sy,s))return Reflect.get(sy,s,o);if(s==="hasOwnProperty")return IR}const d=Reflect.get(e,s,o);return(_p(s)?Xw.has(s):ER(s))||(l||Hi(e,"get",s),a)?d:fi(d)?h&&HT(s)?d:d.value:Be(d)?l?qw(d):fo(d):d}}class Yw extends zw{constructor(e=!1){super(!1,e)}set(e,s,o,l){let a=e[s];if(nc(a)&&fi(a)&&!fi(o))return!1;if(!this._shallow&&(!qd(o)&&!nc(o)&&(a=ue(a),o=ue(o)),!Ht(e)&&fi(a)&&!fi(o)))return a.value=o,!0;const h=Ht(e)&&HT(s)?Number(s)<e.length:ae(e,s),d=Reflect.set(e,s,o,l);return e===ue(l)&&(h?Pr(o,a)&&Fo(e,"set",s,o):Fo(e,"add",s,o)),d}deleteProperty(e,s){const o=ae(e,s);e[s];const l=Reflect.deleteProperty(e,s);return l&&o&&Fo(e,"delete",s,void 0),l}has(e,s){const o=Reflect.has(e,s);return(!_p(s)||!Xw.has(s))&&Hi(e,"has",s),o}ownKeys(e){return Hi(e,"iterate",Ht(e)?"length":Nr),Reflect.ownKeys(e)}}class SR extends zw{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const yR=new Yw,CR=new SR,wR=new Yw(!0),XT=r=>r,vp=r=>Reflect.getPrototypeOf(r);function rd(r,e,s=!1,o=!1){r=r.__v_raw;const l=ue(r),a=ue(e);s||(Pr(e,a)&&Hi(l,"get",e),Hi(l,"get",a));const{has:h}=vp(l),d=o?XT:s?KT:lh;if(h.call(l,e))return d(r.get(e));if(h.call(l,a))return d(r.get(a));r!==l&&r.get(e)}function ld(r,e=!1){const s=this.__v_raw,o=ue(s),l=ue(r);return e||(Pr(r,l)&&Hi(o,"has",r),Hi(o,"has",l)),r===l?s.has(r):s.has(r)||s.has(l)}function cd(r,e=!1){return r=r.__v_raw,!e&&Hi(ue(r),"iterate",Nr),Reflect.get(r,"size",r)}function oy(r){r=ue(r);const e=ue(this);return vp(e).has.call(e,r)||(e.add(r),Fo(e,"add",r,r)),this}function ny(r,e){e=ue(e);const s=ue(this),{has:o,get:l}=vp(s);let a=o.call(s,r);a||(r=ue(r),a=o.call(s,r));const h=l.call(s,r);return s.set(r,e),a?Pr(e,h)&&Fo(s,"set",r,e):Fo(s,"add",r,e),this}function ry(r){const e=ue(this),{has:s,get:o}=vp(e);let l=s.call(e,r);l||(r=ue(r),l=s.call(e,r)),o&&o.call(e,r);const a=e.delete(r);return l&&Fo(e,"delete",r,void 0),a}function ly(){const r=ue(this),e=r.size!==0,s=r.clear();return e&&Fo(r,"clear",void 0,void 0),s}function ad(r,e){return function(o,l){const a=this,h=a.__v_raw,d=ue(h),p=e?XT:r?KT:lh;return!r&&Hi(d,"iterate",Nr),h.forEach((f,m)=>o.call(l,p(f),p(m),a))}}function hd(r,e,s){return function(...o){const l=this.__v_raw,a=ue(l),h=Ql(a),d=r==="entries"||r===Symbol.iterator&&h,p=r==="keys"&&h,f=l[r](...o),m=s?XT:e?KT:lh;return!e&&Hi(a,"iterate",p?E_:Nr),{next(){const{value:T,done:b}=f.next();return b?{value:T,done:b}:{value:d?[m(T[0]),m(T[1])]:m(T),done:b}},[Symbol.iterator](){return this}}}}function Tn(r){return function(...e){return r==="delete"?!1:this}}function kR(){const r={get(a){return rd(this,a)},get size(){return cd(this)},has:ld,add:oy,set:ny,delete:ry,clear:ly,forEach:ad(!1,!1)},e={get(a){return rd(this,a,!1,!0)},get size(){return cd(this)},has:ld,add:oy,set:ny,delete:ry,clear:ly,forEach:ad(!1,!0)},s={get(a){return rd(this,a,!0)},get size(){return cd(this,!0)},has(a){return ld.call(this,a,!0)},add:Tn("add"),set:Tn("set"),delete:Tn("delete"),clear:Tn("clear"),forEach:ad(!0,!1)},o={get(a){return rd(this,a,!0,!0)},get size(){return cd(this,!0)},has(a){return ld.call(this,a,!0)},add:Tn("add"),set:Tn("set"),delete:Tn("delete"),clear:Tn("clear"),forEach:ad(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{r[a]=hd(a,!1,!1),s[a]=hd(a,!0,!1),e[a]=hd(a,!1,!0),o[a]=hd(a,!0,!0)}),[r,s,e,o]}const[OR,AR,RR,NR]=kR();function zT(r,e){const s=e?r?NR:RR:r?AR:OR;return(o,l,a)=>l==="__v_isReactive"?!r:l==="__v_isReadonly"?r:l==="__v_raw"?o:Reflect.get(ae(s,l)&&l in o?s:o,l,a)}const LR={get:zT(!1,!1)},MR={get:zT(!1,!0)},DR={get:zT(!0,!1)},Kw=new WeakMap,jw=new WeakMap,Jw=new WeakMap,xR=new WeakMap;function PR(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function BR(r){return r.__v_skip||!Object.isExtensible(r)?0:PR(rR(r))}function fo(r){return nc(r)?r:YT(r,!1,yR,LR,Kw)}function FR(r){return YT(r,!1,wR,MR,jw)}function qw(r){return YT(r,!0,CR,DR,Jw)}function YT(r,e,s,o,l){if(!Be(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const a=l.get(r);if(a)return a;const h=BR(r);if(h===0)return r;const d=new Proxy(r,h===2?o:s);return l.set(r,d),d}function tc(r){return nc(r)?tc(r.__v_raw):!!(r&&r.__v_isReactive)}function nc(r){return!!(r&&r.__v_isReadonly)}function qd(r){return!!(r&&r.__v_isShallow)}function Zw(r){return tc(r)||nc(r)}function ue(r){const e=r&&r.__v_raw;return e?ue(e):r}function Qw(r){return Jd(r,"__v_skip",!0),r}const lh=r=>Be(r)?fo(r):r,KT=r=>Be(r)?qw(r):r;function tk(r){wn&&ks&&(r=ue(r),Ww(r.dep||(r.dep=GT())))}function ek(r,e){r=ue(r);const s=r.dep;s&&v_(s)}function fi(r){return!!(r&&r.__v_isRef===!0)}function Ls(r){return ik(r,!1)}function HR(r){return ik(r,!0)}function ik(r,e){return fi(r)?r:new UR(r,e)}class UR{constructor(e,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?e:ue(e),this._value=s?e:lh(e)}get value(){return tk(this),this._value}set value(e){const s=this.__v_isShallow||qd(e)||nc(e);e=s?e:ue(e),Pr(e,this._rawValue)&&(this._rawValue=e,this._value=s?e:lh(e),ek(this))}}function Go(r){return fi(r)?r.value:r}const VR={get:(r,e,s)=>Go(Reflect.get(r,e,s)),set:(r,e,s,o)=>{const l=r[e];return fi(l)&&!fi(s)?(l.value=s,!0):Reflect.set(r,e,s,o)}};function sk(r){return tc(r)?r:new Proxy(r,VR)}class GR{constructor(e,s,o,l){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new WT(e,()=>{this._dirty||(this._dirty=!0,ek(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!l,this.__v_isReadonly=o}get value(){const e=ue(this);return tk(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function WR(r,e,s=!1){let o,l;const a=zt(r);return a?(o=r,l=As):(o=r.get,l=r.set),new GR(o,l,a||!l,s)}function kn(r,e,s,o){let l;try{l=o?r(...o):r()}catch(a){Ip(a,e,s)}return l}function Rs(r,e,s,o){if(zt(r)){const a=kn(r,e,s,o);return a&&xw(a)&&a.catch(h=>{Ip(h,e,s)}),a}const l=[];for(let a=0;a<r.length;a++)l.push(Rs(r[a],e,s,o));return l}function Ip(r,e,s,o=!0){const l=e?e.vnode:null;if(e){let a=e.parent;const h=e.proxy,d=s;for(;a;){const f=a.ec;if(f){for(let m=0;m<f.length;m++)if(f[m](r,h,d)===!1)return}a=a.parent}const p=e.appContext.config.errorHandler;if(p){kn(p,null,10,[r,h,d]);return}}XR(r,s,l,o)}function XR(r,e,s,o=!0){console.error(r)}let ch=!1,I_=!1;const pi=[];let lo=0;const ec=[];let Do=null,yr=0;const ok=Promise.resolve();let jT=null;function zR(r){const e=jT||ok;return r?e.then(this?r.bind(this):r):e}function YR(r){let e=lo+1,s=pi.length;for(;e<s;){const o=e+s>>>1,l=pi[o],a=ah(l);a<r||a===r&&l.pre?e=o+1:s=o}return e}function JT(r){(!pi.length||!pi.includes(r,ch&&r.allowRecurse?lo+1:lo))&&(r.id==null?pi.push(r):pi.splice(YR(r.id),0,r),nk())}function nk(){!ch&&!I_&&(I_=!0,jT=ok.then(lk))}function KR(r){const e=pi.indexOf(r);e>lo&&pi.splice(e,1)}function jR(r){Ht(r)?ec.push(...r):(!Do||!Do.includes(r,r.allowRecurse?yr+1:yr))&&ec.push(r),nk()}function cy(r,e=ch?lo+1:0){for(;e<pi.length;e++){const s=pi[e];s&&s.pre&&(pi.splice(e,1),e--,s())}}function rk(r){if(ec.length){const e=[...new Set(ec)];if(ec.length=0,Do){Do.push(...e);return}for(Do=e,Do.sort((s,o)=>ah(s)-ah(o)),yr=0;yr<Do.length;yr++)Do[yr]();Do=null,yr=0}}const ah=r=>r.id==null?1/0:r.id,JR=(r,e)=>{const s=ah(r)-ah(e);if(s===0){if(r.pre&&!e.pre)return-1;if(e.pre&&!r.pre)return 1}return s};function lk(r){I_=!1,ch=!0,pi.sort(JR);const e=As;try{for(lo=0;lo<pi.length;lo++){const s=pi[lo];s&&s.active!==!1&&kn(s,null,14)}}finally{lo=0,pi.length=0,rk(),ch=!1,jT=null,(pi.length||ec.length)&&lk()}}function qR(r,e,...s){if(r.isUnmounted)return;const o=r.vnode.props||Me;let l=s;const a=e.startsWith("update:"),h=a&&e.slice(7);if(h&&h in o){const m=`${h==="modelValue"?"model":h}Modifiers`,{number:T,trim:b}=o[m]||Me;b&&(l=s.map(I=>Ye(I)?I.trim():I)),T&&(l=s.map(aR))}let d,p=o[d=I$(e)]||o[d=I$(go(e))];!p&&a&&(p=o[d=I$(bc(e))]),p&&Rs(p,r,6,l);const f=o[d+"Once"];if(f){if(!r.emitted)r.emitted={};else if(r.emitted[d])return;r.emitted[d]=!0,Rs(f,r,6,l)}}function ck(r,e,s=!1){const o=e.emitsCache,l=o.get(r);if(l!==void 0)return l;const a=r.emits;let h={},d=!1;if(!zt(r)){const p=f=>{const m=ck(f,e,!0);m&&(d=!0,Ti(h,m))};!s&&e.mixins.length&&e.mixins.forEach(p),r.extends&&p(r.extends),r.mixins&&r.mixins.forEach(p)}return!a&&!d?(Be(r)&&o.set(r,null),null):(Ht(a)?a.forEach(p=>h[p]=null):Ti(h,a),Be(r)&&o.set(r,h),h)}function Sp(r,e){return!r||!$p(e)?!1:(e=e.slice(2).replace(/Once$/,""),ae(r,e[0].toLowerCase()+e.slice(1))||ae(r,bc(e))||ae(r,e))}let ki=null,yp=null;function Zd(r){const e=ki;return ki=r,yp=r&&r.type.__scopeId||null,e}function ak(r){yp=r}function hk(){yp=null}function Ca(r,e=ki,s){if(!e||r._n)return r;const o=(...l)=>{o._d&&Ty(-1);const a=Zd(e);let h;try{h=r(...l)}finally{Zd(a),o._d&&Ty(1)}return h};return o._n=!0,o._c=!0,o._d=!0,o}function y$(r){const{type:e,vnode:s,proxy:o,withProxy:l,props:a,propsOptions:[h],slots:d,attrs:p,emit:f,render:m,renderCache:T,data:b,setupState:I,ctx:w,inheritAttrs:M}=r;let N,U;const W=Zd(r);try{if(s.shapeFlag&4){const F=l||o;N=no(m.call(F,F,T,a,I,b,w)),U=p}else{const F=e;N=no(F.length>1?F(a,{attrs:p,slots:d,emit:f}):F(a,null)),U=e.props?p:ZR(p)}}catch(F){xa.length=0,Ip(F,r,1),N=ye(Nn)}let tt=N;if(U&&M!==!1){const F=Object.keys(U),{shapeFlag:st}=tt;F.length&&st&7&&(h&&F.some(BT)&&(U=QR(U,h)),tt=rc(tt,U))}return s.dirs&&(tt=rc(tt),tt.dirs=tt.dirs?tt.dirs.concat(s.dirs):s.dirs),s.transition&&(tt.transition=s.transition),N=tt,Zd(W),N}const ZR=r=>{let e;for(const s in r)(s==="class"||s==="style"||$p(s))&&((e||(e={}))[s]=r[s]);return e},QR=(r,e)=>{const s={};for(const o in r)(!BT(o)||!(o.slice(9)in e))&&(s[o]=r[o]);return s};function tN(r,e,s){const{props:o,children:l,component:a}=r,{props:h,children:d,patchFlag:p}=e,f=a.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&p>=0){if(p&1024)return!0;if(p&16)return o?ay(o,h,f):!!h;if(p&8){const m=e.dynamicProps;for(let T=0;T<m.length;T++){const b=m[T];if(h[b]!==o[b]&&!Sp(f,b))return!0}}}else return(l||d)&&(!d||!d.$stable)?!0:o===h?!1:o?h?ay(o,h,f):!0:!!h;return!1}function ay(r,e,s){const o=Object.keys(e);if(o.length!==Object.keys(r).length)return!0;for(let l=0;l<o.length;l++){const a=o[l];if(e[a]!==r[a]&&!Sp(s,a))return!0}return!1}function eN({vnode:r,parent:e},s){for(;e&&e.subTree===r;)(r=e.vnode).el=s,e=e.parent}const iN=r=>r.__isSuspense;function sN(r,e){e&&e.pendingBranch?Ht(r)?e.effects.push(...r):e.effects.push(r):jR(r)}const ud={};function La(r,e,s){return uk(r,e,s)}function uk(r,e,{immediate:s,deep:o,flush:l,onTrack:a,onTrigger:h}=Me){var d;const p=_R()===((d=ci)==null?void 0:d.scope)?ci:null;let f,m=!1,T=!1;if(fi(r)?(f=()=>r.value,m=qd(r)):tc(r)?(f=()=>r,o=!0):Ht(r)?(T=!0,m=r.some(F=>tc(F)||qd(F)),f=()=>r.map(F=>{if(fi(F))return F.value;if(tc(F))return Kl(F);if(zt(F))return kn(F,p,2)})):zt(r)?e?f=()=>kn(r,p,2):f=()=>{if(!(p&&p.isUnmounted))return b&&b(),Rs(r,p,3,[I])}:f=As,e&&o){const F=f;f=()=>Kl(F())}let b,I=F=>{b=W.onStop=()=>{kn(F,p,4)}},w;if(uh)if(I=As,e?s&&Rs(e,p,3,[f(),T?[]:void 0,I]):f(),l==="sync"){const F=QN();w=F.__watcherHandles||(F.__watcherHandles=[])}else return As;let M=T?new Array(r.length).fill(ud):ud;const N=()=>{if(W.active)if(e){const F=W.run();(o||m||(T?F.some((st,it)=>Pr(st,M[it])):Pr(F,M)))&&(b&&b(),Rs(e,p,3,[F,M===ud?void 0:T&&M[0]===ud?[]:M,I]),M=F)}else W.run()};N.allowRecurse=!!e;let U;l==="sync"?U=N:l==="post"?U=()=>Bi(N,p&&p.suspense):(N.pre=!0,p&&(N.id=p.uid),U=()=>JT(N));const W=new WT(f,U);e?s?N():M=W.run():l==="post"?Bi(W.run.bind(W),p&&p.suspense):W.run();const tt=()=>{W.stop(),p&&p.scope&&FT(p.scope.effects,W)};return w&&w.push(tt),tt}function oN(r,e,s){const o=this.proxy,l=Ye(r)?r.includes(".")?dk(o,r):()=>o[r]:r.bind(o,o);let a;zt(e)?a=e:(a=e.handler,s=e);const h=ci;lc(this);const d=uk(l,a.bind(o),s);return h?lc(h):Lr(),d}function dk(r,e){const s=e.split(".");return()=>{let o=r;for(let l=0;l<s.length&&o;l++)o=o[s[l]];return o}}function Kl(r,e){if(!Be(r)||r.__v_skip||(e=e||new Set,e.has(r)))return r;if(e.add(r),fi(r))Kl(r.value,e);else if(Ht(r))for(let s=0;s<r.length;s++)Kl(r[s],e);else if(Dw(r)||Ql(r))r.forEach(s=>{Kl(s,e)});else if(Bw(r))for(const s in r)Kl(r[s],e);return r}function vr(r,e,s,o){const l=r.dirs,a=e&&e.dirs;for(let h=0;h<l.length;h++){const d=l[h];a&&(d.oldValue=a[h].value);let p=d.dir[o];p&&(Ec(),Rs(p,s,8,[r.el,d,r,e]),vc())}}const Ma=r=>!!r.type.__asyncLoader,pk=r=>r.type.__isKeepAlive;function nN(r,e){gk(r,"a",e)}function rN(r,e){gk(r,"da",e)}function gk(r,e,s=ci){const o=r.__wdc||(r.__wdc=()=>{let l=s;for(;l;){if(l.isDeactivated)return;l=l.parent}return r()});if(Cp(e,o,s),s){let l=s.parent;for(;l&&l.parent;)pk(l.parent.vnode)&&lN(o,e,s,l),l=l.parent}}function lN(r,e,s,o){const l=Cp(e,r,o,!0);fk(()=>{FT(o[e],l)},s)}function Cp(r,e,s=ci,o=!1){if(s){const l=s[r]||(s[r]=[]),a=e.__weh||(e.__weh=(...h)=>{if(s.isUnmounted)return;Ec(),lc(s);const d=Rs(e,s,r,h);return Lr(),vc(),d});return o?l.unshift(a):l.push(a),a}}const jo=r=>(e,s=ci)=>(!uh||r==="sp")&&Cp(r,(...o)=>e(...o),s),cN=jo("bm"),qT=jo("m"),aN=jo("bu"),hN=jo("u"),uN=jo("bum"),fk=jo("um"),dN=jo("sp"),pN=jo("rtg"),gN=jo("rtc");function fN(r,e=ci){Cp("ec",r,e)}const mk="components",$k=Symbol.for("v-ndc");function mN(r){return Ye(r)?$N(mk,r,!1)||r:r||$k}function $N(r,e,s=!0,o=!1){const l=ki||ci;if(l){const a=l.type;if(r===mk){const d=JN(a,!1);if(d&&(d===e||d===go(e)||d===Ep(go(e))))return a}const h=hy(l[r]||a[r],e)||hy(l.appContext[r],e);return!h&&o?a:h}}function hy(r,e){return r&&(r[e]||r[go(e)]||r[Ep(go(e))])}function wp(r,e,s,o){let l;const a=s&&s[o];if(Ht(r)||Ye(r)){l=new Array(r.length);for(let h=0,d=r.length;h<d;h++)l[h]=e(r[h],h,void 0,a&&a[h])}else if(typeof r=="number"){l=new Array(r);for(let h=0;h<r;h++)l[h]=e(h+1,h,void 0,a&&a[h])}else if(Be(r))if(r[Symbol.iterator])l=Array.from(r,(h,d)=>e(h,d,void 0,a&&a[d]));else{const h=Object.keys(r);l=new Array(h.length);for(let d=0,p=h.length;d<p;d++){const f=h[d];l[d]=e(r[f],f,d,a&&a[d])}}else l=[];return s&&(s[o]=l),l}function _N(r,e,s={},o,l){if(ki.isCE||ki.parent&&Ma(ki.parent)&&ki.parent.isCE)return e!=="default"&&(s.name=e),ye("slot",s,o&&o());let a=r[e];a&&a._c&&(a._d=!1),jt();const h=a&&_k(a(s)),d=tb(ni,{key:s.key||h&&h.key||`_${e}`},h||(o?o():[]),h&&r._===1?64:-2);return!l&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),a&&a._c&&(a._d=!0),d}function _k(r){return r.some(e=>kk(e)?!(e.type===Nn||e.type===ni&&!_k(e.children)):!0)?r:null}const S_=r=>r?Ak(r)?sb(r)||r.proxy:S_(r.parent):null,Da=Ti(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>S_(r.parent),$root:r=>S_(r.root),$emit:r=>r.emit,$options:r=>ZT(r),$forceUpdate:r=>r.f||(r.f=()=>JT(r.update)),$nextTick:r=>r.n||(r.n=zR.bind(r.proxy)),$watch:r=>oN.bind(r)}),C$=(r,e)=>r!==Me&&!r.__isScriptSetup&&ae(r,e),TN={get({_:r},e){const{ctx:s,setupState:o,data:l,props:a,accessCache:h,type:d,appContext:p}=r;let f;if(e[0]!=="$"){const I=h[e];if(I!==void 0)switch(I){case 1:return o[e];case 2:return l[e];case 4:return s[e];case 3:return a[e]}else{if(C$(o,e))return h[e]=1,o[e];if(l!==Me&&ae(l,e))return h[e]=2,l[e];if((f=r.propsOptions[0])&&ae(f,e))return h[e]=3,a[e];if(s!==Me&&ae(s,e))return h[e]=4,s[e];y_&&(h[e]=0)}}const m=Da[e];let T,b;if(m)return e==="$attrs"&&Hi(r,"get",e),m(r);if((T=d.__cssModules)&&(T=T[e]))return T;if(s!==Me&&ae(s,e))return h[e]=4,s[e];if(b=p.config.globalProperties,ae(b,e))return b[e]},set({_:r},e,s){const{data:o,setupState:l,ctx:a}=r;return C$(l,e)?(l[e]=s,!0):o!==Me&&ae(o,e)?(o[e]=s,!0):ae(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(a[e]=s,!0)},has({_:{data:r,setupState:e,accessCache:s,ctx:o,appContext:l,propsOptions:a}},h){let d;return!!s[h]||r!==Me&&ae(r,h)||C$(e,h)||(d=a[0])&&ae(d,h)||ae(o,h)||ae(Da,h)||ae(l.config.globalProperties,h)},defineProperty(r,e,s){return s.get!=null?r._.accessCache[e]=0:ae(s,"value")&&this.set(r,e,s.value,null),Reflect.defineProperty(r,e,s)}};function uy(r){return Ht(r)?r.reduce((e,s)=>(e[s]=null,e),{}):r}let y_=!0;function bN(r){const e=ZT(r),s=r.proxy,o=r.ctx;y_=!1,e.beforeCreate&&dy(e.beforeCreate,r,"bc");const{data:l,computed:a,methods:h,watch:d,provide:p,inject:f,created:m,beforeMount:T,mounted:b,beforeUpdate:I,updated:w,activated:M,deactivated:N,beforeDestroy:U,beforeUnmount:W,destroyed:tt,unmounted:F,render:st,renderTracked:it,renderTriggered:Tt,errorCaptured:Lt,serverPrefetch:It,expose:mt,inheritAttrs:Ct,components:Ft,directives:Nt,filters:qt}=e;if(f&&EN(f,o,null),h)for(const xt in h){const At=h[xt];zt(At)&&(o[xt]=At.bind(s))}if(l){const xt=l.call(s,s);Be(xt)&&(r.data=fo(xt))}if(y_=!0,a)for(const xt in a){const At=a[xt],Zt=zt(At)?At.bind(s,s):zt(At.get)?At.get.bind(s,s):As,Dt=!zt(At)&&zt(At.set)?At.set.bind(s):As,Ce=Ih({get:Zt,set:Dt});Object.defineProperty(o,xt,{enumerable:!0,configurable:!0,get:()=>Ce.value,set:ne=>Ce.value=ne})}if(d)for(const xt in d)Tk(d[xt],o,s,xt);if(p){const xt=zt(p)?p.call(s):p;Reflect.ownKeys(xt).forEach(At=>{wN(At,xt[At])})}m&&dy(m,r,"c");function Bt(xt,At){Ht(At)?At.forEach(Zt=>xt(Zt.bind(s))):At&&xt(At.bind(s))}if(Bt(cN,T),Bt(qT,b),Bt(aN,I),Bt(hN,w),Bt(nN,M),Bt(rN,N),Bt(fN,Lt),Bt(gN,it),Bt(pN,Tt),Bt(uN,W),Bt(fk,F),Bt(dN,It),Ht(mt))if(mt.length){const xt=r.exposed||(r.exposed={});mt.forEach(At=>{Object.defineProperty(xt,At,{get:()=>s[At],set:Zt=>s[At]=Zt})})}else r.exposed||(r.exposed={});st&&r.render===As&&(r.render=st),Ct!=null&&(r.inheritAttrs=Ct),Ft&&(r.components=Ft),Nt&&(r.directives=Nt)}function EN(r,e,s=As){Ht(r)&&(r=C_(r));for(const o in r){const l=r[o];let a;Be(l)?"default"in l?a=Md(l.from||o,l.default,!0):a=Md(l.from||o):a=Md(l),fi(a)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:h=>a.value=h}):e[o]=a}}function dy(r,e,s){Rs(Ht(r)?r.map(o=>o.bind(e.proxy)):r.bind(e.proxy),e,s)}function Tk(r,e,s,o){const l=o.includes(".")?dk(s,o):()=>s[o];if(Ye(r)){const a=e[r];zt(a)&&La(l,a)}else if(zt(r))La(l,r.bind(s));else if(Be(r))if(Ht(r))r.forEach(a=>Tk(a,e,s,o));else{const a=zt(r.handler)?r.handler.bind(s):e[r.handler];zt(a)&&La(l,a,r)}}function ZT(r){const e=r.type,{mixins:s,extends:o}=e,{mixins:l,optionsCache:a,config:{optionMergeStrategies:h}}=r.appContext,d=a.get(e);let p;return d?p=d:!l.length&&!s&&!o?p=e:(p={},l.length&&l.forEach(f=>Qd(p,f,h,!0)),Qd(p,e,h)),Be(e)&&a.set(e,p),p}function Qd(r,e,s,o=!1){const{mixins:l,extends:a}=e;a&&Qd(r,a,s,!0),l&&l.forEach(h=>Qd(r,h,s,!0));for(const h in e)if(!(o&&h==="expose")){const d=vN[h]||s&&s[h];r[h]=d?d(r[h],e[h]):e[h]}return r}const vN={data:py,props:gy,emits:gy,methods:wa,computed:wa,beforeCreate:Ci,created:Ci,beforeMount:Ci,mounted:Ci,beforeUpdate:Ci,updated:Ci,beforeDestroy:Ci,beforeUnmount:Ci,destroyed:Ci,unmounted:Ci,activated:Ci,deactivated:Ci,errorCaptured:Ci,serverPrefetch:Ci,components:wa,directives:wa,watch:SN,provide:py,inject:IN};function py(r,e){return e?r?function(){return Ti(zt(r)?r.call(this,this):r,zt(e)?e.call(this,this):e)}:e:r}function IN(r,e){return wa(C_(r),C_(e))}function C_(r){if(Ht(r)){const e={};for(let s=0;s<r.length;s++)e[r[s]]=r[s];return e}return r}function Ci(r,e){return r?[...new Set([].concat(r,e))]:e}function wa(r,e){return r?Ti(Object.create(null),r,e):e}function gy(r,e){return r?Ht(r)&&Ht(e)?[...new Set([...r,...e])]:Ti(Object.create(null),uy(r),uy(e??{})):e}function SN(r,e){if(!r)return e;if(!e)return r;const s=Ti(Object.create(null),r);for(const o in e)s[o]=Ci(r[o],e[o]);return s}function bk(){return{app:null,config:{isNativeTag:sR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yN=0;function CN(r,e){return function(o,l=null){zt(o)||(o=Ti({},o)),l!=null&&!Be(l)&&(l=null);const a=bk(),h=new WeakSet;let d=!1;const p=a.app={_uid:yN++,_component:o,_props:l,_container:null,_context:a,_instance:null,version:tL,get config(){return a.config},set config(f){},use(f,...m){return h.has(f)||(f&&zt(f.install)?(h.add(f),f.install(p,...m)):zt(f)&&(h.add(f),f(p,...m))),p},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),p},component(f,m){return m?(a.components[f]=m,p):a.components[f]},directive(f,m){return m?(a.directives[f]=m,p):a.directives[f]},mount(f,m,T){if(!d){const b=ye(o,l);return b.appContext=a,m&&e?e(b,f):r(b,f,T),d=!0,p._container=f,f.__vue_app__=p,sb(b.component)||b.component.proxy}},unmount(){d&&(r(null,p._container),delete p._container.__vue_app__)},provide(f,m){return a.provides[f]=m,p},runWithContext(f){tp=p;try{return f()}finally{tp=null}}};return p}}let tp=null;function wN(r,e){if(ci){let s=ci.provides;const o=ci.parent&&ci.parent.provides;o===s&&(s=ci.provides=Object.create(o)),s[r]=e}}function Md(r,e,s=!1){const o=ci||ki;if(o||tp){const l=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:tp._context.provides;if(l&&r in l)return l[r];if(arguments.length>1)return s&&zt(e)?e.call(o&&o.proxy):e}}function kN(r,e,s,o=!1){const l={},a={};Jd(a,Op,1),r.propsDefaults=Object.create(null),Ek(r,e,l,a);for(const h in r.propsOptions[0])h in l||(l[h]=void 0);s?r.props=o?l:FR(l):r.type.props?r.props=l:r.props=a,r.attrs=a}function ON(r,e,s,o){const{props:l,attrs:a,vnode:{patchFlag:h}}=r,d=ue(l),[p]=r.propsOptions;let f=!1;if((o||h>0)&&!(h&16)){if(h&8){const m=r.vnode.dynamicProps;for(let T=0;T<m.length;T++){let b=m[T];if(Sp(r.emitsOptions,b))continue;const I=e[b];if(p)if(ae(a,b))I!==a[b]&&(a[b]=I,f=!0);else{const w=go(b);l[w]=w_(p,d,w,I,r,!1)}else I!==a[b]&&(a[b]=I,f=!0)}}}else{Ek(r,e,l,a)&&(f=!0);let m;for(const T in d)(!e||!ae(e,T)&&((m=bc(T))===T||!ae(e,m)))&&(p?s&&(s[T]!==void 0||s[m]!==void 0)&&(l[T]=w_(p,d,T,void 0,r,!0)):delete l[T]);if(a!==d)for(const T in a)(!e||!ae(e,T))&&(delete a[T],f=!0)}f&&Fo(r,"set","$attrs")}function Ek(r,e,s,o){const[l,a]=r.propsOptions;let h=!1,d;if(e)for(let p in e){if(Ld(p))continue;const f=e[p];let m;l&&ae(l,m=go(p))?!a||!a.includes(m)?s[m]=f:(d||(d={}))[m]=f:Sp(r.emitsOptions,p)||(!(p in o)||f!==o[p])&&(o[p]=f,h=!0)}if(a){const p=ue(s),f=d||Me;for(let m=0;m<a.length;m++){const T=a[m];s[T]=w_(l,p,T,f[T],r,!ae(f,T))}}return h}function w_(r,e,s,o,l,a){const h=r[s];if(h!=null){const d=ae(h,"default");if(d&&o===void 0){const p=h.default;if(h.type!==Function&&!h.skipFactory&&zt(p)){const{propsDefaults:f}=l;s in f?o=f[s]:(lc(l),o=f[s]=p.call(null,e),Lr())}else o=p}h[0]&&(a&&!d?o=!1:h[1]&&(o===""||o===bc(s))&&(o=!0))}return o}function vk(r,e,s=!1){const o=e.propsCache,l=o.get(r);if(l)return l;const a=r.props,h={},d=[];let p=!1;if(!zt(r)){const m=T=>{p=!0;const[b,I]=vk(T,e,!0);Ti(h,b),I&&d.push(...I)};!s&&e.mixins.length&&e.mixins.forEach(m),r.extends&&m(r.extends),r.mixins&&r.mixins.forEach(m)}if(!a&&!p)return Be(r)&&o.set(r,Zl),Zl;if(Ht(a))for(let m=0;m<a.length;m++){const T=go(a[m]);fy(T)&&(h[T]=Me)}else if(a)for(const m in a){const T=go(m);if(fy(T)){const b=a[m],I=h[T]=Ht(b)||zt(b)?{type:b}:Ti({},b);if(I){const w=_y(Boolean,I.type),M=_y(String,I.type);I[0]=w>-1,I[1]=M<0||w<M,(w>-1||ae(I,"default"))&&d.push(T)}}}const f=[h,d];return Be(r)&&o.set(r,f),f}function fy(r){return r[0]!=="$"}function my(r){const e=r&&r.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:r===null?"null":""}function $y(r,e){return my(r)===my(e)}function _y(r,e){return Ht(e)?e.findIndex(s=>$y(s,r)):zt(e)&&$y(e,r)?0:-1}const Ik=r=>r[0]==="_"||r==="$stable",QT=r=>Ht(r)?r.map(no):[no(r)],AN=(r,e,s)=>{if(e._n)return e;const o=Ca((...l)=>QT(e(...l)),s);return o._c=!1,o},Sk=(r,e,s)=>{const o=r._ctx;for(const l in r){if(Ik(l))continue;const a=r[l];if(zt(a))e[l]=AN(l,a,o);else if(a!=null){const h=QT(a);e[l]=()=>h}}},yk=(r,e)=>{const s=QT(e);r.slots.default=()=>s},RN=(r,e)=>{if(r.vnode.shapeFlag&32){const s=e._;s?(r.slots=ue(e),Jd(e,"_",s)):Sk(e,r.slots={})}else r.slots={},e&&yk(r,e);Jd(r.slots,Op,1)},NN=(r,e,s)=>{const{vnode:o,slots:l}=r;let a=!0,h=Me;if(o.shapeFlag&32){const d=e._;d?s&&d===1?a=!1:(Ti(l,e),!s&&d===1&&delete l._):(a=!e.$stable,Sk(e,l)),h=e}else e&&(yk(r,e),h={default:1});if(a)for(const d in l)!Ik(d)&&h[d]==null&&delete l[d]};function k_(r,e,s,o,l=!1){if(Ht(r)){r.forEach((b,I)=>k_(b,e&&(Ht(e)?e[I]:e),s,o,l));return}if(Ma(o)&&!l)return;const a=o.shapeFlag&4?sb(o.component)||o.component.proxy:o.el,h=l?null:a,{i:d,r:p}=r,f=e&&e.r,m=d.refs===Me?d.refs={}:d.refs,T=d.setupState;if(f!=null&&f!==p&&(Ye(f)?(m[f]=null,ae(T,f)&&(T[f]=null)):fi(f)&&(f.value=null)),zt(p))kn(p,d,12,[h,m]);else{const b=Ye(p),I=fi(p);if(b||I){const w=()=>{if(r.f){const M=b?ae(T,p)?T[p]:m[p]:p.value;l?Ht(M)&&FT(M,a):Ht(M)?M.includes(a)||M.push(a):b?(m[p]=[a],ae(T,p)&&(T[p]=m[p])):(p.value=[a],r.k&&(m[r.k]=p.value))}else b?(m[p]=h,ae(T,p)&&(T[p]=h)):I&&(p.value=h,r.k&&(m[r.k]=h))};h?(w.id=-1,Bi(w,s)):w()}}}const Bi=sN;function LN(r){return MN(r)}function MN(r,e){const s=__();s.__VUE__=!0;const{insert:o,remove:l,patchProp:a,createElement:h,createText:d,createComment:p,setText:f,setElementText:m,parentNode:T,nextSibling:b,setScopeId:I=As,insertStaticContent:w}=r,M=(y,D,H,j=null,z=null,nt=null,rt=!1,Z=null,et=!!D.dynamicChildren)=>{if(y===D)return;y&&!_a(y,D)&&(j=Ne(y),ne(y,z,nt,!0),y=null),D.patchFlag===-2&&(et=!1,D.dynamicChildren=null);const{type:q,ref:ut,shapeFlag:A}=D;switch(q){case kp:N(y,D,H,j);break;case Nn:U(y,D,H,j);break;case Dd:y==null&&W(D,H,j,rt);break;case ni:Ft(y,D,H,j,z,nt,rt,Z,et);break;default:A&1?st(y,D,H,j,z,nt,rt,Z,et):A&6?Nt(y,D,H,j,z,nt,rt,Z,et):(A&64||A&128)&&q.process(y,D,H,j,z,nt,rt,Z,et,Xe)}ut!=null&&z&&k_(ut,y&&y.ref,nt,D||y,!D)},N=(y,D,H,j)=>{if(y==null)o(D.el=d(D.children),H,j);else{const z=D.el=y.el;D.children!==y.children&&f(z,D.children)}},U=(y,D,H,j)=>{y==null?o(D.el=p(D.children||""),H,j):D.el=y.el},W=(y,D,H,j)=>{[y.el,y.anchor]=w(y.children,D,H,j,y.el,y.anchor)},tt=({el:y,anchor:D},H,j)=>{let z;for(;y&&y!==D;)z=b(y),o(y,H,j),y=z;o(D,H,j)},F=({el:y,anchor:D})=>{let H;for(;y&&y!==D;)H=b(y),l(y),y=H;l(D)},st=(y,D,H,j,z,nt,rt,Z,et)=>{rt=rt||D.type==="svg",y==null?it(D,H,j,z,nt,rt,Z,et):It(y,D,z,nt,rt,Z,et)},it=(y,D,H,j,z,nt,rt,Z)=>{let et,q;const{type:ut,props:A,shapeFlag:X,transition:kt,dirs:ft}=y;if(et=y.el=h(y.type,nt,A&&A.is,A),X&8?m(et,y.children):X&16&&Lt(y.children,et,null,j,z,nt&&ut!=="foreignObject",rt,Z),ft&&vr(y,null,j,"created"),Tt(et,y,y.scopeId,rt,j),A){for(const bt in A)bt!=="value"&&!Ld(bt)&&a(et,bt,null,A[bt],nt,y.children,j,z,xe);"value"in A&&a(et,"value",null,A.value),(q=A.onVnodeBeforeMount)&&to(q,j,y)}ft&&vr(y,null,j,"beforeMount");const Yt=DN(z,kt);Yt&&kt.beforeEnter(et),o(et,D,H),((q=A&&A.onVnodeMounted)||Yt||ft)&&Bi(()=>{q&&to(q,j,y),Yt&&kt.enter(et),ft&&vr(y,null,j,"mounted")},z)},Tt=(y,D,H,j,z)=>{if(H&&I(y,H),j)for(let nt=0;nt<j.length;nt++)I(y,j[nt]);if(z){let nt=z.subTree;if(D===nt){const rt=z.vnode;Tt(y,rt,rt.scopeId,rt.slotScopeIds,z.parent)}}},Lt=(y,D,H,j,z,nt,rt,Z,et=0)=>{for(let q=et;q<y.length;q++){const ut=y[q]=Z?En(y[q]):no(y[q]);M(null,ut,D,H,j,z,nt,rt,Z)}},It=(y,D,H,j,z,nt,rt)=>{const Z=D.el=y.el;let{patchFlag:et,dynamicChildren:q,dirs:ut}=D;et|=y.patchFlag&16;const A=y.props||Me,X=D.props||Me;let kt;H&&Ir(H,!1),(kt=X.onVnodeBeforeUpdate)&&to(kt,H,D,y),ut&&vr(D,y,H,"beforeUpdate"),H&&Ir(H,!0);const ft=z&&D.type!=="foreignObject";if(q?mt(y.dynamicChildren,q,Z,H,j,ft,nt):rt||At(y,D,Z,null,H,j,ft,nt,!1),et>0){if(et&16)Ct(Z,D,A,X,H,j,z);else if(et&2&&A.class!==X.class&&a(Z,"class",null,X.class,z),et&4&&a(Z,"style",A.style,X.style,z),et&8){const Yt=D.dynamicProps;for(let bt=0;bt<Yt.length;bt++){const re=Yt[bt],O=A[re],$=X[re];($!==O||re==="value")&&a(Z,re,O,$,z,y.children,H,j,xe)}}et&1&&y.children!==D.children&&m(Z,D.children)}else!rt&&q==null&&Ct(Z,D,A,X,H,j,z);((kt=X.onVnodeUpdated)||ut)&&Bi(()=>{kt&&to(kt,H,D,y),ut&&vr(D,y,H,"updated")},j)},mt=(y,D,H,j,z,nt,rt)=>{for(let Z=0;Z<D.length;Z++){const et=y[Z],q=D[Z],ut=et.el&&(et.type===ni||!_a(et,q)||et.shapeFlag&70)?T(et.el):H;M(et,q,ut,null,j,z,nt,rt,!0)}},Ct=(y,D,H,j,z,nt,rt)=>{if(H!==j){if(H!==Me)for(const Z in H)!Ld(Z)&&!(Z in j)&&a(y,Z,H[Z],null,rt,D.children,z,nt,xe);for(const Z in j){if(Ld(Z))continue;const et=j[Z],q=H[Z];et!==q&&Z!=="value"&&a(y,Z,q,et,rt,D.children,z,nt,xe)}"value"in j&&a(y,"value",H.value,j.value)}},Ft=(y,D,H,j,z,nt,rt,Z,et)=>{const q=D.el=y?y.el:d(""),ut=D.anchor=y?y.anchor:d("");let{patchFlag:A,dynamicChildren:X,slotScopeIds:kt}=D;kt&&(Z=Z?Z.concat(kt):kt),y==null?(o(q,H,j),o(ut,H,j),Lt(D.children,H,ut,z,nt,rt,Z,et)):A>0&&A&64&&X&&y.dynamicChildren?(mt(y.dynamicChildren,X,H,z,nt,rt,Z),(D.key!=null||z&&D===z.subTree)&&Ck(y,D,!0)):At(y,D,H,ut,z,nt,rt,Z,et)},Nt=(y,D,H,j,z,nt,rt,Z,et)=>{D.slotScopeIds=Z,y==null?D.shapeFlag&512?z.ctx.activate(D,H,j,rt,et):qt(D,H,j,z,nt,rt,et):at(y,D,et)},qt=(y,D,H,j,z,nt,rt)=>{const Z=y.component=XN(y,j,z);if(pk(y)&&(Z.ctx.renderer=Xe),zN(Z),Z.asyncDep){if(z&&z.registerDep(Z,Bt),!y.el){const et=Z.subTree=ye(Nn);U(null,et,D,H)}return}Bt(Z,y,D,H,z,nt,rt)},at=(y,D,H)=>{const j=D.component=y.component;if(tN(y,D,H))if(j.asyncDep&&!j.asyncResolved){xt(j,D,H);return}else j.next=D,KR(j.update),j.update();else D.el=y.el,j.vnode=D},Bt=(y,D,H,j,z,nt,rt)=>{const Z=()=>{if(y.isMounted){let{next:ut,bu:A,u:X,parent:kt,vnode:ft}=y,Yt=ut,bt;Ir(y,!1),ut?(ut.el=ft.el,xt(y,ut,rt)):ut=ft,A&&S$(A),(bt=ut.props&&ut.props.onVnodeBeforeUpdate)&&to(bt,kt,ut,ft),Ir(y,!0);const re=y$(y),O=y.subTree;y.subTree=re,M(O,re,T(O.el),Ne(O),y,z,nt),ut.el=re.el,Yt===null&&eN(y,re.el),X&&Bi(X,z),(bt=ut.props&&ut.props.onVnodeUpdated)&&Bi(()=>to(bt,kt,ut,ft),z)}else{let ut;const{el:A,props:X}=D,{bm:kt,m:ft,parent:Yt}=y,bt=Ma(D);if(Ir(y,!1),kt&&S$(kt),!bt&&(ut=X&&X.onVnodeBeforeMount)&&to(ut,Yt,D),Ir(y,!0),A&&hi){const re=()=>{y.subTree=y$(y),hi(A,y.subTree,y,z,null)};bt?D.type.__asyncLoader().then(()=>!y.isUnmounted&&re()):re()}else{const re=y.subTree=y$(y);M(null,re,H,j,y,z,nt),D.el=re.el}if(ft&&Bi(ft,z),!bt&&(ut=X&&X.onVnodeMounted)){const re=D;Bi(()=>to(ut,Yt,re),z)}(D.shapeFlag&256||Yt&&Ma(Yt.vnode)&&Yt.vnode.shapeFlag&256)&&y.a&&Bi(y.a,z),y.isMounted=!0,D=H=j=null}},et=y.effect=new WT(Z,()=>JT(q),y.scope),q=y.update=()=>et.run();q.id=y.uid,Ir(y,!0),q()},xt=(y,D,H)=>{D.component=y;const j=y.vnode.props;y.vnode=D,y.next=null,ON(y,D.props,j,H),NN(y,D.children,H),Ec(),cy(),vc()},At=(y,D,H,j,z,nt,rt,Z,et=!1)=>{const q=y&&y.children,ut=y?y.shapeFlag:0,A=D.children,{patchFlag:X,shapeFlag:kt}=D;if(X>0){if(X&128){Dt(q,A,H,j,z,nt,rt,Z,et);return}else if(X&256){Zt(q,A,H,j,z,nt,rt,Z,et);return}}kt&8?(ut&16&&xe(q,z,nt),A!==q&&m(H,A)):ut&16?kt&16?Dt(q,A,H,j,z,nt,rt,Z,et):xe(q,z,nt,!0):(ut&8&&m(H,""),kt&16&&Lt(A,H,j,z,nt,rt,Z,et))},Zt=(y,D,H,j,z,nt,rt,Z,et)=>{y=y||Zl,D=D||Zl;const q=y.length,ut=D.length,A=Math.min(q,ut);let X;for(X=0;X<A;X++){const kt=D[X]=et?En(D[X]):no(D[X]);M(y[X],kt,H,null,z,nt,rt,Z,et)}q>ut?xe(y,z,nt,!0,!1,A):Lt(D,H,j,z,nt,rt,Z,et,A)},Dt=(y,D,H,j,z,nt,rt,Z,et)=>{let q=0;const ut=D.length;let A=y.length-1,X=ut-1;for(;q<=A&&q<=X;){const kt=y[q],ft=D[q]=et?En(D[q]):no(D[q]);if(_a(kt,ft))M(kt,ft,H,null,z,nt,rt,Z,et);else break;q++}for(;q<=A&&q<=X;){const kt=y[A],ft=D[X]=et?En(D[X]):no(D[X]);if(_a(kt,ft))M(kt,ft,H,null,z,nt,rt,Z,et);else break;A--,X--}if(q>A){if(q<=X){const kt=X+1,ft=kt<ut?D[kt].el:j;for(;q<=X;)M(null,D[q]=et?En(D[q]):no(D[q]),H,ft,z,nt,rt,Z,et),q++}}else if(q>X)for(;q<=A;)ne(y[q],z,nt,!0),q++;else{const kt=q,ft=q,Yt=new Map;for(q=ft;q<=X;q++){const Y=D[q]=et?En(D[q]):no(D[q]);Y.key!=null&&Yt.set(Y.key,q)}let bt,re=0;const O=X-ft+1;let $=!1,S=0;const R=new Array(O);for(q=0;q<O;q++)R[q]=0;for(q=kt;q<=A;q++){const Y=y[q];if(re>=O){ne(Y,z,nt,!0);continue}let Mt;if(Y.key!=null)Mt=Yt.get(Y.key);else for(bt=ft;bt<=X;bt++)if(R[bt-ft]===0&&_a(Y,D[bt])){Mt=bt;break}Mt===void 0?ne(Y,z,nt,!0):(R[Mt-ft]=q+1,Mt>=S?S=Mt:$=!0,M(Y,D[Mt],H,null,z,nt,rt,Z,et),re++)}const B=$?xN(R):Zl;for(bt=B.length-1,q=O-1;q>=0;q--){const Y=ft+q,Mt=D[Y],ge=Y+1<ut?D[Y+1].el:j;R[q]===0?M(null,Mt,H,ge,z,nt,rt,Z,et):$&&(bt<0||q!==B[bt]?Ce(Mt,H,ge,2):bt--)}}},Ce=(y,D,H,j,z=null)=>{const{el:nt,type:rt,transition:Z,children:et,shapeFlag:q}=y;if(q&6){Ce(y.component.subTree,D,H,j);return}if(q&128){y.suspense.move(D,H,j);return}if(q&64){rt.move(y,D,H,Xe);return}if(rt===ni){o(nt,D,H);for(let A=0;A<et.length;A++)Ce(et[A],D,H,j);o(y.anchor,D,H);return}if(rt===Dd){tt(y,D,H);return}if(j!==2&&q&1&&Z)if(j===0)Z.beforeEnter(nt),o(nt,D,H),Bi(()=>Z.enter(nt),z);else{const{leave:A,delayLeave:X,afterLeave:kt}=Z,ft=()=>o(nt,D,H),Yt=()=>{A(nt,()=>{ft(),kt&&kt()})};X?X(nt,ft,Yt):Yt()}else o(nt,D,H)},ne=(y,D,H,j=!1,z=!1)=>{const{type:nt,props:rt,ref:Z,children:et,dynamicChildren:q,shapeFlag:ut,patchFlag:A,dirs:X}=y;if(Z!=null&&k_(Z,null,H,y,!0),ut&256){D.ctx.deactivate(y);return}const kt=ut&1&&X,ft=!Ma(y);let Yt;if(ft&&(Yt=rt&&rt.onVnodeBeforeUnmount)&&to(Yt,D,y),ut&6)qe(y.component,H,j);else{if(ut&128){y.suspense.unmount(H,j);return}kt&&vr(y,null,D,"beforeUnmount"),ut&64?y.type.remove(y,D,H,z,Xe,j):q&&(nt!==ni||A>0&&A&64)?xe(q,D,H,!1,!0):(nt===ni&&A&384||!z&&ut&16)&&xe(et,D,H),j&&We(y)}(ft&&(Yt=rt&&rt.onVnodeUnmounted)||kt)&&Bi(()=>{Yt&&to(Yt,D,y),kt&&vr(y,null,D,"unmounted")},H)},We=y=>{const{type:D,el:H,anchor:j,transition:z}=y;if(D===ni){pt(H,j);return}if(D===Dd){F(y);return}const nt=()=>{l(H),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(y.shapeFlag&1&&z&&!z.persisted){const{leave:rt,delayLeave:Z}=z,et=()=>rt(H,nt);Z?Z(y.el,nt,et):et()}else nt()},pt=(y,D)=>{let H;for(;y!==D;)H=b(y),l(y),y=H;l(D)},qe=(y,D,H)=>{const{bum:j,scope:z,update:nt,subTree:rt,um:Z}=y;j&&S$(j),z.stop(),nt&&(nt.active=!1,ne(rt,y,D,H)),Z&&Bi(Z,D),Bi(()=>{y.isUnmounted=!0},D),D&&D.pendingBranch&&!D.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===D.pendingId&&(D.deps--,D.deps===0&&D.resolve())},xe=(y,D,H,j=!1,z=!1,nt=0)=>{for(let rt=nt;rt<y.length;rt++)ne(y[rt],D,H,j,z)},Ne=y=>y.shapeFlag&6?Ne(y.component.subTree):y.shapeFlag&128?y.suspense.next():b(y.anchor||y.el),Te=(y,D,H)=>{y==null?D._vnode&&ne(D._vnode,null,null,!0):M(D._vnode||null,y,D,null,null,null,H),cy(),rk(),D._vnode=y},Xe={p:M,um:ne,m:Ce,r:We,mt:qt,mc:Lt,pc:At,pbc:mt,n:Ne,o:r};let ai,hi;return e&&([ai,hi]=e(Xe)),{render:Te,hydrate:ai,createApp:CN(Te,ai)}}function Ir({effect:r,update:e},s){r.allowRecurse=e.allowRecurse=s}function DN(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function Ck(r,e,s=!1){const o=r.children,l=e.children;if(Ht(o)&&Ht(l))for(let a=0;a<o.length;a++){const h=o[a];let d=l[a];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=l[a]=En(l[a]),d.el=h.el),s||Ck(h,d)),d.type===kp&&(d.el=h.el)}}function xN(r){const e=r.slice(),s=[0];let o,l,a,h,d;const p=r.length;for(o=0;o<p;o++){const f=r[o];if(f!==0){if(l=s[s.length-1],r[l]<f){e[o]=l,s.push(o);continue}for(a=0,h=s.length-1;a<h;)d=a+h>>1,r[s[d]]<f?a=d+1:h=d;f<r[s[a]]&&(a>0&&(e[o]=s[a-1]),s[a]=o)}}for(a=s.length,h=s[a-1];a-- >0;)s[a]=h,h=e[h];return s}const PN=r=>r.__isTeleport,ni=Symbol.for("v-fgt"),kp=Symbol.for("v-txt"),Nn=Symbol.for("v-cmt"),Dd=Symbol.for("v-stc"),xa=[];let Os=null;function jt(r=!1){xa.push(Os=r?null:[])}function BN(){xa.pop(),Os=xa[xa.length-1]||null}let hh=1;function Ty(r){hh+=r}function wk(r){return r.dynamicChildren=hh>0?Os||Zl:null,BN(),hh>0&&Os&&Os.push(r),r}function te(r,e,s,o,l,a){return wk(ht(r,e,s,o,l,a,!0))}function tb(r,e,s,o,l){return wk(ye(r,e,s,o,l,!0))}function kk(r){return r?r.__v_isVNode===!0:!1}function _a(r,e){return r.type===e.type&&r.key===e.key}const Op="__vInternal",Ok=({key:r})=>r??null,xd=({ref:r,ref_key:e,ref_for:s})=>(typeof r=="number"&&(r=""+r),r!=null?Ye(r)||fi(r)||zt(r)?{i:ki,r,k:e,f:!!s}:r:null);function ht(r,e=null,s=null,o=0,l=null,a=r===ni?0:1,h=!1,d=!1){const p={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&Ok(e),ref:e&&xd(e),scopeId:yp,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:o,dynamicProps:l,dynamicChildren:null,appContext:null,ctx:ki};return d?(eb(p,s),a&128&&r.normalize(p)):s&&(p.shapeFlag|=Ye(s)?8:16),hh>0&&!h&&Os&&(p.patchFlag>0||a&6)&&p.patchFlag!==32&&Os.push(p),p}const ye=FN;function FN(r,e=null,s=null,o=0,l=null,a=!1){if((!r||r===$k)&&(r=Nn),kk(r)){const d=rc(r,e,!0);return s&&eb(d,s),hh>0&&!a&&Os&&(d.shapeFlag&6?Os[Os.indexOf(r)]=d:Os.push(d)),d.patchFlag|=-2,d}if(qN(r)&&(r=r.__vccOpts),e){e=HN(e);let{class:d,style:p}=e;d&&!Ye(d)&&(e.class=VT(d)),Be(p)&&(Zw(p)&&!Ht(p)&&(p=Ti({},p)),e.style=UT(p))}const h=Ye(r)?1:iN(r)?128:PN(r)?64:Be(r)?4:zt(r)?2:0;return ht(r,e,s,o,l,h,a,!0)}function HN(r){return r?Zw(r)||Op in r?Ti({},r):r:null}function rc(r,e,s=!1){const{props:o,ref:l,patchFlag:a,children:h}=r,d=e?VN(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:d,key:d&&Ok(d),ref:e&&e.ref?s&&l?Ht(l)?l.concat(xd(e)):[l,xd(e)]:xd(e):l,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:h,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==ni?a===-1?16:a|16:a,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&rc(r.ssContent),ssFallback:r.ssFallback&&rc(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce}}function jl(r=" ",e=0){return ye(kp,null,r,e)}function UN(r,e){const s=ye(Dd,null,r);return s.staticCount=e,s}function Pa(r="",e=!1){return e?(jt(),tb(Nn,null,r)):ye(Nn,null,r)}function no(r){return r==null||typeof r=="boolean"?ye(Nn):Ht(r)?ye(ni,null,r.slice()):typeof r=="object"?En(r):ye(kp,null,String(r))}function En(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:rc(r)}function eb(r,e){let s=0;const{shapeFlag:o}=r;if(e==null)e=null;else if(Ht(e))s=16;else if(typeof e=="object")if(o&65){const l=e.default;l&&(l._c&&(l._d=!1),eb(r,l()),l._c&&(l._d=!0));return}else{s=32;const l=e._;!l&&!(Op in e)?e._ctx=ki:l===3&&ki&&(ki.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else zt(e)?(e={default:e,_ctx:ki},s=32):(e=String(e),o&64?(s=16,e=[jl(e)]):s=8);r.children=e,r.shapeFlag|=s}function VN(...r){const e={};for(let s=0;s<r.length;s++){const o=r[s];for(const l in o)if(l==="class")e.class!==o.class&&(e.class=VT([e.class,o.class]));else if(l==="style")e.style=UT([e.style,o.style]);else if($p(l)){const a=e[l],h=o[l];h&&a!==h&&!(Ht(a)&&a.includes(h))&&(e[l]=a?[].concat(a,h):h)}else l!==""&&(e[l]=o[l])}return e}function to(r,e,s,o=null){Rs(r,e,7,[s,o])}const GN=bk();let WN=0;function XN(r,e,s){const o=r.type,l=(e?e.appContext:r.appContext)||GN,a={uid:WN++,vnode:r,type:o,parent:e,appContext:l,root:null,next:null,subTree:null,effect:null,update:null,scope:new mR(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(l.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vk(o,l),emitsOptions:ck(o,l),emit:null,emitted:null,propsDefaults:Me,inheritAttrs:o.inheritAttrs,ctx:Me,data:Me,props:Me,attrs:Me,slots:Me,refs:Me,setupState:Me,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=qR.bind(null,a),r.ce&&r.ce(a),a}let ci=null,ib,Ul,by="__VUE_INSTANCE_SETTERS__";(Ul=__()[by])||(Ul=__()[by]=[]),Ul.push(r=>ci=r),ib=r=>{Ul.length>1?Ul.forEach(e=>e(r)):Ul[0](r)};const lc=r=>{ib(r),r.scope.on()},Lr=()=>{ci&&ci.scope.off(),ib(null)};function Ak(r){return r.vnode.shapeFlag&4}let uh=!1;function zN(r,e=!1){uh=e;const{props:s,children:o}=r.vnode,l=Ak(r);kN(r,s,l,e),RN(r,o);const a=l?YN(r,e):void 0;return uh=!1,a}function YN(r,e){const s=r.type;r.accessCache=Object.create(null),r.proxy=Qw(new Proxy(r.ctx,TN));const{setup:o}=s;if(o){const l=r.setupContext=o.length>1?jN(r):null;lc(r),Ec();const a=kn(o,r,0,[r.props,l]);if(vc(),Lr(),xw(a)){if(a.then(Lr,Lr),e)return a.then(h=>{Ey(r,h,e)}).catch(h=>{Ip(h,r,0)});r.asyncDep=a}else Ey(r,a,e)}else Rk(r,e)}function Ey(r,e,s){zt(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:Be(e)&&(r.setupState=sk(e)),Rk(r,s)}let vy;function Rk(r,e,s){const o=r.type;if(!r.render){if(!e&&vy&&!o.render){const l=o.template||ZT(r).template;if(l){const{isCustomElement:a,compilerOptions:h}=r.appContext.config,{delimiters:d,compilerOptions:p}=o,f=Ti(Ti({isCustomElement:a,delimiters:d},h),p);o.render=vy(l,f)}}r.render=o.render||As}{lc(r),Ec();try{bN(r)}finally{vc(),Lr()}}}function KN(r){return r.attrsProxy||(r.attrsProxy=new Proxy(r.attrs,{get(e,s){return Hi(r,"get","$attrs"),e[s]}}))}function jN(r){const e=s=>{r.exposed=s||{}};return{get attrs(){return KN(r)},slots:r.slots,emit:r.emit,expose:e}}function sb(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(sk(Qw(r.exposed)),{get(e,s){if(s in e)return e[s];if(s in Da)return Da[s](r)},has(e,s){return s in e||s in Da}}))}function JN(r,e=!0){return zt(r)?r.displayName||r.name:r.name||e&&r.__name}function qN(r){return zt(r)&&"__vccOpts"in r}const Ih=(r,e)=>WR(r,e,uh),ZN=Symbol.for("v-scx"),QN=()=>Md(ZN),tL="3.3.7",eL="http://www.w3.org/2000/svg",Cr=typeof document<"u"?document:null,Iy=Cr&&Cr.createElement("template"),iL={insert:(r,e,s)=>{e.insertBefore(r,s||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,s,o)=>{const l=e?Cr.createElementNS(eL,r):Cr.createElement(r,s?{is:s}:void 0);return r==="select"&&o&&o.multiple!=null&&l.setAttribute("multiple",o.multiple),l},createText:r=>Cr.createTextNode(r),createComment:r=>Cr.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Cr.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,s,o,l,a){const h=s?s.previousSibling:e.lastChild;if(l&&(l===a||l.nextSibling))for(;e.insertBefore(l.cloneNode(!0),s),!(l===a||!(l=l.nextSibling)););else{Iy.innerHTML=o?`<svg>${r}</svg>`:r;const d=Iy.content;if(o){const p=d.firstChild;for(;p.firstChild;)d.appendChild(p.firstChild);d.removeChild(p)}e.insertBefore(d,s)}return[h?h.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},sL=Symbol("_vtc");function oL(r,e,s){const o=r[sL];o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?r.removeAttribute("class"):s?r.setAttribute("class",e):r.className=e}const nL=Symbol("_vod");function rL(r,e,s){const o=r.style,l=Ye(s);if(s&&!l){if(e&&!Ye(e))for(const a in e)s[a]==null&&O_(o,a,"");for(const a in s)O_(o,a,s[a])}else{const a=o.display;l?e!==s&&(o.cssText=s):e&&r.removeAttribute("style"),nL in r&&(o.display=a)}}const Sy=/\s*!important$/;function O_(r,e,s){if(Ht(s))s.forEach(o=>O_(r,e,o));else if(s==null&&(s=""),e.startsWith("--"))r.setProperty(e,s);else{const o=lL(r,e);Sy.test(s)?r.setProperty(bc(o),s.replace(Sy,""),"important"):r[o]=s}}const yy=["Webkit","Moz","ms"],w$={};function lL(r,e){const s=w$[e];if(s)return s;let o=go(e);if(o!=="filter"&&o in r)return w$[e]=o;o=Ep(o);for(let l=0;l<yy.length;l++){const a=yy[l]+o;if(a in r)return w$[e]=a}return e}const Cy="http://www.w3.org/1999/xlink";function cL(r,e,s,o,l){if(o&&e.startsWith("xlink:"))s==null?r.removeAttributeNS(Cy,e.slice(6,e.length)):r.setAttributeNS(Cy,e,s);else{const a=fR(e);s==null||a&&!Fw(s)?r.removeAttribute(e):r.setAttribute(e,a?"":s)}}function aL(r,e,s,o,l,a,h){if(e==="innerHTML"||e==="textContent"){o&&h(o,l,a),r[e]=s??"";return}const d=r.tagName;if(e==="value"&&d!=="PROGRESS"&&!d.includes("-")){r._value=s;const f=d==="OPTION"?r.getAttribute("value"):r.value,m=s??"";f!==m&&(r.value=m),s==null&&r.removeAttribute(e);return}let p=!1;if(s===""||s==null){const f=typeof r[e];f==="boolean"?s=Fw(s):s==null&&f==="string"?(s="",p=!0):f==="number"&&(s=0,p=!0)}try{r[e]=s}catch{}p&&r.removeAttribute(e)}function hL(r,e,s,o){r.addEventListener(e,s,o)}function uL(r,e,s,o){r.removeEventListener(e,s,o)}const wy=Symbol("_vei");function dL(r,e,s,o,l=null){const a=r[wy]||(r[wy]={}),h=a[e];if(o&&h)h.value=o;else{const[d,p]=pL(e);if(o){const f=a[e]=mL(o,l);hL(r,d,f,p)}else h&&(uL(r,d,h,p),a[e]=void 0)}}const ky=/(?:Once|Passive|Capture)$/;function pL(r){let e;if(ky.test(r)){e={};let o;for(;o=r.match(ky);)r=r.slice(0,r.length-o[0].length),e[o[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):bc(r.slice(2)),e]}let k$=0;const gL=Promise.resolve(),fL=()=>k$||(gL.then(()=>k$=0),k$=Date.now());function mL(r,e){const s=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=s.attached)return;Rs($L(o,s.value),e,5,[o])};return s.value=r,s.attached=fL(),s}function $L(r,e){if(Ht(e)){const s=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{s.call(r),r._stopped=!0},e.map(o=>l=>!l._stopped&&o&&o(l))}else return e}const Oy=/^on[a-z]/,_L=(r,e,s,o,l=!1,a,h,d,p)=>{e==="class"?oL(r,o,l):e==="style"?rL(r,s,o):$p(e)?BT(e)||dL(r,e,s,o,h):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):TL(r,e,o,l))?aL(r,e,o,a,h,d,p):(e==="true-value"?r._trueValue=o:e==="false-value"&&(r._falseValue=o),cL(r,e,o,l))};function TL(r,e,s,o){return o?!!(e==="innerHTML"||e==="textContent"||e in r&&Oy.test(e)&&zt(s)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA"||Oy.test(e)&&Ye(s)?!1:e in r}const bL=Ti({patchProp:_L},iL);let Ay;function EL(){return Ay||(Ay=LN(bL))}const vL=(...r)=>{const e=EL().createApp(...r),{mount:s}=e;return e.mount=o=>{const l=IL(o);if(!l)return;const a=e._component;!zt(a)&&!a.render&&!a.template&&(a.template=l.innerHTML),l.innerHTML="";const h=s(l,!1,l instanceof SVGElement);return l instanceof Element&&(l.removeAttribute("v-cloak"),l.setAttribute("data-v-app","")),h},e};function IL(r){return Ye(r)?document.querySelector(r):r}const SL={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil d-block mx-auto mb-1",viewBox:"0 0 16 16"},yL=ht("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"},null,-1),CL=[yL],wL={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-bug d-block mx-auto mb-1",viewBox:"0 0 16 16"},kL=ht("path",{d:"M4.355.522a.5.5 0 0 1 .623.333l.291.956A4.979 4.979 0 0 1 8 1c1.007 0 1.946.298 2.731.811l.29-.956a.5.5 0 1 1 .957.29l-.41 1.352A4.985 4.985 0 0 1 13 6h.5a.5.5 0 0 0 .5-.5V5a.5.5 0 0 1 1 0v.5A1.5 1.5 0 0 1 13.5 7H13v1h1.5a.5.5 0 0 1 0 1H13v1h.5a1.5 1.5 0 0 1 1.5 1.5v.5a.5.5 0 1 1-1 0v-.5a.5.5 0 0 0-.5-.5H13a5 5 0 0 1-10 0h-.5a.5.5 0 0 0-.5.5v.5a.5.5 0 1 1-1 0v-.5A1.5 1.5 0 0 1 2.5 10H3V9H1.5a.5.5 0 0 1 0-1H3V7h-.5A1.5 1.5 0 0 1 1 5.5V5a.5.5 0 0 1 1 0v.5a.5.5 0 0 0 .5.5H3c0-1.364.547-2.601 1.432-3.503l-.41-1.352a.5.5 0 0 1 .333-.623zM4 7v4a4 4 0 0 0 3.5 3.97V7H4zm4.5 0v7.97A4 4 0 0 0 12 11V7H8.5zM12 6a3.989 3.989 0 0 0-1.334-2.982A3.983 3.983 0 0 0 8 2a3.983 3.983 0 0 0-2.667 1.018A3.989 3.989 0 0 0 4 6h8z"},null,-1),OL=[kL],AL={key:2,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-cloud-download d-block mx-auto mb-1",viewBox:"0 0 16 16"},RL=ht("path",{d:"M4.406 1.342A5.53 5.53 0 0 1 8 0c2.69 0 4.923 2 5.166 4.579C14.758 4.804 16 6.137 16 7.773 16 9.569 14.502 11 12.687 11H10a.5.5 0 0 1 0-1h2.688C13.979 10 15 8.988 15 7.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 2.825 10.328 1 8 1a4.53 4.53 0 0 0-2.941 1.1c-.757.652-1.153 1.438-1.153 2.055v.448l-.445.049C2.064 4.805 1 5.952 1 7.318 1 8.785 2.23 10 3.781 10H6a.5.5 0 0 1 0 1H3.781C1.708 11 0 9.366 0 7.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383z"},null,-1),NL=ht("path",{d:"M7.646 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V5.5a.5.5 0 0 0-1 0v8.793l-2.146-2.147a.5.5 0 0 0-.708.708l3 3z"},null,-1),LL=[RL,NL],ML={key:3,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-gear d-block mx-auto mb-1",viewBox:"0 0 16 16"},DL=ht("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"},null,-1),xL=ht("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"},null,-1),PL=[DL,xL],BL={key:4,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-play-circle",viewBox:"0 0 16 16"},FL=ht("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"},null,-1),HL=ht("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z"},null,-1),UL=[FL,HL],VL={key:5,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-right-square",viewBox:"0 0 16 16"},GL=ht("path",{"fill-rule":"evenodd",d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"},null,-1),WL=[GL],XL={key:6,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-reply",viewBox:"0 0 16 16"},zL=ht("path",{d:"M6.598 5.013a.144.144 0 0 1 .202.134V6.3a.5.5 0 0 0 .5.5c.667 0 2.013.005 3.3.822.984.624 1.99 1.76 2.595 3.876-1.02-.983-2.185-1.516-3.205-1.799a8.74 8.74 0 0 0-1.921-.306 7.404 7.404 0 0 0-.798.008h-.013l-.005.001h-.001L7.3 9.9l-.05-.498a.5.5 0 0 0-.45.498v1.153c0 .108-.11.176-.202.134L2.614 8.254a.503.503 0 0 0-.042-.028.147.147 0 0 1 0-.252.499.499 0 0 0 .042-.028l3.984-2.933zM7.8 10.386c.068 0 .143.003.223.006.434.02 1.034.086 1.7.271 1.326.368 2.896 1.202 3.94 3.08a.5.5 0 0 0 .933-.305c-.464-3.71-1.886-5.662-3.46-6.66-1.245-.79-2.527-.942-3.336-.971v-.66a1.144 1.144 0 0 0-1.767-.96l-3.994 2.94a1.147 1.147 0 0 0 0 1.946l3.994 2.94a1.144 1.144 0 0 0 1.767-.96v-.667z"},null,-1),YL=[zL],KL={key:7,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-terminal",viewBox:"0 0 16 16"},jL=ht("path",{d:"M6 9a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 6 9zM3.854 4.146a.5.5 0 1 0-.708.708L4.793 6.5 3.146 8.146a.5.5 0 1 0 .708.708l2-2a.5.5 0 0 0 0-.708l-2-2z"},null,-1),JL=ht("path",{d:"M2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h12z"},null,-1),qL=[jL,JL],Nk={__name:"BaseIcon",props:{name:String},setup(r){return(e,s)=>r.name==="pencil"?(jt(),te("svg",SL,CL)):r.name==="bug"?(jt(),te("svg",wL,OL)):r.name==="cloud-download"?(jt(),te("svg",AL,LL)):r.name==="gear"?(jt(),te("svg",ML,PL)):r.name==="play-circle"?(jt(),te("svg",BL,UL)):r.name==="arrow-right-square"?(jt(),te("svg",VL,WL)):r.name==="reply"?(jt(),te("svg",XL,YL)):r.name==="terminal"?(jt(),te("svg",KL,qL)):Pa("",!0)}};const Sh=(r,e)=>{const s=r.__vccOpts||r;for(const[o,l]of e)s[o]=l;return s},ZL=r=>(ak("data-v-5a69690e"),r=r(),hk(),r),QL={class:"px-3 text-bg-dark"},tM={class:"container-fluid"},eM={class:"d-flex flex-wrap align-items-center justify-content-center"},iM=ZL(()=>ht("h1",{href:"/#",class:"d-flex align-items-center my-2 my-lg-0 me-lg-auto"}," Blocksambler ",-1)),sM={class:"nav col-12 col-lg-auto my-2 my-md-0"},oM=["href"],nM={__name:"BlocksamblerNavigation",setup(r){let e=fo([{label:"Editor",href:"/#/editor",icon:"pencil"},{label:"Debugger",href:"/#/debugger",icon:"bug"},{label:"Settings",href:"/#/settings",icon:"gear"}]);return fo([{name:"ANNA"},{name:"ARM (64-bit)"}]),(s,o)=>(jt(),te("header",null,[ht("div",QL,[ht("div",tM,[ht("div",eM,[iM,ht("ul",sM,[(jt(!0),te(ni,null,wp(Go(e),l=>(jt(),te("li",null,[ht("a",{href:l.href,class:"nav-link text-white"},[ye(Nk,{name:l.icon},null,8,["name"]),jl(" "+cs(l.label),1)],8,oM)]))),256))])])])])]))}},rM=Sh(nM,[["__scopeId","data-v-5a69690e"]]),lM={kind:"categoryToolbox",contents:[{kind:"category",name:"Control Flow",colour:"240",contents:[{kind:"block",type:"start"},{kind:"block",type:"halt"},{kind:"block",type:"bez"},{kind:"block",type:"bgz"},{kind:"block",type:"jalr"},{kind:"block",type:"labelsection"},{kind:"block",type:"labeldescriptor"}]},{kind:"category",name:"Arithmetic Instructions",colour:"240",contents:[{kind:"block",type:"add"},{kind:"block",type:"addi"},{kind:"block",type:"sub"},{kind:"block",type:"and"},{kind:"block",type:"or"},{kind:"block",type:"not"},{kind:"block",type:"shf"},{kind:"block",type:"lli"},{kind:"block",type:"lui"},{kind:"block",type:"register"}]},{kind:"category",name:"Input/Output",colour:"240",contents:[{kind:"block",type:"in"},{kind:"block",type:"out"}]},{kind:"category",name:"Memory Access",colour:"240",contents:[{kind:"block",type:"lw"},{kind:"block",type:"sw"}]}]};var as=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cM(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Lk={exports:{}},O$={exports:{}},A$={exports:{}},R$={exports:{}},N$={exports:{}},Ry;function ob(){return Ry||(Ry=1,function(r,e){(function(s,o){r.exports=o()})(as,function(){var s={},o,l,a,h,d,p,f,m,T,b,I,w,M,N,U,W,tt,F,st,it,Tt,Lt,It,mt,Ct,Ft,Nt,qt,at,Bt,xt,At,Zt,Dt,Ce,ne,We,pt,qe,xe,Ne,Te,Xe,ai,hi,y,D,H,j,z,nt,rt,Z,et,q,ut,A,X,kt,ft,Yt,bt,re,O,$,S,R,B,Y,Mt,ge,is,Nh,Zo,Ui,be,Vn,Gn,Wn,_o,_,v,k,P,J,St,Xt,Fe,Xn,zn,Yn,kc,Lh,Bb,Mh,Fb,Dh,Gp,Wp,xh,Ph,Bh,Oc,Hb,Fh,Ub,Vb,Hh,Gb,Xp,Xr,Wb,Uh,zp,Yp,Xb,Vh,zr,Gh,zb,Kp,jp,Yb,Kb,Kn,jb,Wh,Xh,Jb,Jp,Yr,xs,qb,qp,zh,Zp,Qp,tg,Zb,eg,Ac,Qb,tE,Qo,ig,Ps,eE,iE,sE,tn,sg,oE,nE,rE,lE,cE,og,aE,hE,Yh,uE,dE,ng,Kh,jh,pE,Bs,gE,fE,mE,$E,_E,TE,bE,rg,en,Kr,lg,EE,vE,IE,SE,yE,CE,wE,kE,cg,OE,AE,RE,NE,LE,ME,jr,ag,DE,xE,$s,we,jn,PE,hg,Jh,ss,ug,qh,dg,pg,BE,FE,HE,gg,UE,fg,Rc,VE,GE,WE,XE,Nc,mg,$g,_g,zE,Jr,Tg,qr,bg,Eg,vg,Zr,Zh,Qh,YE,Lc,Ig,Sg,yg,Cg,wg,kg,KE,Mc,Og,Qr,tu,_s,Ag,Rg,Ng,Lg,Mg,Dg,xg,tl,jE,Dc,Pg,Bg,JE,eu,Fg,qE,ZE,QE,tv,ev,el,Hg,Ug,xc,Vg,iv,sv,Gg,Wg,To,Xg,zg,ov,nv,rv,lv,bo,sn,iu,Yg,su,Kg,on,Pc,ou,nu,Jn,jg,ru,Jg,Pe,cv,il,nn,lu,Vi,av,hv,uv,dv,qg,pv,Zg,cu,gv,fv,mv,Qg,au,tf,hu,$v,_v,Tv,bv,vt,Ni,ti,ke,Fs,sl,$t,He,ef,Ev,uu,sf,vv,of,du,nf,rf,Iv,lf,Sv,cf,Bc,yv,Cv,wv,ol,kv,af,hf,uf,df,pu,pf,Fc,gf,ff,mf,$f,_f,Tf,bf,Ef,vf,If,Sf,yf,Ov,Av,nl,Cf,Rv,gu,wf,kf,Of,Af,Rf,Nf,Lf,Mf,fu,Hc,Df,Nv,xf,Pf,Bf,Ff,Hf,Uf,Vf,Lv,Gf,Mv,Dv,xv,Pv,Bv,Fv,Hv,Uv,Vv,Gv,Wv,yt;o=function(t,i,n,c){if(!(t instanceof Q)&&typeof t!="string"||`${t}`.trim()==="")throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=`${t}`.toLowerCase(),typeof i!="string"||i.trim()==="")throw Error('Invalid name "'+i+'". The name must be a non-empty string.');const u=i.toLowerCase();if(!n)throw Error("Can not register a null value");let g=rn[t],E=mu[t];if(g||(g=rn[t]=Object.create(null),E=mu[t]=Object.create(null)),l(t,n),!c&&g[u])throw Error('Name "'+u+'" with type "'+t+'" already registered.');g[u]=n,E[u]=i},l=function(t,i){switch(t){case String(Q.FIELD):if(typeof i.fromJson!="function")throw Error('Type "'+t+'" must have a fromJson function')}},a=function(t,i){t=`${t}`.toLowerCase(),i=i.toLowerCase();const n=rn[t];n&&n[i]?(delete rn[t][i],delete mu[t][i]):console.warn("Unable to unregister ["+i+"]["+t+"] from the registry.")},h=function(t,i,n){t=`${t}`.toLowerCase(),i=i.toLowerCase();const c=rn[t];if(!c||!c[i]){if(i="Unable to find ["+i+"]["+t+"] in the registry.",n)throw Error(i+" You must require or register a "+t+" plugin.");return console.warn(i),null}return c[i]},d=function(t,i){return t=`${t}`.toLowerCase(),i=i.toLowerCase(),(t=rn[t])?!!t[i]:!1},p=function(t,i,n){return h(t,i,n)},f=function(t,i,n){return h(t,i,n)},m=function(t,i,n){t=`${t}`.toLowerCase();var c=rn[t];if(!c){if(c=`Unable to find [${t}] in the registry.`,n)throw Error(`${c} You must require or register a ${t} plugin.`);return console.warn(c),null}if(!i)return c;t=mu[t],n=Object.create(null);for(const u of Object.keys(c))n[t[u]]=c[u];return n},T=function(t,i,n){return i=i.plugins[String(t)]||Eo,typeof i=="function"?i:p(t,i,n)},b=function(t){return Uc[t]||null},I=function(){const t=[];for(const i in Uc)t.push(Uc[i]);return t},w=function(t){Uc[t.id]=t},M=function(t){delete Uc[t.id]},N=function(){return Xv},U=function(t){Xv=t},W=function(){return zv},tt=function(t){zv=t},F=function(){return Yv},st=function(t){Yv=t},it=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;const i=t.getParentSvg(),n=t.getCachedParentSvgSize();var c=i.parentElement;if(c instanceof HTMLElement){var u=c.offsetWidth;c=c.offsetHeight,n.width!==u&&(i.setAttribute("width",u+"px"),t.setCachedParentSvgSize(u,null)),n.height!==c&&(i.setAttribute("height",c+"px"),t.setCachedParentSvgSize(null,c)),t.resize()}},Tt=function(t,i){const n=Object.create(null),c=t.getDescendants(!0);i&&(t=t.getNextBlock())&&(t=c.indexOf(t),c.splice(t,c.length-t));for(let u=0,g;g=c[u];u++)n[g.type]?n[g.type]++:n[g.type]=1;return n},Lt=function(t){return function(){this.jsonInit(t)}},It=function(t){Kv.defineBlocksWithJsonArrayInternal(t)},mt=function(t){s.defineBlocks$$module$build$src$core$common(s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(t))},s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){const i={};for(let n=0;n<t.length;n++){const c=t[n];if(!c){console.warn(`Block definition #${n} in JSON array is ${c}. Skipping`);continue}const u=c.type;u?i[u]={init:Lt(c)}:console.warn(`Block definition #${n} in JSON array is missing a type attribute. Skipping.`)}return i},s.defineBlocks$$module$build$src$core$common=function(t){for(const i of Object.keys(t)){const n=t[i];i in Li&&console.warn(`Block definiton "${i}" overwrites previous definition.`),Li[i]=n}},Ct=function(){return"blockly-"+(sA++).toString(36)},Ft=function(){return Jv.genUid()},Nt=function(t){ll=t},qt=function(){return ll},at=function(t){bu.fireInternal(t)},Bt=function(t){if(Dt()){if(!er.length)try{requestAnimationFrame(()=>{setTimeout(xt,0)})}catch{setTimeout(xt,0)}er.push(t)}},xt=function(){var t=At(er,!0);er.length=0;for(let n=0,c;c=t[n];n++)if(c.workspaceId){var i=b(c.workspaceId);i&&i.fireChangeListener(c)}t=new Set(t.map(n=>n.workspaceId));for(const n of t){if(!n||(t=b(n),!t))continue;t=t.getUndoStack();let c;for(i=t.length;0<i;i--){const u=t[i-1];if(u.group==="")break;if(c===void 0)c=u.group;else if(u.group!==c)break}c&&i!=t.length-1&&(i=t.splice(i,t.length-i),i=At(i,!0),t.push(...i))}},At=function(t,i){t=t.slice(),i||t.reverse();const n=[],c=Object.create(null);for(let E=0,C;C=t[E];E++)if(!C.isNull()){var u=[C.isUiEvent?_u:C.type,C.blockId,C.workspaceId].join(" "),g=c[u];const G=g?g.event:null;g?C.type===s.MOVE$$module$build$src$core$events$utils&&g.index===E-1?(u=C,G.newParentId=u.newParentId,G.newInputName=u.newInputName,G.newCoordinate=u.newCoordinate,u.reason&&(G.reason?(u=new Set(u.reason.concat(G.reason)),G.reason=Array.from(u)):G.reason=u.reason),g.index=E):C.type===s.CHANGE$$module$build$src$core$events$utils&&C.element===G.element&&C.name===G.name?G.newValue=C.newValue:C.type===an?(g=C,G.viewTop=g.viewTop,G.viewLeft=g.viewLeft,G.scale=g.scale,G.oldScale=g.oldScale):(C.type!==So||G.type!==Hs)&&(c[u]={event:C,index:E},n.push(C)):(c[u]={event:C,index:E},n.push(C))}t=n.filter(function(E){return!E.isNull()}),i||t.reverse();for(let E=1,C;C=t[E];E++)C.type===s.CHANGE$$module$build$src$core$events$utils&&C.element==="mutation"&&t.unshift(t.splice(E,1)[0]);return t},Zt=function(){for(let t=0,i;i=er[t];t++)i.recordUndo=!1},s.disable$$module$build$src$core$events$utils=function(){$u++},s.enable$$module$build$src$core$events$utils=function(){$u--},Dt=function(){return $u===0},s.getGroup$$module$build$src$core$events$utils=function(){return Xf},s.setGroup$$module$build$src$core$events$utils=function(t){bu.setGroupInternal(t)},Ce=function(t){Xf=typeof t=="boolean"?t?Ft():"":t},ne=function(t){const i=[];t=t.getDescendants(!1);for(let n=0,c;c=t[n];n++)i[n]=c.id;return i},We=function(t,i){const n=pt(t.type);if(!n)throw Error("Unknown event type.");return n.fromJson(t,i)},pt=function(t){const i=p(Q.EVENT,t);if(!i)throw Error(`Event type ${t} not found in registry.`);return i},qe=function(t){if((t.type===s.MOVE$$module$build$src$core$events$utils||t.type===s.CREATE$$module$build$src$core$events$utils)&&t.workspaceId){var i=b(t.workspaceId);if(!t.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(t=i.getBlockById(t.blockId)){const n=ll;try{ll=!1;const c=t.getParent();if(c&&c.isEnabled()){const u=t.getDescendants(!1);for(let g=0,E;E=u[g];g++)E.setEnabled(!0)}else if((t.outputConnection||t.previousConnection)&&!i.isDragging())do t.setEnabled(!1),t=t.getNextBlock();while(t)}finally{ll=n}}}},xe=function(t,i){Ne(),vu=setTimeout(function(){i&&i.handleRightClick(t)},oA)},Ne=function(){vu&&(clearTimeout(vu),vu=0)},Te=function(){Eu=null},Xe=function(t){return!t.type.startsWith("pointer")||t instanceof PointerEvent&&hi(t)},ai=function(t){return`${t.pointerId}`},hi=function(t){const i=ai(t);return Eu?Eu===i:t.type==="pointerdown"?(Eu=i,!0):!1},y=function(t,i,n,c,u){function g(C){(u||Xe(C))&&(n?c.call(n,C):c(C))}const E=[];if(i in ir)for(let C=0;C<ir[i].length;C++){const G=ir[i][C];t.addEventListener(G,g,!1),E.push([t,G,g])}else t.addEventListener(i,g,!1),E.push([t,i,g]);return E},D=function(t,i,n,c){function u(E){n?c.call(n,E):c(E)}const g=[];if(i in ir)for(let E=0;E<ir[i].length;E++){const C=ir[i][E];t.addEventListener(C,u,!1),g.push([t,C,u])}else t.addEventListener(i,u,!1),g.push([t,i,u]);return g},H=function(t){const i=t[t.length-1][2];for(;t.length;){const[n,c,u]=t.pop();n.removeEventListener(c,u,!1)}return i},j=function(t){if(t.target instanceof HTMLElement){if(t.target.isContentEditable||t.target.getAttribute("data-is-text-input")==="true")return!0;if(t.target instanceof HTMLInputElement)return t=t.target,t.type==="text"||t.type==="number"||t.type==="email"||t.type==="password"||t.type==="search"||t.type==="tel"||t.type==="url";if(t.target instanceof HTMLTextAreaElement)return!0}return!1},z=function(t){return t.ctrlKey&&qf?!0:t.button===2},nt=function(t,i,n){const c=i.createSVGPoint();return c.x=t.clientX,c.y=t.clientY,n||(n=i.getScreenCTM().inverse()),c.matrixTransform(n)},rt=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*rI,y:t.deltaY*rI};case 2:return{x:t.deltaX*lI,y:t.deltaY*lI}}},Z=function(t,i){return i=t.indexOf(i),i===-1?!1:(t.splice(i,1),!0)},et=function(t){if(Qf)throw Error("CSS already injected");tm+=`
`+t},q=function(t,i){Qf||(Qf=!0,t&&(t=i.replace(/[\\/]$/,""),i=tm.replace(/<<<PATH>>>/g,t),tm="",t=document.createElement("style"),t.id="blockly-common-style",i=document.createTextNode(i),t.appendChild(i),document.head.insertBefore(t,document.head.firstChild)))},ut=function(t,i,n,c){t=t+" was deprecated in "+i+" and will be deleted in "+n+".",c&&(t+=`
Use `+c+" instead."),console.warn(t)},A=function(t,i,n){t=document.createElementNS(Cu,`${t}`);for(const c in i)t.setAttribute(c,`${i[c]}`);return n&&n.appendChild(t),t},X=function(t,i){return i=i.split(" "),i.every(n=>t.classList.contains(n))?!1:(t.classList.add(...i),!0)},kt=function(t,i){t.classList.remove(...i.split(" "))},ft=function(t,i){return i=i.split(" "),i.every(n=>!t.classList.contains(n))?!1:(t.classList.remove(...i),!0)},Yt=function(t,i){return t.classList.contains(i)},bt=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},re=function(t,i){const n=i.nextSibling;if(i=i.parentNode,!i)throw Error("Reference node has no parent.");n?i.insertBefore(t,n):i.appendChild(t)},O=function(t,i){return ut("Blockly.utils.dom.containsNode","version 10","version 11",'Use native "contains" DOM method'),t.contains(i)},$=function(t,i){t.style.transform=i,t.style["-webkit-transform"]=i},S=function(){im++,Ts||(Ts=Object.create(null))},R=function(){im--,im||(Ts=null)},B=function(t){const i=t.textContent+`
`+t.className.baseVal;let n;if(Ts&&(n=Ts[i]))return n;try{n=t.getComputedTextLength()}catch{return 8*t.textContent.length}return Ts&&(Ts[i]=n),n},Y=function(t,i,n,c){return Mt(t,i+"pt",n,c)},Mt=function(t,i,n,c){const u=t.textContent;t=u+`
`+t.className.baseVal;var g;return Ts&&(g=Ts[t])||(wu||(g=document.createElement("canvas"),g.className="blocklyComputeCanvas",document.body.appendChild(g),wu=g.getContext("2d")),wu.font=n+" "+i+" "+c,g=u?wu.measureText(u).width:0,Ts&&(Ts[t]=g)),g},ge=function(t,i,n,c){const u=document.createElement("span");u.style.font=n+" "+i+" "+c,u.textContent=t,t=document.createElement("div"),t.style.width="1px",t.style.height="0",i=document.createElement("div"),i.style.display="flex",i.style.position="fixed",i.style.top="0",i.style.left="0",i.appendChild(u),i.appendChild(t),document.body.appendChild(i),n={height:0,baseline:0};try{i.style.alignItems="baseline",n.baseline=t.offsetTop-u.offsetTop,i.style.alignItems="flex-end",n.height=t.offsetTop-u.offsetTop}finally{document.body.removeChild(i)}return n},is=function(t){return hI.getSizeInternal(t)},Nh=function(t){if(Ui(t,"display")!=="none")return Zo(t);const i=t.style,n=i.display,c=i.visibility,u=i.position;i.visibility="hidden",i.position="absolute",i.display="inline";const g=t.offsetWidth;return t=t.offsetHeight,i.display=n,i.position=u,i.visibility=c,new Ee(g,t)},Zo=function(t){return new Ee(t.offsetWidth,t.offsetHeight)},Ui=function(t,i){return t=window.getComputedStyle(t),t[i]||t.getPropertyValue(i)},be=function(t){const i=new lt(0,0);t=t.getBoundingClientRect();var n=document.documentElement;return n=new lt(window.pageXOffset||n.scrollLeft,window.pageYOffset||n.scrollTop),i.x=t.left+n.x,i.y=t.top+n.y,i},Vn=function(){const t=document.body,i=document.documentElement;return new lt(t.scrollLeft||i.scrollLeft,t.scrollTop||i.scrollTop)},Gn=function(t){const i=parseFloat(Ui(t,"borderLeftWidth")),n=parseFloat(Ui(t,"borderRightWidth")),c=parseFloat(Ui(t,"borderTopWidth"));return t=parseFloat(Ui(t,"borderBottomWidth")),new fe(c,t,i,n)},Wn=function(t,i,n){t=_o(t,i,n),i.scrollLeft=t.x,i.scrollTop=t.y},_o=function(t,i,n){var c=be(t),u=be(i),g=Gn(i);const E=c.x-u.x-g.left;return c=c.y-u.y-g.top,u=Zo(t),t=i.clientWidth-u.width,u=i.clientHeight-u.height,g=i.scrollLeft,i=i.scrollTop,n?(g+=E-t/2,i+=c-u/2):(g+=Math.min(E,Math.max(E-t,0)),i+=Math.min(c,Math.max(c-u,0))),new lt(g,i)},_=function(t){const i=new lt(0,0);var n=t.x&&t.getAttribute("x");const c=t.y&&t.getAttribute("y");return n&&(i.x=parseInt(n)),c&&(i.y=parseInt(c)),(n=(n=t.getAttribute("transform"))&&n.match(uI))&&(i.x+=Number(n[1]),n[3]&&(i.y+=Number(n[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(dI))&&(i.x+=Number(t[1]),t[3]&&(i.y+=Number(t[3]))),i},v=function(t){let i=0,n=0;for(;t;){const c=_(t);if(i+=c.x,n+=c.y,(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;t=t.parentNode}return new lt(i,n)},k=function(){const t=Vn();return new fe(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},P=function(){const t=document.documentElement,i=window;return new lt(i.pageXOffset||t.scrollLeft,i.pageYOffset||t.scrollTop)},J=function(t,i){var n=i.x;i=i.y;const c=t.getInjectionDiv().getBoundingClientRect();return n=new lt(n-c.left,i-c.top),i=t.getOriginOffsetInPixels(),lt.difference(n,i).scale(1/t.scale)},St=function(t,i){var n=i.scale(t.scale);i=n.x,n=n.y;const c=t.getInjectionDiv().getBoundingClientRect();return t=t.getOriginOffsetInPixels(),new lt(i+c.left+t.x,n+c.top+t.y)},Xt=function(t){({document:Ou=Ou,DOMParser:Vc=Vc,XMLSerializer:Gc=Gc}=t),ku=new Vc,sm=new Gc},s.createElement$$module$build$src$core$utils$xml=function(t){return Ou.createElementNS(pI,t)},s.createTextNode$$module$build$src$core$utils$xml=function(t){return Ou.createTextNode(t)},s.textToDom$$module$build$src$core$utils$xml=function(t){let i=ku.parseFromString(t,"text/xml");if(i&&i.documentElement&&!i.getElementsByTagName("parsererror").length)return i.documentElement;if((i=ku.parseFromString(t,"text/html"))&&i.body.firstChild&&i.body.firstChild.nodeName.toLowerCase()==="xml")return i.body.firstChild;throw Error(`DOMParser was unable to parse: ${t}`)},Fe=function(t){return Xn(sm.serializeToString(t))},Xn=function(t){return t.replace(cA,i=>`&#${i.charCodeAt(0)};`)},zn=function(t){return t?((t instanceof Element||typeof t=="string")&&(t=Wp(t),t=Fb(t)),Yn(t),t):null},Yn=function(t){const i=t.kind;if(t=t.contents,i&&i!==gI&&i!==om)throw Error("Invalid toolbox kind "+i+". Please supply either "+gI+" or "+om);if(!t)throw Error("Toolbox must have a contents attribute.")},kc=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:Dh(t):[]},Lh=function(t){return fI.hasCategoriesInternal(t)},Bb=function(t){if(!t)return!1;const i=t.kind;return i?i===om:!!t.contents.filter(function(n){return n.kind.toUpperCase()==="CATEGORY"}).length},Mh=function(t){return t&&t.contents?!!t.contents.filter(function(i){return i.kind.toUpperCase()==="CATEGORY"}).length:!1},Fb=function(t){const i={contents:Dh(t)};return t instanceof Node&&Gp(t,i),i},Dh=function(t){const i=[];let n=t.childNodes;n||(n=t);for(let c=0,u;u=n[c];c++){if(!u.tagName)continue;t={};const g=u.tagName.toUpperCase();t.kind=g,g==="BLOCK"?t.blockxml=u:u.childNodes&&0<u.childNodes.length&&(t.contents=Dh(u)),Gp(u,t),i.push(t)}return i},Gp=function(t,i){for(let n=0;n<t.attributes.length;n++){const c=t.attributes[n];-1<c.nodeName.indexOf("css-")?(i.cssconfig=i.cssconfig||{},i.cssconfig[c.nodeName.replace("css-","")]=c.value):i[c.nodeName]=c.value}},Wp=function(t){let i=null;if(t)if(typeof t=="string"){if(i=s.textToDom$$module$build$src$core$utils$xml(t),i.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else t instanceof Element&&(i=t);return i},xh=function(t,i,n,c,u,g){const E=g.scrollbar&&g.scrollbar.canScrollVertically();return t.horizontal===$l.LEFT?(n=u.absoluteMetrics.left+n,E&&g.RTL&&(n+=Ue.scrollbarThickness)):(n=u.absoluteMetrics.left+u.viewMetrics.width-i.width-n,E&&!g.RTL&&(n-=Ue.scrollbarThickness)),t.vertical===Oo.TOP?t=u.absoluteMetrics.top+c:(t=u.absoluteMetrics.top+u.viewMetrics.height-i.height-c,g.scrollbar&&g.scrollbar.canScrollHorizontally()&&(t-=Ue.scrollbarThickness)),new fe(t,t+i.height,n,n+i.width)},Ph=function(t,i){return{horizontal:i.toolboxMetrics.position===Pt.LEFT||t.horizontalLayout&&!t.RTL?$l.RIGHT:$l.LEFT,vertical:i.toolboxMetrics.position===Pt.BOTTOM?Oo.TOP:Oo.BOTTOM}},Bh=function(t,i,n,c){const u=t.left,g=t.right-t.left,E=t.bottom-t.top;for(let C=0;C<c.length;C++){const G=c[C];t.intersects(G)&&(t=n===pn.UP?G.top-E-i:G.bottom+i,t=new fe(t,t+E,u,u+g),C=-1)}return t},Oc=function(t,i){$I(t,i)},Hb=function(t){$I=t},Fh=function(t,i){bI.confirmInternal(t,i)},Ub=function(t,i){_I(t,i)},Vb=function(t){_I=t},Hh=function(t,i,n){TI(t,i,n)},Gb=function(t){TI=t},Xp=function(t){return t.getVariableModel!==void 0},Xr=function(t){return t.getProcedureDef!==void 0},Wb=function(t){return t.getProcedureCall!==void 0&&t.renameProcedure!==void 0},s.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const i=new Set;for(let n=0;n<t.length;n++){const c=t[n].getVarModels();if(c)for(let u=0;u<c.length;u++){const g=c[u];g.getId()&&i.add(g)}}return Array.from(i.values())},s.allDeveloperVariables$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const i=new Set;for(let c=0,u;u=t[c];c++){var n=u.getDeveloperVariables;if(n){n=n();for(let g=0;g<n.length;g++)i.add(n[g])}}return Array.from(i.values())},Uh=function(t){let i=[];const n=document.createElement("button");return n.setAttribute("text","%{BKY_NEW_VARIABLE}"),n.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(c){zr(c.getTargetWorkspace())}),i.push(n),t=zp(t),i=i.concat(t)},zp=function(t){t=t.getVariablesOfType("");const i=[];if(0<t.length){var n=t[t.length-1];if(Li.variables_set){var c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","variables_set"),c.setAttribute("gap",Li.math_change?"8":"24"),c.appendChild(Kn(n)),i.push(c)}if(Li.math_change&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","math_change"),c.setAttribute("gap",Li.variables_get?"20":"8"),c.appendChild(Kn(n)),n=s.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),c.appendChild(n),i.push(c)),Li.variables_get){t.sort(Xc.compareByName);for(let u=0,g;g=t[u];u++)n=s.createElement$$module$build$src$core$utils$xml("block"),n.setAttribute("type","variables_get"),n.setAttribute("gap","8"),n.appendChild(Kn(g)),i.push(n)}}return i},Yp=function(t){return vI.generateUniqueNameInternal(t)},Xb=function(t){return Vh(cm.charAt(0),t.getAllVariableNames())},Vh=function(t,i){if(!i.length)return t;const n=cm;let c="",u=n.indexOf(t);for(;;){let g=!1;for(let E=0;E<i.length;E++)if(i[E].toLowerCase()===t){g=!0;break}if(!g)break;u++,u===n.length&&(u=0,c=`${Number(c)+1}`),t=n.charAt(u)+c}return t},zr=function(t,i,n){function c(g){Gh(s.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,g,function(E){if(E){var C=Kp(E,t);if(C){if(C.type===u)var G=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",C.name);else G=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,G=G.replace("%1",C.name).replace("%2",C.type);Oc(G,function(){c(E)})}else t.createVariable(E,u),i&&i(E)}else i&&i(null)})}const u=n||"";c("")},s.renameVariable$$module$build$src$core$variables=function(t,i,n){function c(u){const g=s.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",i.name);Gh(g,u,function(E){if(E){var C=zb(E,i.type,t),G=jp(i.name,E,t);if(C||G){var dt="";C?dt=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",C.name).replace("%2",C.type):G&&(dt=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",E).replace("%2",G)),Oc(dt,function(){c(E)})}else t.renameVariableById(i.getId(),E),n&&n(E)}else n&&n(null)})}c("")},Gh=function(t,i,n){Hh(t,i,function(c){c&&(c=c.replace(/[\s\xa0]+/g," ").trim(),c===s.Msg$$module$build$src$core$msg.RENAME_VARIABLE||c===s.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(c=null),n(c)})},zb=function(t,i,n){n=n.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let c=0,u;u=n[c];c++)if(u.name.toLowerCase()===t&&u.type!==i)return u;return null},Kp=function(t,i){i=i.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let n=0,c;c=i[n];n++)if(c.name.toLowerCase()===t)return c;return null},jp=function(t,i,n){return n.getProcedureMap().getProcedures().length?Yb(t,i,n):Kb(t,i,n)},Yb=function(t,i,n){t=t.toLowerCase(),i=i.toLowerCase(),n=n.getProcedureMap().getProcedures();for(const u of n){var c=u.getParameters().filter(Xp).map(g=>g.getVariableModel().name);if(c&&(n=c.some(g=>g.toLowerCase()===t),c=c.some(g=>g.toLowerCase()===i),n&&c))return u.getName()}return null},Kb=function(t,i,n){t=t.toLowerCase(),i=i.toLowerCase(),n=n.getAllBlocks(!1);for(const u of n){if(!Xr(u))continue;n=u.getProcedureDef();var c=n[1];const g=c.some(E=>E.toLowerCase()===t);if(c=c.some(E=>E.toLowerCase()===i),g&&c)return n[0]}return null},Kn=function(t){const i=s.createElement$$module$build$src$core$utils$xml("field");return i.setAttribute("name","VAR"),i.setAttribute("id",t.getId()),i.setAttribute("variabletype",t.type),t=s.createTextNode$$module$build$src$core$utils$xml(t.name),i.appendChild(t),i},s.getOrCreateVariablePackage$$module$build$src$core$variables=function(t,i,n,c){let u=s.getVariable$$module$build$src$core$variables(t,i,n,c);return u||(u=jb(t,i,n,c)),u},s.getVariable$$module$build$src$core$variables=function(t,i,n,c){const u=t.getPotentialVariableMap();let g=null;if(i&&(g=t.getVariableById(i),!g&&u&&(g=u.getVariableById(i)),g))return g;if(n){if(c===void 0)throw Error("Tried to look up a variable by name without a type");g=t.getVariable(n,c),!g&&u&&(g=u.getVariable(n,c))}return g},jb=function(t,i,n,c){const u=t.getPotentialVariableMap();return n||(n=Yp(t.isFlyout?t.targetWorkspace:t)),u?u.createVariable(n,c,i):t.createVariable(n,c,i)},Wh=function(t,i){t=t.getAllVariables();const n=[];if(i.length!==t.length)for(let c=0;c<t.length;c++){const u=t[c];i.indexOf(u)===-1&&n.push(u)}return n},Xh=function(t,i){o(Q.PASTER,t,i)},Jb=function(t){a(Q.PASTER,t)},Jp=function(t){return qp(t),qb()?(zh(),Promise.resolve()):(_l||(_l=new Promise(i=>{um=i,II=window.requestAnimationFrame(()=>{zh(),i()})})),_l)},Yr=function(){return _l||Promise.resolve()},xs=function(){window.cancelAnimationFrame(II),zh(),um&&um()},qb=function(){return oI},qp=function(t){Lu.add(t);const i=t.getParent();i?qp(i):Nu.add(t)},zh=function(){const t=new Set([...Nu].map(i=>i.workspace));for(const i of Nu){if(i.isDisposed()||i.getParent())continue;Zp(i);const n=i.getRelativeToSurfaceXY();Qp(i,n),tg(i,n)}for(const i of t)i.resizeContents();Nu.clear(),Lu=new Set,_l=null},Zp=function(t){if(Lu.has(t)){for(const i of t.getChildren(!1))Zp(i);t.renderEfficiently()}},Qp=function(t,i){for(const n of t.getConnections_(!1)){t=n.moveToOffset(i);const c=n.targetBlock();n.isSuperior()&&c&&(t||Lu.has(c))&&Qp(c,lt.sum(i,c.relativeCoords))}},tg=function(t,i){if(t.getIcons){for(const n of t.getIcons())n.onLocationChange(i);for(const n of t.getChildren(!1))tg(n,lt.sum(i,n.relativeCoords))}},Zb=function(t,i){const n=s.createElement$$module$build$src$core$utils$xml("xml");var c=eg(s.allUsedVarModels$$module$build$src$core$variables(t));c.hasChildNodes()&&n.appendChild(c),c=t.getTopComments(!0);for(let u=0;u<c.length;u++)n.appendChild(c[u].toXmlWithXY(i));for(t=t.getTopBlocks(!0),c=0;c<t.length;c++)n.appendChild(Ac(t[c],i));return n},eg=function(t){const i=s.createElement$$module$build$src$core$utils$xml("variables");for(let n=0;n<t.length;n++){const c=t[n],u=s.createElement$$module$build$src$core$utils$xml("variable");u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(c.name)),c.type&&u.setAttribute("type",c.type),u.id=c.getId(),i.appendChild(u)}return i},Ac=function(t,i){if(t.isInsertionMarker()&&(t=t.getChildren(!1)[0],!t))return new DocumentFragment;let n=0;if(t.workspace.RTL&&(n=t.workspace.getWidth()),i=Qo(t,i),ng(i)){const c=t.getRelativeToSurfaceXY();i.setAttribute("x",String(Math.round(t.workspace.RTL?n-c.x:c.x))),i.setAttribute("y",String(Math.round(c.y)))}return i},Qb=function(t){if(t.isSerializable()){const i=s.createElement$$module$build$src$core$utils$xml("field");return i.setAttribute("name",t.name||""),t.toXml(i)}return null},tE=function(t,i){for(let n=0;n<t.inputList.length;n++){const c=t.inputList[n];for(let u=0;u<c.fieldRow.length;u++){const g=Qb(c.fieldRow[u]);g&&i.appendChild(g)}}},Qo=function(t,i){if(t.isInsertionMarker())return(i=t.getChildren(!1)[0])?Qo(i):new DocumentFragment;const n=s.createElement$$module$build$src$core$utils$xml(t.isShadow()?"shadow":"block");if(n.setAttribute("type",t.type),i||(n.id=t.id),t.mutationToDom){var c=t.mutationToDom();c&&(c.hasChildNodes()||c.hasAttributes())&&n.appendChild(c)}if(tE(t,n),c=t.getCommentText()){var u=t.getIcon(Mi.COMMENT),g=u.getBubbleSize();u=u.bubbleIsVisible();var E=s.createElement$$module$build$src$core$utils$xml("comment");E.appendChild(s.createTextNode$$module$build$src$core$utils$xml(c)),E.setAttribute("pinned",`${u}`),E.setAttribute("h",String(g.height)),E.setAttribute("w",String(g.width)),n.appendChild(E)}for(t.data&&(c=s.createElement$$module$build$src$core$utils$xml("data"),c.appendChild(s.createTextNode$$module$build$src$core$utils$xml(t.data)),n.appendChild(c)),c=0;c<t.inputList.length;c++){g=t.inputList[c];var C=void 0;if(u=!0,g.type!==s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&g.type!==s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){E=g.connection.targetBlock(),g.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?C=s.createElement$$module$build$src$core$utils$xml("value"):g.type===s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(C=s.createElement$$module$build$src$core$utils$xml("statement"));const dt=g.connection.getShadowDom();!dt||E&&E.isShadow()||C.appendChild(ig(dt,i)),E&&(E=Qo(E,i),E.nodeType===ko.ELEMENT_NODE&&(C.appendChild(E),u=!1)),C.setAttribute("name",g.name),u||n.appendChild(C)}}t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&n.setAttribute("inline",String(t.inputsInline)),t.isCollapsed()&&n.setAttribute("collapsed","true"),t.isEnabled()||n.setAttribute("disabled","true"),t.isDeletable()||t.isShadow()||n.setAttribute("deletable","false"),t.isMovable()||t.isShadow()||n.setAttribute("movable","false"),t.isEditable()||n.setAttribute("editable","false"),C=t.getNextBlock();let G;return C&&(c=Qo(C,i),c.nodeType===ko.ELEMENT_NODE&&(G=s.createElement$$module$build$src$core$utils$xml("next"),G.appendChild(c),n.appendChild(G))),t=t.nextConnection&&t.nextConnection.getShadowDom(),!t||C&&C.isShadow()||G.appendChild(ig(t,i)),n},ig=function(t,i){let n=t=t.cloneNode(!0),c;for(;n;)if(i&&n.nodeName==="shadow"&&n.removeAttribute("id"),n.firstChild)n=n.firstChild;else{for(;n&&!n.nextSibling;){c=n,n=n.parentNode;let u;c.nodeType===ko.TEXT_NODE&&c.data.trim()===""&&((u=n)==null?void 0:u.firstChild)!==c&&bt(c)}n&&(c=n,n=n.nextSibling,c.nodeType===ko.TEXT_NODE&&c.data.trim()===""&&bt(c))}return t},Ps=function(t){return Fe(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},eE=function(t){t=Ps(t).split("<");let i="";for(let n=1;n<t.length;n++){const c=t[n];c[0]==="/"&&(i=i.substring(2)),t[n]=i+"<"+c,c[0]!=="/"&&c.slice(-2)!=="/>"&&(i+="  ")}return t=t.join(`
`),t=t.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),t.replace(/^\n/,"")},iE=function(t,i){return i.setResizesEnabled(!1),i.clear(),t=s.domToWorkspace$$module$build$src$core$xml(t,i),i.setResizesEnabled(!0),t},s.domToWorkspace$$module$build$src$core$xml=function(t,i){let n=0;i.RTL&&(n=i.getWidth());const c=[];S();const u=s.getGroup$$module$build$src$core$events$utils();u||s.setGroup$$module$build$src$core$events$utils(!0),i.setResizesEnabled&&i.setResizesEnabled(!1);let g=!0;try{for(let E=0,C;C=t.childNodes[E];E++){const G=C.nodeName.toLowerCase(),dt=C;if(G==="block"||G==="shadow"&&!qt()){const Ie=tn(dt,i);c.push(Ie.id);let $e;const Pi=parseInt(($e=dt.getAttribute("x"))!=null?$e:"10",10);let Fl;const Hl=parseInt((Fl=dt.getAttribute("y"))!=null?Fl:"10",10);isNaN(Pi)||isNaN(Hl)||Ie.moveBy(i.RTL?n-Pi:Pi,Hl,["create"]),g=!1}else{if(G==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(G==="comment")i.rendered?si.fromXmlRendered(dt,i,n):Gs.fromXml(dt,i);else if(G==="variables"){if(g)sg(dt,i);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");g=!1}}}}finally{s.setGroup$$module$build$src$core$events$utils(u),i.setResizesEnabled&&i.setResizesEnabled(!0),i.rendered&&xs(),R()}return at(new(pt(tr))(i)),c},sE=function(t,i){if(!i.getBlocksBoundingBox)return s.domToWorkspace$$module$build$src$core$xml(t,i);var n=i.getBlocksBoundingBox();if(t=s.domToWorkspace$$module$build$src$core$xml(t,i),n&&n.top!==n.bottom){var c=n.bottom;n=i.RTL?n.right:n.left;var u=1/0;let g=-1/0,E=1/0;for(let C=0;C<t.length;C++){const G=i.getBlockById(t[C]).getRelativeToSurfaceXY();G.y<E&&(E=G.y),G.x<u&&(u=G.x),G.x>g&&(g=G.x)}for(c=c-E+10,n=i.RTL?n-g:n-u,u=0;u<t.length;u++)i.getBlockById(t[u]).moveBy(n,c,["create"])}return t},s.domToBlock$$module$build$src$core$xml=function(t,i){return t=tn(t,i),i.rendered&&xs(),t},tn=function(t,i){s.disable$$module$build$src$core$events$utils();var n=i.getAllVariables();let c;try{if(c=Yh(t,i),i.rendered){const u=c,g=c.getDescendants(!1);u.setConnectionTracking(!1);for(let E=g.length-1;0<=E;E--)g[E].initSvg();for(let E=g.length-1;0<=E;E--)g[E].queueRender();setTimeout(function(){u.disposed||u.setConnectionTracking(!0)},1),u.updateDisabled(),i.resizeContents()}else{const u=c.getDescendants(!1);for(let g=u.length-1;0<=g;g--)u[g].initModel()}}finally{s.enable$$module$build$src$core$events$utils()}if(Dt()){for(t=Wh(i,n),i=0;i<t.length;i++)n=t[i],at(new(pt(cn))(n));at(new(pt(s.CREATE$$module$build$src$core$events$utils))(c))}return c},sg=function(t,i){for(let c=0;c<t.children.length;c++){var n=t.children[c];const u=n.getAttribute("type"),g=n.getAttribute("id");if(n=n.textContent,!n)break;i.createVariable(n,u,g)}},oE=function(t){const i={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let n=0;n<t.children.length;n++){const c=t.children[n];if(c.nodeType!==ko.TEXT_NODE)switch(c.nodeName.toLowerCase()){case"mutation":i.mutation.push(c);break;case"comment":i.comment.push(c);break;case"data":i.data.push(c);break;case"title":case"field":i.field.push(c);break;case"value":case"statement":i.input.push(c);break;case"next":i.next.push(c);break;default:console.warn("Ignoring unknown tag: "+c.nodeName)}}return i},nE=function(t,i){let n=!1;for(let c=0;c<t.length;c++){const u=t[c];i.domToMutation&&(i.domToMutation(u),i.initSvg&&(n=!0))}return n},rE=function(t,i){for(let c=0;c<t.length;c++){var n=t[c];const u=n.textContent,g=n.getAttribute("pinned")==="true";let E;const C=parseInt((E=n.getAttribute("w"))!=null?E:"50",10);let G;n=parseInt((G=n.getAttribute("h"))!=null?G:"50",10),i.setCommentText(u);const dt=i.getIcon(Mi.COMMENT);isNaN(C)||isNaN(n)||dt.setBubbleSize(new Ee(C,n)),dt.setBubbleVisible(g),setTimeout(()=>dt.setBubbleVisible(g),1)}},lE=function(t,i){for(let n=0;n<t.length;n++)i.data=t[n].textContent},cE=function(t,i){for(let n=0;n<t.length;n++){const c=t[n],u=c.getAttribute("name");u?uE(i,u,c):console.warn(`Ignoring unnamed field in block ${i.type}`)}},og=function(t){let i=null,n=null;for(let c=0;c<t.childNodes.length;c++){const u=t.childNodes[c];ng(u)&&(u.nodeName.toLowerCase()==="block"?i=u:u.nodeName.toLowerCase()==="shadow"&&(n=u))}return{childBlockElement:i,childShadowElement:n}},aE=function(t,i,n,c){for(let g=0;g<t.length;g++){var u=t[g];const E=u.getAttribute("name"),C=E?n.getInput(E):null;if(!C){console.warn("Ignoring non-existent input "+E+" in block "+c);break}if(u=og(u),u.childBlockElement){if(!C.connection)throw TypeError("Input connection does not exist.");Yh(u.childBlockElement,i,C.connection,!1)}if(u.childShadowElement){let G;(G=C.connection)==null||G.setShadowDom(u.childShadowElement)}}},hE=function(t,i,n){for(let c=0;c<t.length;c++){const u=og(t[c]);if(u.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Yh(u.childBlockElement,i,n.nextConnection,!0)}u.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(u.childShadowElement)}},Yh=function(t,i,n,c){var u;const g=t.getAttribute("type");if(!g)throw TypeError("Block type unspecified: "+t.outerHTML);var E=(u=t.getAttribute("id"))!=null?u:void 0;u=i.newBlock(g,E),E=oE(t);const C=nE(E.mutation,u);if(rE(E.comment,u),lE(E.data,u),n)if(c)if(u.previousConnection)n.connect(u.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(u.outputConnection)n.connect(u.outputConnection);else if(u.previousConnection)n.connect(u.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(cE(E.field,u),aE(E.input,i,u,g),hE(E.next,i,u),C&&u.initSvg(),(i=t.getAttribute("inline"))&&u.setInputsInline(i==="true"),(i=t.getAttribute("disabled"))&&u.setEnabled(i!=="true"&&i!=="disabled"),(i=t.getAttribute("deletable"))&&u.setDeletable(i==="true"),(i=t.getAttribute("movable"))&&u.setMovable(i==="true"),(i=t.getAttribute("editable"))&&u.setEditable(i==="true"),(i=t.getAttribute("collapsed"))&&u.setCollapsed(i==="true"),t.nodeName.toLowerCase()==="shadow"){for(t=u.getChildren(!1),i=0;i<t.length;i++)if(!t[i].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(u.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");u.setShadow(!0)}return u},uE=function(t,i,n){const c=t.getField(i);c?c.fromXml(n):console.warn("Ignoring non-existent field "+i+" in block "+t.type)},dE=function(t){for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeName.toLowerCase()==="next"){t.removeChild(n);break}}},ng=function(t){return t.nodeType===ko.ELEMENT_NODE},Kh=function(t){return t.saveState!==void 0&&t.loadState!==void 0},jh=function(t,i){o(Q.SERIALIZER,t,i)},pE=function(t){a(Q.SERIALIZER,t)},Bs=function(t,{addCoordinates:i=!1,addInputBlocks:n=!0,addNextBlocks:c=!0,doFullSerialization:u=!0}={}){if(t.isInsertionMarker())return null;const g={type:t.type,id:t.id};return i&&fE(t,g),gE(t,g),mE(t,g,u),$E(t,g,u),_E(t,g,u),n&&TE(t,g,u),c&&bE(t,g,u),g},gE=function(t,i){t.isCollapsed()&&(i.collapsed=!0),t.isEnabled()||(i.enabled=!1),t.isOwnDeletable()||(i.deletable=!1),t.isOwnMovable()||(i.movable=!1),t.isOwnEditable()||(i.editable=!1),t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&(i.inline=t.inputsInline),t.data&&(i.data=t.data)},fE=function(t,i){const n=t.workspace;t=t.getRelativeToSurfaceXY(),i.x=Math.round(n.RTL?n.getWidth()-t.x:t.x),i.y=Math.round(t.y)},mE=function(t,i,n){t.saveExtraState?(t=t.saveExtraState(n),t!==null&&(i.extraState=t)):t.mutationToDom&&(t=t.mutationToDom(),t!==null&&(i.extraState=Ps(t).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},$E=function(t,i,n){const c=Object.create(null);for(const u of t.getIcons())Kh(u)&&(t=u.saveState(n))&&(c[u.getType().toString()]=t);Object.keys(c).length&&(i.icons=c)},_E=function(t,i,n){const c=Object.create(null);for(let u=0;u<t.inputList.length;u++){const g=t.inputList[u];for(let E=0;E<g.fieldRow.length;E++){const C=g.fieldRow[E];C.isSerializable()&&(c[C.name]=C.saveState(n))}}Object.keys(c).length&&(i.fields=c)},TE=function(t,i,n){const c=Object.create(null);for(let u=0;u<t.inputList.length;u++){const g=t.inputList[u];if(!g.connection)continue;const E=rg(g.connection,n);E&&(c[g.name]=E)}Object.keys(c).length&&(i.inputs=c)},bE=function(t,i,n){t.nextConnection&&(t=rg(t.nextConnection,n))&&(i.next=t)},rg=function(t,i){const n=t.getShadowState(!0);if(t=t.targetBlock(),!n&&!t)return null;const c=Object.create(null);return n&&(c.shadow=n),t&&!t.isShadow()&&(c.block=Bs(t,{doFullSerialization:i})),c},en=function(t,i,{recordUndo:n=!1}={}){return t=Kr(t,i,{recordUndo:n}),i.rendered&&xs(),t},Kr=function(t,i,{parentConnection:n,isShadow:c=!1,recordUndo:u=!1}={}){const g=qt();Nt(u),(u=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),s.disable$$module$build$src$core$events$utils();let E;try{E=lg(t,i,{parentConnection:n,isShadow:c})}finally{s.enable$$module$build$src$core$events$utils()}if(Dt()&&at(new(pt(s.CREATE$$module$build$src$core$events$utils))(E)),s.setGroup$$module$build$src$core$events$utils(u),Nt(g),i.rendered){const C=E;setTimeout(()=>{C.disposed||C.setConnectionTracking(!0)},1)}return E},lg=function(t,i,{parentConnection:n,isShadow:c=!1}={}){if(!t.type)throw new SI(t);const u=i.newBlock(t.type,t.id);return u.setShadow(c),EE(u,t),vE(u,t),IE(u,t),SE(n,u,t),yE(u,t),CE(u,t),wE(u,t),kE(u,t),OE(u,i.rendered),u},EE=function(t,i){let n=i.x===void 0?0:i.x;i=i.y===void 0?0:i.y;const c=t.workspace;n=c.RTL?c.getWidth()-n:n,t.moveBy(n,i)},vE=function(t,i){i.collapsed&&t.setCollapsed(!0),i.deletable===!1&&t.setDeletable(!1),i.movable===!1&&t.setMovable(!1),i.editable===!1&&t.setEditable(!1),i.enabled===!1&&t.setEnabled(!1),i.inline!==void 0&&t.setInputsInline(i.inline),i.data!==void 0&&(t.data=i.data)},IE=function(t,i){i.extraState&&(t.loadExtraState?t.loadExtraState(i.extraState):t.domToMutation&&t.domToMutation(s.textToDom$$module$build$src$core$utils$xml(i.extraState)))},SE=function(t,i,n){if(t){if(t.getSourceBlock().isShadow()&&!i.isShadow())throw new CI(n);if(t.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var c=i.outputConnection;if(!c)throw new zc("output",i,n)}else if(c=i.previousConnection,!c)throw new zc("previous",i,n);if(!t.connect(c)){const u=i.workspace.connectionChecker;throw new yI(u.getErrorMessage(u.canConnectWithReason(c,t,!1),c,t),t.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",i,n)}}},yE=function(t,i){if(i.icons){var n=Object.keys(i.icons);for(const u of n){n=i.icons[u];var c=t.getIcon(u);if(!c){if(c=p(Q.ICON,u,!1),!c)throw new wI(u,t,i);c=new c(t),t.addIcon(c)}Kh(c)&&c.loadState(n)}}},CE=function(t,i){if(i.fields){var n=Object.keys(i.fields);for(let c=0;c<n.length;c++){const u=n[c],g=i.fields[u],E=t.getField(u);E?E.loadState(g):console.warn(`Ignoring non-existant field ${u} in block ${t.type}`)}}},wE=function(t,i){if(i.inputs){var n=Object.keys(i.inputs);for(let c=0;c<n.length;c++){const u=n[c],g=t.getInput(u);if(!g||!g.connection)throw new zc(u,t,i);cg(g.connection,i.inputs[u])}}},kE=function(t,i){if(i.next){if(!t.nextConnection)throw new zc("next",t,i);cg(t.nextConnection,i.next)}},cg=function(t,i){i.shadow&&t.setShadowState(i.shadow),i.block&&lg(i.block,t.getSourceBlock().workspace,{parentConnection:t})},OE=function(t,i){if(i){t.setConnectionTracking(!1),t.initSvg(),t.queueRender(),t.updateDisabled();for(const n of t.getIcons())n.onLocationChange(t.getRelativeToSurfaceXY())}else t.initModel()},AE=function(t){const i=t.workspace,n=s.config$$module$build$src$core$config.snapRadius,c=t.getRelativeToSurfaceXY(),u=new lt(0,0),g=i.getAllBlocks(!1).filter(E=>E.id!=t.id).map(E=>E.getRelativeToSurfaceXY());for(;RE(lt.sum(c,u),g)||NE(t,u,n);)i.RTL?u.translate(-n,2*n):u.translate(n,2*n);t.moveTo(lt.sum(c,u))},RE=function(t,i){return i.some(n=>1>=Math.abs(n.x-t.x)&&1>=Math.abs(n.y-t.y))},NE=function(t,i,n){return t.getConnections_(!1).some(c=>!!c.closest(n,i).connection)},LE=function(t){return ut("Blockly.clipboard.copy","v11","v12","myCopyable.toCopyData()"),Tm.copyInternal(t)},ME=function(t){const i=t.toCopyData();$m=i;let n;return _m=(n=t.workspace)!=null?n:null,i},jr=function(t,i,n){return t&&i?ag(t,i,n):$m&&_m?ag($m,_m):null},ag=function(t,i,n){let c;i=(c=i.getRootWorkspace())!=null?c:i;let u,g;return(g=(u=f(Q.PASTER,t.paster,!1))==null?void 0:u.paste(t,i,n))!=null?g:null},DE=function(t){return ut("Blockly.clipboard.duplicate","v11","v12","Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)"),Tm.duplicateInternal(t)},xE=function(t){const i=t.toCopyData();return i?jr(i,t.workspace):null},$s=function(t,i){t.setAttribute(pA,i)},we=function(t,i,n){Array.isArray(n)&&(n=n.join(" ")),t.setAttribute(dA+i,`${n}`)},jn=function(){return bs},PE=function(t){bs=t},hg=function(){bs||(bs=document.createElement("div"),bs.className="blocklyWidgetDiv",(F()||document.body).appendChild(bs))},Jh=function(t,i,n){ss(),El=t,Du=n,(t=bs)&&(t.style.direction=i?"rtl":"ltr",t.style.display="block",i=N(),vl=i.getRenderer().getClassName(),Il=i.getTheme().getClassName(),vl&&X(t,vl),Il&&X(t,Il))},ss=function(){if(ug()){El=null;var t=bs;t&&(t.style.display="none",t.style.left="",t.style.top="",Du&&Du(),Du=null,t.textContent="",vl&&(ft(t,vl),vl=""),Il&&(ft(t,Il),Il=""),N().markFocused())}},ug=function(){return!!El},qh=function(t){El===t&&ss()},dg=function(t,i,n){bs.style.left=t+"px",bs.style.top=i+"px",bs.style.height=n+"px"},pg=function(t,i,n,c){const u=FE(t,i,n);t=BE(t,i,n,c),0>u?dg(t,0,n.height+u):dg(t,u,n.height)},BE=function(t,i,n,c){return c?Math.min(Math.max(i.right-n.width,t.left),t.right-n.width):Math.max(Math.min(i.left,t.right-n.width),t.left)},FE=function(t,i,n){return i.bottom+n.height>=t.bottom?i.top-n.height:i.bottom},HE=function(t){return!(t==null||!t.repositionForWindowResize)},gg=function(){HE(El)&&El.repositionForWindowResize()||ss()},UE=function(){return xu},fg=function(t){xu=t},Rc=function(t,i,n){if(Jh(NI,n,mg),i.length){var c=VE(i,n);Pu=c,GE(c,t,n),setTimeout(function(){c.focus()},1),xu=null}else Nc()},VE=function(t,i){const n=new bm;n.setRole(xi.MENU);for(let c=0;c<t.length;c++){const u=t[c],g=new Em(u.text);g.setRightToLeft(i),g.setRole(xi.MENUITEM),n.addChild(g),g.setEnabled(u.enabled),u.enabled&&g.onAction(function(){Nc(),requestAnimationFrame(()=>{setTimeout(()=>{u.callback(u.scope)},0)})},{})}return n},GE=function(t,i,n){const c=k();i=new fe(i.clientY+c.top,i.clientY+c.top,i.clientX+c.left,i.clientX+c.left),WE(t);const u=t.getSize();n&&(i.left+=u.width,i.right+=u.width,c.left+=u.width,c.right+=u.width),pg(c,i,u,n),t.focus()},WE=function(t){var i=jn();if(!i)throw Error("Attempting to create a context menu when widget div is null");i=t.render(i),X(i,"blocklyContextMenu"),y(i,"contextmenu",null,XE),t.focus()},XE=function(t){t.preventDefault(),t.stopPropagation()},Nc=function(){qh(NI),xu=null},mg=function(){Pu&&(Pu.dispose(),Pu=null)},s.callbackFactory$$module$build$src$core$contextmenu=function(t,i){return()=>{s.disable$$module$build$src$core$events$utils();let n;try{n=i instanceof Element?tn(i,t.workspace):Kr(i,t.workspace);const c=t.getRelativeToSurfaceXY();c.x=t.RTL?c.x-s.config$$module$build$src$core$config.snapRadius:c.x+s.config$$module$build$src$core$config.snapRadius,c.y+=2*s.config$$module$build$src$core$config.snapRadius,n.moveBy(c.x,c.y)}finally{s.enable$$module$build$src$core$events$utils()}return Dt()&&!n.isShadow()&&at(new(pt(s.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}},$g=function(t){return{text:s.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){s.setGroup$$module$build$src$core$events$utils(!0),t.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)}}},_g=function(t){return{text:s.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const i=t.toCopyData();i&&jr(i,t.workspace)}}},zE=function(t,i){const n={enabled:!0};return n.text=s.Msg$$module$build$src$core$msg.ADD_COMMENT,n.callback=function(){const c=new si(t,s.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,si.DEFAULT_SIZE,si.DEFAULT_SIZE);var u=t.getInjectionDiv().getBoundingClientRect();u=new lt(i.clientX-u.left,i.clientY-u.top);const g=t.getOriginOffsetInPixels();u=lt.difference(u,g),u.scale(1/t.scale),c.moveBy(u.x,u.y),t.rendered&&(c.initSvg(),c.render(),c.select())},n},Jr=function(t){return t*Math.PI/180},Tg=function(t){return 180*t/Math.PI},qr=function(t,i,n){if(n<t){const c=n;n=t,t=c}return Math.max(t,Math.min(i,n))},bg=function(){ie||(ie=document.createElement("div"),ie.className="blocklyDropDownDiv",(F()||document.body).appendChild(ie),Cl=document.createElement("div"),Cl.className="blocklyDropDownContent",ie.appendChild(Cl),ur=document.createElement("div"),ur.className="blocklyDropDownArrow",ie.appendChild(ur),ie.style.opacity="0",ie.style.transition="transform "+Fu+"s, opacity "+Fu+"s",ie.addEventListener("focusin",function(){X(ie,"blocklyFocused")}),ie.addEventListener("focusout",function(){ft(ie,"blocklyFocused")}))},Eg=function(t){ym=t},vg=function(){return gn},Zr=function(){return Cl},Zh=function(){Cl.textContent="",Cl.style.width=""},Qh=function(t,i){ie.style.backgroundColor=t,ie.style.borderColor=i},YE=function(t,i,n,c){return yg(Ig(i),t,n,c)},Lc=function(t,i,n){return MI=!0,yg(Sg(t),t,i,n)},Ig=function(t){var i=t.getSvgRoot();const n=t.workspace.scale,c=t.height*n;return t=t.width*n,i=be(i),new fe(i.y,i.y+c,i.x,i.x+t)},Sg=function(t){return t=t.getScaledBBox(),new fe(t.top,t.bottom,t.left,t.right)},yg=function(t,i,n,c){const u=t.left+(t.right-t.left)/2,g=t.bottom;t=t.top,c&&(t+=c),c=i.getSourceBlock();let E=c.workspace;for(;E.options.parentWorkspace;)E=E.options.parentWorkspace;return Eg(E.getParentSvg().parentNode),Cg(i,c.RTL,u,g,u,t,n)},Cg=function(t,i,n,c,u,g,E){return gn=t,hr=E||null,ie.style.direction=i?"rtl":"ltr",t=N(),Sl=t.getRenderer().getClassName(),yl=t.getTheme().getClassName(),Sl&&X(ie,Sl),yl&&X(ie,yl),Ag(n,c,u,g)},wg=function(t,i,n,c){return t=Mc(t,n.left,n.right,c.width),{initialX:t.divX,initialY:i,finalX:t.divX,finalY:i+Im,arrowX:t.arrowX,arrowY:-(Jc/2+vm),arrowAtTop:!0,arrowVisible:!0}},kg=function(t,i,n,c){return t=Mc(t,n.left,n.right,c.width),{initialX:t.divX,initialY:i-c.height,finalX:t.divX,finalY:i-c.height-Im,arrowX:t.arrowX,arrowY:c.height-2*vm-Jc/2,arrowAtTop:!1,arrowVisible:!0}},KE=function(t,i,n){return t=Mc(t,i.left,i.right,n.width),{initialX:t.divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Mc=function(t,i,n,c){return i=qr(i,t-c/2,n-c),t=t-Jc/2-i,n=LI,t=qr(n,t,c-n-Jc),{arrowX:t,divX:i}},Og=function(){return!!gn},Qr=function(t,i){return gn===t?(i?_s():tu(),!0):!1},tu=function(){ie.style.transform="translate(0, 0)",ie.style.opacity="0",Sm=setTimeout(function(){_s()},1e3*Fu),hr&&(hr(),hr=null)},_s=function(){Og()&&(Sm&&clearTimeout(Sm),ie.style.transform="",ie.style.left="",ie.style.top="",ie.style.opacity="0",ie.style.display="none",ie.style.backgroundColor="",ie.style.borderColor="",hr&&(hr(),hr=null),Zh(),gn=null,Sl&&(ft(ie,Sl),Sl=""),yl&&(ft(ie,yl),yl=""),N().markFocused())},Ag=function(t,i,n,c){t=Cm.getPositionMetrics(t,i,n,c),t.arrowVisible?(ur.style.display="",ur.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",ur.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):ur.style.display="none",i=Math.floor(t.initialX),n=Math.floor(t.initialY),c=Math.floor(t.finalX);const u=Math.floor(t.finalY);return ie.style.left=i+"px",ie.style.top=n+"px",ie.style.display="block",ie.style.opacity="1",ie.style.transform="translate("+(c-i)+"px,"+(u-n)+"px)",!!t.arrowAtTop},Rg=function(){if(gn){var t=gn.getSourceBlock();t=MI?Sg(gn):Ig(t);const i=t.left+(t.right-t.left)/2;Ag(i,t.bottom,i,t.top)}else tu()},Ng=function(t){if(!(100<t.getDescendants(!1).length)){var i=t.workspace,n=t.getSvgRoot();i.getAudioManager().play("delete");var c=i.getSvgXY(n);n=n.cloneNode(!0),n.setAttribute("transform","translate("+c.x+","+c.y+")"),i.getParentSvg().appendChild(n),Lg(n,{x:c.x,y:c.y,width:t.width,height:t.height},i.RTL,new Date,i.scale)}},Lg=function(t,i,n,c,u){const g=(new Date().getTime()-c.getTime())/150;1<g?bt(t):(t.setAttribute("transform","translate("+(i.x+(n?-1:1)*i.width*u/2*g)+","+(i.y+i.height*u*g)+") scale("+(1-g)*u+")"),setTimeout(Lg,10,t,i,n,c,u))},Mg=function(t){var i=t.workspace;const n=i.scale;if(i.getAudioManager().play("click"),!(1>n)){var c=i.getSvgXY(t.getSvgRoot());t.outputConnection?(c.x+=(t.RTL?3:-3)*n,c.y+=13*n):t.previousConnection&&(c.x+=(t.RTL?-23:23)*n,c.y+=3*n);var u=A(x.CIRCLE,{cx:c.x,cy:c.y,r:0,fill:"none",stroke:"#888","stroke-width":10},i.getParentSvg());t=A(x.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*n},u),i=A(x.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},u),t.beginElement(),i.beginElement(),setTimeout(()=>void bt(u),150)}},Dg=function(t){if(tl(),t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var i=t.getHeightWidth().height;i=Math.atan(10/i)/Math.PI*180,t.RTL||(i*=-1),qc=t,xg(t,i,new Date)}},xg=function(t,i,n){const c=(new Date().getTime()-n.getTime())/200;let u="";1>=c&&(u=`skewX(${Math.round(Math.sin(c*Math.PI*3)*(1-c)*i)})`,Hu=setTimeout(xg,10,t,i,n)),t.getSvgRoot().setAttribute("transform",`${t.getTranslation()} ${u}`)},tl=function(){qc&&(Hu&&(clearTimeout(Hu),Hu=null),qc.getSvgRoot().setAttribute("transform",qc.getTranslation()),qc=null)},jE=function(t,i){return ut("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),t.startsWith(i)},Dc=function(t){return t.length?t.reduce(function(i,n){return i.length<n.length?i:n}).length:0},Pg=function(t,i){if(!t.length)return 0;if(t.length===1)return t[0].length;let n=0;i=i||Dc(t);let c;for(c=0;c<i;c++){for(var u=t[0][c],g=1;g<t.length;g++)if(u!==t[g][c])return n;u===" "&&(n=c+1)}for(u=1;u<t.length;u++)if((g=t[u][c])&&g!==" ")return n;return i},Bg=function(t,i){if(!t.length)return 0;if(t.length===1)return t[0].length;let n=0;i=i||Dc(t);let c;for(c=0;c<i;c++){for(var u=t[0].substr(-c-1,1),g=1;g<t.length;g++)if(u!==t[g].substr(-c-1,1))return n;u===" "&&(n=c+1)}for(u=1;u<t.length;u++)if((g=t[u].charAt(t[u].length-c-1))&&g!==" ")return n;return i},s.wrap$$module$build$src$core$utils$string=function(t,i){t=t.split(`
`);for(let n=0;n<t.length;n++)t[n]=JE(t[n],i);return t.join(`
`)},JE=function(t,i){if(t.length<=i)return t;const n=t.trim().split(/\s+/);for(var c=0;c<n.length;c++)n[c].length>i&&(i=n[c].length);var u=-1/0;let g,E=1;do{c=u,g=t,t=[],u=n.length/E;let C=1;for(let G=0;G<n.length-1;G++)C<(G+1.5)/u?(C++,t[G]=!0):t[G]=!1;t=Fg(n,t,i),u=eu(n,t,i),t=qE(n,t),E++}while(u>c);return g},eu=function(t,i,n){const c=[0],u=[];for(var g=0;g<t.length;g++)c[c.length-1]+=t[g].length,i[g]===!0?(c.push(0),u.push(t[g].charAt(t[g].length-1))):i[g]===!1&&c[c.length-1]++;for(t=Math.max(...c),i=0,g=0;g<c.length;g++)i-=2*Math.pow(Math.abs(n-c[g]),1.5),i-=Math.pow(t-c[g],1.5),".?!".indexOf(u[g])!==-1?i+=n/3:",;)]}".indexOf(u[g])!==-1&&(i+=n/4);return 1<c.length&&c[c.length-1]<=c[c.length-2]&&(i+=.5),i},Fg=function(t,i,n){let c=eu(t,i,n),u;for(let g=0;g<i.length-1;g++){if(i[g]===i[g+1])continue;const E=[].concat(i);E[g]=!E[g],E[g+1]=!E[g+1];const C=eu(t,E,n);C>c&&(c=C,u=E)}return u?Fg(t,u,n):i},qE=function(t,i){const n=[];for(let c=0;c<t.length;c++)n.push(t[c]),i[c]!==void 0&&n.push(i[c]?`
`:" ");return n.join("")},s.isNumber$$module$build$src$core$utils$string=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},ZE=function(t){Uu=t},QE=function(){return Uu},tv=function(){return Qc},ev=function(){return Ve},el=function(t){if(t=Hg(t)){for(t=t.tooltip;typeof t=="function";)t=t();if(typeof t!="string")throw Error("Tooltip function must return a string.");return t}return""},Hg=function(t){for(;t&&t.tooltip;){if(typeof t.tooltip=="string"||typeof t.tooltip=="function")return t;t=t.tooltip}return null},Ug=function(){Ve||(Ve=document.createElement("div"),Ve.className="blocklyTooltipDiv",(F()||document.body).appendChild(Ve))},xc=function(t){t.mouseOverWrapper_=D(t,"pointerover",null,iv),t.mouseOutWrapper_=D(t,"pointerout",null,sv),t.addEventListener("pointermove",Gg,!1)},Vg=function(t){t&&(H(t.mouseOverWrapper_),H(t.mouseOutWrapper_),t.removeEventListener("pointermove",Gg))},iv=function(t){wl||(t=Hg(t.currentTarget),ns!==t&&(To(),ta=null,ns=t),clearTimeout(FI))},sv=function(t){wl||(FI=setTimeout(function(){ta=ns=null,To()},1),clearTimeout(gr),gr=0)},Gg=function(t){if(ns&&ns.tooltip&&!wl)if(Qc){const i=Om-t.pageX;t=Am-t.pageY,Math.sqrt(i*i+t*t)>HI&&To()}else ta!==ns&&(clearTimeout(gr),Om=t.pageX,Am=t.pageY,gr=setTimeout(lv,UI))},Wg=function(){ta=ns=null,To()},To=function(){Qc&&(Qc=!1,Ve&&(Ve.style.display="none")),gr&&(clearTimeout(gr),gr=0)},Xg=function(){To(),wl=!0},zg=function(){wl=!1},ov=function(){Ve&&ns&&(typeof Uu=="function"?Uu(Ve,ns):nv())},nv=function(){var t=el(ns);t=s.wrap$$module$build$src$core$utils$string(t,BI),t=t.split(`
`);for(let i=0;i<t.length;i++){const n=document.createElement("div");n.appendChild(document.createTextNode(t[i])),Ve.appendChild(n)}},rv=function(t){const i=document.documentElement.clientWidth,n=document.documentElement.clientHeight;let c=Om;c=t?c-(Rm+Ve.offsetWidth):c+Rm;let u=Am+Nm;return u+Ve.offsetHeight>n+window.scrollY&&(u-=Ve.offsetHeight+2*Nm),t?c=Math.max(Vu-window.scrollX,c):c+Ve.offsetWidth>i+window.scrollX-2*Vu&&(c=i-Ve.offsetWidth-2*Vu),{x:c,y:u}},lv=function(){if(!wl&&(ta=ns,Ve)){Ve.textContent="",ov();var t=ns.RTL;Ve.style.direction=t?"rtl":"ltr",Ve.style.display="block",Qc=!0;var{x:i,y:n}=rv(t);Ve.style.left=i+"px",Ve.style.top=n+"px"}},bo=function(t,i){for(const n in i)t[n]=i[n]!==null&&typeof i[n]=="object"?bo(t[n]||Object.create(null),i[n]):i[n];return t},sn=function(t){return t.bubbleIsVisible!==void 0&&t.setBubbleVisible!==void 0},iu=function(){return Mm},Yg=function(t){Mm=t},su=function(){return Dm},Kg=function(t){Dm=t},on=function(t){t=`${t}`.toLowerCase().trim();var i=WI[t];if(i||(i=t.substring(0,2)==="0x"?"#"+t.substring(2):t,i=i[0]==="#"?i:"#"+i,/^#[0-9a-f]{6}$/.test(i)))return i;if(/^#[0-9a-f]{3}$/.test(i))return["#",i[1],i[1],i[2],i[2],i[3],i[3]].join("");var n=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return n&&(t=Number(n[1]),i=Number(n[2]),n=Number(n[3]),0<=t&&256>t&&0<=i&&256>i&&0<=n&&256>n)?Pc(t,i,n):null},Pc=function(t,i,n){return i=t<<16|i<<8|n,16>t?"#"+(16777216|i).toString(16).substr(1):"#"+i.toString(16)},ou=function(t){return t=on(t),t?(t=parseInt(t.substr(1),16),[t>>16,t>>8&255,t&255]):[0,0,0]},nu=function(t,i,n){let c=0,u=0,g=0;if(i===0)g=u=c=n;else{const E=Math.floor(t/60),C=t/60-E;t=n*(1-i);const G=n*(1-i*C);switch(i=n*(1-i*(1-C)),E){case 1:c=G,u=n,g=t;break;case 2:c=t,u=n,g=i;break;case 3:c=t,u=G,g=n;break;case 4:c=i,u=t,g=n;break;case 5:c=n,u=t,g=G;break;case 6:case 0:c=n,u=i,g=t}}return Pc(Math.floor(c),Math.floor(u),Math.floor(g))},Jn=function(t,i,n){return t=on(t),!t||(i=on(i),!i)?null:(t=ou(t),i=ou(i),Pc(Math.round(i[0]+n*(t[0]-i[0])),Math.round(i[1]+n*(t[1]-i[1])),Math.round(i[2]+n*(t[2]-i[2]))))},jg=function(t){return nu(t,Mm,255*Dm)},ru=function(t,i,n){const c=[];var u=t.split("");u.push("");var g=0;t=[];let E=null;for(let dt=0;dt<u.length;dt++){var C=u[dt];if(g===0)if(C==="%")(g=t.join(""))&&c.push(g),t.length=0,g=1;else if(n&&C===`
`){const Ie=t.join("");Ie&&c.push(Ie),t.length=0,c.push(C)}else t.push(C);else if(g===1)C==="%"?(t.push(C),g=0):i&&"0"<=C&&"9">=C?(g=2,E=C,(C=t.join(""))&&c.push(C),t.length=0):C==="{"?g=3:(t.push("%",C),g=0);else if(g===2)if("0"<=C&&"9">=C)E+=C;else{var G=void 0;c.push(parseInt((G=E)!=null?G:"",10)),dt--,g=0}else g===3&&(C===""?(t.splice(0,0,"%{"),dt--,g=0):C!=="}"?t.push(C):(g=t.join(""),/[A-Z]\w*/i.test(g)?(C=g.toUpperCase(),(C=C.startsWith("BKY_")?C.substring(4):null)&&C in s.Msg$$module$build$src$core$msg?(g=s.Msg$$module$build$src$core$msg[C],typeof g=="string"?Array.prototype.push.apply(c,ru(g,i,n)):i?c.push(`${g}`):c.push(g)):c.push("%{"+g+"}")):c.push("%{"+g+"}"),g=t.length=0))}for((i=t.join(""))&&c.push(i),G=[],t.length=0,u=0;u<c.length;u++)typeof c[u]!="string"||n&&c[u]===`
`?((i=t.join(""))&&G.push(i),t.length=0,G.push(c[u])):t.push(c[u]);return(i=t.join(""))&&G.push(i),t.length=0,G},Jg=function(t){return ru(t,!0,!0)},Pe=function(t){return typeof t!="string"?t:(t=ru(t,!1,!1),t.length?String(t[0]):"")},cv=function(t){let i=!0;const n=s.Msg$$module$build$src$core$msg,c=t.match(/%{BKY_[A-Z]\w*}/gi);if(c)for(let u=0;u<c.length;u++){const g=c[u].toUpperCase();n[g.slice(6,-1)]===void 0&&(console.warn("No message string for "+c[u]+" in "+t),i=!1)}return i},il=function(t){const i=typeof t=="string"?Pe(t):t;var n=Number(i);if(!isNaN(n)&&0<=n&&360>=n)return{hue:n,hex:nu(n,iu(),255*su())};if(n=on(i))return{hue:null,hex:n};throw n='Invalid colour: "'+i+'"',t!==i&&(n+=' (from "'+t+'")'),Error(n)},nn=function(t){return t.getProcedureModel!==void 0&&t.doProcedureUpdate!==void 0&&t.isProcedureDef!==void 0},lu=function(t){return t.startPublishing!==void 0&&t.stopPublishing!==void 0},Vi=function(t,i){o(Q.FIELD,t,i)},av=function(t){a(Q.FIELD,t)},s.fromJson$$module$build$src$core$field_registry=function(t){return zI.fromJsonInternal(t)},hv=function(t){const i=f(Q.FIELD,t.type);if(i){if(typeof i.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return i.fromJson(t)}return console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},uv=function(t){let i=!1;const n=t.map(([E,C])=>typeof E=="string"?[Pe(E),C]:(i=!0,[E.alt!==null?Object.assign({},E,{alt:Pe(E.alt)}):Object.assign({},E),C]));if(i||2>t.length)return{options:n};var c=n.map(([E])=>E),u=Dc(c);t=Pg(c,u);const g=Bg(c,u);return!t&&!g||u<=t+g?{options:n}:(u=t?c[0].substring(0,t-1):void 0,c=g?c[0].substr(1-g):void 0,{options:dv(n,t,g),prefix:u,suffix:c})},dv=function(t,i,n){return t.map(([c,u])=>[c.substring(i,c.length-n),u])},qg=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let i=!1;for(let n=0;n<t.length;n++){const c=t[n];Array.isArray(c)?typeof c[1]!="string"?(i=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+c[1]+" in: ",c)):c[0]&&typeof c[0]!="string"&&typeof c[0].src!="string"&&(i=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+c[0]+" in: ",c)):(i=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",c))}if(i)throw TypeError("Found invalid FieldDropdown options.")},s.register$$module$build$src$core$extensions=function(t,i){if(typeof t!="string"||t.trim()==="")throw Error('Error: Invalid extension name "'+t+'"');if(kl[t])throw Error('Error: Extension "'+t+'" is already registered.');if(typeof i!="function")throw Error('Error: Extension "'+t+'" must be a function');kl[t]=i},s.registerMixin$$module$build$src$core$extensions=function(t,i){if(!i||typeof i!="object")throw Error('Error: Mixin "'+t+'" must be a object');s.register$$module$build$src$core$extensions(t,function(){this.mixin(i)})},s.registerMutator$$module$build$src$core$extensions=function(t,i,n,c){const u='Error when registering mutator "'+t+'": ';tf(u,i);const g=Qg(i,u);if(n&&typeof n!="function")throw Error(u+'Extension "'+t+'" is not a function');s.register$$module$build$src$core$extensions(t,function(){g&&this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(c||[],this)),this.mixin(i),n&&n.apply(this)})},pv=function(t){Zg(t)?delete kl[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},Zg=function(t){return!!kl[t]},cu=function(t,i,n){const c=kl[t];if(typeof c!="function")throw Error('Error: Extension "'+t+'" not found.');let u;if(n?gv(t,i):u=hu(i),c.apply(i),n)tf('Error after applying mutator "'+t+'": ',i);else if(!$v(u,i))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},gv=function(t,i){if(hu(i).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+i.id)},fv=function(t,i){return au(t.mutationToDom,t.domToMutation,i+" mutationToDom/domToMutation")},mv=function(t,i){return au(t.saveExtraState,t.loadExtraState,i+" saveExtraState/loadExtraState")},Qg=function(t,i){return au(t.compose,t.decompose,i+" compose/decompose")},au=function(t,i,n){if(t&&i){if(typeof t!="function"||typeof i!="function")throw Error(n+" must be a function");return!0}if(!t&&!i)return!1;throw Error(n+"Must have both or neither functions")},tf=function(t,i){const n=fv(i,t),c=mv(i,t);if(!n&&!c)throw Error(t+"Mutations must contain either XML hooks, or JSON hooks, or both");Qg(i,t)},hu=function(t){const i=[];return t.domToMutation!==void 0&&i.push(t.domToMutation),t.mutationToDom!==void 0&&i.push(t.mutationToDom),t.saveExtraState!==void 0&&i.push(t.saveExtraState),t.loadExtraState!==void 0&&i.push(t.loadExtraState),t.compose!==void 0&&i.push(t.compose),t.decompose!==void 0&&i.push(t.decompose),i},$v=function(t,i){if(i=hu(i),i.length!==t.length)return!1;for(let n=0;n<i.length;n++)if(t[n]!==i[n])return!1;return!0},_v=function(t){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")t();else{const i=setInterval(function(){document.readyState==="complete"&&(clearInterval(i),t())},10)}},s.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,i){const n=[];return function(){n.indexOf(this.type)===-1&&(Tv(this,t,i),n.push(this.type)),this.setTooltip((function(){const c=String(this.getFieldValue(t));return Pe(i[c])}).bind(this))}},Tv=function(t,i,n){var c=t.getField(i);if(c instanceof zs&&!c.isOptionListDynamic()){c=c.getOptions();for(const[,u]of c)n[u]===void 0&&console.warn(`No tooltip mapping for value ${u} of field ${i} of block type ${t.type}.`)}},s.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,i){return function(){this.setTooltip((function(){const n=this.getField(i);return Pe(t).replace("%1",n?n.getText():"")}).bind(this))}},bv=function(){const t=this.tooltip;this.setTooltip((function(){const i=this.getParent();return i&&i.getInputsInline()&&i.tooltip||t}).bind(this))},vt=function(t,i){return" "+t+","+i+" "},Ni=function(t,i){return" "+t+i.join("")},ti=function(t,i){return" M "+t+","+i+" "},ke=function(t,i){return" m "+t+","+i+" "},Fs=function(t,i){return" l "+t+","+i+" "},sl=function(t){return" l"+t.join("")},$t=function(t,i){return" "+t+" "+i+" "},He=function(t,i,n,c){return t+" "+n+" "+n+" "+i+c},ef=function(t,i){o(Q.ICON,t.toString(),i)},Ev=function(t){a(Q.ICON,t)},uu=function(t){const i=t.getProcedureMap().getProcedures().filter(c=>!c.getReturnTypes()).map(c=>[c.getName(),c.getParameters().map(u=>u.getName()),!1]);t.getBlocksByType("procedures_defnoreturn",!1).forEach(c=>{!nn(c)&&Xr(c)&&i.push(c.getProcedureDef())});const n=t.getProcedureMap().getProcedures().filter(c=>!!c.getReturnTypes()).map(c=>[c.getName(),c.getParameters().map(u=>u.getName()),!0]);return t.getBlocksByType("procedures_defreturn",!1).forEach(c=>{!nn(c)&&Xr(c)&&n.push(c.getProcedureDef())}),i.sort(sf),n.sort(sf),[i,n]},sf=function(t,i){return t[0].localeCompare(i[0],void 0,{sensitivity:"base"})},s.findLegalName$$module$build$src$core$procedures=function(t,i){if(i.isInFlyout)return t;for(t=t||s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!vv(t,i.workspace,i);){const n=t.match(/^(.*?)(\d+)$/);t=n?n[1]+(parseInt(n[2])+1):t+"2"}return t},vv=function(t,i,n){return!of(t,i,n)},of=function(t,i,n){for(const c of i.getAllBlocks(!1))if(c!==n&&Xr(c)&&s.Names$$module$build$src$core$names.equals(c.getProcedureDef()[0],t))return!0;n=n&&nn(n)?n==null?void 0:n.getProcedureModel():void 0;for(const c of i.getProcedureMap().getProcedures())if(c!==n&&s.Names$$module$build$src$core$names.equals(c.getName(),t))return!0;return!1},s.rename$$module$build$src$core$procedures=function(t){var i=this.getSourceBlock();if(!i)throw new me;t=t.trim();const n=s.findLegalName$$module$build$src$core$procedures(t,i);nn(i)&&!i.isInsertionMarker()&&i.getProcedureModel().setName(n);const c=this.getValue();if(c!==t&&c!==n)for(t=i.workspace.getAllBlocks(!1),i=0;i<t.length;i++){const u=t[i];u.renameProcedure&&u.renameProcedure(c,n)}return n},du=function(t){function i(g,E){for(let G=0;G<g.length;G++){var C=g[G][0];const dt=g[G][1],Ie=s.createElement$$module$build$src$core$utils$xml("block");Ie.setAttribute("type",E),Ie.setAttribute("gap","16");const $e=s.createElement$$module$build$src$core$utils$xml("mutation");for($e.setAttribute("name",C),Ie.appendChild($e),C=0;C<dt.length;C++){const Pi=s.createElement$$module$build$src$core$utils$xml("arg");Pi.setAttribute("name",dt[C]),$e.appendChild(Pi)}n.push(Ie)}}const n=[];if(Li.procedures_defnoreturn){var c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_defnoreturn"),c.setAttribute("gap","16");var u=s.createElement$$module$build$src$core$utils$xml("field");u.setAttribute("name","NAME"),u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),c.appendChild(u),n.push(c)}return Li.procedures_defreturn&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","procedures_defreturn"),c.setAttribute("gap","16"),u=s.createElement$$module$build$src$core$utils$xml("field"),u.setAttribute("name","NAME"),u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),c.appendChild(u),n.push(c)),Li.procedures_ifreturn&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","procedures_ifreturn"),c.setAttribute("gap","16"),n.push(c)),n.length&&n[n.length-1].setAttribute("gap","24"),t=uu(t),i(t[0],"procedures_callnoreturn"),i(t[1],"procedures_callreturn"),n},nf=function(t){var i=[],n=t.getBlocksByType("procedures_mutatorarg",!1);for(let g=0,E;E=n[g];g++)i.push(E.getFieldValue("NAME"));n=s.createElement$$module$build$src$core$utils$xml("xml");const c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_mutatorarg");const u=s.createElement$$module$build$src$core$utils$xml("field");u.setAttribute("name","NAME"),i=Vh(s.DEFAULT_ARG$$module$build$src$core$procedures,i),i=s.createTextNode$$module$build$src$core$utils$xml(i),u.appendChild(i),c.appendChild(u),n.appendChild(c),t.updateToolbox(n)},rf=function(t){if(t.type===Hs&&t.bubbleType==="mutator"&&t.isOpen&&t.blockId){t=b(t.workspaceId).getBlockById(t.blockId);var i=t.type;(i==="procedures_defnoreturn"||i==="procedures_defreturn")&&(t=t.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),nf(t),t.addChangeListener(Iv))}},Iv=function(t){(t.type===s.CREATE$$module$build$src$core$events$utils||t.type===s.DELETE$$module$build$src$core$events$utils||t.type===s.CHANGE$$module$build$src$core$events$utils||t.type===ln)&&(t=b(t.workspaceId),nf(t))},lf=function(t,i){return i.getAllBlocks(!1).filter(n=>Sv(n,t)||Wb(n)&&s.Names$$module$build$src$core$names.equals(n.getProcedureCall(),t))},Sv=function(t,i){return nn(t)&&!t.isProcedureDef()&&t.getProcedureModel()&&s.Names$$module$build$src$core$names.equals(t.getProcedureModel().getName(),i)},s.mutateCallers$$module$build$src$core$procedures=function(t){const i=qt();var n=t.getProcedureDef()[0];const c=t.mutationToDom(!0);t=lf(n,t.workspace);for(let g=0,E;E=t[g];g++){n=(n=E.mutationToDom())&&Fe(n),E.domToMutation&&E.domToMutation(c);var u=E.mutationToDom();u=u&&Fe(u),n!==u&&(Nt(!1),at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(E,"mutation",null,n,u)),Nt(i))}},s.getDefinition$$module$build$src$core$procedures=function(t,i){for(const n of i.getAllBlocks(!1))if(nn(n)&&n.isProcedureDef()&&s.Names$$module$build$src$core$names.equals(n.getProcedureModel().getName(),t)||Xr(n)&&s.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],t))return n;return null},cf=function(t){return t.isDynamic},Bc=function(t){let i=t.outputConnection;return(!i||t.previousConnection&&t.previousConnection.isConnected())&&(i=t.previousConnection),i},yv=function(t,i){if(!t||!i)throw Error("Cannot connect null connections.");t.targetConnection=i,i.targetConnection=t},Cv=function(t,i){let n=null;i=i.outputConnection;const c=i==null?void 0:i.getConnectionChecker();for(let u=0,g;g=t.inputList[u];u++){const E=g.connection;let C;if(E&&((C=c)!=null&&C.canConnect(i,E,!1))){if(n)return null;n=E}}return n},wv=function(t,i){let n;for(;n=Cv(t,i);)if(t=n.targetBlock(),!t||t.isShadow())return n;return null},ol=function(t,i){o(Q.RENDERER,t,i)},kv=function(t){a(Q.RENDERER,t)},af=function(t,i,n){return t=new(p(Q.RENDERER,t))(t),t.init(i,n),t},hf=function(t){zr(t.getTargetWorkspace(),void 0,"String")},uf=function(t){zr(t.getTargetWorkspace(),void 0,"Number")},df=function(t){zr(t.getTargetWorkspace(),void 0,"Colour")},pu=function(t){let i=[],n=document.createElement("button");return n.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),i.push(n),n=document.createElement("button"),n.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),i.push(n),n=document.createElement("button"),n.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),i.push(n),t.registerButtonCallback("CREATE_VARIABLE_STRING",hf),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",uf),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",df),t=pf(t),i=i.concat(t)},pf=function(t){t=t.getAllVariables();const i=[];if(0<t.length){if(Li.variables_set_dynamic){var n=t[t.length-1];const c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","variables_set_dynamic"),c.setAttribute("gap","24"),c.appendChild(Kn(n)),i.push(c)}if(Li.variables_get_dynamic){t.sort(Xc.compareByName);for(let c=0,u;u=t[c];c++)n=s.createElement$$module$build$src$core$utils$xml("block"),n.setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(Kn(u)),i.push(n)}}return i},Fc=function(t){return t.toCopyData!==void 0},gf=function(){ce.registry.register({name:qs.ESCAPE,preconditionFn(t){return!t.options.readOnly},callback(t){return t.hideChaff(),!0},keyCodes:[Gt.ESC]})},ff=function(){ce.registry.register({name:qs.DELETE,preconditionFn(t){const i=W();return!t.options.readOnly&&i!=null&&i.isDeletable()},callback(t,i){return i.preventDefault(),Ao.inProgress()?!1:(W().checkAndDelete(),!0)},keyCodes:[Gt.DELETE,Gt.BACKSPACE]})},mf=function(){const t=ce.registry.createSerializedKey(Gt.C,[Gt.CTRL]),i=ce.registry.createSerializedKey(Gt.C,[Gt.ALT]),n=ce.registry.createSerializedKey(Gt.C,[Gt.META]);ce.registry.register({name:qs.COPY,preconditionFn(c){const u=W();return!c.options.readOnly&&!Ao.inProgress()&&u!=null&&u.isDeletable()&&u.isMovable()&&Fc(u)},callback(c,u){return u.preventDefault(),c.hideChaff(),u=W(),!u||!Fc(u)?!1:(da=u.toCopyData(),ed=c,!!da)},keyCodes:[t,i,n]})},$f=function(){const t=ce.registry.createSerializedKey(Gt.X,[Gt.CTRL]),i=ce.registry.createSerializedKey(Gt.X,[Gt.ALT]),n=ce.registry.createSerializedKey(Gt.X,[Gt.META]);ce.registry.register({name:qs.CUT,preconditionFn(c){const u=W();return!c.options.readOnly&&!Ao.inProgress()&&u!=null&&u instanceof Js&&u.isDeletable()&&u.isMovable()&&!u.workspace.isFlyout},callback(c){const u=W();return!u||!Fc(u)?!1:(da=u.toCopyData(),ed=c,u.checkAndDelete(),!0)},keyCodes:[t,i,n]})},_f=function(){const t=ce.registry.createSerializedKey(Gt.V,[Gt.CTRL]),i=ce.registry.createSerializedKey(Gt.V,[Gt.ALT]),n=ce.registry.createSerializedKey(Gt.V,[Gt.META]);ce.registry.register({name:qs.PASTE,preconditionFn(c){return!c.options.readOnly&&!Ao.inProgress()},callback(){return da&&ed?!!jr(da,ed):!1},keyCodes:[t,i,n]})},Tf=function(){const t=ce.registry.createSerializedKey(Gt.Z,[Gt.CTRL]),i=ce.registry.createSerializedKey(Gt.Z,[Gt.ALT]),n=ce.registry.createSerializedKey(Gt.Z,[Gt.META]);ce.registry.register({name:qs.UNDO,preconditionFn(c){return!c.options.readOnly&&!Ao.inProgress()},callback(c){return c.hideChaff(),c.undo(!1),!0},keyCodes:[t,i,n]})},bf=function(){const t=ce.registry.createSerializedKey(Gt.Z,[Gt.SHIFT,Gt.CTRL]),i=ce.registry.createSerializedKey(Gt.Z,[Gt.SHIFT,Gt.ALT]),n=ce.registry.createSerializedKey(Gt.Z,[Gt.SHIFT,Gt.META]),c=ce.registry.createSerializedKey(Gt.Y,[Gt.CTRL]);ce.registry.register({name:qs.REDO,preconditionFn(u){return!Ao.inProgress()&&!u.options.readOnly},callback(u){return u.hideChaff(),u.undo(!0),!0},keyCodes:[t,i,n,c]})},Ef=function(){gf(),ff(),mf(),$f(),_f(),Tf(),bf()},vf=function(t){const i={id:t.getId(),name:t.getName(),returnTypes:t.getReturnTypes()};return t.getParameters().length&&(i.parameters=t.getParameters().map(n=>If(n))),i},If=function(t){const i={id:t.getId(),name:t.getName()};return t.getTypes().length&&(i.types=t.getTypes()),i},Sf=function(t,i,n,c){if(t=new t(c,n.name,n.id).setReturnTypes(n.returnTypes),!n.parameters)return t;for(const[u,g]of n.parameters.entries())t.insertParameter(yf(i,g,c),u);return t},yf=function(t,i,n){return t=new t(n,i.name,i.id),i.types&&t.setTypes(i.types),t},Ov=function(t){const i=Object.create(null),n=m(Q.SERIALIZER,!0);for(const c in n){let u;const g=(u=n[c])==null?void 0:u.save(t);g&&(i[c]=g)}return i},Av=function(t,i,{recordUndo:n=!1}={}){var c=m(Q.SERIALIZER,!0);if(c){c=Object.entries(c).sort((g,E)=>E[1].priority-g[1].priority);var u=qt();Nt(n),(n=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),S(),i instanceof Is&&i.setResizesEnabled(!1);for(const[,g]of c.reverse()){let E;(E=g)==null||E.clear(i)}for(let[g,E]of c.reverse())if(t[g]){let C;(C=E)==null||C.load(t[g],i)}i instanceof Is&&i.setResizesEnabled(!0),R(),at(new(pt(tr))(i)),s.setGroup$$module$build$src$core$events$utils(n),Nt(u)}},nl=function(t,i,n){const c=n.getBoundingRectangle(),u=c.right-c.left,g=qr(i.top,c.top,i.top+i.height-(c.bottom-c.top))-c.top;let E=i.left;return i=i.left+i.width-u,t.RTL?E=Math.min(i,E):i=Math.max(E,i),(t=qr(E,c.left,i)-c.left)||g?(n.moveBy(t,g,["inbounds"]),!0):!1},Cf=function(t){return i=>{var n=t.getMetricsManager();if(n.hasFixedEdges()&&!t.isDragging()){var c;if(Tu.indexOf((c=i.type)!=null?c:"")!==-1){c=n.getScrollMetrics(!0);const u=Rv(t,i);u&&(n=s.getGroup$$module$build$src$core$events$utils()||!1,s.setGroup$$module$build$src$core$events$utils(i.group),nl(t,c,u)&&!i.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),s.setGroup$$module$build$src$core$events$utils(n))}else i.type===an&&i.scale&&i.oldScale&&i.scale>i.oldScale&&gu(t)}}},Rv=function(t,i){let n=null;switch(i.type){case s.CREATE$$module$build$src$core$events$utils:case s.MOVE$$module$build$src$core$events$utils:(n=t.getBlockById(i.blockId))&&(n=n.getRootBlock());break;case hn:case Us:n=t.getCommentById(i.commentId)}return n},gu=function(t){var i=t.getMetricsManager();if(i.hasFixedEdges()&&!t.isDragging()){i=i.getScrollMetrics(!0);var n=t.getTopBoundedElements();for(let c=0,u;u=n[c];c++)nl(t,i,u)}},wf=function(t,i){const n=[];for(const c of t.getIcons())(!sn(c)||c.bubbleIsVisible())&&(n.push({location:i,icon:c}),c.onLocationChange(i));for(const c of t.getChildren(!1))n.push(...wf(c,lt.sum(i,c.relativeCoords)));return n},kf=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.UNDO},preconditionFn(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!1)},scopeType:ee.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Of=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.REDO},preconditionFn(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!0)},scopeType:ee.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Af=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(t){t.workspace.cleanUp()},scopeType:ee.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Rf=function(t,i){function n(g){u--,g.setCollapsed(t),u===0&&s.setGroup$$module$build$src$core$events$utils(!1)}let c=0,u=0;s.setGroup$$module$build$src$core$events$utils(!0);for(let g=0;g<i.length;g++){let E=i[g];for(;E;)u++,setTimeout(n.bind(null,E),c),E=E.getNextBlock(),c+=10}},Nf=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let i=0;i<t.length;i++){let n=t[i];for(;n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Rf(!0,t.workspace.getTopBlocks(!0))},scopeType:ee.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Lf=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let i=0;i<t.length;i++){let n=t[i];for(;n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Rf(!1,t.workspace.getTopBlocks(!0))},scopeType:ee.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},Mf=function(t,i){if(t.isDeletable())Array.prototype.push.apply(i,t.getDescendants(!1));else{t=t.getChildren(!1);for(let n=0;n<t.length;n++)Mf(t[n],i)}},fu=function(t){const i=[];t=t.getTopBlocks(!0);for(let n=0;n<t.length;n++)Mf(t[n],i);return i},Hc=function(t,i){i?s.setGroup$$module$build$src$core$events$utils(i):(s.setGroup$$module$build$src$core$events$utils(!0),i=s.getGroup$$module$build$src$core$events$utils());const n=t.shift();n&&(n.isDeadOrDying()?Hc(t,i):(n.dispose(!1,!0),setTimeout(Hc,10,t,i))),s.setGroup$$module$build$src$core$events$utils(!1)},Df=function(){ee.registry.register({displayText(t){return t.workspace?(t=fu(t.workspace).length,t===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)):""},preconditionFn(t){return t.workspace&&0<fu(t.workspace).length?"enabled":"disabled"},callback(t){if(t.workspace){t.workspace.cancelCurrentGesture();var i=fu(t.workspace);2>i.length?Hc(i):Fh(s.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(i.length)),function(n){n&&Hc(i)})}},scopeType:ee.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},Nv=function(){kf(),Of(),Af(),Nf(),Lf(),Df()},xf=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){if(t.block){var i=t.block.toCopyData();i&&jr(i,t.block.workspace)}},scopeType:ee.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Pf=function(){ee.registry.register({displayText(t){return t.block.hasIcon(vi.TYPE)?s.Msg$$module$build$src$core$msg.REMOVE_COMMENT:s.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.comments&&!t.isCollapsed()&&t.isEditable()?"enabled":"hidden"},callback(t){t=t.block,t.hasIcon(vi.TYPE)?t.setCommentText(null):t.setCommentText("")},scopeType:ee.ScopeType.BLOCK,id:"blockComment",weight:2})},Bf=function(){ee.registry.register({displayText(t){return t.block.getInputsInline()?s.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:s.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(t){if(t=t.block,!t.isInFlyout&&t.isMovable()&&!t.isCollapsed()){for(let i=1;i<t.inputList.length;i++)if(!(t.inputList[i-1]instanceof sd||t.inputList[i]instanceof sd))return"enabled"}return"hidden"},callback(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:ee.ScopeType.BLOCK,id:"blockInline",weight:3})},Ff=function(){ee.registry.register({displayText(t){return t.block.isCollapsed()?s.Msg$$module$build$src$core$msg.EXPAND_BLOCK:s.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:ee.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Hf=function(){ee.registry.register({displayText(t){return t.block.isEnabled()?s.Msg$$module$build$src$core$msg.DISABLE_BLOCK:s.Msg$$module$build$src$core$msg.ENABLE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(t){t=t.block;const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0),t.setEnabled(!t.isEnabled()),s.setGroup$$module$build$src$core$events$utils(i)},scopeType:ee.ScopeType.BLOCK,id:"blockDisable",weight:5})},Uf=function(){ee.registry.register({displayText(t){var i=t.block;return t=i.getDescendants(!1).length,(i=i.getNextBlock())&&(t-=i.getDescendants(!1).length),t===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)},preconditionFn(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback(t){t.block&&t.block.checkAndDelete()},scopeType:ee.ScopeType.BLOCK,id:"blockDelete",weight:6})},Vf=function(){ee.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.HELP},preconditionFn(t){return t=t.block,(typeof t.helpUrl=="function"?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(t){t.block.showHelp()},scopeType:ee.ScopeType.BLOCK,id:"blockHelp",weight:7})},Lv=function(){xf(),Pf(),Bf(),Ff(),Hf(),Uf(),Vf()},Gf=function(){Nv(),Lv()},Mv=function(t,i){var n=null;n=typeof t=="string"?document.getElementById(t)||document.querySelector(t):t;let c;if(!document.contains(n)&&document!==((c=n)==null?void 0:c.ownerDocument))throw Error("Error: container is not in current document");t=new rs(i||{}),i=document.createElement("div"),i.className="injectionDiv",i.tabIndex=0,we(i,ve.LABEL,s.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),n.appendChild(i),n=Dv(i,t);const u=xv(n,t);return Pv(u),U(u),it(u),i.addEventListener("focusin",function(){U(u)}),u},Dv=function(t,i){t.setAttribute("dir","LTR"),q(i.hasCss,i.pathToMedia),t=A(x.SVG,{xmlns:Cu,"xmlns:html":wo,"xmlns:xlink":os,version:"1.1",class:"blocklySvg",tabindex:"0"},t);const n=A(x.DEFS,{},t),c=String(Math.random()).substring(2);return i.gridPattern=Lm.createDom(c,i.gridOptions,n),t},xv=function(t,i){i.parentWorkspace=null,i=new Is(i);const n=i.options;i.scale=n.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground"));var c=i.getInjectionDiv(),u=i.getRenderer().getClassName();return u&&X(c,u),(u=i.getTheme().getClassName())&&X(c,u),!n.hasCategories&&n.languageTree&&(c=i.addFlyout(x.SVG),re(c,t)),n.hasTrashcan&&i.addTrashcan(),n.zoomOptions&&n.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(Cf(i)),it(i),hg(),bg(),Ug(),i},Pv=function(t){const i=t.options;var n=t.getParentSvg();if(y(n.parentNode,"contextmenu",null,function(c){j(c)||c.preventDefault()}),n=y(window,"resize",null,function(){To(),t.hideComponents(!0),Rg(),gg(),it(t),gu(t)}),t.setResizeHandlerWrapper(n),Fv(),i.languageTree){n=t.getToolbox();const c=t.getFlyout(!0);n?n.init():c&&(c.init(t),c.show(i.languageTree),typeof c.scrollToStart=="function"&&c.scrollToStart())}i.hasTrashcan&&t.trashcan.init(),i.zoomOptions&&i.zoomOptions.controls&&t.zoomControls_.init(),i.moveOptions&&i.moveOptions.scrollbars?(t.scrollbar=new n$(t,i.moveOptions.scrollbars===!0||!!i.moveOptions.scrollbars.horizontal,i.moveOptions.scrollbars===!0||!!i.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),i.hasSounds&&Hv(i.pathToMedia,t)},Bv=function(t){const i=N();i&&!(j(t)||i.rendered&&!i.isVisible())&&ce.registry.onKeyDown(i,t)},Fv=function(){LS||(y(document,"scroll",null,function(){const t=I();for(let i=0,n;n=t[i];i++)n instanceof Is&&n.updateInverseScreenCTM()}),y(document,"keydown",null,Bv),D(document,"touchend",null,Ne),D(document,"touchcancel",null,Ne),fl&&y(window,"orientationchange",document,function(){it(N())})),LS=!0},Hv=function(t,i){function n(){for(;u.length;){const g=u.pop();g&&H(g)}c.preload()}const c=i.getAudioManager();c.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),c.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),c.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");const u=[];u.push(y(document,"pointermove",null,n,!0)),u.push(y(document,"touchstart",null,n,!0))},Uv=function(t){return t.getType!==void 0&&t.initView!==void 0&&t.dispose!==void 0&&t.getWeight!==void 0&&t.getSize!==void 0&&t.applyColour!==void 0&&t.hideForInsertionMarker!==void 0&&t.updateEditable!==void 0&&t.updateCollapsed!==void 0&&t.isShownWhenCollapsed!==void 0&&t.setOffsetInBlock!==void 0&&t.onLocationChange!==void 0&&t.onClick!==void 0},Vv=function(t){return t.paste!==void 0},Gv=function(t){return t.isSelectable()},Wv=function(t){N().hideChaff(t)},yt=yt||{},yt.scope={},yt.ASSUME_ES5=!1,yt.ASSUME_NO_NATIVE_MAP=!1,yt.ASSUME_NO_NATIVE_SET=!1,yt.SIMPLE_FROUND_POLYFILL=!1,yt.ISOLATE_POLYFILLS=!1,yt.FORCE_POLYFILL_PROMISE=!1,yt.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,yt.defineProperty=yt.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(t,i,n){return t==Array.prototype||t==Object.prototype||(t[i]=n.value),t},yt.getGlobal=function(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof as=="object"&&as];for(var i=0;i<t.length;++i){var n=t[i];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")},yt.global=yt.getGlobal(this),yt.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",yt.TRUST_ES6_POLYFILLS=!yt.ISOLATE_POLYFILLS||yt.IS_SYMBOL_NATIVE,yt.polyfills={},yt.propertyToPolyfillSymbol={},yt.POLYFILL_PREFIX="$jscp$",yt.polyfill=function(t,i,n,c){i&&(yt.ISOLATE_POLYFILLS?yt.polyfillIsolated(t,i,n,c):yt.polyfillUnisolated(t,i,n,c))},yt.polyfillUnisolated=function(t,i,n,c){for(n=yt.global,t=t.split("."),c=0;c<t.length-1;c++){var u=t[c];if(!(u in n))return;n=n[u]}t=t[t.length-1],c=n[t],i=i(c),i!=c&&i!=null&&yt.defineProperty(n,t,{configurable:!0,writable:!0,value:i})},yt.polyfillIsolated=function(t,i,n,c){var u=t.split(".");t=u.length===1,c=u[0],c=!t&&c in yt.polyfills?yt.polyfills:yt.global;for(var g=0;g<u.length-1;g++){var E=u[g];if(!(E in c))return;c=c[E]}u=u[u.length-1],n=yt.IS_SYMBOL_NATIVE&&n==="es6"?c[u]:null,i=i(n),i!=null&&(t?yt.defineProperty(yt.polyfills,u,{configurable:!0,writable:!0,value:i}):i!==n&&(yt.propertyToPolyfillSymbol[u]===void 0&&(n=1e9*Math.random()>>>0,yt.propertyToPolyfillSymbol[u]=yt.IS_SYMBOL_NATIVE?yt.global.Symbol(u):yt.POLYFILL_PREFIX+n+"$"+u),yt.defineProperty(c,yt.propertyToPolyfillSymbol[u],{configurable:!0,writable:!0,value:i})))},yt.polyfill("globalThis",function(t){return t||yt.global},"es_2020","es3"),yt.arrayIteratorImpl=function(t){var i=0;return function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}},yt.arrayIterator=function(t){return{next:yt.arrayIteratorImpl(t)}},yt.initSymbol=function(){},yt.iteratorPrototype=function(t){return t={next:t},t[Symbol.iterator]=function(){return this},t},yt.iteratorFromArray=function(t,i){t instanceof String&&(t+="");var n=0,c=!1,u={next:function(){if(!c&&n<t.length){var g=n++;return{value:i(g,t[g]),done:!1}}return c=!0,{done:!0,value:void 0}}};return u[Symbol.iterator]=function(){return u},u},yt.polyfill("Array.prototype.values",function(t){return t||function(){return yt.iteratorFromArray(this,function(i,n){return n})}},"es8","es3"),yt.polyfill("Array.prototype.flat",function(t){return t||function(i){i=i===void 0?1:i;var n=[];return Array.prototype.forEach.call(this,function(c){Array.isArray(c)&&0<i?(c=Array.prototype.flat.call(c,i-1),n.push.apply(n,c)):n.push(c)}),n}},"es9","es5"),yt.owns=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},yt.polyfill("Object.entries",function(t){return t||function(i){var n=[],c;for(c in i)yt.owns(i,c)&&n.push([c,i[c]]);return n}},"es8","es3"),yt.polyfill("Object.values",function(t){return t||function(i){var n=[],c;for(c in i)yt.owns(i,c)&&n.push(i[c]);return n}},"es8","es3");var rn=Object.create(null),iA={typeMap:rn},mu=Object.create(null),Eo="default",Q=class{constructor(t){this.name=t}toString(){return this.name}};Q.CONNECTION_CHECKER=new Q("connectionChecker"),Q.CURSOR=new Q("cursor"),Q.EVENT=new Q("event"),Q.FIELD=new Q("field"),Q.INPUT=new Q("input"),Q.RENDERER=new Q("renderer"),Q.TOOLBOX=new Q("toolbox"),Q.THEME=new Q("theme"),Q.TOOLBOX_ITEM=new Q("toolboxItem"),Q.FLYOUTS_VERTICAL_TOOLBOX=new Q("flyoutsVerticalToolbox"),Q.FLYOUTS_HORIZONTAL_TOOLBOX=new Q("flyoutsHorizontalToolbox"),Q.METRICS_MANAGER=new Q("metricsManager"),Q.BLOCK_DRAGGER=new Q("blockDragger"),Q.SERIALIZER=new Q("serializer"),Q.ICON=new Q("icon"),Q.PASTER=new Q("paster");var vo={DEFAULT:Eo,TEST_ONLY:iA};vo.Type=Q,vo.getAllItems=m,vo.getClass=p,vo.getClassFromOptions=T,vo.getObject=f,vo.hasItem=d,vo.register=o,vo.unregister=a;var Li=Object.create(null),Uc=Object.create(null),Xv,zv=null,Yv,rl=[],Kv={defineBlocksWithJsonArrayInternal:mt},ei={TEST_ONLY:Kv};ei.createBlockDefinitionsFromJsonArray=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,ei.defineBlocks=s.defineBlocks$$module$build$src$core$common,ei.defineBlocksWithJsonArray=It,ei.draggingConnections=rl,ei.getAllWorkspaces=I,ei.getBlockTypeCounts=Tt,ei.getMainWorkspace=N,ei.getParentContainer=F,ei.getSelected=W,ei.getWorkspaceById=b,ei.registerWorkspace=w,ei.setMainWorkspace=U,ei.setParentContainer=st,ei.setSelected=tt,ei.svgResize=it,ei.unregisterWorkpace=M;var jv="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Jv={genUid:()=>{const t=jv.length,i=[];for(let n=0;20>n;n++)i[n]=jv.charAt(Math.random()*t);return i.join("")}},sA=0,Wf={TEST_ONLY:Jv};Wf.genUid=Ft,Wf.getNextUniqueId=Ct;var Xf,ll,$u,ln,cn,qn,cl,_u,Zn,Io,So,al,Hs,hl,ul,dl,an,hn,Qn,pl,Us,tr,Tu,er,bu,bi;Xf="",ll=!0,$u=0,s.CREATE$$module$build$src$core$events$utils="create",s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils="delete",s.DELETE$$module$build$src$core$events$utils,s.CHANGE$$module$build$src$core$events$utils="change",s.CHANGE$$module$build$src$core$events$utils,ln="block_field_intermediate_change",s.MOVE$$module$build$src$core$events$utils="move",s.MOVE$$module$build$src$core$events$utils,cn="var_create",qn="var_delete",cl="var_rename",_u="ui",Zn="drag",Io="selected",So="click",al="marker_move",Hs="bubble_open",hl="trashcan_open",ul="toolbox_item_select",dl="theme_change",an="viewport_change",hn="comment_create",Qn="comment_delete",pl="comment_change",Us="comment_move",tr="finished_loading",Tu=[s.CREATE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,hn,Us],er=[],bu={FIRE_QUEUE:er,fireNow:xt,fireInternal:Bt,setGroupInternal:Ce},bi={BLOCK_CHANGE:s.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:s.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:s.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:Zn,BLOCK_FIELD_INTERMEDIATE_CHANGE:ln,BLOCK_MOVE:s.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:Hs,BUMP_EVENTS:Tu,CHANGE:s.CHANGE$$module$build$src$core$events$utils,CLICK:So,COMMENT_CHANGE:pl,COMMENT_CREATE:hn,COMMENT_DELETE:Qn,COMMENT_MOVE:Us,CREATE:s.CREATE$$module$build$src$core$events$utils,DELETE:s.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:tr,MARKER_MOVE:al,MOVE:s.MOVE$$module$build$src$core$events$utils,SELECTED:Io,TEST_ONLY:bu,THEME_CHANGE:dl,TOOLBOX_ITEM_SELECT:ul,TRASHCAN_OPEN:hl,UI:_u,VAR_CREATE:cn,VAR_DELETE:qn,VAR_RENAME:cl,VIEWPORT_CHANGE:an},bi.clearPendingUndo=Zt,bi.disable=s.disable$$module$build$src$core$events$utils,bi.disableOrphans=qe,bi.enable=s.enable$$module$build$src$core$events$utils,bi.filter=At,bi.fire=at,bi.fromJson=We,bi.get=pt,bi.getDescendantIds=ne,bi.getGroup=s.getGroup$$module$build$src$core$events$utils,bi.getRecordUndo=qt,bi.isEnabled=Dt,bi.setGroup=s.setGroup$$module$build$src$core$events$utils,bi.setRecordUndo=Nt;var gl=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=qt()}toJson(){return{type:this.type,group:this.group}}static fromJson(t,i,n){return n.isBlank=!1,n.group=t.group||"",n.workspaceId=i.id,n}isNull(){return!1}run(t){}getEventWorkspace_(){let t;if(this.workspaceId&&(t=b(this.workspaceId)),!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t}},Vs=class extends gl{constructor(t){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof t>"u",this.workspaceId=t||""}},zf=class extends Vs{constructor(t,i,n){i=t?t.workspace.id:i,i===null&&(i=void 0),super(i),this.type=So,this.blockId=t?t.id:void 0,this.targetType=n}toJson(){const t=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return t.targetType=this.targetType,t.blockId=this.blockId,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new zf),i.targetType=t.targetType,i.blockId=t.blockId,i}},Yf;(function(t){t.BLOCK="block",t.WORKSPACE="workspace",t.ZOOM_CONTROLS="zoom_controls"})(Yf||(Yf={})),o(Q.EVENT,So,zf);var oA=750,qv="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Eu=null,ir={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},vu=0,sr={TOUCH_ENABLED:qv,TOUCH_MAP:ir};sr.checkTouchIdentifier=hi,sr.clearTouchIdentifier=Te,sr.getTouchIdentifierFromEvent=ai,sr.longStart=xe,sr.longStop=Ne,sr.shouldHandleEvent=Xe;var Kf,Zv,Qv,tI,Iu,Su,jf,eI,iI,sI;(function(t){function i(c){return n.indexOf(c.toUpperCase())!==-1}Kf=t;const n=Kf.toUpperCase();Zv=i("JavaFX"),Qv=i("WebKit"),tI=i("Gecko")&&!Qv,Iu=i("Android"),t=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Su=i("iPad")||i("Macintosh")&&0<t,jf=i("iPhone")&&!Su,eI=i("Macintosh"),iI=Su||Iu&&!i("Mobile")||i("Silk"),sI=!iI&&(jf||Iu)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var nA=Kf,oI=Zv,Jf=tI,yu=Iu,fl=Su,nI=jf,qf=eI,Zf=sI,rA={ANDROID:yu,GECKO:Jf,IPAD:fl,IPHONE:nI,JavaFx:oI,MAC:qf,MOBILE:Zf,raw:nA},rI=40,lI=125,yo={};yo.bind=D,yo.conditionalBind=y,yo.getScrollDeltaPixels=rt,yo.isRightButton=z,yo.isTargetInput=j,yo.mouseToSvg=nt,yo.unbind=H;var cI={};cI.removeElem=Z;var Co=class{constructor(t){this.name_=t}toString(){return this.name_}};Co.POSITIONABLE=new Co("positionable"),Co.DRAG_TARGET=new Co("drag_target"),Co.DELETE_AREA=new Co("delete_area"),Co.AUTOHIDEABLE=new Co("autohideable");var Ze=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(t,i){const n=t.component.id;if(!i&&this.componentData.has(n)){var c;throw Error('Plugin "'+n+'" with capabilities "'+((c=this.componentData.get(n))==null?void 0:c.capabilities)+'" already added.')}for(this.componentData.set(n,t),i=[],c=0;c<t.capabilities.length;c++){const u=String(t.capabilities[c]).toLowerCase();if(i.push(u),this.capabilityToComponentIds.has(u)){let g;(g=this.capabilityToComponentIds.get(u))==null||g.push(n)}else this.capabilityToComponentIds.set(u,[n])}this.componentData.get(n).capabilities=i}removeComponent(t){const i=this.componentData.get(t);if(i){for(let n=0;n<i.capabilities.length;n++){const c=String(i.capabilities[n]).toLowerCase();Z(this.capabilityToComponentIds.get(c),t)}this.componentData.delete(t)}}addCapability(t,i){if(!this.getComponent(t))throw Error('Cannot add capability, "'+i+'". Plugin "'+t+'" has not been added to the ComponentManager');if(this.hasCapability(t,i))console.warn('Plugin "'+t+'already has capability "'+i+'"');else{i=`${i}`.toLowerCase();var n;(n=this.componentData.get(t))==null||n.capabilities.push(i);var c;(c=this.capabilityToComponentIds.get(i))==null||c.push(t)}}removeCapability(t,i){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+i+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,i)?(i=`${i}`.toLowerCase(),Z(this.componentData.get(t).capabilities,i),Z(this.capabilityToComponentIds.get(i),t)):console.warn('Plugin "'+t+`doesn't have capability "`+i+'" to remove')}hasCapability(t,i){return i=`${i}`.toLowerCase(),this.componentData.has(t)&&this.componentData.get(t).capabilities.indexOf(i)!==-1}getComponent(t){let i;return(i=this.componentData.get(t))==null?void 0:i.component}getComponents(t,i){if(t=`${t}`.toLowerCase(),t=this.capabilityToComponentIds.get(t),!t)return[];const n=[];if(i){const c=[];t.forEach(u=>{c.push(this.componentData.get(u))}),c.sort(function(u,g){return u.weight-g.weight}),c.forEach(function(u){n.push(u.component)})}else t.forEach(c=>{n.push(this.componentData.get(c).component)});return n}};Ze.Capability=Co;var Qf=!1,tm=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}
`,em={};em.inject=q,em.register=et;var lt=class{constructor(t,i){this.x=t,this.y=i}clone(){return new lt(this.x,this.y)}scale(t){return this.x*=t,this.y*=t,this}translate(t,i){return this.x+=t,this.y+=i,this}static equals(t,i){return t===i?!0:t&&i?t.x===i.x&&t.y===i.y:!1}static distance(t,i){const n=t.x-i.x;return t=t.y-i.y,Math.sqrt(n*n+t*t)}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static difference(t,i){return new lt(t.x-i.x,t.y-i.y)}static sum(t,i){return new lt(t.x+i.x,t.y+i.y)}},aI={};aI.warn=ut;var Cu="http://www.w3.org/2000/svg",wo="http://www.w3.org/1999/xhtml",os="http://www.w3.org/1999/xlink",ko;(function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE"})(ko||(ko={}));var Ts=null,im=0,wu=null,Ke={HTML_NS:wo};Ke.NodeType=ko,Ke.SVG_NS=Cu,Ke.XLINK_NS=os,Ke.addClass=X,Ke.containsNode=O,Ke.createSvgElement=A,Ke.getFastTextWidth=Y,Ke.getFastTextWidthWithSizeString=Mt,Ke.getTextWidth=B,Ke.hasClass=Yt,Ke.insertAfter=re,Ke.measureFontMetrics=ge,Ke.removeClass=ft,Ke.removeClasses=kt,Ke.removeNode=bt,Ke.setCssTransform=$,Ke.startTextWidthCache=S,Ke.stopTextWidthCache=R;var x=class{constructor(t){this.tagName=t}toString(){return this.tagName}};x.ANIMATE=new x("animate"),x.CIRCLE=new x("circle"),x.CLIPPATH=new x("clipPath"),x.DEFS=new x("defs"),x.FECOMPOSITE=new x("feComposite"),x.FECOMPONENTTRANSFER=new x("feComponentTransfer"),x.FEFLOOD=new x("feFlood"),x.FEFUNCA=new x("feFuncA"),x.FEGAUSSIANBLUR=new x("feGaussianBlur"),x.FEPOINTLIGHT=new x("fePointLight"),x.FESPECULARLIGHTING=new x("feSpecularLighting"),x.FILTER=new x("filter"),x.FOREIGNOBJECT=new x("foreignObject"),x.G=new x("g"),x.IMAGE=new x("image"),x.LINE=new x("line"),x.PATH=new x("path"),x.PATTERN=new x("pattern"),x.POLYGON=new x("polygon"),x.RECT=new x("rect"),x.SVG=new x("svg"),x.TEXT=new x("text"),x.TSPAN=new x("tspan");var fe=class{constructor(t,i,n,c){this.top=t,this.bottom=i,this.left=n,this.right=c}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(t,i){return t>=this.left&&t<=this.right&&i>=this.top&&i<=this.bottom}intersects(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)}},Ee=class{constructor(t,i){this.width=t,this.height=i}static equals(t,i){return t===i?!0:t&&i?t.width===i.width&&t.height===i.height:!1}},hI={getSizeInternal:Nh},un={TEST_ONLY:hI};un.getBorderBox=Gn,un.getComputedStyle=Ui,un.getContainerOffsetToScrollInto=_o,un.getPageOffset=be,un.getSize=is,un.getViewportPageOffset=Vn,un.scrollIntoContainerView=Wn;var uI=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,dI=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,lA={XY_REGEX:uI,XY_STYLE_REGEX:dI},or={TEST_ONLY:lA};or.getDocumentScroll=P,or.getInjectionDivXY=v,or.getRelativeXY=_,or.getViewportBBox=k,or.screenToWsCoordinates=J,or.wsToScreenCoordinates=St;var Ue=class{constructor(t,i,n,c,u){this.workspace=t,this.horizontal=i,this.oldHostMetrics=null,this.ratio=1,this.origin=new lt(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new lt(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=n||!1,this.margin=u!==void 0?u:Ue.DEFAULT_SCROLLBAR_MARGIN,t="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),c&&(t+=" "+c),this.outerSvg=A(x.SVG,{class:t}),c=A(x.G,{},this.outerSvg),this.svgBackground=A(x.RECT,{class:"blocklyScrollbarBackground"},c),t=Math.floor((Ue.scrollbarThickness-5)/2),this.svgHandle=A(x.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},c),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),re(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),i?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=y(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=y(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const t=Ue.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(t)),this.outerSvg.setAttribute("height",String(t)),this.svgHandle.setAttribute("height",String(t-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(t)),this.outerSvg.setAttribute("width",String(t)),this.svgHandle.setAttribute("width",String(t-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),H(this.onMouseDownBarWrapper_),H(this.onMouseDownHandleWrapper_),bt(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength)}setHandleLength(t){this.handleLength=t,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength-this.handleLength)}setHandlePosition(t){this.handlePosition=t,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(t){this.scrollbarLength=t,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(t,i){this.position.x=t,this.position.y=i,$(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(t){!t&&(t=this.workspace.getMetrics(),!t)||this.oldHostMetrics&&Ue.metricsAreEquivalent(t,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(t):this.resizeVertical(t),this.oldHostMetrics=t,this.updateMetrics())}requiresViewResize(t){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==t.viewWidth||this.oldHostMetrics.viewHeight!==t.viewHeight||this.oldHostMetrics.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics.absoluteTop!==t.absoluteTop:!0}resizeHorizontal(t){this.requiresViewResize(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)}resizeViewHorizontal(t){var i=t.viewWidth-2*this.margin;this.pair&&(i-=Ue.scrollbarThickness),this.setScrollbarLength(Math.max(0,i)),i=t.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(i+=Ue.scrollbarThickness),this.setPosition(i,t.absoluteTop+t.viewHeight-Ue.scrollbarThickness-this.margin),this.resizeContentHorizontal(t)}resizeContentHorizontal(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var i=this.scrollbarLength*t.viewWidth/t.scrollWidth;i=this.constrainHandleLength(i),this.setHandleLength(i),i=t.scrollWidth-t.viewWidth;var n=this.scrollbarLength-this.handleLength;t=(t.viewLeft-t.scrollLeft)/i*n,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=n/i}}resizeVertical(t){this.requiresViewResize(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)}resizeViewVertical(t){let i=t.viewHeight-2*this.margin;this.pair&&(i-=Ue.scrollbarThickness),this.setScrollbarLength(Math.max(0,i)),this.setPosition(this.workspace.RTL?t.absoluteLeft+this.margin:t.absoluteLeft+t.viewWidth-Ue.scrollbarThickness-this.margin,t.absoluteTop+this.margin),this.resizeContentVertical(t)}resizeContentVertical(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var i=this.scrollbarLength*t.viewHeight/t.scrollHeight;i=this.constrainHandleLength(i),this.setHandleLength(i),i=t.scrollHeight-t.viewHeight;var n=this.scrollbarLength-this.handleLength;t=(t.viewTop-t.scrollTop)/i*n,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=n/i}}isVisible(){return this.isHandleVisible}setContainerVisible(t){const i=t!==this.containerVisible;this.containerVisible=t,i&&this.updateDisplay_()}setVisible(t){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(t)}setVisibleInternal(t){const i=t!==this.isVisible();this.isHandleVisible=t,i&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(t){if(this.workspace.markFocused(),Te(),this.cleanUp(),z(t))t.stopPropagation();else{var i=nt(t,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());i=this.horizontal?i.x:i.y;var n=v(this.svgHandle);n=this.horizontal?n.x:n.y;var c=this.handlePosition,u=.95*this.handleLength;i<=n?c-=u:i>=n+this.handleLength&&(c+=u),this.setHandlePosition(this.constrainHandlePosition(c)),this.updateMetrics(),t.stopPropagation(),t.preventDefault()}}onMouseDownHandle(t){this.workspace.markFocused(),this.cleanUp(),z(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?t.clientX:t.clientY,this.onMouseUpWrapper_=y(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=y(document,"pointermove",this,this.onMouseMoveHandle),t.stopPropagation(),t.preventDefault())}onMouseMoveHandle(t){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?t.clientX:t.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Te(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(H(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(H(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let t=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(t)&&(t=0),t}updateMetrics(){const t=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:t}):this.workspace.setMetrics({y:t})}set(t,i){this.setHandlePosition(this.constrainHandlePosition(t*this.ratio)),(i||i===void 0)&&this.updateMetrics()}setOrigin(t,i){this.origin=new lt(t,i)}static metricsAreEquivalent(t,i){return t.viewWidth===i.viewWidth&&t.viewHeight===i.viewHeight&&t.viewLeft===i.viewLeft&&t.viewTop===i.viewTop&&t.absoluteTop===i.absoluteTop&&t.absoluteLeft===i.absoluteLeft&&t.scrollWidth===i.scrollWidth&&t.scrollHeight===i.scrollHeight&&t.scrollLeft===i.scrollLeft&&t.scrollTop===i.scrollTop}};Ue.scrollbarThickness=qv?25:15,Ue.DEFAULT_SCROLLBAR_MARGIN=.5;var ku={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},sm={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Ou,DOMParser:Vc,XMLSerializer:Gc}=globalThis;Vc&&(ku=new Vc),Gc&&(sm=new Gc);var pI="https://developers.google.com/blockly/xml",cA=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,ml={NAME_SPACE:pI};ml.createElement=s.createElement$$module$build$src$core$utils$xml,ml.createTextNode=s.createTextNode$$module$build$src$core$utils$xml,ml.domToText=Fe,ml.injectDependencies=Xt,ml.textToDom=s.textToDom$$module$build$src$core$utils$xml;var om="categoryToolbox",gI="flyoutToolbox",Pt;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"})(Pt||(Pt={}));var fI={hasCategoriesInternal:Bb},dn={};dn.Position=Pt,dn.TEST_ONLY=fI,dn.convertFlyoutDefToJsonArray=kc,dn.convertToolboxDefToJson=zn,dn.hasCategories=Lh,dn.isCategoryCollapsible=Mh,dn.parseToolboxTree=Wp;var Oo;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"})(Oo||(Oo={}));var $l;(function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"})($l||($l={}));var pn;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN"})(pn||(pn={}));var nr={};nr.bumpDirection=pn,nr.bumpPositionRect=Bh,nr.getCornerOppositeToolbox=Ph,nr.getStartPositionRect=xh,nr.horizontalPosition=$l,nr.verticalPosition=Oo;var Ei={width:96,height:124,url:"sprites.png"},mI=class{constructor(t){this.workspace=t,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=A(x.G,{});const t=String(Math.random()).substring(2);return this.createZoomOutSvg(t),this.createZoomInSvg(t),this.workspace.isMovable()&&this.createZoomResetSvg(t),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[Ze.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&bt(this.svgGroup);for(const t of this.boundEvents)H(t);this.boundEvents.length=0}getBoundingRectangle(){let t=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(t+=this.LARGE_SPACING+this.HEIGHT),new fe(this.top,this.top+t,this.left,this.left+this.WIDTH)}position(t,i){if(this.initialized){var n=Ph(this.workspace,t),c=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(c+=this.LARGE_SPACING+this.HEIGHT),t=xh(n,new Ee(this.WIDTH,c),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,t,this.workspace),n=n.vertical,i=Bh(t,this.MARGIN_VERTICAL,n===Oo.TOP?pn.DOWN:pn.UP,i),n===Oo.TOP){var u=this.SMALL_SPACING+this.HEIGHT,g;(g=this.zoomInGroup)==null||g.setAttribute("transform","translate(0, "+u+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(u+this.LARGE_SPACING+this.HEIGHT)+")")}else{g=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let C;(C=this.zoomInGroup)==null||C.setAttribute("transform","translate(0, "+g+")"),g=g+this.SMALL_SPACING+this.HEIGHT,(u=this.zoomOutGroup)==null||u.setAttribute("transform","translate(0, "+g+")")}this.top=i.top,this.left=i.left;var E;(E=this.svgGroup)==null||E.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(t){this.zoomOutGroup=A(x.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const i=A(x.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup);A(x.RECT,{width:32,height:32},i),A(x.IMAGE,{width:Ei.width,height:Ei.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup).setAttributeNS(os,"xlink:href",this.workspace.options.pathToMedia+Ei.url),this.boundEvents.push(y(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(t){this.zoomInGroup=A(x.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const i=A(x.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup);A(x.RECT,{width:32,height:32},i),A(x.IMAGE,{width:Ei.width,height:Ei.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup).setAttributeNS(os,"xlink:href",this.workspace.options.pathToMedia+Ei.url),this.boundEvents.push(y(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(t,i){this.workspace.markFocused(),this.workspace.zoomCenter(t),this.fireZoomEvent(),Te(),i.stopPropagation(),i.preventDefault()}createZoomResetSvg(t){this.zoomResetGroup=A(x.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const i=A(x.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup);A(x.RECT,{width:32,height:32},i),A(x.IMAGE,{width:Ei.width,height:Ei.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup).setAttributeNS(os,"xlink:href",this.workspace.options.pathToMedia+Ei.url),this.boundEvents.push(y(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(t){this.workspace.markFocused();const i=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(i),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Te(),t.stopPropagation(),t.preventDefault()}fireZoomEvent(){const t=new(pt(So))(null,this.workspace.id,"zoom_controls");at(t)}};et(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var Mi=class{constructor(t){this.name=t}toString(){return this.name}equals(t){return this.name===t.toString()}};Mi.MUTATOR=new Mi("mutator"),Mi.WARNING=new Mi("warning"),Mi.COMMENT=new Mi("comment"),function(t){t[t.VALUE=1]="VALUE",t[t.STATEMENT=3]="STATEMENT",t[t.DUMMY=5]="DUMMY",t[t.CUSTOM=6]="CUSTOM",t[t.END_ROW=7]="END_ROW"}(s.inputTypes$$module$build$src$core$inputs$input_types||(s.inputTypes$$module$build$src$core$inputs$input_types={})),s.inputTypes$$module$build$src$core$inputs$input_types;var $I=function(t,i){window.alert(t),i&&i()},_I=function(t,i){i(window.confirm(t))},TI=function(t,i,n){n(window.prompt(t,i))},bI={confirmInternal:Ub},rr={TEST_ONLY:bI};rr.alert=Oc,rr.confirm=Fh,rr.prompt=Hh,rr.setAlert=Hb,rr.setConfirm=Vb,rr.setPrompt=Gb;var nm,EI;s.Msg$$module$build$src$core$msg=Object.create(null),nm=function(t){Object.keys(t).forEach(function(i){s.Msg$$module$build$src$core$msg[i]=t[i]})},EI={Msg:s.Msg$$module$build$src$core$msg,setLocale:nm};var Wc=class extends gl{constructor(t){super(),this.isBlank=typeof t>"u",t&&(this.varId=t.getId(),this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return t.varId=this.varId,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new Wc),i.varId=t.varId,i}},rm=class extends Wc{constructor(t){super(t),this.type=cn,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new rm),i.varType=t.varType,i.varName=t.varName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?i.createVariable(this.varName,this.varType,this.varId):i.deleteVariableById(this.varId)}};o(Q.EVENT,cn,rm);var Xc=class{constructor(t,i,n,c){this.workspace=t,this.name=i,this.type=n||"",this.id_=c||Ft()}getId(){return this.id_}static compareByName(t,i){return t.name.localeCompare(i.name,void 0,{sensitivity:"base"})}},lm="VARIABLE",cm="ijkmnopqrstuvwxyzabcdefgh",vI={generateUniqueNameInternal:Xb},ii={CATEGORY_NAME:lm,TEST_ONLY:vI,VAR_LETTER_OPTIONS:cm};ii.allDeveloperVariables=s.allDeveloperVariables$$module$build$src$core$variables,ii.allUsedVarModels=s.allUsedVarModels$$module$build$src$core$variables,ii.createVariableButtonHandler=zr,ii.flyoutCategory=Uh,ii.flyoutCategoryBlocks=zp,ii.generateUniqueName=Yp,ii.generateUniqueNameFromOptions=Vh,ii.generateVariableFieldDom=Kn,ii.getAddedVariables=Wh,ii.getOrCreateVariablePackage=s.getOrCreateVariablePackage$$module$build$src$core$variables,ii.getVariable=s.getVariable$$module$build$src$core$variables,ii.nameUsedWithAnyType=Kp,ii.nameUsedWithConflictingParam=jp,ii.promptName=Gh,ii.renameVariable=s.renameVariable$$module$build$src$core$variables;var Gs=class{constructor(t,i,n,c,u){this.workspace=t,this.editable=this.movable=this.deletable=!0,this.disposed_=!1,this.isComment=!0,this.id=u&&!t.getCommentById(u)?u:Ft(),t.addTopComment(this),this.xy_=new lt(0,0),this.height_=n,this.width_=c,this.RTL=t.RTL,this.content_=i,Gs.fireCreateEvent(this)}dispose(){this.disposed_||(Dt()&&at(new(pt(Qn))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(t){this.height_=t}getWidth(){return this.width_}setWidth(t){this.width_=t}getRelativeToSurfaceXY(){return new lt(this.xy_.x,this.xy_.y)}moveBy(t,i){const n=new(pt(Us))(this);this.xy_.translate(t,i),n.recordNew(),at(n)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(t){this.deletable=t}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(t){this.movable=t}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(t){this.editable=t}getContent(){return this.content_}setContent(t){this.content_!==t&&(at(new(pt(pl))(this,this.content_,t)),this.content_=t)}toXmlWithXY(t){return t=this.toXml(t),t.setAttribute("x",String(Math.round(this.xy_.x))),t.setAttribute("y",String(Math.round(this.xy_.y))),t.setAttribute("h",String(this.height_)),t.setAttribute("w",String(this.width_)),t}toXml(t){const i=s.createElement$$module$build$src$core$utils$xml("comment");return t||(i.id=this.id),i.textContent=this.getContent(),i}static fireCreateEvent(t){if(Dt()){const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0);try{at(new(pt(hn))(t))}finally{s.setGroup$$module$build$src$core$events$utils(i)}}}static fromXml(t,i){var n=Gs.parseAttributes(t);return i=new Gs(i,n.content,n.h,n.w,n.id),n=t.getAttribute("x"),t=t.getAttribute("y"),n=n?parseInt(n,10):NaN,t=t?parseInt(t,10):NaN,isNaN(n)||isNaN(t)||i.moveBy(n,t),Gs.fireCreateEvent(i),i}static parseAttributes(t){const i=t.getAttribute("h"),n=t.getAttribute("w"),c=t.getAttribute("x"),u=t.getAttribute("y"),g=t.getAttribute("id");if(!g)throw Error("No ID present in XML comment definition.");let E;return{id:g,h:i?parseInt(i):100,w:n?parseInt(n):100,x:c?parseInt(c):NaN,y:u?parseInt(u):NaN,content:(E=t.textContent)!=null?E:""}}},am=class extends Vs{constructor(t,i,n){super(n),this.type=Io,this.oldElementId=t??void 0,this.newElementId=i??void 0}toJson(){const t=super.toJson();return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new am),i.oldElementId=t.oldElementId,i.newElementId=t.newElementId,i}};o(Q.EVENT,Io,am);var hm={};hm.register=Xh,hm.unregister=Jb;var Au=class{paste(t,i,n){const c=t.commentState;if(n)c.setAttribute("x",`${n.x}`),c.setAttribute("y",`${n.y}`);else{var u;n=parseInt((u=c.getAttribute("x"))!=null?u:"0")+50;let g;u=parseInt((g=c.getAttribute("y"))!=null?g:"0")+50,c.setAttribute("x",`${n}`),c.setAttribute("y",`${u}`)}return si.fromXmlRendered(t.commentState,i)}};Au.TYPE="workspace-comment",Xh(Au.TYPE,new Au);var ze=8,Ru=3,aA=2,si=class extends Gs{constructor(t,i,n,c,u){super(t,i,n,c,u),this.onMouseMoveWrapper=this.onMouseUpWrapper=null,this.eventsInit=!1,this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=this.svgHandleTarget=this.svgRectTarget=this.textarea=null,this.rendered=this.autoLayout=this.focused=!1,this.svgGroup=A(x.G,{class:"blocklyComment"}),this.workspace=t,this.svgRect_=A(x.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:Ru,ry:Ru}),this.svgGroup.appendChild(this.svgRect_),this.render()}dispose(){this.disposed_||(W()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Dt()&&at(new(pt(Qn))(this)),bt(this.svgGroup),s.disable$$module$build$src$core$events$utils(),super.dispose(),s.enable$$module$build$src$core$events$utils())}initSvg(t){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit||(y(this.svgRectTarget,"pointerdown",this,this.pathMouseDown),y(this.svgHandleTarget,"pointerdown",this,this.pathMouseDown)),this.eventsInit=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!t&&this.textarea&&this.textarea.select()}pathMouseDown(t){const i=this.workspace.getGesture(t);i&&i.handleBubbleStart(t,this)}showContextMenu(t){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(W()!==this){var t=null;if(W()){t=W().id,s.disable$$module$build$src$core$events$utils();try{W().unselect()}finally{s.enable$$module$build$src$core$events$utils()}}t=new(pt(Io))(t,this.id,this.workspace.id),at(t),tt(this),this.addSelect()}}unselect(){if(W()===this){var t=new(pt(Io))(this.id,null,this.workspace.id);at(t),tt(null),this.removeSelect(),this.blurFocus()}}addSelect(){X(this.svgGroup,"blocklySelected"),this.setFocus()}removeSelect(){X(this.svgGroup,"blocklySelected"),this.blurFocus()}addFocus(){X(this.svgGroup,"blocklyFocused")}removeFocus(){ft(this.svgGroup,"blocklyFocused")}getRelativeToSurfaceXY(){let t=0,i=0,n=this.getSvgRoot();if(n)do{const c=_(n);t+=c.x,i+=c.y,n=n.parentNode}while(n&&n!==this.workspace.getBubbleCanvas()&&n!==null);return this.xy_=new lt(t,i)}moveBy(t,i){const n=new(pt(Us))(this),c=this.getRelativeToSurfaceXY();this.translate(c.x+t,c.y+i),this.xy_=new lt(c.x+t,c.y+i),n.recordNew(),at(n),this.workspace.resizeContents()}translate(t,i){this.xy_=new lt(t,i),this.getSvgRoot().setAttribute("transform","translate("+t+","+i+")")}moveDuringDrag(t){t=`translate(${t.x}, ${t.y})`,this.getSvgRoot().setAttribute("transform",t)}moveTo(t,i){this.translate(t,i)}clearTransformAttributes(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var t=this.getRelativeToSurfaceXY();const i=this.getHeightWidth(),n=t.y,c=t.y+i.height;let u;return this.RTL?(u=t.x-i.width,t=t.x):(u=t.x,t=t.x+i.width),new fe(n,c,u,t)}updateMovable(){this.isMovable()?X(this.svgGroup,"blocklyDraggable"):ft(this.svgGroup,"blocklyDraggable")}setMovable(t){super.setMovable(t),this.updateMovable()}setEditable(t){super.setEditable(t),this.textarea&&(this.textarea.readOnly=!t)}setDragging(t){t?X(this.getSvgRoot(),"blocklyDragging"):ft(this.getSvgRoot(),"blocklyDragging")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(t){super.setContent(t),this.textarea&&(this.textarea.value=t)}setDeleteStyle(t){t?X(this.svgGroup,"blocklyDraggingDelete"):ft(this.svgGroup,"blocklyDraggingDelete")}setAutoLayout(t){}toXmlWithXY(t){let i=0;this.workspace.RTL&&(i=this.workspace.getWidth()),t=this.toXml(t);const n=this.getRelativeToSurfaceXY();return t.setAttribute("x",String(Math.round(this.workspace.RTL?i-n.x:n.x))),t.setAttribute("y",String(Math.round(n.y))),t.setAttribute("h",String(this.getHeight())),t.setAttribute("w",String(this.getWidth())),t}toCopyData(){return{paster:Au.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered){var t=this.getHeightWidth(),i=this.createEditor();this.svgGroup.appendChild(i),this.svgHandleTarget=A(x.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup.appendChild(this.svgHandleTarget),this.svgRectTarget=A(x.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:Ru,ry:Ru}),this.svgGroup.appendChild(this.svgRectTarget),this.addResizeDom(),this.isDeletable()&&this.addDeleteDom(),this.setSize(t.width,t.height),this.textarea.value=this.content_,this.rendered=!0,this.resizeGroup&&y(this.resizeGroup,"pointerdown",this,this.resizeMouseDown),this.isDeletable()&&(y(this.deleteGroup,"pointerdown",this,this.deleteMouseDown),y(this.deleteGroup,"pointerout",this,this.deleteMouseOut),y(this.deleteGroup,"pointerup",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=A(x.FOREIGNOBJECT,{x:0,y:si.TOP_OFFSET,class:"blocklyCommentForeignObject"});const t=document.createElementNS(wo,"body");t.setAttribute("xmlns",wo),t.className="blocklyMinimalBody";const i=document.createElementNS(wo,"textarea");return i.className="blocklyCommentTextarea",i.setAttribute("dir",this.RTL?"RTL":"LTR"),i.readOnly=!this.isEditable(),t.appendChild(i),this.textarea=i,this.foreignObject.appendChild(t),y(i,"wheel",this,function(n){n.stopPropagation()}),y(i,"change",this,function(n){this.setContent(i.value)}),this.foreignObject}addResizeDom(){this.resizeGroup=A(x.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup),A(x.POLYGON,{points:`0,${ze} ${ze},${ze} ${ze},0`},this.resizeGroup),A(x.LINE,{class:"blocklyResizeLine",x1:ze/3,y1:ze-1,x2:ze-1,y2:ze/3},this.resizeGroup),A(x.LINE,{class:"blocklyResizeLine",x1:2*ze/3,y1:ze-1,x2:ze-1,y2:2*ze/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=A(x.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup),this.deleteIconBorder=A(x.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup),A(x.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup),A(x.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup)}resizeMouseDown(t){this.unbindDragEvents(),z(t)||(this.workspace.startDrag(t,new lt(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=y(document,"pointerup",this,this.resizeMouseUp),this.onMouseMoveWrapper=y(document,"pointermove",this,this.resizeMouseMove),this.workspace.hideChaff()),t.stopPropagation()}deleteMouseDown(t){this.deleteIconBorder&&X(this.deleteIconBorder,"blocklyDeleteIconHighlighted"),t.stopPropagation()}deleteMouseOut(t){this.deleteIconBorder&&ft(this.deleteIconBorder,"blocklyDeleteIconHighlighted")}deleteMouseUp(t){this.dispose(),t.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(H(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onMouseMoveWrapper&&(H(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)}resizeMouseUp(t){Te(),this.unbindDragEvents()}resizeMouseMove(t){this.autoLayout=!1,t=this.workspace.moveDrag(t),this.setSize(this.RTL?-t.x:t.x,t.y)}resizeComment(){const t=this.getHeightWidth(),i=si.TOP_OFFSET,n=2*aA;let c;(c=this.foreignObject)==null||c.setAttribute("width",String(t.width));let u;if((u=this.foreignObject)==null||u.setAttribute("height",String(t.height-i)),this.RTL){let g;(g=this.foreignObject)==null||g.setAttribute("x",String(-t.width))}this.textarea&&(this.textarea.style.width=t.width-n+"px",this.textarea.style.height=t.height-n-i+"px")}setSize(t,i){t=Math.max(t,45),i=Math.max(i,20+si.TOP_OFFSET),this.width_=t,this.height_=i,this.svgRect_.setAttribute("width",`${t}`),this.svgRect_.setAttribute("height",`${i}`);let n;(n=this.svgRectTarget)==null||n.setAttribute("width",`${t}`);let c;(c=this.svgRectTarget)==null||c.setAttribute("height",`${i}`);let u;(u=this.svgHandleTarget)==null||u.setAttribute("width",`${t}`);let g;if((g=this.svgHandleTarget)==null||g.setAttribute("height",String(si.TOP_OFFSET)),this.RTL){this.svgRect_.setAttribute("transform","scale(-1 1)");let E;(E=this.svgRectTarget)==null||E.setAttribute("transform","scale(-1 1)")}if(this.resizeGroup)if(this.RTL){this.resizeGroup.setAttribute("transform","translate("+(-t+ze)+","+(i-ze)+") scale(-1 1)");let E;(E=this.deleteGroup)==null||E.setAttribute("transform","translate("+(-t+ze)+","+-ze+") scale(-1 1)")}else{this.resizeGroup.setAttribute("transform","translate("+(t-ze)+","+(i-ze)+")");let E;(E=this.deleteGroup)==null||E.setAttribute("transform","translate("+(t-ze)+","+-ze+")")}this.resizeComment()}setFocus(){this.focused=!0,setTimeout(()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&X(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&X(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused=!1,setTimeout(()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&ft(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&ft(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(t,i,n){s.disable$$module$build$src$core$events$utils();let c;try{const u=Gs.parseAttributes(t);if(c=new si(i,u.content,u.h,u.w,u.id),i.rendered&&(c.initSvg(!0),c.render()),!isNaN(u.x)&&!isNaN(u.y))if(i.RTL){const g=n||i.getWidth();c.moveBy(g-u.x,u.y)}else c.moveBy(u.x,u.y)}finally{s.enable$$module$build$src$core$events$utils()}return Gs.fireCreateEvent(c),c}};si.DEFAULT_SIZE=100,si.TOP_OFFSET=10,et(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`);var Nu=new Set,Lu=new WeakSet,_l=null,um=null,II=0,Mu={};Mu.finishQueuedRenders=Yr,Mu.queueRender=Jp,Mu.triggerQueuedRenders=xs;var Di={};Di.appendDomToWorkspace=sE,Di.blockToDom=Qo,Di.blockToDomWithXY=Ac,Di.clearWorkspaceAndLoadFromXml=iE,Di.deleteNext=dE,Di.domToBlock=s.domToBlock$$module$build$src$core$xml,Di.domToBlockInternal=tn,Di.domToPrettyText=eE,Di.domToText=Ps,Di.domToVariables=sg,Di.domToWorkspace=s.domToWorkspace$$module$build$src$core$xml,Di.variablesToDom=eg,Di.workspaceToDom=Zb;var Tl=class extends Error{},SI=class extends Tl{constructor(t){super("Expected to find a 'type' property, defining the block type"),this.state=t}},zc=class extends Tl{constructor(t,i,n){super(`The block ${i.toDevString()} is missing a(n) ${t}
connection`),this.block=i,this.state=n}},yI=class extends Tl{constructor(t,i,n,c){super(`The block ${n.toDevString()} could not connect its
${i} to its parent, because: ${t}`),this.childBlock=n,this.childState=c}},CI=class extends Tl{constructor(t){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=t}},wI=class extends Tl{constructor(t,i,n){super(`Cannot add an icon of type '${t}' to the block ${i.toDevString()}, because there is no icon registered with type '${t}'. Make sure that all of your icons have been registered.`),this.block=i,this.state=n}},lr={};lr.BadConnectionCheck=yI,lr.DeserializationError=Tl,lr.MissingBlockType=SI,lr.MissingConnection=zc,lr.RealChildOfShadow=CI,lr.UnregisteredIcon=wI;var kI=100,OI=75,AI=50,hA={BLOCKS:AI,PROCEDURES:OI,VARIABLES:kI},dm={};dm.register=jh,dm.unregister=pE;var RI=class{constructor(){this.priority=AI}save(t){const i=[];for(const n of t.getTopBlocks(!1))(t=Bs(n,{addCoordinates:!0,doFullSerialization:!1}))&&i.push(t);return i.length?{languageVersion:0,blocks:i}:null}load(t,i){t=t.blocks;for(const n of t)en(n,i,{recordUndo:qt()})}clear(t){for(const i of t.getTopBlocks(!1))i.dispose(!1)}};jh("blocks",new RI);var Yc={};Yc.BlockSerializer=RI,Yc.append=en,Yc.appendInternal=Kr,Yc.save=Bs;var cr=class extends gl{constructor(t){super(),this.isBlank=!t,t&&(this.blockId=t.id,this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.blockId=this.blockId,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new cr),i.blockId=t.blockId,i}},pm=class extends cr{constructor(t){super(t),this.type=s.CREATE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=Ac(t),this.ids=ne(t),this.json=Bs(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=Ps(this.xml),t.ids=this.ids,t.json=this.json,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new pm),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i.ids=t.ids,i.json=t.json,t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}run(t){const i=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!uA(i,this.ids))if(t)en(this.json,i);else for(t=0;t<this.ids.length;t++){const n=this.ids[t],c=i.getBlockById(n);c?c.dispose(!1):n===this.blockId&&console.warn("Can't uncreate non-existent block: "+n)}}},uA=function(t,i){return i.map(n=>t.getBlockById(n)).filter(n=>n&&n.isShadow()).length===i.length};o(Q.EVENT,s.CREATE$$module$build$src$core$events$utils,pm);var gm=class extends Vs{constructor(t,i){super(i),this.type=dl,this.themeName=t}toJson(){const t=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return t.themeName=this.themeName,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new gm),i.themeName=t.themeName,i}};o(Q.EVENT,dl,gm);var fm=class extends Vs{constructor(t,i,n,c,u){super(c),this.type=an,this.viewTop=t,this.viewLeft=i,this.scale=n,this.oldScale=u}toJson(){const t=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new fm),i.viewTop=t.viewTop,i.viewLeft=t.viewLeft,i.scale=t.scale,i.oldScale=t.oldScale,i}};o(Q.EVENT,an,fm);var mm;mm=28,s.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:mm,connectingSnapRadius:mm,currentConnectionPreference:8,bumpDelay:250},s.config$$module$build$src$core$config;var Et;(function(t){t[t.INPUT_VALUE=1]="INPUT_VALUE",t[t.OUTPUT_VALUE=2]="OUTPUT_VALUE",t[t.NEXT_STATEMENT=3]="NEXT_STATEMENT",t[t.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Et||(Et={}));var bl=class{constructor(t){this.connectionChecker=t,this.connections=[]}addConnection(t,i){i=this.calculateIndexForYPos(i),this.connections.splice(i,0,t)}findIndexOfConnection(t,i){if(!this.connections.length)return-1;const n=this.calculateIndexForYPos(i);if(n>=this.connections.length)return-1;i=t.y;let c=n;for(;0<=c&&this.connections[c].y===i;){if(this.connections[c]===t)return c;c--}for(c=n;c<this.connections.length&&this.connections[c].y===i;){if(this.connections[c]===t)return c;c++}return-1}calculateIndexForYPos(t){if(!this.connections.length)return 0;let i=0,n=this.connections.length;for(;i<n;){const c=Math.floor((i+n)/2);if(this.connections[c].y<t)i=c+1;else if(this.connections[c].y>t)n=c;else{i=c;break}}return i}removeConnection(t,i){if(t=this.findIndexOfConnection(t,i),t===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(t,1)}getNeighbours(t,i){function n(dt){const Ie=u-c[dt].x,$e=g-c[dt].y;return Math.sqrt(Ie*Ie+$e*$e)<=i&&G.push(c[dt]),$e<i}const c=this.connections,u=t.x,g=t.y;t=0;let E=c.length-2,C=E;for(;t<C;)c[C].y<g?t=C:E=C,C=Math.floor((t+E)/2);const G=[];if(E=t=C,c.length){for(;0<=t&&n(t);)t--;do E++;while(E<c.length&&n(E))}return G}isInYRange(t,i,n){return Math.abs(this.connections[t].y-i)<=n}searchForClosest(t,i,n){if(!this.connections.length)return{connection:null,radius:i};const c=t.y,u=t.x;t.x=u+n.x,t.y=c+n.y;var g=this.calculateIndexForYPos(t.y);n=null;let E=i,C,G=g-1;for(;0<=G&&this.isInYRange(G,t.y,i);)C=this.connections[G],this.connectionChecker.canConnect(t,C,!0,E)&&(n=C,E=C.distanceFrom(t)),G--;for(;g<this.connections.length&&this.isInYRange(g,t.y,i);)C=this.connections[g],this.connectionChecker.canConnect(t,C,!0,E)&&(n=C,E=C.distanceFrom(t)),g++;return t.x=u,t.y=c,{connection:n,radius:E}}static init(t){const i=[];return i[Et.INPUT_VALUE]=new bl(t),i[Et.OUTPUT_VALUE]=new bl(t),i[Et.NEXT_STATEMENT]=new bl(t),i[Et.PREVIOUS_STATEMENT]=new bl(t),i}},Kc=class{paste(t,i,n){if(!i.isCapacityAvailable(t.typeCounts))return null;n&&(t.blockState.x=n.x,t.blockState.y=n.y),s.disable$$module$build$src$core$events$utils();let c;try{c=en(t.blockState,i),AE(c)}finally{s.enable$$module$build$src$core$events$utils()}return c&&(Dt()&&!c.isShadow()&&at(new(pt(s.CREATE$$module$build$src$core$events$utils))(c)),c.select(),c)}};Kc.TYPE="block",Xh(Kc.TYPE,new Kc);var $m=null,_m=null,Tm={duplicateInternal:xE,copyInternal:ME},ar={};ar.BlockPaster=Kc,ar.TEST_ONLY=Tm,ar.copy=LE,ar.duplicate=DE,ar.paste=jr,ar.registry=hm;var dA="aria-",pA="role",xi;(function(t){t.GRID="grid",t.GRIDCELL="gridcell",t.GROUP="group",t.LISTBOX="listbox",t.MENU="menu",t.MENUITEM="menuitem",t.MENUITEMCHECKBOX="menuitemcheckbox",t.OPTION="option",t.PRESENTATION="presentation",t.ROW="row",t.TREE="tree",t.TREEITEM="treeitem"})(xi||(xi={}));var ve;(function(t){t.ACTIVEDESCENDANT="activedescendant",t.COLCOUNT="colcount",t.DISABLED="disabled",t.EXPANDED="expanded",t.INVALID="invalid",t.LABEL="label",t.LABELLEDBY="labelledby",t.LEVEL="level",t.ORIENTATION="orientation",t.POSINSET="posinset",t.ROWCOUNT="rowcount",t.SELECTED="selected",t.SETSIZE="setsize",t.VALUEMAX="valuemax",t.VALUEMIN="valuemin"})(ve||(ve={}));var jc={};jc.Role=xi,jc.State=ve,jc.setRole=$s,jc.setState=we;var bm=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(t){this.menuItems.push(t)}render(t){const i=document.createElement("div");i.className="blocklyMenu goog-menu blocklyNonSelectable",i.tabIndex=0,this.roleName&&$s(i,this.roleName),this.element=i;for(let n=0,c;c=this.menuItems[n];n++)i.appendChild(c.createDom());return this.mouseOverHandler=y(i,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=y(i,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=y(i,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=y(i,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=y(i,"keydown",this,this.handleKeyEvent),t.appendChild(i),i}getElement(){return this.element}focus(){const t=this.getElement();t&&(t.focus({preventScroll:!0}),X(t,"blocklyFocused"))}blur(){const t=this.getElement();t&&(t.blur(),ft(t,"blocklyFocused"))}setRole(t){this.roleName=t}dispose(){this.mouseOverHandler&&(H(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(H(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(H(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(H(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(H(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t=0,i;i=this.menuItems[t];t++)i.dispose();this.element=null}getMenuItem(t){const i=this.getElement();for(;t&&t!==i;){if(t.classList.contains("blocklyMenuItem")){for(let n=0,c;c=this.menuItems[n];n++)if(c.getElement()===t)return c}t=t.parentElement}return null}setHighlighted(t){var i=this.highlightedItem;i&&(i.setHighlighted(!1),this.highlightedItem=null),t&&(t.setHighlighted(!0),this.highlightedItem=t,i=this.getElement(),Wn(t.getElement(),i),we(i,ve.ACTIVEDESCENDANT,t.getId()))}highlightNext(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(t,1)}highlightPrevious(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>t?this.menuItems.length:t,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(t,i){t+=i;let n;for(;n=this.menuItems[t];){if(n.isEnabled()){this.setHighlighted(n);break}t+=i}}handleMouseOver(t){(t=this.getMenuItem(t.target))&&(t.isEnabled()?this.highlightedItem!==t&&this.setHighlighted(t):this.setHighlighted(null))}handleClick(t){const i=this.openingCoords;if(this.openingCoords=null,i&&typeof t.clientX=="number"){const n=new lt(t.clientX,t.clientY);if(1>lt.distance(i,n))return}(t=this.getMenuItem(t.target))&&t.performAction()}handleMouseEnter(t){this.focus()}handleMouseLeave(t){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(t){if(this.menuItems.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var i=this.highlightedItem;switch(t.key){case"Enter":case" ":i&&i.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}t.preventDefault(),t.stopPropagation()}}getSize(){const t=this.getElement(),i=is(t);return i.height=t.scrollHeight,i}},Em=class{constructor(t,i){this.content=t,this.opt_value=i,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const t=document.createElement("div");t.id=Ct(),this.element=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const i=document.createElement("div");if(i.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var n=document.createElement("div");n.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",i.appendChild(n)}return n=this.content,typeof this.content=="string"&&(n=document.createTextNode(this.content)),i.appendChild(n),t.appendChild(i),this.roleName&&$s(t,this.roleName),we(t,ve.SELECTED,this.checkable&&this.checked||!1),we(t,ve.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let t;return(t=this.opt_value)!=null?t:null}setRightToLeft(t){this.rightToLeft=t}setRole(t){this.roleName=t}setCheckable(t){this.checkable=t}setChecked(t){this.checked=t}setHighlighted(t){this.highlight=t;const i=this.getElement();i&&this.isEnabled()&&(t?(X(i,"blocklyMenuItemHighlight"),X(i,"goog-menuitem-highlight")):(ft(i,"blocklyMenuItemHighlight"),ft(i,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(t,i){this.actionHandler=t.bind(i)}},El=null,Du=null,vl="",Il="",bs,Ws={};Ws.createDom=hg,Ws.getDiv=jn,Ws.hide=ss,Ws.hideIfOwner=qh,Ws.isVisible=ug,Ws.positionWithAnchor=pg,Ws.repositionForWindowResize=gg,Ws.show=Jh,Ws.testOnly_setDiv=PE;var xu=null,NI={},Pu=null,Xs={};Xs.callbackFactory=s.callbackFactory$$module$build$src$core$contextmenu,Xs.commentDeleteOption=$g,Xs.commentDuplicateOption=_g,Xs.dispose=mg,Xs.getCurrentBlock=UE,Xs.hide=Nc,Xs.setCurrentBlock=fg,Xs.show=Rc,Xs.workspaceCommentOption=zE;var ee=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(t){if(this.registry_.has(t.id))throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_.set(t.id,t)}unregister(t){if(!this.registry_.has(t))throw Error('Menu item with ID "'+t+'" not found.');this.registry_.delete(t)}getItem(t){let i;return(i=this.registry_.get(t))!=null?i:null}getContextMenuOptions(t,i){const n=[];for(const u of this.registry_.values())if(t===u.scopeType){var c=u.preconditionFn(i);c!=="hidden"&&(c={text:typeof u.displayText=="function"?u.displayText(i):u.displayText,enabled:c==="enabled",callback:u.callback,scope:i,weight:u.weight},n.push(c))}return n.sort(function(u,g){return u.weight-g.weight}),n}};(function(t){var i=t.ScopeType||(t.ScopeType={});i.BLOCK="block",i.WORKSPACE="workspace",t.registry=new t})(ee||(ee={})),ee.ScopeType;var Bu={};Bu.clamp=qr,Bu.toDegrees=Tg,Bu.toRadians=Jr;var Jc=16,vm=1,LI=12,Im=16,Fu=.25,Sm=null,hr=null,Sl="",yl="",ie,Cl,ur,ym=null,gn=null,MI=null,Cm={getBoundsInfo:function(){const t=be(ym),i=is(ym);return{left:t.x,right:t.x+i.width,top:t.y,bottom:t.y+i.height,width:i.width,height:i.height}},getPositionMetrics:function(t,i,n,c){const u=Cm.getBoundsInfo(),g=is(ie);return i+g.height<u.bottom?wg(t,i,u,g):c-g.height>u.top?kg(n,c,u,g):i+g.height<document.documentElement.clientHeight?wg(t,i,u,g):c-g.height>document.documentElement.clientTop?kg(n,c,u,g):KE(t,u,g)}},ui={ANIMATION_TIME:Fu,ARROW_HORIZONTAL_PADDING:LI,ARROW_SIZE:Jc,BORDER_SIZE:vm,PADDING_Y:Im,TEST_ONLY:Cm};ui.clearContent=Zh,ui.createDom=bg,ui.getContentDiv=Zr,ui.getOwner=vg,ui.getPositionX=Mc,ui.hide=tu,ui.hideIfOwner=Qr,ui.hideWithoutAnimation=_s,ui.isVisible=Og,ui.repositionForWindowResize=Rg,ui.setBoundsElement=Eg,ui.setColour=Qh,ui.show=Cg,ui.showPositionedByBlock=YE,ui.showPositionedByField=Lc;var Hu=null,qc=null,Zc={};Zc.connectionUiEffect=Mg,Zc.disconnectUiEffect=Dg,Zc.disconnectUiStop=tl,Zc.disposeUiEffect=Ng;var DI=class{constructor(t,i){this.bubble=t,this.workspace=i,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(t,i){i=this.pixelsToWorkspaceUnits_(i),i=lt.sum(this.startXY_,i),this.bubble.moveDuringDrag(i),i=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==i&&(i&&i.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(t){return t&&this.workspace.getComponentManager().hasCapability(t.id,Ze.Capability.DELETE_AREA)?t.wouldDelete(this.bubble,!1):!1}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(t,i){this.dragBubble(t,i),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(i),t=lt.sum(this.startXY_,t)),this.bubble.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.bubble.setDragging&&this.bubble.setDragging(!1),this.fireMoveEvent_()),this.workspace.setResizesEnabled(!0),s.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof si){const t=new(pt(Us))(this.bubble);t.setOldCoordinate(this.startXY_),t.recordNew(),at(t)}}pixelsToWorkspaceUnits_(t){return t=new lt(t.x/this.workspace.scale,t.y/this.workspace.scale),this.workspace.isMutator&&t.scale(1/this.workspace.options.parentWorkspace.scale),t}},xI=30,PI=!0,dr=[];dr[Et.INPUT_VALUE]=Et.OUTPUT_VALUE,dr[Et.OUTPUT_VALUE]=Et.INPUT_VALUE,dr[Et.NEXT_STATEMENT]=Et.PREVIOUS_STATEMENT,dr[Et.PREVIOUS_STATEMENT]=Et.NEXT_STATEMENT;var wm="RENAME_VARIABLE_ID",km="DELETE_VARIABLE_ID",pr={};pr.commonWordPrefix=Pg,pr.commonWordSuffix=Bg,pr.isNumber=s.isNumber$$module$build$src$core$utils$string,pr.shortestStringLength=Dc,pr.startsWith=jE,pr.wrap=s.wrap$$module$build$src$core$utils$string;var Uu=void 0,Qc=!1,wl=!1,BI=50,FI=0,gr=0,Om=0,Am=0,ns=null,ta=null,Rm=0,Nm=10,HI=10,UI=750,Vu=5,Ve=null,Gi={HOVER_MS:UI,LIMIT:BI,MARGINS:Vu,OFFSET_X:Rm,OFFSET_Y:Nm,RADIUS_OK:HI};Gi.bindMouseEvents=xc,Gi.block=Xg,Gi.createDom=Ug,Gi.dispose=Wg,Gi.getCustomTooltip=QE,Gi.getDiv=ev,Gi.getTooltipOfObject=el,Gi.hide=To,Gi.isVisible=tv,Gi.setCustomTooltip=ZE,Gi.unbindMouseEvents=Vg,Gi.unblock=zg;var VI=class{constructor(t){this.workspace=t,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new lt(t.scrollX,t.scrollY)}dispose(){this.workspace=null}startDrag(){W()&&W().unselect()}endDrag(t){this.drag(t)}drag(t){if(t=lt.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(t.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,t.y);else throw new TypeError("Invalid state.")}},gA=5,fA=6,Ao=class{constructor(t,i){this.creatorWorkspace=i,this.mouseDownXY=new lt(0,0),this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=t,this.currentDragDeltaXY=new lt(0,0),this.healStack=!PI}dispose(){Te(),zg(),this.creatorWorkspace.clearGesture();for(const t of this.boundEvents)H(t);this.boundEvents.length=0,this.blockDragger&&this.blockDragger.dispose(),this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(t){const i=new lt(t.clientX,t.clientY);this.updateDragDelta(i)&&(this.updateIsDragging(),Ne()),this.mostRecentEvent=t}updateDragDelta(t){return this.currentDragDeltaXY=lt.difference(t,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=lt.magnitude(this.currentDragDeltaXY)>(this.flyout?s.config$$module$build$src$core$config.flyoutDragRadius:s.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let t;if(!this.targetBlock||(t=this.flyout)==null||!t.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),!0):!1}updateIsDraggingBubble(){return this.startBubble?(this.startDraggingBubble(),!0):!1}updateIsDraggingBlock(){if(!this.targetBlock)return!1;if(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger=new VI(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new(T(Q.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_),this.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack),this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger=new DI(this.startBubble,this.startWorkspace_),this.bubbleDragger.startBubbleDrag(),this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(t){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,j(t)?this.cancel():(this.gestureHasStarted=!0,tl(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=vg(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=t,Xg(),this.targetBlock&&this.targetBlock.select(),z(t)?this.handleRightClick(t):(t.type.toLowerCase()==="pointerdown"&&t.pointerType!=="mouse"&&xe(t,this),this.mouseDownXY=new lt(t.clientX,t.clientY),this.healStack=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t),this.isEnding_||this.handleTouchStart(t)))}bindMouseEvents(t){this.boundEvents.push(y(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(y(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(y(document,"pointerup",null,this.handleUp.bind(this),!0)),t.preventDefault(),t.stopPropagation()}handleStart(t){this.isDragging()||(this.handleTouchStart(t),this.isMultiTouch()&&Ne())}handleMove(t){this.isDragging()&&Xe(t)||!this.isMultiTouch()?(this.updateFromEvent(t),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),t.preventDefault(),t.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(t),Ne())}handleUp(t){if(this.isDragging()||this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()){if(!Xe(t))return;if(this.updateFromEvent(t),Ne(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.bubbleDragger?this.bubbleDragger.endBubbleDrag(t,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(t,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(t)}t.preventDefault(),t.stopPropagation(),this.dispose()}handleTouchStart(t){var i=ai(t);this.cachedPoints.set(i,this.getTouchPoint(t));var n=Array.from(this.cachedPoints.keys());n.length===2&&(i=this.cachedPoints.get(n[0]),n=this.cachedPoints.get(n[1]),this.startDistance=lt.distance(i,n),this.isMultiTouch_=!0,t.preventDefault())}handleTouchMove(t){const i=ai(t);this.cachedPoints.set(i,this.getTouchPoint(t)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(t):this.handleMove(t)}handlePinch(t){var i=Array.from(this.cachedPoints.keys()),n=this.cachedPoints.get(i[0]);if(i=this.cachedPoints.get(i[1]),n=lt.distance(n,i)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(i=n-this.previousScale,i=0<i?i*gA:i*fA,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const c=this.startWorkspace_,u=nt(t,c.getParentSvg(),c.getInverseScreenCTM());c.zoom(u.x,u.y,i)}this.previousScale=n,t.preventDefault()}handleTouchEnd(t){t=ai(t),this.cachedPoints.has(t)&&this.cachedPoints.delete(t),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(t){return this.startWorkspace_?new lt(t.pageX,t.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(Ne(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(t){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(t)):this.startBubble?this.startBubble.showContextMenu(t):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()}handleWsStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(i),this.mostRecentEvent=t,this.doStart(t)}fireWorkspaceClick(t){at(new(pt(So))(null,t.id,"workspace"))}handleFlyoutStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(i),this.handleWsStart(t,i.getWorkspace())}handleBlockStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(i),this.mostRecentEvent=t}handleBubbleStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(i),this.mostRecentEvent=t}doBubbleClick(){this.startBubble instanceof si&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock.isEnabled()&&(s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const t=new(pt(So))(this.startBlock,this.startWorkspace_.id,"block");at(t)}this.bringBlockToFront(),s.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(t){t=this.creatorWorkspace,W()&&W().unselect(),this.fireWorkspaceClick(this.startWorkspace_||t)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=t)}setStartIcon(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=t)}setStartBubble(t){this.startBubble||(this.startBubble=t)}setStartBlock(t){this.startBlock||this.startBubble||(this.startBlock=t,t.isInFlyout&&t!==t.getRootBlock()?this.setTargetBlock(t.getRootBlock()):this.setTargetBlock(t))}setTargetBlock(t){t.isShadow()?this.setTargetBlock(t.getParent()):this.targetBlock=t}setStartWorkspace(t){this.startWorkspace_||(this.startWorkspace_=t)}setStartFlyout(t){this.flyout||(this.flyout=t)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return(this.startField?this.startField.isClickable():!1)&&!this.hasExceededDragRadius&&(!this.flyout||!this.flyout.autoClose)}isIconClick(){return!!this.startIcon&&!this.hasExceededDragRadius}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let t,i;return(i=(t=this.blockDragger)!=null?t:this.workspaceDragger)!=null?i:this.bubbleDragger}static inProgress(){const t=I();for(let i=0,n;n=t[i];i++)if(n.currentGesture_)return!0;return!1}},Lm=class{constructor(t,i){this.pattern=t;let n;this.spacing=(n=i.spacing)!=null?n:0;let c;this.length=(c=i.length)!=null?c:1,this.line2=(this.line1=t.firstChild)&&this.line1.nextSibling;let u;this.snapToGrid=(u=i.snap)!=null?u:!1}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(t){var i=this.spacing*t;this.pattern.setAttribute("width",`${i}`),this.pattern.setAttribute("height",`${i}`),i=Math.floor(this.spacing/2)+.5;let n=i-this.length/2,c=i+this.length/2;i*=t,n*=t,c*=t,this.setLineAttributes(this.line1,t,n,c,i,i),this.setLineAttributes(this.line2,t,i,i,n,c)}setLineAttributes(t,i,n,c,u,g){t&&(t.setAttribute("stroke-width",`${i}`),t.setAttribute("x1",`${n}`),t.setAttribute("y1",`${u}`),t.setAttribute("x2",`${c}`),t.setAttribute("y2",`${g}`))}moveTo(t,i){this.pattern.setAttribute("x",`${t}`),this.pattern.setAttribute("y",`${i}`)}static createDom(t,i,n){t=A(x.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},n);let c,u;if(0<((c=i.length)!=null?c:1)&&0<((u=i.spacing)!=null?u:0)){A(x.LINE,{stroke:i.colour},t);let g;(g=i.length)!=null&&g&&A(x.LINE,{stroke:i.colour},t)}else A(x.LINE,{},t);return t}},ea=class{constructor(t){this.workspace=t,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(t,i){this.markers.has(t)&&this.unregisterMarker(t),i.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,i)),this.setMarkerSvg(i.getDrawer().createDom()),this.markers.set(t,i)}unregisterMarker(t){const i=this.markers.get(t);if(i)i.dispose(),this.markers.delete(t);else throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(t){return this.markers.get(t)||null}setCursor(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(t){t?(this.workspace.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null}setMarkerSvg(t){t?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(t)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const t=Object.keys(this.markers);for(let i=0,n;n=t[i];i++)this.unregisterMarker(n);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};ea.LOCAL_MARKER="local_marker_1";var GI={};GI.deepMerge=bo;var fr=class{constructor(t,i,n,c){this.name=t,this.startHats=!1,this.blockStyles=i||Object.create(null),this.categoryStyles=n||Object.create(null),this.componentStyles=c||Object.create(null),this.fontStyle=Object.create(null),o(Q.THEME,t,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(t,i){this.blockStyles[t]=i}setCategoryStyle(t,i){this.categoryStyles[t]=i}getComponentStyle(t){if(t=this.componentStyles[t],!t)return null;if(typeof t=="string"){const i=this.getComponentStyle(t);if(i)return i}return`${t}`}setComponentStyle(t,i){this.componentStyles[t]=i}setFontStyle(t){this.fontStyle=t}setStartHats(t){this.startHats=t}static defineTheme(t,i){t=t.toLowerCase();const n=new fr(t);let c=i.base;if(c){if(typeof c=="string"){let u;c=(u=f(Q.THEME,c))!=null?u:void 0}c instanceof fr&&(bo(n,c),n.name=t)}return bo(n.blockStyles,i.blockStyles),bo(n.categoryStyles,i.categoryStyles),bo(n.componentStyles,i.componentStyles),bo(n.fontStyle,i.fontStyle),i.startHats!==null&&(n.startHats=i.startHats),n}},mA={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},$A={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},Gu=new fr("classic",mA,$A),rs=class{constructor(t){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let i=null,n=!1;var c=!1,u=!1,g=!1,E=!1,C=!1;const G=!!t.readOnly;if(!G){var dt;i=zn((dt=t.toolbox)!=null?dt:null),n=Lh(i),c=t.trashcan,c=c===void 0?n:c,u=t.collapse,u=u===void 0?n:u,g=t.comments,g=g===void 0?n:g,E=t.disable,E=E===void 0?n:E,C=t.sounds,C=C===void 0?!0:C}dt=t.maxTrashcanContents,c?dt===void 0&&(dt=32):dt=0;const Ie=!!t.rtl;let $e=t.horizontalLayout;$e===void 0&&($e=!1);var Pi=t.toolboxPosition!=="end";Pi=$e?Pi?Pt.TOP:Pt.BOTTOM:Pi===Ie?Pt.RIGHT:Pt.LEFT;let Fl=t.css;Fl===void 0&&(Fl=!0);let Hl="https://blockly-demo.appspot.com/static/media/";t.media?Hl=t.media.endsWith("/")?t.media:t.media+"/":"path"in t&&(ut("path","Nov 2014","Jul 2023","media"),Hl=t.path+"media/");const JS=t.oneBasedIndex,QA=t.renderer||"geras",tR=t.plugins||{};let v$=t.modalInputs;v$===void 0&&(v$=!0),this.RTL=Ie,this.oneBasedIndex=JS===void 0?!0:JS,this.collapse=u,this.comments=g,this.disable=E,this.readOnly=G,this.maxBlocks=t.maxBlocks||1/0;let qS;this.maxInstances=(qS=t.maxInstances)!=null?qS:null,this.modalInputs=v$,this.pathToMedia=Hl,this.hasCategories=n,this.moveOptions=rs.parseMoveOptions_(t,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=c,this.maxTrashcanContents=dt,this.hasSounds=C,this.hasCss=Fl,this.horizontalLayout=$e,this.languageTree=i,this.gridOptions=rs.parseGridOptions_(t),this.zoomOptions=rs.parseZoomOptions_(t),this.toolboxPosition=Pi,this.theme=rs.parseThemeOptions_(t),this.renderer=QA;let ZS;this.rendererOverrides=(ZS=t.rendererOverrides)!=null?ZS:null;let QS;this.parentWorkspace=(QS=t.parentWorkspace)!=null?QS:null,this.plugins=tR}static parseMoveOptions_(t,i){const n=t.move||{},c={};return n.scrollbars===void 0&&t.scrollbars===void 0?c.scrollbars=i:typeof n.scrollbars=="object"?(c.scrollbars={horizontal:!!n.scrollbars.horizontal,vertical:!!n.scrollbars.vertical},c.scrollbars.horizontal&&c.scrollbars.vertical?c.scrollbars=!0:c.scrollbars.horizontal||c.scrollbars.vertical||(c.scrollbars=!1)):c.scrollbars=!!n.scrollbars||!!t.scrollbars,c.wheel=c.scrollbars&&n.wheel!==void 0?!!n.wheel:typeof c.scrollbars=="object",c.drag=c.scrollbars?n.drag===void 0?!0:!!n.drag:!1,c}static parseZoomOptions_(t){t=t.zoom||{};const i={};return i.controls=t.controls===void 0?!1:!!t.controls,i.wheel=t.wheel===void 0?!1:!!t.wheel,i.startScale=t.startScale===void 0?1:Number(t.startScale),i.maxScale=t.maxScale===void 0?3:Number(t.maxScale),i.minScale=t.minScale===void 0?.3:Number(t.minScale),i.scaleSpeed=t.scaleSpeed===void 0?1.2:Number(t.scaleSpeed),i.pinch=t.pinch===void 0?i.wheel||i.controls:!!t.pinch,i}static parseGridOptions_(t){t=t.grid||{};const i={};return i.spacing=Number(t.spacing)||0,i.colour=t.colour||"#888",i.length=t.length===void 0?1:Number(t.length),i.snap=0<i.spacing&&!!t.snap,i}static parseThemeOptions_(t){return t=t.theme||Gu,typeof t=="string"?f(Q.THEME,t):t instanceof fr?t:fr.defineTheme(t.name||"builtin"+Ct(),t)}},mr=class extends cr{constructor(t,i,n,c,u){super(t),this.type=s.CHANGE$$module$build$src$core$events$utils,t&&(this.element=i,this.name=n||void 0,this.oldValue=c,this.newValue=u)}toJson(){const t=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return t.element=this.element,t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new mr),i.element=t.element,i.name=t.name,i.oldValue=t.oldValue,i.newValue=t.newValue,i}isNull(){return this.oldValue===this.newValue}run(t){var i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(i=i.getBlockById(this.blockId),!i)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var n=i.getIcon(Mi.MUTATOR);switch(n&&sn(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(i=i.getField(this.name))?i.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":i.setCommentText(t||null);break;case"collapsed":i.setCollapsed(!!t);break;case"disabled":i.setEnabled(!t);break;case"inline":i.setInputsInline(!!t);break;case"mutation":n=mr.getExtraBlockState_(i),i.loadExtraState?i.loadExtraState(JSON.parse(t||"{}")):i.domToMutation&&i.domToMutation(s.textToDom$$module$build$src$core$utils$xml(t||"<mutation/>")),at(new mr(i,"mutation",null,n,t));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(t){return t.saveExtraState?(t=t.saveExtraState(!0))?JSON.stringify(t):"":t.mutationToDom&&(t=t.mutationToDom())?Ps(t):""}};o(Q.EVENT,s.CHANGE$$module$build$src$core$events$utils,mr);var Mm=.45,Dm=.65,WI={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},ls={};ls.blend=Jn,ls.getHsvSaturation=iu,ls.getHsvValue=su,ls.hexToRgb=ou,ls.hsvToHex=nu,ls.hueToHex=jg,ls.names=WI,ls.parse=on,ls.rgbToHex=Pc,ls.setHsvSaturation=Yg,ls.setHsvValue=Kg;var ia={};ia.checkMessageReferences=cv,ia.parseBlockColour=il,ia.replaceMessageReferences=Pe,ia.tokenizeInterpolation=Jg;var Kt=class{constructor(t,i,n){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Ee(0,0),t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){t.tooltip&&this.setTooltip(Pe(t.tooltip))}setSourceBlock(t){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=t}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=A(x.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=A(x.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=A(x.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const t=this.getClickTarget_();if(!t)throw Error("A click target has not been set.");xc(t),this.mouseDownWrapper_=y(t,"pointerdown",this,this.onMouseDown_)}fromXml(t){this.setValue(t.textContent)}toXml(t){return t.textContent=this.getValue(),t}saveState(t){return t=this.saveLegacyState(Kt),t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(Kt,t)||this.setValue(t)}saveLegacyState(t){return t.prototype.saveState===this.saveState&&t.prototype.toXml!==this.toXml?(t=s.createElement$$module$build$src$core$utils$xml("field"),t.setAttribute("name",this.name||""),Fe(this.toXml(t)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(t,i){return t.prototype.loadState===this.loadState&&t.prototype.fromXml!==this.fromXml?(this.fromXml(s.textToDom$$module$build$src$core$utils$xml(i)),!0):!1}dispose(){Qr(this),qh(this);let t;(t=this.getSourceBlock())!=null&&t.isDeadOrDying()||bt(this.fieldGroup_),this.disposed=!0}updateEditable(){const t=this.fieldGroup_,i=this.getSourceBlock();this.EDITABLE&&t&&i&&(this.enabled_&&i.isEditable()?(X(t,"blocklyEditableText"),ft(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(X(t,"blocklyNonEditableText"),ft(t,"blocklyEditableText"),t.style.cursor=""))}setEnabled(t){this.enabled_=t,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Kt.prototype.showEditor_}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t}isVisible(){return this.visible_}setVisible(t){if(this.visible_!==t){this.visible_=t;var i=this.fieldGroup_;i&&(i.style.display=t?"block":"none")}}setValidator(t){this.validator_=t}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(t){this.isClickable()&&this.showEditor_(t)}showEditor_(t){}repositionForWindowResize(){return!1}updateSize_(t){const i=this.getConstants();t=t!==void 0?t:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let n=2*t,c=i.FIELD_TEXT_HEIGHT,u=0;this.textElement_&&(u=Y(this.textElement_,i.FIELD_TEXT_FONTSIZE,i.FIELD_TEXT_FONTWEIGHT,i.FIELD_TEXT_FONTFAMILY),n+=u),this.isFullBlockField()||(c=Math.max(c,i.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=c,this.size_.width=n,this.positionTextElement_(t,u),this.positionBorderRect_()}positionTextElement_(t,i){if(this.textElement_){var n=this.getConstants(),c=this.size_.height/2,u;this.textElement_.setAttribute("x",String((u=this.getSourceBlock())!=null&&u.RTL?this.size_.width-i-t:t)),this.textElement_.setAttribute("y",String(n.FIELD_TEXT_BASELINE_CENTER?c:c-n.FIELD_TEXT_HEIGHT/2+n.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Ee(0,0)}getScaledBBox(){let t;var i=this.getSourceBlock();if(!i)throw new me;if(this.isFullBlockField()){var n=this.sourceBlock_.getHeightWidth();const c=i.workspace.scale;t=this.getAbsoluteXY_(),i=(n.width+1)*c,n=(n.height+1)*c,Jf?(t.x+=1.5*c,t.y+=1.5*c):(t.x-=.5*c,t.y-=.5*c)}else n=this.borderRect_.getBoundingClientRect(),t=be(this.borderRect_),i=n.width,n=n.height;return new fe(t.y,t.y+n,t.x,t.x+i)}getDisplayText_(){let t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"…"),t=t.replace(/\s/g,Kt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="‏"),t):Kt.NBSP}getText(){const t=this.getText_();return String(t!==null?t:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),this.sourceBlock_.bumpNeighbours())}setValue(t,i=!0){if(t!==null){var n=this.doClassValidation_(t);if(t=this.processValidation_(t,n),!(t instanceof Error)){var c;n=(c=this.getValidator())==null?void 0:c.call(this,t),c=this.processValidation_(t,n),c instanceof Error||(t=this.sourceBlock_,t&&t.disposed||(n=this.getValue(),n===c?this.doValueUpdate_(c):(this.doValueUpdate_(c),i&&t&&Dt()&&at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(t,"field",this.name||null,n,c)),this.isDirty_&&this.forceRerender())))}}}processValidation_(t,i){return i===null?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):i===void 0?t:i}getValue(){return this.value_}doClassValidation_(t){return t??null}doValueUpdate_(t){this.value_=t,this.isDirty_=!0}doValueInvalid_(t){}onMouseDown_(t){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)}setTooltip(t){t||t===""||(t=this.sourceBlock_);const i=this.getClickTarget_();i?i.tooltip=t:this.tooltip_=t}getTooltip(){const t=this.getClickTarget_();return el(t||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return be(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;const i=this.getSourceBlock();if(!i)throw new me;const n=i.inputList;for(let c=0;c<i.inputList.length;c++){const u=n[c],g=u.fieldRow;for(let E=0;E<g.length;E++)if(g[E]===this){t=u;break}}return t}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(t){return!1}setCursorSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.cursorSvg_=t}else this.cursorSvg_=null}setMarkerSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.markerSvg_=t}else this.markerSvg_=null}updateMarkers_(){var t=this.getSourceBlock();if(!t)throw new me;t=t.workspace,t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(ea.LOCAL_MARKER).draw()}};Kt.NBSP=" ",Kt.SKIP_SETUP=Symbol("SKIP_SETUP");var me=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}};s.Names$$module$build$src$core$names=class{constructor(t,i){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=i||"",this.reservedWords=new Set(t?t.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(t){this.variableMap=t}getNameForUserVariable(t){return this.variableMap?(t=this.variableMap.getVariableById(t))?t.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(t){t=s.allUsedVarModels$$module$build$src$core$variables(t);for(let i=0;i<t.length;i++)this.getName(t[i].getId(),s.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(t){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(t,i){let n=t;i===s.NameType$$module$build$src$core$names.VARIABLE&&(t=this.getNameForUserVariable(t))&&(n=t),t=n.toLowerCase();const c=i===s.NameType$$module$build$src$core$names.VARIABLE||i===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(i)||this.db.set(i,new Map);const u=this.db.get(i);return u.has(t)?c+u.get(t):(i=this.getDistinctName(n,i),u.set(t,i.substr(c.length)),i)}getUserNames(t){let i;return(t=(i=this.db.get(t))==null?void 0:i.keys())?Array.from(t):[]}getDistinctName(t,i){t=this.safeName(t);let n=null,c,u;for(;this.dbReverse.has(t+((c=n)!=null?c:""))||this.reservedWords.has(t+((u=n)!=null?u:""));)n=n?n+1:2;let g;return t+=(g=n)!=null?g:"",this.dbReverse.add(t),(i===s.NameType$$module$build$src$core$names.VARIABLE||i===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+t}safeName(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(t[0])!==-1&&(t="my_"+t)):t=s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",t}static equals(t,i){return t.toLowerCase()===i.toLowerCase()}},function(t){t=t.NameType||(t.NameType={}),t.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",t.VARIABLE="VARIABLE",t.PROCEDURE="PROCEDURE"}(s.Names$$module$build$src$core$names||(s.Names$$module$build$src$core$names={})),s.NameType$$module$build$src$core$names=s.Names$$module$build$src$core$names.NameType,s.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,s.NameType$$module$build$src$core$names,s.Names$$module$build$src$core$names;var XI=class extends Map{constructor(){super()}set(t,i){return this.get(t)===i?this:(super.set(t,i),lu(i)&&i.startPublishing(),this)}delete(t){const i=this.get(t);return t=super.delete(t),t&&(lu(i)&&i.stopPublishing(),t)}clear(){if(this.size)for(const t of this.keys())this.delete(t)}add(t){return this.set(t.getId(),t)}getProcedures(){return[...this.values()]}},Wu=class{constructor(t){this.sourceBlock=t,this.offsetInBlock=new lt(0,0),this.workspaceLocation=new lt(0,0),this.svgRoot=null}getType(){throw Error("Icons must implement getType")}initView(t){if(!this.svgRoot){var i=this.sourceBlock;this.svgRoot=A(x.G,{class:"blocklyIconGroup"}),i.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),y(this.svgRoot,"pointerdown",this,t)}}dispose(){bt(this.svgRoot)}getWeight(){return-1}getSize(){return new Ee(0,0)}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",sn(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(t){this.offsetInBlock=t,this.updateSvgRootOffset()}updateSvgRootOffset(){let t;(t=this.svgRoot)==null||t.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(t){this.workspaceLocation=lt.sum(t,this.offsetInBlock)}onClick(){}setVisible(t){ut("setVisible","v10","v11","setBubbleVisible"),sn(this)&&this.setBubbleVisible(t)}},zI={fromJsonInternal:hv},Xu={TEST_ONLY:zI};Xu.fromJson=s.fromJson$$module$build$src$core$field_registry,Xu.register=Vi,Xu.unregister=av;var zs=class extends Kt{constructor(t,i,n){super(Kt.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,t!==Kt.SKIP_SETUP&&(Array.isArray(t)?(qg(t),t=uv(t),this.menuGenerator_=t.options,this.prefixField=t.prefix||null,this.suffixField=t.suffix||null):this.menuGenerator_=t,this.selectedOption=this.getOptions(!1)[0],n&&this.configure_(n),this.setValue(this.selectedOption[1]),i&&this.setValidator(i))}fromXml(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)}loadState(t){this.loadLegacyState(zs,t)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=A(x.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&X(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let t;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((t=this.getSourceBlock())!=null&&t.isShadow())}createTextArrow_(){this.arrow=A(x.TSPAN,{},this.textElement_);let t;this.arrow.appendChild(document.createTextNode((t=this.getSourceBlock())!=null&&t.RTL?zs.ARROW_CHAR+" ":" "+zs.ARROW_CHAR));let i;(i=this.getSourceBlock())!=null&&i.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=A(x.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(os,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(t){var i=this.getSourceBlock();if(!i)throw new me;this.dropdownCreate(),this.menu_.openingCoords=t&&typeof t.clientX=="number"?new lt(t.clientX,t.clientY):null,Zh(),t=this.menu_.render(Zr()),X(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=i.isShadow()?i.getParent().getColour():i.getColour(),i=i.isShadow()?i.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,Qh(t,i)),Lc(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Wn(this.selectedMenuItem.getElement(),Zr(),!0)),this.applyColour()}dropdownCreate(){const t=this.getSourceBlock();if(!t)throw new me;const i=new bm;i.setRole(xi.LISTBOX),this.menu_=i;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let u=0;u<n.length;u++){const[g,E]=n[u];if(typeof g=="object"){var c=new Image(g.width,g.height);c.src=g.src,c.alt=g.alt||""}else c=g;c=new Em(c,E),c.setRole(xi.OPTION),c.setRightToLeft(t.RTL),c.setCheckable(!0),i.addChild(c),c.setChecked(E===this.value_),E===this.value_&&(this.selectedMenuItem=c),c.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(t){Qr(this,!0),this.onItemSelected_(this.menu_,t)}onItemSelected_(t,i){this.setValue(i.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(t){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:t&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),qg(this.generatedOptions),this.generatedOptions)}doClassValidation_(t){return this.getOptions(!0).some(i=>i[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(t){super.doValueUpdate_(t),t=this.getOptions(!0);for(let i=0,n;n=t[i];i++)n[1]===this.value_&&(this.selectedOption=n)}applyColour(){const t=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",t.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",t.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=t.colourSecondary:this.arrow.style.fill=t.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const t=this.selectedOption&&this.selectedOption[0];t&&typeof t=="object"?this.renderSelectedImage(t):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(t){const i=this.getSourceBlock();if(!i)throw new me;this.imageElement.style.display="",this.imageElement.setAttributeNS(os,"xlink:href",t.src),this.imageElement.setAttribute("height",String(t.height)),this.imageElement.setAttribute("width",String(t.width));const n=Number(t.height);t=Number(t.width);var c=!!this.borderRect_;const u=Math.max(c?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+TA);c=c?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let g;g=this.svgArrow?this.positionSVGArrow(t+c,u/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):Y(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=t+g+2*c,this.size_.height=u;let E=0;i.RTL?this.imageElement.setAttribute("x",`${c+g}`):(E=t+g,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${c}`)),this.imageElement.setAttribute("y",String(u/2-n/2)),this.positionTextElement_(E+c,t+g)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var t=this.getTextElement();X(t,"blocklyDropdownText"),t.setAttribute("text-anchor","start");var i=!!this.borderRect_;t=Math.max(i?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const n=Y(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);i=i?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let c=0;this.svgArrow&&(c=this.positionSVGArrow(n+i,t/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=n+c+2*i,this.size_.height=t,this.positionTextElement_(i,n)}positionSVGArrow(t,i){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new me;const c=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,u=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,g=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(n.RTL?c:t+u)+","+i+")"),g+u}getText_(){if(!this.selectedOption)return null;const t=this.selectedOption[0];return typeof t=="object"?t.alt:t}static fromJson(t){if(!t.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(t.options,void 0,t)}};zs.CHECKMARK_OVERHANG=25,zs.MAX_MENU_HEIGHT_VH=.45,zs.ARROW_CHAR="▾";var _A=5,TA=2*_A;Vi("field_dropdown",zs);var Wi,le=class{constructor(t,i,n){this.workspace=t,this.anchor=i,this.ownerRect=n,this.size=new Ee(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.svgRoot=A(x.G,{},t.getBubbleCanvas()),t=A(x.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=A(x.PATH,{},t),this.background=A(x.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Wi.BORDER_WIDTH,ry:Wi.BORDER_WIDTH},t),this.contentContainer=A(x.G,{},this.svgRoot),y(this.background,"pointerdown",this,this.onMouseDown)}dispose(){bt(this.svgRoot),this.disposed=!0}setAnchorLocation(t,i=!1){this.anchor=t,i?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(t,i){this.relativeLeft=t,this.relativeTop=i,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(t,i=!1){t.width=Math.max(t.width,Wi.MIN_SIZE),t.height=Math.max(t.height,Wi.MIN_SIZE),this.size=t,this.background.setAttribute("width",`${t.width}`),this.background.setAttribute("height",`${t.height}`),i?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(t){this.colour=t,this.tail.setAttribute("fill",t),this.background.setAttribute("fill",t)}onMouseDown(t){let i;(i=this.workspace.getGesture(t))==null||i.handleBubbleStart(t,this)}positionRelativeToAnchor(){let t=this.anchor.x;t=this.workspace.RTL?t-(this.relativeLeft+this.size.width):t+this.relativeLeft,this.moveTo(t,this.relativeTop+this.anchor.y)}moveTo(t,i){this.svgRoot.setAttribute("transform",`translate(${t}, ${i})`)}positionByRect(t=new fe(0,0,0,0)){var i=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(i),c=this.getOptimalRelativeTop(i);const u={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},g={x:-this.size.width-30,y:c};c={x:t.getWidth(),y:c};var E={x:n,y:t.getHeight()};n=t.getWidth()<t.getHeight()?c:E,t=t.getWidth()<t.getHeight()?E:c,c=this.getOverlap(u,i),E=this.getOverlap(g,i);const C=this.getOverlap(n,i);i=this.getOverlap(t,i),i=Math.max(c,E,C,i),c===i?(this.relativeLeft=u.x,this.relativeTop=u.y):E===i?(this.relativeLeft=g.x,this.relativeTop=g.y):C===i?(this.relativeLeft=n.x,this.relativeTop=n.y):(this.relativeLeft=t.x,this.relativeTop=t.y),this.positionRelativeToAnchor()}getOverlap(t,i){var n=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x+this.anchor.x;return t=t.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(n+this.size.width,i.left+i.width)-Math.max(n,i.left))*(Math.min(t+this.size.height,i.top+i.height)-Math.max(t,i.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(t){let i=-this.size.width/4;if(this.size.width>t.width)return i;if(t=this.getWorkspaceViewRect(t),this.workspace.RTL){var n=this.anchor.x-i;n-this.size.width<t.left?i=-(t.left-this.anchor.x+this.size.width):n>t.right&&(i=-(t.right-this.anchor.x))}else{n=i+this.anchor.x;const c=n+this.size.width;n<t.left?i=t.left-this.anchor.x:c>t.right&&(i=t.right-this.anchor.x-this.size.width)}return i}getOptimalRelativeTop(t){let i=-this.size.height/4;if(this.size.height>t.height)return i;const n=this.anchor.y+i,c=n+this.size.height;return t=this.getWorkspaceViewRect(t),n<t.top?i=t.top-this.anchor.y:c>t.bottom&&(i=t.bottom-this.anchor.y-this.size.height),i}getWorkspaceViewRect(t){const i=t.top;let n=t.top+t.height,c=t.left;return t=t.left+t.width,n-=this.getScrollbarThickness(),this.workspace.RTL?c-=this.getScrollbarThickness():t-=this.getScrollbarThickness(),new fe(i,n,c,t)}getScrollbarThickness(){return Ue.scrollbarThickness/this.workspace.scale}renderTail(){const t=[];var i=this.size.width/2,n=this.size.height/2,c=-this.relativeLeft,u=-this.relativeTop;if(i===c&&n===u)t.push("M "+i+","+n);else{u-=n,c-=i,this.workspace.RTL&&(c*=-1);var g=Math.sqrt(u*u+c*c),E=Math.acos(c/g);0>u&&(E=2*Math.PI-E);var C=E+Math.PI/2;C>2*Math.PI&&(C-=2*Math.PI);var G=Math.sin(C);const Ie=Math.cos(C);let $e=(this.size.width+this.size.height)/Wi.TAIL_THICKNESS;$e=Math.min($e,this.size.width,this.size.height)/4,C=1-Wi.ANCHOR_RADIUS/g,c=i+C*c,u=n+C*u,C=i+$e*Ie;const Pi=n+$e*G;i-=$e*Ie,n-=$e*G,G=Jr(this.workspace.RTL?-Wi.TAIL_ANGLE:Wi.TAIL_ANGLE),G=E+G,G>2*Math.PI&&(G-=2*Math.PI),E=Math.sin(G)*g/Wi.TAIL_BEND,g=Math.cos(G)*g/Wi.TAIL_BEND,t.push("M"+C+","+Pi),t.push("C"+(C+g)+","+(Pi+E)+" "+c+","+u+" "+c+","+u),t.push("C"+c+","+u+" "+(i+g)+","+(n+E)+" "+i+","+n)}t.push("z");let dt;(dt=this.tail)==null||dt.setAttribute("d",t.join(" "))}bringToFront(){let t;const i=(t=this.svgRoot)==null?void 0:t.parentNode;return this.svgRoot&&(i==null?void 0:i.lastChild)!==this.svgRoot?(i==null||i.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new lt(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(t){this.moveTo(t.x,t.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x-this.anchor.x,this.relativeTop=t.y-this.anchor.y,this.renderTail()}setDragging(t){}setDeleteStyle(t){}isDeletable(){return!1}showContextMenu(t){}};Wi=le,le.BORDER_WIDTH=6,le.DOUBLE_BORDER=2*Wi.BORDER_WIDTH,le.MIN_SIZE=Wi.DOUBLE_BORDER,le.TAIL_THICKNESS=1,le.TAIL_ANGLE=20,le.TAIL_BEND=4,le.ANCHOR_RADIUS=8;var Ro=class extends le{constructor(t,i,n,c){super(i,n,c),this.workspace=i,this.anchor=n,this.ownerRect=c,this.autoLayout=!0,i=new rs(t),this.validateWorkspaceOptions(i),this.svgDialog=A(x.SVG,{x:le.BORDER_WIDTH,y:le.BORDER_WIDTH},this.contentContainer),t.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new rs(t)),this.miniWorkspace.internalIsMutator=!0,t=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(t),i.languageTree&&(t.insertBefore(this.miniWorkspace.addFlyout(x.G),this.miniWorkspace.getCanvas()),t=this.miniWorkspace.getFlyout(),t==null||t.init(this.miniWorkspace),t==null||t.show(i.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let u,g;(u=this.miniWorkspace.getFlyout())==null||(g=u.getWorkspace())==null||g.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(t){this.miniWorkspace.addChangeListener(t)}validateWorkspaceOptions(t){if(t.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(t.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(t.zoomOptions.controls||t.zoomOptions.wheel||t.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(t.moveOptions.scrollbars||t.moveOptions.wheel||t.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(t.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const t of this.miniWorkspace.getTopBlocks(!1)){const i=t.getRelativeToSurfaceXY();if(20>i.y&&t.moveBy(0,20-i.y),t.RTL){let n=-20;const c=this.miniWorkspace.getFlyout();c&&(n-=c.getWidth()),i.x>n&&t.moveBy(n-i.x,0)}else 20>i.x&&t.moveBy(20-i.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var t=this.getSize(),i=this.calculateWorkspaceSize();Math.abs(t.width-i.width)<Ro.MINIMUM_VIEW_CHANGE&&Math.abs(t.height-i.height)<Ro.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${i.width}px`),this.svgDialog.setAttribute("height",`${i.height}px`),this.miniWorkspace.setCachedParentSvgSize(i.width,i.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${i.width}, 0)`),this.setSize(new Ee(i.width+le.DOUBLE_BORDER,i.height+le.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var t=this.miniWorkspace.getCanvas().getBBox();let i=t.width+Ro.MARGIN;t=t.height+Ro.MARGIN;const n=this.miniWorkspace.getFlyout();if(n){const c=n.getWorkspace().getMetricsManager().getScrollMetrics();t=Math.max(t,c.height+20),i+=n.getWidth()}return new Ee(i,t)}updateBlockStyles(){for(var t of this.miniWorkspace.getAllBlocks(!1))t.setStyle(t.getStyleName());let i;if(t=(i=this.miniWorkspace.getFlyout())==null?void 0:i.getWorkspace())for(const n of t.getAllBlocks(!1))n.setStyle(n.getStyleName())}moveDuringDrag(t){super.moveDuringDrag(t),this.autoLayout=!1}moveTo(t,i){super.moveTo(t,i),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(t){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};Ro.MINIMUM_VIEW_CHANGE=10,Ro.MARGIN=3*le.DOUBLE_BORDER;var zu,Yu;zu=17,Yu=16,s.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Wu{constructor(t,i){super(i),this.flyoutBlockTypes=t,this.sourceBlock=i,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(t){this.svgRoot||(super.initView(t),A(x.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),A(x.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),A(x.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot))}dispose(){super.dispose();let t;(t=this.miniWorkspaceBubble)==null||t.dispose()}getWeight(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Ee(zu,zu)}applyColour(){super.applyColour();let t;(t=this.miniWorkspaceBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary);let i;(i=this.miniWorkspaceBubble)==null||i.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(t){super.onLocationChange(t);let i;(i=this.miniWorkspaceBubble)==null||i.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){if(this.bubbleIsVisible()!==t){if(t){this.miniWorkspaceBubble=new Ro(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour(),this.createRootBlock(),this.addSaveConnectionsListener();let i;(i=this.miniWorkspaceBubble)==null||i.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let i;(i=this.miniWorkspaceBubble)==null||i.dispose(),this.miniWorkspaceBubble=null,this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener),this.saveConnectionsListener=null}at(new(pt(Hs))(this.sourceBlock,t,"mutator"))}}getMiniWorkspaceConfig(){let t;const i={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(t=this.sourceBlock.workspace.options.rendererOverrides)!=null?t:void 0};return this.flyoutBlockTypes.length&&(i.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(n=>({kind:"block",type:n}))}),i}getAnchorLocation(){const t=zu/2;return lt.sum(this.workspaceLocation,new lt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new fe(t.y,t.y+t.height,t.x,t.x+t.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var t of this.rootBlock.getDescendants(!1))t.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let i,n,c,u;t=(u=(i=this.miniWorkspaceBubble)==null||(n=i.getWorkspace())==null||(c=n.getFlyout())==null?void 0:c.getWidth())!=null?u:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(t+Yu):Yu,Yu)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return t=>{s.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(t)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(t){return t.isUiEvent||t.type===s.CREATE$$module$build$src$core$events$utils||t.type===s.CHANGE$$module$build$src$core$events$utils&&t.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0);var i=mr.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var n=mr.getExtraBlockState_(this.sourceBlock);i!==n&&at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,i,n)),s.setGroup$$module$build$src$core$events$utils(t)}}getWorkspace(){let t;return(t=this.miniWorkspaceBubble)==null?void 0:t.getWorkspace()}static reconnect(t,i,n){return ut("MutatorIcon.reconnect","v10","v11","connection.reconnect"),t?t.reconnect(i,n):!1}static findParentWs(t){return ut("MutatorIcon.findParentWs","v10","v11","workspace.getRootWorkspace"),t.getRootWorkspace()}},s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Mi.MUTATOR,s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,s.MutatorIcon$$module$build$src$core$icons$mutator_icon;var kl=Object.create(null),bA={allExtensions:kl};s.register$$module$build$src$core$extensions("parent_tooltip_when_inline",bv);var Es={TEST_ONLY:bA};Es.apply=cu,Es.buildTooltipForDropdown=s.buildTooltipForDropdown$$module$build$src$core$extensions,Es.buildTooltipWithFieldText=s.buildTooltipWithFieldText$$module$build$src$core$extensions,Es.isRegistered=Zg,Es.register=s.register$$module$build$src$core$extensions,Es.registerMixin=s.registerMixin$$module$build$src$core$extensions,Es.registerMutator=s.registerMutator$$module$build$src$core$extensions,Es.runAfterPageLoad=_v,Es.unregister=pv;var Gt;(function(t){t[t.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",t[t.MAC_ENTER=3]="MAC_ENTER",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.NUM_CENTER=12]="NUM_CENTER",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.FF_SEMICOLON=59]="FF_SEMICOLON",t[t.FF_EQUALS=61]="FF_EQUALS",t[t.FF_DASH=173]="FF_DASH",t[t.FF_HASH=163]="FF_HASH",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.AT_SIGN=64]="AT_SIGN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META=91]="META",t[t.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUM_ZERO=96]="NUM_ZERO",t[t.NUM_ONE=97]="NUM_ONE",t[t.NUM_TWO=98]="NUM_TWO",t[t.NUM_THREE=99]="NUM_THREE",t[t.NUM_FOUR=100]="NUM_FOUR",t[t.NUM_FIVE=101]="NUM_FIVE",t[t.NUM_SIX=102]="NUM_SIX",t[t.NUM_SEVEN=103]="NUM_SEVEN",t[t.NUM_EIGHT=104]="NUM_EIGHT",t[t.NUM_NINE=105]="NUM_NINE",t[t.NUM_MULTIPLY=106]="NUM_MULTIPLY",t[t.NUM_PLUS=107]="NUM_PLUS",t[t.NUM_MINUS=109]="NUM_MINUS",t[t.NUM_PERIOD=110]="NUM_PERIOD",t[t.NUM_DIVISION=111]="NUM_DIVISION",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",t[t.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",t[t.SEMICOLON=186]="SEMICOLON",t[t.DASH=189]="DASH",t[t.EQUALS=187]="EQUALS",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.APOSTROPHE=192]="APOSTROPHE",t[t.TILDE=192]="TILDE",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE",t[t.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",t[t.WIN_KEY=224]="WIN_KEY",t[t.MAC_FF_META=224]="MAC_FF_META",t[t.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",t[t.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",t[t.WIN_IME=229]="WIN_IME",t[t.VK_NONAME=252]="VK_NONAME",t[t.PHANTOM=255]="PHANTOM"})(Gt||(Gt={}));var No={};No.arc=He,No.curve=Ni,No.line=sl,No.lineOnAxis=$t,No.lineTo=Fs,No.moveBy=ke,No.moveTo=ti,No.point=vt;var Le={};Le.Coordinate=lt,Le.KeyCodes=Gt,Le.Rect=fe,Le.Size=Ee,Le.Svg=x,Le.aria=jc,Le.array=cI,Le.browserEvents=yo,Le.colour=ls,Le.deprecation=aI,Le.dom=Ke,Le.extensions=Es,Le.idGenerator=Wf,Le.math=Bu,Le.object=GI,Le.parsing=ia,Le.string=pr,Le.style=un,Le.svgMath=or,Le.svgPaths=No,Le.toolbox=dn,Le.userAgent=rA,Le.xml=ml;var xm={};xm.register=ef,xm.unregister=Ev;var Pm=class extends le{constructor(t,i,n,c){super(i,n,c),this.text=t,this.workspace=i,this.anchor=n,this.ownerRect=c,this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(t){this.text=t,bt(this.paragraph),this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}stringToSvg(t,i){return i=this.createParagraph(i),t=this.createSpans(i,t),this.workspace.RTL&&this.rightAlignSpans(i.getBBox().width,t),i}createParagraph(t){return A(x.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:le.BORDER_WIDTH},t)}createSpans(t,i){return i.split(`
`).map(n=>{const c=A(x.TSPAN,{dy:"1em",x:le.BORDER_WIDTH},t);return n=document.createTextNode(n),c.appendChild(n),c})}rightAlignSpans(t,i){for(const n of i)n.setAttribute("text-anchor","end"),n.setAttribute("x",`${t+le.BORDER_WIDTH}`)}updateBubbleSize(){const t=this.paragraph.getBBox();this.setSize(new Ee(t.width+2*le.BORDER_WIDTH,t.height+2*le.BORDER_WIDTH),!0)}},YI=class extends le{constructor(t,i,n){super(t,i,n),this.workspace=t,this.anchor=i,this.ownerRect=n,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Ee(160+le.DOUBLE_BORDER,80+le.DOUBLE_BORDER),this.MIN_SIZE=new Ee(45+le.DOUBLE_BORDER,20+le.DOUBLE_BORDER),{inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer),this.resizeGroup=this.createResizeHandle(this.svgRoot),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(t){this.text=t,this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}createEditor(t){t=A(x.FOREIGNOBJECT,{x:le.BORDER_WIDTH,y:le.BORDER_WIDTH},t);const i=document.createElementNS(wo,"body");i.setAttribute("xmlns",wo),i.className="blocklyMinimalBody";const n=document.createElementNS(wo,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(n),t.appendChild(i),this.bindTextAreaEvents(n),setTimeout(()=>{n.focus()},0),{inputRoot:t,textArea:n}}bindTextAreaEvents(t){y(t,"wheel",this,i=>{i.stopPropagation()}),y(t,"focus",this,this.onStartEdit,!0),y(t,"change",this,this.onTextChange)}createResizeHandle(t){t=A(x.G,{class:this.workspace.RTL?"blocklyResizeSW":"blocklyResizeSE"},t);const i=2*le.BORDER_WIDTH;return A(x.POLYGON,{points:`0,${i} ${i},${i} ${i},0`},t),A(x.LINE,{class:"blocklyResizeLine",x1:i/3,y1:i-1,x2:i-1,y2:i/3},t),A(x.LINE,{class:"blocklyResizeLine",x1:2*i/3,y1:i-1,x2:i-1,y2:2*i/3},t),y(t,"pointerdown",this,this.onResizePointerDown),t}setSize(t,i=!1){t.width=Math.max(t.width,this.MIN_SIZE.width),t.height=Math.max(t.height,this.MIN_SIZE.height);const n=t.width-le.DOUBLE_BORDER,c=t.height-le.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${n}`),this.inputRoot.setAttribute("height",`${c}`),this.textArea.style.width=`${n-4}px`,this.textArea.style.height=`${c-4}px`,this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${le.DOUBLE_BORDER}, ${c}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${n}, ${c})`),super.setSize(t,i),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(t){this.bringToFront(),z(t)||(this.workspace.startDrag(t,new lt(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=y(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=y(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation()}onResizePointerUp(t){Te(),this.resizePointerUpListener&&(H(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(H(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Ee(this.workspace.RTL?-t.x:t.x,t.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const t of this.textChangeListeners)t()}onSizeChange(){for(const t of this.sizeChangeListeners)t()}};et(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Bm=17,KI=160,jI=80,vi=class extends Wu{constructor(t){super(t),this.sourceBlock=t,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Ee(KI,jI),this.bubbleVisiblity=!1}getType(){return vi.TYPE}initView(t){this.svgRoot||(super.initView(t),A(x.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),A(x.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),A(x.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot))}dispose(){super.dispose();let t;(t=this.textInputBubble)==null||t.dispose();let i;(i=this.textBubble)==null||i.dispose()}getWeight(){return vi.WEIGHT}getSize(){return new Ee(Bm,Bm)}applyColour(){super.applyColour();const t=this.sourceBlock.style.colourPrimary;let i;(i=this.textInputBubble)==null||i.setColour(t);let n;(n=this.textBubble)==null||n.setColour(t)}updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(t){super.onLocationChange(t),t=this.getAnchorLocation();let i;(i=this.textInputBubble)==null||i.setAnchorLocation(t);let n;(n=this.textBubble)==null||n.setAnchorLocation(t)}setText(t){this.text=t;let i;(i=this.textInputBubble)==null||i.setText(this.text);let n;(n=this.textBubble)==null||n.setText(this.text)}getText(){return this.text}setBubbleSize(t){this.bubbleSize=t;let i;(i=this.textInputBubble)==null||i.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(t){let i;this.text=(i=t.text)!=null?i:"";let n,c;this.bubbleSize=new Ee((n=t.width)!=null?n:KI,(c=t.height)!=null?c:jI);let u;this.bubbleVisiblity=(u=t.pinned)!=null?u:!1,setTimeout(()=>this.setBubbleVisible(this.bubbleVisiblity),1)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}onTextChange(){this.textInputBubble&&(this.text=this.textInputBubble.getText())}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(t){(!t||!this.textBubble&&!this.textInputBubble)&&(t||this.textBubble||this.textInputBubble)&&(this.bubbleVisiblity=t,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(t?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),at(new(pt(Hs))(this.sourceBlock,t,"comment"))))}showEditableBubble(){this.textInputBubble=new YI(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.textBubble=new Pm(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let t;(t=this.textInputBubble)==null||t.dispose(),this.textInputBubble=null;let i;(i=this.textBubble)==null||i.dispose(),this.textBubble=null}getAnchorLocation(){const t=Bm/2;return lt.sum(this.workspaceLocation,new lt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new fe(t.y,t.y+t.height,t.x,t.x+t.width)}};vi.TYPE=Mi.COMMENT,vi.WEIGHT=3,ef(vi.TYPE,vi);var Fm=17,vs=class extends Wu{constructor(t){super(t),this.sourceBlock=t,this.textMap=new Map,this.textBubble=null}getType(){return vs.TYPE}initView(t){this.svgRoot||(super.initView(t),A(x.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),A(x.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),A(x.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot))}dispose(){super.dispose();let t;(t=this.textBubble)==null||t.dispose()}getWeight(){return vs.WEIGHT}getSize(){return new Ee(Fm,Fm)}applyColour(){super.applyColour();let t;(t=this.textBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(t){super.onLocationChange(t);let i;(i=this.textBubble)==null||i.setAnchorLocation(this.getAnchorLocation())}addMessage(t,i){if(this.textMap.get(i)===t)return this;t?this.textMap.set(i,t):this.textMap.delete(i);let n;return(n=this.textBubble)==null||n.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){if(this.bubbleIsVisible()!==t){if(t)this.textBubble=new Pm(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let i;(i=this.textBubble)==null||i.dispose(),this.textBubble=null}at(new(pt(Hs))(this.sourceBlock,t,"warning"))}}getAnchorLocation(){const t=Fm/2;return lt.sum(this.workspaceLocation,new lt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new fe(t.y,t.y+t.height,t.x,t.x+t.width)}};vs.TYPE=Mi.WARNING,vs.WEIGHT=2;var JI=class extends Error{constructor(t){super(`Tried to append an icon of type ${t.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=t}},qI={};qI.DuplicateIconType=JI;var fn={};fn.CommentIcon=vi,fn.Icon=Wu,fn.IconType=Mi,fn.MutatorIcon=s.MutatorIcon$$module$build$src$core$icons$mutator_icon,fn.WarningIcon=vs,fn.exceptions=qI,fn.registry=xm;var Ku,Ii;Ku="PROCEDURE",s.DEFAULT_ARG$$module$build$src$core$procedures="x",Ii={CATEGORY_NAME:Ku,DEFAULT_ARG:s.DEFAULT_ARG$$module$build$src$core$procedures},Ii.ObservableProcedureMap=XI,Ii.allProcedures=uu,Ii.findLegalName=s.findLegalName$$module$build$src$core$procedures,Ii.flyoutCategory=du,Ii.getCallers=lf,Ii.getDefinition=s.getDefinition$$module$build$src$core$procedures,Ii.isNameUsed=of,Ii.isProcedureBlock=nn,Ii.mutateCallers=s.mutateCallers$$module$build$src$core$procedures,Ii.mutatorOpenListener=rf,Ii.rename=s.rename$$module$build$src$core$procedures;var EA=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(t){return Object.prototype.hasOwnProperty.call(this,t)||(this[t]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[t]}isField(t){return t.type&this.FIELD}isHat(t){return t.type&this.HAT}isIcon(t){return t.type&this.ICON}isSpacer(t){return t.type&this.SPACER}isInRowSpacer(t){return t.type&this.IN_ROW_SPACER}isInput(t){return t.type&this.INPUT}isExternalInput(t){return t.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(t){return t.type&this.INLINE_INPUT}isStatementInput(t){return t.type&this.STATEMENT_INPUT}isPreviousConnection(t){return t.type&this.PREVIOUS_CONNECTION}isNextConnection(t){return t.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(t){return t.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(t){return t.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(t){return t.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(t){return t.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(t){return t.type&this.RIGHT_SQUARE_CORNER}isCorner(t){return t.type&this.CORNER}isJaggedEdge(t){return t.type&this.JAGGED_EDGE}isRow(t){return t.type&this.ROW}isBetweenRowSpacer(t){return t.type&this.BETWEEN_ROW_SPACER}isTopRow(t){return t.type&this.TOP_ROW}isBottomRow(t){return t.type&this.BOTTOM_ROW}isTopOrBottomRow(t){return t.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(t){return t.type&this.INPUT_ROW}},L=new EA,Ys=class{constructor(t){this.centerline=this.xPos=this.height=this.width=0,this.constants_=t,this.type=L.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},sa=class{constructor(t){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=t,this.type=L.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let t=this.elements.length-1;0<=t;t--){const i=this.elements[t];if(L.isInput(i))return i}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let t=0;t<this.elements.length;t++){const i=this.elements[t];if(L.isSpacer(i))return i}return null}getLastSpacer(){for(let t=this.elements.length-1;0<=t;t--){const i=this.elements[t];if(L.isSpacer(i))return i}return null}},Hm=class extends sa{constructor(t){super(t),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=L.BOTTOM_ROW}hasLeftSquareCorner(t){return!!t.outputConnection||!!t.getNextBlock()}hasRightSquareCorner(t){return!0}measure(){let t=0,i=0,n=0;for(let c=0;c<this.elements.length;c++){const u=this.elements[c];i+=u.width,L.isSpacer(u)||(L.isNextConnection(u)?n=Math.max(n,u.height):t=Math.max(t,u.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},$r=class extends Ys{constructor(t,i){super(t),this.connectionModel=i,this.shape=this.constants_.shapeFor(i),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=L.CONNECTION}},mn=class extends $r{constructor(t,i){super(t,i.connection),this.input=i,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=L.INPUT,this.align=i.align,(this.connectedBlock=i.connection&&i.connection.targetBlock()?i.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},ju=class extends mn{constructor(t,i){super(t,i),this.height=0,this.type|=L.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Ol=class extends Ys{constructor(t,i,n){super(t),this.field=i,this.parentInput=n,this.isEditable=i.EDITABLE,this.flipRtl=i.getFlipRtl(),this.type|=L.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width}},Um=class extends Ys{constructor(t){super(t),this.type|=L.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},ZI=class extends Ys{constructor(t,i){super(t),this.icon=i,this.flipRtl=!1,this.isVisible=sn(i)&&i.bubbleIsVisible(),this.type|=L.ICON,t=i.getSize(),this.height=t.height,this.width=t.width}},Xi=class extends Ys{constructor(t,i){super(t),this.type=this.type|L.SPACER|L.IN_ROW_SPACER,this.width=i,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},Vm=class extends mn{constructor(t,i){super(t,i),this.type|=L.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},oa=class extends mn{constructor(t,i){super(t,i),this.type|=L.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Gm=class extends sa{constructor(t){super(t),this.connectedBlockWidths=0,this.type|=L.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let i=0;i<this.elements.length;i++){const n=this.elements[i];this.width+=n.width,L.isInput(n)&&n instanceof mn&&(L.isStatementInput(n)&&n instanceof oa?t+=n.connectedBlockWidth:L.isExternalInput(n)&&n instanceof ju&&n.connectedBlockWidth!==0&&(t+=n.connectedBlockWidth-n.connectionWidth)),L.isSpacer(n)||(this.height=Math.max(this.height,n.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},QI=class extends Ys{constructor(t){super(t),this.type|=L.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},tS=class extends $r{constructor(t,i){super(t,i),this.type|=L.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},eS=class extends $r{constructor(t,i){super(t,i),this.connectionOffsetX=0,this.type|=L.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},iS=class extends $r{constructor(t,i){super(t,i),this.type|=L.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},na=class extends Ys{constructor(t,i){super(t),this.type=(i&&i!=="left"?L.RIGHT_ROUND_CORNER:L.LEFT_ROUND_CORNER)|L.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Wm=class extends sa{constructor(t,i,n){super(t),this.height=i,this.width=n,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|L.SPACER|L.BETWEEN_ROW_SPACER,this.elements=[new Xi(this.constants_,n)]}measure(){}},ra=class extends Ys{constructor(t,i){super(t),this.type=(i&&i!=="left"?L.RIGHT_SQUARE_CORNER:L.LEFT_SQUARE_CORNER)|L.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Xm=class extends sa{constructor(t){super(t),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=L.TOP_ROW}hasLeftSquareCorner(t){const i=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,n=t.getPreviousBlock();return!!t.outputConnection||i||(n?n.getNextBlock()===t:!1)}hasRightSquareCorner(t){return!0}measure(){let t=0,i=0,n=0;for(let c=0;c<this.elements.length;c++){const u=this.elements[c];i+=u.width,L.isSpacer(u)||(L.isHat(u)&&u instanceof Um?n=Math.max(n,u.ascenderHeight):t=Math.max(t,u.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},la=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=ke(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(t){this.blockStyles=Object.create(null);const i=t.blockStyles;for(const n in i)this.blockStyles[n]=this.validatedBlockStyle_(i[n]);this.setDynamicProperties_(t)}setDynamicProperties_(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=t.startHats!==void 0?t.startHats:this.ADD_START_HATS}setFontConstants_(t){t.fontStyle&&t.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=t.fontStyle.family),t.fontStyle&&t.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=t.fontStyle.weight),t.fontStyle&&t.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=t.fontStyle.size),t=ge("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline}setComponentConstants_(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(t){const i="auto_"+t;return this.blockStyles[i]||(this.blockStyles[i]=this.createBlockStyle_(t)),{style:this.blockStyles[i],name:i}}getBlockStyle(t){return this.blockStyles[t||""]||(t&&t.indexOf("auto_")===0?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(t){return this.validatedBlockStyle_({colourPrimary:t})}validatedBlockStyle_(t){const i={};return t&&Object.assign(i,t),t=il(i.colourPrimary||"#000"),i.colourPrimary=t.hex,i.colourSecondary=i.colourSecondary?il(i.colourSecondary).hex:this.generateSecondaryColour_(i.colourPrimary),i.colourTertiary=i.colourTertiary?il(i.colourTertiary).hex:this.generateTertiaryColour_(i.colourPrimary),i.hat=i.hat||"",i}generateSecondaryColour_(t){return Jn("#fff",t,.6)||t}generateTertiaryColour_(t){return Jn("#fff",t,.3)||t}dispose(){this.embossFilter&&bt(this.embossFilter),this.disabledPattern&&bt(this.disabledPattern),this.debugFilter&&bt(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const t=this.JAGGED_TEETH_HEIGHT,i=this.JAGGED_TEETH_WIDTH,n=sl([vt(i,t/4),vt(2*-i,t/2),vt(i,t/4)]);return{height:t,width:i,path:n}}makeStartHat(){const t=this.START_HAT_HEIGHT,i=this.START_HAT_WIDTH,n=Ni("c",[vt(30,-t),vt(70,-t),vt(i,0)]);return{height:t,width:i,path:n}}makePuzzleTab(){function t(g){g=g?-1:1;const E=-g;var C=n/2;const G=C+2.5,dt=C+.5,Ie=vt(-i,g*C);return C=vt(i,g*C),Ni("c",[vt(0,g*G),vt(-i,E*dt),Ie])+Ni("s",[vt(i,2.5*E),C])}const i=this.TAB_WIDTH,n=this.TAB_HEIGHT,c=t(!0),u=t(!1);return{type:this.SHAPES.PUZZLE,width:i,height:n,pathDown:u,pathUp:c}}makeNotch(){function t(E){return sl([vt(E*c,n),vt(3*E,0),vt(E*c,-n)])}const i=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,c=(i-3)/2,u=t(1),g=t(-1);return{type:this.SHAPES.NOTCH,width:i,height:n,pathLeft:u,pathRight:g}}makeInsideCorners(){const t=this.CORNER_RADIUS,i=He("a","0 0,0",t,vt(-t,t)),n=He("a","0 0,0",t,vt(t,t));return{width:t,height:t,pathTop:i,pathBottom:n}}makeOutsideCorners(){const t=this.CORNER_RADIUS,i=ke(0,t)+He("a","0 0,1",t,vt(t,-t)),n=He("a","0 0,1",t,vt(t,t)),c=He("a","0 0,1",t,vt(-t,-t)),u=He("a","0 0,1",t,vt(-t,t));return{topLeft:i,topRight:n,bottomRight:u,bottomLeft:c,rightHeight:t}}shapeFor(t){switch(t.type){case Et.INPUT_VALUE:case Et.OUTPUT_VALUE:return this.PUZZLE_TAB;case Et.PREVIOUS_STATEMENT:case Et.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(t,i,n){this.injectCSS_(i,n),this.defs=A(x.DEFS,{},t),t=A(x.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),A(x.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},t),i=A(x.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},t),A(x.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},i),A(x.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},t),A(x.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},t),this.embossFilterId=t.id,this.embossFilter=t,t=A(x.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),A(x.RECT,{width:10,height:10,fill:"#aaa"},t),A(x.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},t),this.disabledPatternId=t.id,this.disabledPattern=t,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const t=A(x.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),i=A(x.FECOMPONENTTRANSFER,{result:"outBlur"},t);A(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),A(x.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),A(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter=t}}injectCSS_(t,i){i=this.getCSS_(i),t="blockly-renderer-style-"+t,this.cssNode=document.getElementById(t);const n=i.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=n:(i=document.createElement("style"),i.id=t,t=document.createTextNode(n),i.appendChild(t),document.head.insertBefore(i,document.head.firstChild),this.cssNode=i)}getCSS_(t){return[`${t} .blocklyText, `,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect,`,`${t} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text {`,"fill: #000;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${t} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${t} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${t} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${t} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${t} .blocklyReplaceable .blocklyPathLight,`,`${t} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},ca=class{constructor(t,i){this.inlinePath_=this.outlinePath_="",this.block_=t,this.info_=i,this.topLeft_=t.getRelativeToSurfaceXY(),this.constants_=i.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}hideHiddenIcons_(){ut("hideHiddenIcons_","v10","v11")}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let t=1;t<this.info_.rows.length-1;t++){const i=this.info_.rows[t];i.hasJaggedEdge?this.drawJaggedEdge_(i):i.hasStatement?this.drawStatementInput_(i):i.hasExternalInput?this.drawValueInput_(i):this.drawRightSideRow_(i)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const t=this.info_.topRow,i=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=ke(t.xPos,this.info_.startY);for(let n=0,c;c=i[n];n++)L.isLeftRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:L.isRightRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:L.isPreviousConnection(c)&&c instanceof $r?this.outlinePath_+=c.shape.pathLeft:L.isHat(c)?this.outlinePath_+=this.constants_.START_HAT.path:L.isSpacer(c)&&(this.outlinePath_+=$t("h",c.width));this.outlinePath_+=$t("v",t.height)}drawJaggedEdge_(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+$t("v",t.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(t){const i=t.getLastInput();this.positionExternalValueConnection_(t);const n=cf(i.shape)?i.shape.pathDown(i.height):i.shape.pathDown;this.outlinePath_+=$t("H",i.xPos+i.width)+n+$t("v",t.height-i.connectionHeight)}drawStatementInput_(t){var i=t.getLastInput();if(i){var n=i.xPos+i.notchOffset+i.shape.width;i=i.shape.pathRight+$t("h",-(i.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var c=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=$t("H",n)+i+$t("v",c)+this.constants_.INSIDE_CORNERS.pathBottom+$t("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}}drawRightSideRow_(t){this.outlinePath_+=$t("V",t.yPos+t.height)}drawBottom_(){const t=this.info_.bottomRow,i=t.elements;this.positionNextConnection_();let n=0,c="";for(let u=i.length-1,g;g=i[u];u--)L.isNextConnection(g)&&g instanceof $r?c+=g.shape.pathRight:L.isLeftSquareCorner(g)?c+=$t("H",t.xPos):L.isLeftRoundedCorner(g)?c+=this.constants_.OUTSIDE_CORNERS.bottomLeft:L.isRightRoundedCorner(g)?(c+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):L.isSpacer(g)&&(c+=$t("h",-1*g.width));this.outlinePath_+=$t("V",t.baseline-n),this.outlinePath_+=c}drawLeft_(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){const i=t.connectionOffsetY+t.height;t=cf(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=$t("V",i)+t}this.outlinePath_+="z"}drawInternals_(){for(let t=0,i;i=this.info_.rows[t];t++)for(let n=0,c;c=i.elements[n];n++)L.isInlineInput(c)?this.drawInlineInput_(c):(L.isIcon(c)||L.isField(c))&&this.layoutField_(c)}layoutField_(t){const i=t.centerline-t.height/2;let n=t.xPos;var c="";this.info_.RTL&&(n=-(n+t.width),t.flipRtl&&(n+=t.width,c="scale(-1 1)")),L.isIcon(t)?(c=t.icon,c.setOffsetInBlock(new lt(n,i)),this.info_.isInsertionMarker&&c.hideForInsertionMarker()):(t=t.field.getSvgRoot(),t.setAttribute("transform","translate("+n+","+i+")"+c),this.info_.isInsertionMarker&&t.setAttribute("display","none"))}drawInlineInput_(t){const i=t.width,n=t.height,c=t.connectionOffsetY,u=t.connectionHeight+c;this.inlinePath_+=ti(t.xPos+t.connectionWidth,t.centerline-n/2)+$t("v",c)+t.shape.pathDown+$t("v",n-u)+$t("h",i-t.connectionWidth)+$t("v",-n)+"z",this.positionInlineInputConnection_(t)}positionInlineInputConnection_(t){const i=t.centerline-t.height/2;if(t.connectionModel){let n=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,i+t.connectionOffsetY)}}positionStatementInputConnection_(t){const i=t.getLastInput();if(i!=null&&i.connectionModel){let n=t.xPos+t.statementEdge+i.notchOffset;this.info_.RTL&&(n*=-1),i.connectionModel.setOffsetInBlock(n,t.yPos)}}positionExternalValueConnection_(t){const i=t.getLastInput();if(i&&i.connectionModel){let n=t.xPos+t.width;this.info_.RTL&&(n*=-1),i.connectionModel.setOffsetInBlock(n,t.yPos)}}positionPreviousConnection_(){const t=this.info_.topRow;if(t.connection){const i=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,0)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const i=t.connection,n=i.xPos;i.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,t.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}}};(function(t){t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(s.Align$$module$build$src$core$inputs$align||(s.Align$$module$build$src$core$inputs$align={})),s.Align$$module$build$src$core$inputs$align;var _r=class extends Kt{constructor(t,i,n){super(Kt.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,t!==Kt.SKIP_SETUP&&(n?this.configure_(n):this.class=i||null,this.setValue(t))}configure_(t){super.configure_(t),t.class&&(this.class=t.class)}initView(){this.createTextElement_(),this.class&&X(this.getTextElement(),this.class)}doClassValidation_(t){return t==null?null:`${t}`}setClass(t){this.textElement_&&(this.class&&ft(this.textElement_,this.class),t&&X(this.textElement_,t)),this.class=t}static fromJson(t){return new this(Pe(t.text),void 0,t)}};Vi("field_label",_r),_r.prototype.DEFAULT_VALUE="";var Ks=class{constructor(t,i){this.name=t,this.sourceBlock=i,this.fieldRow=[],this.align=s.Align$$module$build$src$core$inputs$input.LEFT,this.visible=!0,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(t,i){return this.insertFieldAt(this.fieldRow.length,t,i),this}insertFieldAt(t,i,n){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(i||i===""&&n)&&(typeof i=="string"&&(i=s.fromJson$$module$build$src$core$field_registry({type:"field_label",text:i})),i.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(i.init(),i.applyColour()),i.name=n,i.setVisible(this.isVisible()),i.prefixField&&(t=this.insertFieldAt(t,i.prefixField)),this.fieldRow.splice(t,0,i),t++,i.suffixField&&(t=this.insertFieldAt(t,i.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours())),t}removeField(t,i){for(let n=0,c;c=this.fieldRow[n];n++)if(c.name===t)return c.dispose(),this.fieldRow.splice(n,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(i)return!1;throw Error('Field "'+t+'" not found.')}isVisible(){return this.visible}setVisible(t){let i=[];if(this.visible===t)return i;this.visible=t;for(let c=0,u;u=this.fieldRow[c];c++)u.setVisible(t);if(this.connection){var n=this.connection;t?i=n.startTrackingAll():n.stopTrackingAll(),(n=n.targetBlock())&&(n.getSvgRoot().style.display=t?"block":"none")}return i}markDirty(){for(let t=0,i;i=this.fieldRow[t];t++)i.markDirty()}setCheck(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this}setAlign(t){return this.align=t,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()}dispose(){for(let t=0,i;i=this.fieldRow[t];t++)i.dispose();this.connection&&this.connection.dispose()}makeConnection(t){return this.sourceBlock.makeConnection_(t)}},sS;(function(t){t=t.Align||(t.Align={}),t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(Ks||(Ks={})),s.Align$$module$build$src$core$inputs$input=Ks.Align,sS={Align:s.Align$$module$build$src$core$inputs$input},sS.Input=Ks;var js=class extends Ks{constructor(t,i){super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Lo=class extends Ks{constructor(t,i){super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},zi=class extends Ks{constructor(t,i){if(!t)throw Error("Statement inputs must have a non-empty name");super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Et.NEXT_STATEMENT)}},oS;s.ValueInput$$module$build$src$core$inputs$value_input=class extends Ks{constructor(t,i){if(!t)throw Error("Value inputs must have a non-empty name");super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Et.INPUT_VALUE)}},oS={},oS.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input;var Al=class{constructor(t,i){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=t,this.block_=i,this.constants_=this.renderer_.getConstants(),this.outputConnection=i.outputConnection?new eS(this.constants_,i.outputConnection):null,this.isInline=i.getInputsInline()&&!i.isCollapsed(),this.isCollapsed=i.isCollapsed(),this.isInsertionMarker=i.isInsertionMarker(),this.RTL=i.RTL,this.topRow=new Xm(this.constants_),this.bottomRow=new Hm(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let t=new Gm(this.constants_);this.inputRows.push(t);var i=this.block_.getIcons();for(let n=0,c;c=i[n];n++){const u=new ZI(this.constants_,c);this.isCollapsed&&!c.isShownWhenCollapsed()||t.elements.push(u)}i=void 0;for(let n=0,c;c=this.block_.inputList[n];n++)if(c.isVisible()){this.shouldStartNewRow_(c,i)&&(this.rows.push(t),t=new Gm(this.constants_),this.inputRows.push(t));for(let u=0,g;g=c.fieldRow[u];u++)t.elements.push(new Ol(this.constants_,g,c));this.addInput_(c,t),i=c}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new QI(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var t=!!this.block_.previousConnection;const i=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;let n=this.topRow.hasLeftSquareCorner(this.block_)?ra:na;this.topRow.elements.push(new n(this.constants_)),i?(t=new Um(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new iS(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof zi&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,n=this.topRow.hasRightSquareCorner(this.block_)?ra:na,this.topRow.elements.push(new n(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof zi?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new ra(this.constants_)):this.bottomRow.elements.push(new na(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new tS(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new ra(this.constants_,"right")):this.bottomRow.elements.push(new na(this.constants_,"right"))}addInput_(t,i){this.isInline&&t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new Vm(this.constants_,t)),i.hasInlineInput=!0):t instanceof zi?(i.elements.push(new oa(this.constants_,t)),i.hasStatement=!0):t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new ju(this.constants_,t)),i.hasExternalInput=!0):(t instanceof js||t instanceof Lo)&&(i.minHeight=Math.max(i.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),i.hasDummyInput=!0),i.align===null&&(i.align=t.align)}shouldStartNewRow_(t,i){return i?i instanceof Lo||t instanceof zi||i instanceof zi?!0:t instanceof s.ValueInput$$module$build$src$core$inputs$value_input||t instanceof js||i instanceof s.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let t=0,i;i=this.rows[t];t++){const n=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new Xi(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let c=0;c<n.length-1;c++){i.elements.push(n[c]);const u=this.getInRowSpacing_(n[c],n[c+1]);i.elements.push(new Xi(this.constants_,u))}i.elements.push(n[n.length-1]),i.endsWithElemSpacer()&&i.elements.push(new Xi(this.constants_,this.getInRowSpacing_(n[n.length-1],null)))}}}getInRowSpacing_(t,i){if(!t&&i&&L.isStatementInput(i))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&L.isInput(t)&&!i){if(L.isExternalInput(t))return this.constants_.NO_PADDING;if(L.isInlineInput(t))return this.constants_.LARGE_PADDING;if(L.isStatementInput(t))return this.constants_.NO_PADDING}return t&&L.isLeftSquareCorner(t)&&i&&(L.isPreviousConnection(i)||L.isNextConnection(i))?i.notchOffset:t&&L.isLeftRoundedCorner(t)&&i&&(L.isPreviousConnection(i)||L.isNextConnection(i))?i.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let t=0,i=0,n=0;for(let u=0,g;g=this.rows[u];u++){if(g.measure(),i=Math.max(i,g.width),g.hasStatement){var c=g.getLastInput();let E,C;c=g.width-((C=(E=c)==null?void 0:E.width)!=null?C:0),t=Math.max(t,c)}n=Math.max(n,g.widthWithConnectedBlocks)}this.statementEdge=t,this.width=i;for(let u=0,g;g=this.rows[u];u++)g.hasStatement&&(g.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(i,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let i=0,n;n=this.rows[i];i++)if(n.hasStatement)this.alignStatementRow_(n);else{var t=n.width;t=this.getDesiredRowWidth_(n)-t,0<t&&this.addAlignmentPadding_(n,t),L.isTopOrBottomRow(n)&&(n.widthWithConnectedBlocks=n.width)}}getDesiredRowWidth_(t){return this.width-this.startX}addAlignmentPadding_(t,i){const n=t.getFirstSpacer(),c=t.getLastSpacer();if((t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=i),t.align===s.Align$$module$build$src$core$inputs$align.LEFT&&c)c.width+=i;else if(t.align===s.Align$$module$build$src$core$inputs$align.CENTRE&&n&&c)n.width+=i/2,c.width+=i/2;else if(t.align===s.Align$$module$build$src$core$inputs$align.RIGHT&&n)n.width+=i;else if(c)c.width+=i;else return;t.width+=i}alignStatementRow_(t){const i=t.getLastInput();if(i){var n=t.width-i.width,c=this.statementEdge;n=c-n,0<n&&this.addAlignmentPadding_(t,n),n=t.width,c=this.getDesiredRowWidth_(t),i.width+=c-n,i.height=Math.max(i.height,t.height),t.width+=c-n,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)}}addRowSpacing_(){const t=this.rows;this.rows=[];for(let i=0;i<t.length;i++)this.rows.push(t[i]),i!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[i],t[i+1]))}makeSpacerRow_(t,i){var n=this.getSpacerRowHeight_(t,i);const c=this.getSpacerRowWidth_(t,i);return n=new Wm(this.constants_,n,c),t.hasStatement&&(n.followsStatement=!0),i.hasStatement&&(n.precedesStatement=!0),n}getSpacerRowWidth_(t,i){return this.width-this.startX}getSpacerRowHeight_(t,i){return this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){return L.isSpacer(i)?t.yPos+i.height/2:L.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,L.isNextConnection(i)?t+i.height/2:t-i.height/2):L.isTopRow(t)?L.isHat(i)?t.capline-i.height/2:t.capline+i.height/2:t.yPos+t.height/2}recordElemPositions_(t){let i=t.xPos;for(let n=0,c;c=t.elements[n];n++)L.isSpacer(c)&&(c.height=t.height),c.xPos=i,c.centerline=this.getElemCenterline_(t,c),i+=c.width}finalize_(){let t=0,i=0;for(let n=0,c;c=this.rows[n];n++)c.yPos=i,c.xPos=this.startX,i+=c.height,t=Math.max(t,c.widthWithConnectedBlocks),this.recordElemPositions_(c);if(this.outputConnection&&this.block_.nextConnection){const n=this.block_.nextConnection.targetBlock();n&&(t=Math.max(t,n.getHeightWidth().width))}this.widthWithChildren=t+this.startX,this.height=i,this.startY=this.topRow.capline,this.bottomRow.baseline=i-this.bottomRow.descenderHeight}},K=class{constructor(t,i,n){if(this.wsCoordinate=null,!i)throw Error("Cannot create a node without a location.");this.type=t,this.isConnectionLocation=K.isConnectionType(t),this.location=i,this.processParams(n||null)}processParams(t){t&&t.wsCoordinate&&(this.wsCoordinate=t.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var t=this.location.getParentInput();const i=t.getSourceBlock();for(t=i.inputList.indexOf(t),t+=1;t<i.inputList.length;t++){const n=i.inputList[t],c=n.fieldRow;for(let u=0;u<c.length;u++){const g=c[u];if(g.isClickable()||K.NAVIGATE_ALL_FIELDS)return K.createFieldNode(g)}if(n.connection)return K.createInputNode(n)}return null}findNextForField(){var t=this.location,i=t.getParentInput();const n=t.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var c=n.inputList.indexOf(i);for(t=i.fieldRow.indexOf(t)+1;c<n.inputList.length;c++){i=n.inputList[c];const u=i.fieldRow;for(;t<u.length;){if(u[t].isClickable()||K.NAVIGATE_ALL_FIELDS)return K.createFieldNode(u[t]);t++}if(t=0,i.connection)return K.createInputNode(i)}return null}findPrevForInput(){const t=this.location.getParentInput(),i=t.getSourceBlock();for(var n=i.inputList.indexOf(t);0<=n;n--){var c=i.inputList[n];if(c.connection&&c!==t)return K.createInputNode(c);c=c.fieldRow;for(let u=c.length-1;0<=u;u--){const g=c[u];if(g.isClickable()||K.NAVIGATE_ALL_FIELDS)return K.createFieldNode(g)}}return null}findPrevForField(){var t=this.location;const i=t.getParentInput(),n=t.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var c=n.inputList.indexOf(i);for(t=i.fieldRow.indexOf(t)-1;0<=c;c--){var u=n.inputList[c];if(u.connection&&u!==i)return K.createInputNode(u);for(u=u.fieldRow;-1<t;){if(u[t].isClickable()||K.NAVIGATE_ALL_FIELDS)return K.createFieldNode(u[t]);t--}0<=c-1&&(t=n.inputList[c-1].fieldRow.length-1)}return null}navigateBetweenStacks(t){var i=this.getLocation();if(i.getSourceBlock){var n=i.getSourceBlock();n&&(i=n)}if(!i||i.isDeadOrDying())return null;n=i.getRootBlock(),i=n.workspace.getTopBlocks(!0);for(let c=0;c<i.length;c++)if(n.id===i[c].id)return t=c+(t?1:-1),t===-1||t===i.length?null:K.createStackNode(i[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")}findTopASTNodeForBlock(t){const i=Bc(t);return i?K.createConnectionNode(i):K.createBlockNode(t)}getOutAstNodeForBlock(t){if(!t)return null;t=t.getTopStackBlock();const i=Bc(t);return i&&i.targetConnection&&i.targetConnection.getParentInput()?K.createInputNode(i.targetConnection.getParentInput()):K.createStackNode(t)}findFirstFieldOrInput(t){t=t.inputList;for(let i=0;i<t.length;i++){const n=t[i],c=n.fieldRow;for(let u=0;u<c.length;u++){const g=c[u];if(g.isClickable()||K.NAVIGATE_ALL_FIELDS)return K.createFieldNode(g)}if(n.connection)return K.createInputNode(n)}return null}getSourceBlock(){return this.getType()===K.types.BLOCK?this.getLocation():this.getType()===K.types.STACK?this.getLocation():this.getType()===K.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case K.types.STACK:return this.navigateBetweenStacks(!0);case K.types.OUTPUT:return K.createBlockNode(this.location.getSourceBlock());case K.types.FIELD:return this.findNextForField();case K.types.INPUT:return this.findNextForInput();case K.types.BLOCK:const t=this.location.nextConnection;if(!t)break;return K.createConnectionNode(t);case K.types.PREVIOUS:return K.createBlockNode(this.location.getSourceBlock());case K.types.NEXT:return K.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case K.types.WORKSPACE:const t=this.location.getTopBlocks(!0);if(0<t.length)return K.createStackNode(t[0]);break;case K.types.STACK:return this.findTopASTNodeForBlock(this.location);case K.types.BLOCK:return this.findFirstFieldOrInput(this.location);case K.types.INPUT:return K.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case K.types.STACK:return this.navigateBetweenStacks(!1);case K.types.FIELD:return this.findPrevForField();case K.types.INPUT:return this.findPrevForInput();case K.types.BLOCK:var t=Bc(this.location);if(!t)break;return K.createConnectionNode(t);case K.types.PREVIOUS:if((t=this.location.targetConnection)&&!t.getParentInput())return K.createConnectionNode(t);break;case K.types.NEXT:return K.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case K.types.STACK:var t=this.location,i=t.getRelativeToSurfaceXY();return i=new lt(i.x,i.y+K.DEFAULT_OFFSET_Y),K.createWorkspaceNode(t.workspace,i);case K.types.OUTPUT:return t=this.location,(i=t.targetConnection)?K.createConnectionNode(i):K.createStackNode(t.getSourceBlock());case K.types.FIELD:if(t=this.location.getSourceBlock(),!t)throw Error("The current AST location is not associated with a block");return K.createBlockNode(t);case K.types.INPUT:return K.createBlockNode(this.location.getSourceBlock());case K.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case K.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case K.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(t){switch(t){case K.types.PREVIOUS:case K.types.NEXT:case K.types.INPUT:case K.types.OUTPUT:return!0}return!1}static createFieldNode(t){return t?new K(K.types.FIELD,t):null}static createConnectionNode(t){if(!t)return null;const i=t.type;return i===Et.INPUT_VALUE||i===Et.NEXT_STATEMENT&&t.getParentInput()?K.createInputNode(t.getParentInput()):i===Et.NEXT_STATEMENT?new K(K.types.NEXT,t):i===Et.OUTPUT_VALUE?new K(K.types.OUTPUT,t):i===Et.PREVIOUS_STATEMENT?new K(K.types.PREVIOUS,t):null}static createInputNode(t){return t&&t.connection?new K(K.types.INPUT,t.connection):null}static createBlockNode(t){return t?new K(K.types.BLOCK,t):null}static createStackNode(t){return t?new K(K.types.STACK,t):null}static createWorkspaceNode(t,i){return i&&t?new K(K.types.WORKSPACE,t,{wsCoordinate:i}):null}static createTopNode(t){const i=Bc(t);return i?K.createConnectionNode(i):K.createBlockNode(t)}};K.NAVIGATE_ALL_FIELDS=!1,K.DEFAULT_OFFSET_Y=-20,function(t){t=t.types||(t.types={}),t.FIELD="field",t.BLOCK="block",t.INPUT="input",t.OUTPUT="output",t.NEXT="next",t.PREVIOUS="previous",t.STACK="stack",t.WORKSPACE="workspace"}(K||(K={}));var zm=class extends Vs{constructor(t,i,n,c){let u=t?t.workspace.id:void 0;c&&c.getType()===K.types.WORKSPACE&&(u=c.getLocation().id),super(u),this.type=al,this.blockId=t==null?void 0:t.id,this.oldNode=n||void 0,this.newNode=c,this.isCursor=i}toJson(){const t=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new zm),i.isCursor=t.isCursor,i.blockId=t.blockId,i.oldNode=t.oldNode,i.newNode=t.newNode,i}};o(Q.EVENT,al,zm);var vA="blocklyCursor",IA="blocklyMarker",SA=.75,Ym=class{constructor(t,i,n){this.workspace=t,this.marker=n,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=i,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=n.colour||t}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const t=this.isCursor()?vA:IA;return this.svgGroup_=A(x.G,{class:t}),this.createDomInternal_(),this.svgGroup_}setParent_(t){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent=t}draw(t,i){if(i){this.constants_=this.workspace.getRenderer().getConstants();var n=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||n,this.applyColour_(i),this.showAtLocation_(i),this.fireMarkerEvent(t,i),t=this.currentMarkerSvg.childNodes[0],t!==void 0&&t.beginElement&&t.beginElement()}else this.hide()}showAtLocation_(t){const i=t.getLocation().type;t.getType()===K.types.BLOCK?this.showWithBlock_(t):t.getType()===K.types.OUTPUT?this.showWithOutput_(t):i===Et.INPUT_VALUE?this.showWithInput_(t):i===Et.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===K.types.PREVIOUS?this.showWithPrevious_(t):t.getType()===K.types.FIELD?this.showWithField_(t):t.getType()===K.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===K.types.STACK&&this.showWithStack_(t)}showWithBlockPrevOutput(t){t=t.getSourceBlock();const i=t.width;var n=t.height,c=n*SA;const u=this.constants_.CURSOR_BLOCK_PADDING;t.previousConnection?(n=this.constants_.shapeFor(t.previousConnection),this.positionPrevious_(i,u,c,n)):t.outputConnection?(c=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(i,n,c)):this.positionBlock_(i,u,c),this.setParent_(t),this.showCurrent_()}showWithBlock_(t){this.showWithBlockPrevOutput(t)}showWithPrevious_(t){this.showWithBlockPrevOutput(t)}showWithOutput_(t){this.showWithBlockPrevOutput(t)}showWithCoordinates_(t){var i=t.getWsCoordinate();t=i.x,i=i.y,this.workspace.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,i,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(t){t=t.getLocation();const i=t.getSize().width,n=t.getSize().height;this.positionRect_(0,0,i,n),this.setParent_(t),this.showCurrent_()}showWithInput_(t){t=t.getLocation();const i=t.getSourceBlock();this.positionInput_(t),this.setParent_(i),this.showCurrent_()}showWithNext_(t){var i=t.getLocation();t=i.getSourceBlock();let n=0;i=i.getOffsetInBlock().y;const c=t.getHeightWidth().width;this.workspace.RTL&&(n=-c),this.positionLine_(n,i,c),this.setParent_(t),this.showCurrent_()}showWithStack_(t){t=t.getLocation();var i=t.getHeightWidth();const n=i.width+this.constants_.CURSOR_STACK_PADDING;i=i.height+this.constants_.CURSOR_STACK_PADDING;const c=-this.constants_.CURSOR_STACK_PADDING/2,u=-this.constants_.CURSOR_STACK_PADDING/2;let g=c;this.workspace.RTL&&(g=-(n+c)),this.positionRect_(g,u,n,i),this.setParent_(t),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(t,i,n){if(t=ke(-i,n)+$t("V",-i)+$t("H",t+2*i)+$t("V",n),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(t){const i=t.getOffsetInBlock().x,n=t.getOffsetInBlock().y;t=ti(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+i+","+n+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(t,i,n){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${t}`),this.markerSvgLine_.setAttribute("y",`${i}`),this.markerSvgLine_.setAttribute("width",`${n}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(t,i,n){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");t=ke(t,0)+$t("h",-(t-n.width))+$t("v",this.constants_.TAB_OFFSET_FROM_TOP)+n.pathDown+$t("V",i)+$t("H",t),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(t,i,n,c){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");t=ke(-i,n)+$t("V",-i)+$t("H",this.constants_.NOTCH_OFFSET_LEFT)+c.pathLeft+$t("H",t+2*i)+$t("V",n),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(t,i,n,c){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${t}`),this.markerSvgRect_.setAttribute("y",`${i}`),this.markerSvgRect_.setAttribute("width",`${n}`),this.markerSvgRect_.setAttribute("height",`${c}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(t){t.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(t,i){const n=i.getSourceBlock();t=new(pt(al))(n,this.isCursor(),t,i),at(t)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=A(x.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=A(x.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=A(x.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=A(x.PATH,{transform:""},this.markerSvg_),this.markerBlock_=A(x.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();A(x.ANIMATE,t,this.markerSvgLine_),A(x.ANIMATE,t,this.markerInput_),A(x.ANIMATE,Object.assign({},t,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(t){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",t),this.markerInput_.firstElementChild.setAttribute("values",t),this.markerBlock_.firstElementChild.setAttribute("values",t))}dispose(){this.svgGroup_&&bt(this.svgGroup_)}},Ju=class{constructor(t,i,n){this.markerSvg=this.cursorSvg=null,this.constants=n,this.style=i,this.svgRoot=t,this.svgPath=A(x.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null}applyColour(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())}setStyle(t){this.style=t}setClass_(t,i){t&&(i?X(this.svgRoot,t):ft(this.svgRoot,t))}updateHighlighted(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(t){this.setClass_("blocklySelected",t)}updateDraggingDelete(t){this.setClass_("blocklyDraggingDelete",t)}updateInsertionMarker(t){this.setClass_("blocklyInsertionMarker",t)}updateMovable(t){this.setClass_("blocklyDraggable",t)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t)}updateShapeForInputHighlight(t,i){}},se=class{constructor(t,i){this.type=i,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=t}connect_(t){const i=Et.INPUT_VALUE,n=this.getSourceBlock();var c=t.getSourceBlock();t.isConnected()&&t.disconnectInternal(!1);let u;if(this.isConnected()){const E=this.stashShadowState(),C=this.targetBlock();C.isShadow()?C.dispose(!1):(this.disconnectInternal(),u=C),this.applyShadowState(E)}let g;Dt()&&(g=new(pt(s.MOVE$$module$build$src$core$events$utils))(c),g.setReason(["connect"])),yv(this,t),c.setParent(n),g&&(g.recordNew(),at(g)),u&&(t=this.type===i?u.outputConnection:u.previousConnection)&&((c=se.getConnectionForOrphanedConnection(c,t))?t.connect(c):t.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal();const t=this.targetBlock();t&&!t.isDeadOrDying()&&t.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Et.INPUT_VALUE||this.type===Et.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(t){}connect(t){if(this.targetConnection===t)return!0;if(this.getConnectionChecker().canConnect(this,t,!1)){const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(t):t.connect_(this),s.setGroup$$module$build$src$core$events$utils(i)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(t=!0){const{parentConnection:i,childConnection:n}=this.getParentAndChildConnections();if(!i||!n)throw Error("Source connection not connected.");const c=s.getGroup$$module$build$src$core$events$utils();c||s.setGroup$$module$build$src$core$events$utils(!0);let u;Dt()&&(u=new(pt(s.MOVE$$module$build$src$core$events$utils))(n.getSourceBlock()),u.setReason(["disconnect"]));const g=this.targetConnection;g&&(g.targetConnection=null),this.targetConnection=null,t&&n.getSourceBlock().setParent(null),u&&(u.recordNew(),at(u)),n.getSourceBlock().isShadow()||i.respawnShadow_(),s.setGroup$$module$build$src$core$events$utils(c)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(t,i){if(this.getSourceBlock().isDeadOrDying())return!1;var n;return i=(n=t.getInput(i))==null?void 0:n.connection,n=this.targetBlock(),n&&n!==t||!i||i.targetConnection===this?!1:(i.isConnected()&&i.disconnect(),i.connect(this),!0)}targetBlock(){if(this.isConnected()){let t,i;return(i=(t=this.targetConnection)==null?void 0:t.getSourceBlock())!=null?i:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return t?(Array.isArray(t)||(t=[t]),this.check=t,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(t){this.setShadowStateInternal({shadowDom:t})}getShadowDom(t){return t&&this.targetBlock().isShadow()?Qo(this.targetBlock()):this.shadowDom}setShadowState(t){this.setShadowStateInternal({shadowState:t})}getShadowState(t){return t&&this.targetBlock()&&this.targetBlock().isShadow()?Bs(this.targetBlock()):this.shadowState}neighbours(t){return[]}getParentInput(){let t=null;const i=this.sourceBlock_.inputList;for(let n=0;n<i.length;n++)if(i[n].connection===this){t=i[n];break}return t}toString(){const t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection===this)var i="Output Connection of ";else if(t.previousConnection===this)i="Previous Connection of ";else if(t.nextConnection===this)i="Next Connection of ";else{i=null;for(let n=0,c;c=t.inputList[n];n++)if(c.connection===this){i=c;break}if(i)i='Input "'+i.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return i+t.toDevString()}stashShadowState(){const t=this.getShadowDom(!0),i=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:t,shadowState:i}}applyShadowState({shadowDom:t,shadowState:i}){this.shadowDom=t,this.shadowState=i}setShadowStateInternal({shadowDom:t=null,shadowState:i=null}={}){this.shadowDom=t,this.shadowState=i,(t=this.targetBlock())?t.isShadow()?(t.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):(t=this.createShadowBlock(!1),this.serializeShadow(t),t&&t.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(t){var i=this.getSourceBlock();const n=this.getShadowState(),c=this.getShadowDom();if(i.isDeadOrDying()||!n&&!c)return null;if(n)return i=Kr(n,i.workspace,{parentConnection:t?this:void 0,isShadow:!0,recordUndo:!1});if(c){if(i=tn(c,i.workspace),t)if(this.type===Et.INPUT_VALUE){if(!i.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(i.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Et.NEXT_STATEMENT){if(!i.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(i.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return i}return null}serializeShadow(t){t&&(this.shadowDom=Qo(t),this.shadowState=Bs(t))}static getConnectionForOrphanedConnection(t,i){if(i.type===Et.OUTPUT_VALUE)return wv(t,i.getSourceBlock());t=t.lastConnectionInStack(!0);const n=i.getConnectionChecker();return t&&n.canConnect(i,t,!1)?t:null}};se.CAN_CONNECT=0,se.REASON_SELF_CONNECTION=1,se.REASON_WRONG_TYPE=2,se.REASON_TARGET_NULL=3,se.REASON_CHECKS_FAILED=4,se.REASON_DIFFERENT_WORKSPACES=5,se.REASON_SHADOW_PARENT=6,se.REASON_DRAG_CHECKS_FAILED=7,se.REASON_PREVIOUS_AND_OUTPUT=8;var Rl="_TEMP_COLLAPSED_INPUT",qu="_TEMP_COLLAPSED_FIELD",yA={COLLAPSED_FIELD_NAME:qu,COLLAPSED_INPUT_NAME:Rl},nS="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Yi=class{constructor(t){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,tt(t),this.topBlock=t,this.workspace=t.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){s.disable$$module$build$src$core$events$utils(),this.hidePreview(),s.enable$$module$build$src$core$events$utils();var{local:t,closest:i}=this.activeCandidate;if(t.connect(i),this.topBlock.rendered){const n=t.isSuperior()?i:t,c=this.topBlock.getRootBlock();Yr().then(()=>{Mg(n.getSourceBlock()),setTimeout(()=>{c.bringToFront()},0)})}}}update(t,i){const n=this.getCandidate(t);((this.wouldDeleteBlock=this.shouldDelete(!!n,i))||this.shouldUpdatePreviews(n,t))&&(s.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(n),this.maybeShowPreview(n),s.enable$$module$build$src$core$events$utils())}createMarkerBlock(t){var i=t.type;s.disable$$module$build$src$core$events$utils();let n;try{if(n=this.workspace.newBlock(i),n.setInsertionMarker(!0),t.saveExtraState){var c=t.saveExtraState(!0);c&&n.loadExtraState&&n.loadExtraState(c)}else if(t.mutationToDom){const u=t.mutationToDom();u&&n.domToMutation&&n.domToMutation(u)}for(i=0;i<t.inputList.length;i++){const u=t.inputList[i];if(u.name===Rl)continue;const g=n.inputList[i];if(!g)throw Error(nS.replace("%1","an input"));for(c=0;c<u.fieldRow.length;c++){const E=u.fieldRow[c],C=g.fieldRow[c];if(!C)throw Error(nS.replace("%1","a field"));C.setValue(E.getValue())}}n.setCollapsed(t.isCollapsed()),n.setInputsInline(t.getInputsInline()),n.initSvg(),n.getSvgRoot().setAttribute("visibility","hidden")}finally{s.enable$$module$build$src$core$events$utils()}return n}initAvailableConnections(){const t=this.topBlock.getConnections_(!1),i=this.topBlock.lastConnectionInStack(!0);return i&&i!==this.topBlock.nextConnection&&(t.push(i),this.lastOnStack=i),t}shouldUpdatePreviews(t,i){if(!t)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:n,closest:c}=this.activeCandidate;if(c===t.closest&&n===t.local)return!1;const u=n.x+i.x-c.x;return i=n.y+i.y-c.y,t.radius<Math.sqrt(u*u+i*i)-s.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(t){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let i=this.getStartRadius(),n=null;for(let c=0;c<this.availableConnections.length;c++){const u=this.availableConnections[c],g=u.closest(i,t);g.connection&&(n={closest:g.connection,local:u,radius:g.radius},i=g.radius)}return n}getStartRadius(){return this.activeCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius}shouldDelete(t,i){return i&&this.workspace.getComponentManager().hasCapability(i.id,Ze.Capability.DELETE_AREA)?i.wouldDelete(this.topBlock,t):!1}maybeShowPreview(t){if(!this.wouldDeleteBlock&&t){var i=t.closest,n;i===((n=this.activeCandidate)==null?void 0:n.closest)||i.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=t,this.showPreview(this.activeCandidate))}}showPreview(t){const i=this.workspace.getRenderer();switch(i.getConnectionPreviewMethod(t.closest,t.local,this.topBlock)){case Yi.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(t);break;case Yi.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(t);break;case Yi.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(t)}i.shouldHighlightConnection(t.closest)&&t.closest.highlight()}maybeHidePreview(t){if(!t)this.hidePreview();else if(this.activeCandidate){const i=this.activeCandidate.local!==t.local;(this.activeCandidate.closest!==t.closest||i||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let t;const i=(t=this.activeCandidate)==null?void 0:t.closest;i&&i.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(i)&&i.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(t){const{local:i,closest:n}=t;let c=(t=this.lastOnStack&&i===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!c)throw Error("Cannot show the insertion marker because there is no insertion marker block");let u;try{u=c.getMatchingConnection(i.getSourceBlock(),i)}catch{if(t&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),c=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),c=this.firstMarker=this.createMarkerBlock(this.topBlock)),!c)throw Error("Cannot show the insertion marker because there is no insertion marker block");u=c.getMatchingConnection(i.getSourceBlock(),i)}if(!u)throw Error("Cannot show the insertion marker because there is no associated connection");if(u===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");c.queueRender(),xs(),u.connect(n);const g={x:n.x-u.x,y:n.y-u.y},E=u.getOffsetInBlock().clone(),C=u;Yr().then(()=>{let G;(G=c)==null||G.positionNearConnection(C,g,E);let dt;(dt=c)==null||dt.getSvgRoot().setAttribute("visibility","visible")}),this.markerConnection=u}hideInsertionMarker(){if(this.markerConnection){var t=this.markerConnection,i=t.getSourceBlock(),n=i.outputConnection,c;if((c=i.previousConnection)!=null&&c.targetConnection||n!=null&&n.targetConnection)i.unplug(!0);else{let u;(u=t.targetBlock())==null||u.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=i.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(t){t=t.closest,this.highlightedBlock=t.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(t,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(t){if(this.fadedBlock=t.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const t=[];return this.firstMarker&&t.push(this.firstMarker),this.lastMarker&&t.push(this.lastMarker),t}disposeInsertionMarker(t){if(t){s.disable$$module$build$src$core$events$utils();try{t.dispose()}finally{s.enable$$module$build$src$core$events$utils()}}}};(function(t){t=t.PREVIEW_TYPE||(t.PREVIEW_TYPE={}),t[t.INSERTION_MARKER=0]="INSERTION_MARKER",t[t.INPUT_OUTLINE=1]="INPUT_OUTLINE",t[t.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(Yi||(Yi={})),Yi.PREVIEW_TYPE;var aa=class{constructor(t){this.overrides=null,this.name=t}getClassName(){return this.name+"-renderer"}init(t,i){this.constants_=this.makeConstants_(),i&&(this.overrides=i,Object.assign(this.constants_,i)),this.constants_.setTheme(t),this.constants_.init()}createDom(t,i){this.constants_.createDom(t,this.name+"-"+i.name,"."+this.getClassName()+"."+i.getClassName())}refreshDom(t,i){const n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(i),this.constants_.init(),this.createDom(t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new la}makeRenderInfo_(t){return new Al(this,t)}makeDrawer_(t,i){return new ca(t,i)}makeMarkerDrawer(t,i){return new Ym(t,this.getConstants(),i)}makePathObject(t,i){return new Ju(t,i,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(t){return!0}orphanCanConnectAtEnd(t,i,n){return!!se.getConnectionForOrphanedConnection(t,n===Et.OUTPUT_VALUE?i.outputConnection:i.previousConnection)}getConnectionPreviewMethod(t,i,n){return i.type===Et.OUTPUT_VALUE||i.type===Et.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(n,t.targetBlock(),i.type)?Yi.PREVIEW_TYPE.INSERTION_MARKER:Yi.PREVIEW_TYPE.REPLACEMENT_FADE:Yi.PREVIEW_TYPE.INSERTION_MARKER}render(t){const i=this.makeRenderInfo_(t);i.measure(),this.makeDrawer_(t,i).draw()}},he={};he.BottomRow=Hm,he.Connection=$r,he.ConstantProvider=la,he.Drawer=ca,he.ExternalValueInput=ju,he.Field=Ol,he.Hat=Um,he.Icon=ZI,he.InRowSpacer=Xi,he.InlineInput=Vm,he.InputConnection=mn,he.InputRow=Gm,he.JaggedEdge=QI,he.MarkerSvg=Ym,he.Measurable=Ys,he.NextConnection=tS,he.OutputConnection=eS,he.PathObject=Ju,he.PreviousConnection=iS,he.RenderInfo=Al,he.Renderer=aa,he.RoundCorner=na,he.Row=sa,he.SpacerRow=Wm,he.SquareCorner=ra,he.StatementInput=oa,he.TopRow=Xm,he.Types=L,he.init=af,he.register=ol,he.unregister=kv;var rS=class{constructor(t,i){this.workspace=t,this.theme=i,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(t){var i=this.theme;this.theme=t,(t=this.workspace.getInjectionDiv())&&(i&&(i=i.getClassName())&&ft(t,i),(i=this.theme.getClassName())&&X(t,i));for(let n=0,c;c=this.subscribedWorkspaces_[n];n++)c.refreshTheme();for(const[n,c]of this.componentDB)for(const u of c){t=u.element,i=u.propertyName;const g=this.theme&&this.theme.getComponentStyle(n);t.style.setProperty(i,g||"")}for(const n of this.subscribedWorkspaces_)n.hideChaff()}subscribeWorkspace(t){this.subscribedWorkspaces_.push(t)}unsubscribeWorkspace(t){if(!Z(this.subscribedWorkspaces_,t))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(t,i,n){this.componentDB.has(i)||this.componentDB.set(i,[]),this.componentDB.get(i).push({element:t,propertyName:n}),i=this.theme&&this.theme.getComponentStyle(i),t.style.setProperty(n,i||"")}unsubscribe(t){if(t)for(const[i,n]of this.componentDB){for(let c=n.length-1;0<=c;c--)n[c].element===t&&n.splice(c,1);n.length||this.componentDB.delete(i)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},Km="VARIABLE_DYNAMIC",Tr={CATEGORY_NAME:Km};Tr.flyoutCategory=pu,Tr.flyoutCategoryBlocks=pf,Tr.onCreateVariableButtonClick_Colour=df,Tr.onCreateVariableButtonClick_Number=uf,Tr.onCreateVariableButtonClick_String=hf;var lS=class{canConnect(t,i,n,c){return this.canConnectWithReason(t,i,n,c)===se.CAN_CONNECT}canConnectWithReason(t,i,n,c){const u=this.doSafetyChecks(t,i);return u!==se.CAN_CONNECT?u:this.doTypeChecks(t,i)?n&&!this.doDragChecks(t,i,c||0)?se.REASON_DRAG_CHECKS_FAILED:se.CAN_CONNECT:se.REASON_CHECKS_FAILED}getErrorMessage(t,i,n){switch(t){case se.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case se.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case se.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case se.REASON_TARGET_NULL:return"Target connection is null.";case se.REASON_CHECKS_FAILED:return"Connection checks failed. "+(i+" expected "+i.getCheck()+", found "+n.getCheck());case se.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case se.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case se.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(t,i){if(!t||!i)return se.REASON_TARGET_NULL;let n,c,u;return t.isSuperior()?(n=t.getSourceBlock(),c=i.getSourceBlock(),u=i):(c=t.getSourceBlock(),n=i.getSourceBlock(),u=t,t=i),n===c?se.REASON_SELF_CONNECTION:u.type!==dr[t.type]?se.REASON_WRONG_TYPE:n.workspace!==c.workspace?se.REASON_DIFFERENT_WORKSPACES:n.isShadow()&&!c.isShadow()?se.REASON_SHADOW_PARENT:u.type===Et.OUTPUT_VALUE&&c.previousConnection&&c.previousConnection.isConnected()||u.type===Et.PREVIOUS_STATEMENT&&c.outputConnection&&c.outputConnection.isConnected()?se.REASON_PREVIOUS_AND_OUTPUT:se.CAN_CONNECT}doTypeChecks(t,i){if(t=t.getCheck(),i=i.getCheck(),!t||!i)return!0;for(let n=0;n<t.length;n++)if(i.indexOf(t[n])!==-1)return!0;return!1}doDragChecks(t,i,n){if(t.distanceFrom(i)>n||i.getSourceBlock().isInsertionMarker())return!1;switch(i.type){case Et.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,i);case Et.OUTPUT_VALUE:if(i.isConnected()&&!i.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case Et.INPUT_VALUE:if(i.isConnected()&&!i.targetBlock().isMovable()&&!i.targetBlock().isShadow())return!1;break;case Et.NEXT_STATEMENT:if(i.isConnected()&&!t.getSourceBlock().nextConnection&&!i.targetBlock().isShadow()&&i.targetBlock().nextConnection||i.targetBlock()&&!i.targetBlock().isMovable()&&!i.targetBlock().isShadow())return!1;break;default:return!1}return rl.indexOf(i)===-1}canConnectToPrevious_(t,i){return t.targetConnection||rl.indexOf(i)!==-1?!1:i.targetConnection?(t=i.targetBlock(),t.isInsertionMarker()?!t.getPreviousBlock():!1):!0}};o(Q.CONNECTION_CHECKER,Eo,lS);var jm=class extends Wc{constructor(t){super(t),this.type=qn,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new jm),i.varType=t.varType,i.varName=t.varName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?i.deleteVariableById(this.varId):i.createVariable(this.varName,this.varType,this.varId)}};o(Q.EVENT,qn,jm);var Jm=class extends Wc{constructor(t,i){super(t),this.type=cl,t&&(this.oldName=t.name,this.newName=typeof i>"u"?"":i)}toJson(){const t=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return t.oldName=this.oldName,t.newName=this.newName,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new Jm),i.oldName=t.oldName,i.newName=t.newName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t?i.renameVariableById(this.varId,this.newName):i.renameVariableById(this.varId,this.oldName)}};o(Q.EVENT,cl,Jm);var qm=class{constructor(t){this.workspace=t,this.variableMap=new Map}clear(){for(const t of this.variableMap.values())for(;0<t.length;)this.deleteVariable(t[0]);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(t,i){if(t.name!==i){var n=this.getVariable(i,t.type),c=this.workspace.getAllBlocks(!1),u=s.getGroup$$module$build$src$core$events$utils();u||s.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==t.getId()?this.renameVariableWithConflict_(t,i,n,c):this.renameVariableAndUses_(t,i,c)}finally{s.setGroup$$module$build$src$core$events$utils(u)}}}renameVariableById(t,i){const n=this.getVariableById(t);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(n,i)}renameVariableAndUses_(t,i,n){for(at(new(pt(cl))(t,i)),t.name=i,i=0;i<n.length;i++)n[i].updateVarName(t)}renameVariableWithConflict_(t,i,n,c){const u=t.type;for(i!==n.name&&this.renameVariableAndUses_(n,i,c),i=0;i<c.length;i++)c[i].renameVarById(t.getId(),n.getId());at(new(pt(qn))(t)),Z(this.variableMap.get(u),t)}createVariable(t,i,n){var c=this.getVariable(t,i);if(c){if(n&&c.getId()!==n)throw Error('Variable "'+t+'" is already in use and its id is "'+c.getId()+'" which conflicts with the passed in id, "'+n+'".');return c}if(n&&this.getVariableById(n))throw Error('Variable id, "'+n+'", is already in use.');return c=n||Ft(),i=i||"",c=new Xc(this.workspace,t,i,c),t=this.variableMap.get(i)||[],t.push(c),this.variableMap.delete(i),this.variableMap.set(i,t),at(new(pt(cn))(c)),c}deleteVariable(t){const i=t.getId(),n=this.variableMap.get(t.type);if(n){for(let c=0;c<n.length;c++)if(n[c].getId()===i){n.splice(c,1),at(new(pt(qn))(t)),n.length===0&&this.variableMap.delete(t.type);break}}}deleteVariableById(t){const i=this.getVariableById(t);if(i){var n=i.name;const c=this.getVariableUsesById(t);for(let u=0,g;g=c[u];u++)if(g.type==="procedures_defnoreturn"||g.type==="procedures_defreturn"){t=String(g.getFieldValue("NAME")),n=s.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",n).replace("%2",t),Oc(n);return}1<c.length?(n=s.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(c.length)).replace("%2",n),Fh(n,u=>{u&&i&&this.deleteVariableInternal(i,c)})):this.deleteVariableInternal(i,c)}else console.warn("Can't delete non-existent variable: "+t)}deleteVariableInternal(t,i){const n=s.getGroup$$module$build$src$core$events$utils();n||s.setGroup$$module$build$src$core$events$utils(!0);try{for(let c=0;c<i.length;c++)i[c].dispose(!0);this.deleteVariable(t)}finally{s.setGroup$$module$build$src$core$events$utils(n)}}getVariable(t,i){if(i=this.variableMap.get(i||"")){for(let n=0,c;c=i[n];n++)if(s.Names$$module$build$src$core$names.equals(c.name,t))return c}return null}getVariableById(t){for(const i of this.variableMap.values())for(const n of i)if(n.getId()===t)return n;return null}getVariablesOfType(t){return(t=this.variableMap.get(t||""))?t.slice():[]}getVariableTypes(t){const i=new Set(this.variableMap.keys());if(t&&t.getPotentialVariableMap())for(const n of t.getPotentialVariableMap().variableMap.keys())i.add(n);return i.has("")||i.add(""),Array.from(i.values())}getAllVariables(){let t=[];for(const i of this.variableMap.values())t=t.concat(i);return t}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(t=>t.name)}getVariableUsesById(t){const i=[],n=this.workspace.getAllBlocks(!1);for(let c=0;c<n.length;c++){const u=n[c].getVarModels();if(u)for(let g=0;g<u.length;g++)u[g].getId()===t&&i.push(n[c])}return i}},ha=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(t){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new XI,this.potentialVariableMap=null,this.id=Ft(),w(this),this.options=t||new rs({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(T(Q.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new qm(this)}dispose(){this.listeners.length=0,this.clear(),M(this)}sortObjects_(t,i){const n=Math.sin(Jr(ha.SCAN_ANGLE))*(this.RTL?-1:1);return t=t.getRelativeToSurfaceXY(),i=i.getRelativeToSurfaceXY(),t.y+n*t.x-(i.y+n*i.x)}addTopBlock(t){this.topBlocks.push(t)}removeTopBlock(t){if(!Z(this.topBlocks,t))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(t=!1){const i=[].concat(this.topBlocks);return t&&1<i.length&&i.sort(this.sortObjects_.bind(this)),i}addTypedBlock(t){this.typedBlocksDB.has(t.type)||this.typedBlocksDB.set(t.type,[]),this.typedBlocksDB.get(t.type).push(t)}removeTypedBlock(t){Z(this.typedBlocksDB.get(t.type),t),this.typedBlocksDB.get(t.type).length||this.typedBlocksDB.delete(t.type)}getBlocksByType(t,i=!1){return this.typedBlocksDB.has(t)?(t=this.typedBlocksDB.get(t).slice(0),i&&t&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t.filter(function(n){return!n.isInsertionMarker()})):[]}addTopComment(t){this.topComments.push(t),this.commentDB.has(t.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB.set(t.id,t)}removeTopComment(t){if(!Z(this.topComments,t))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(t.id)}getTopComments(t=!1){const i=[].concat(this.topComments);return t&&1<i.length&&i.sort(this.sortObjects_.bind(this)),i}getAllBlocks(t=!1){if(t){var i=this.getTopBlocks(!0);t=[];for(let n=0;n<i.length;n++)t.push(...i[n].getDescendants(!0))}else for(t=this.getTopBlocks(!1),i=0;i<t.length;i++)t.push(...t[i].getChildren(!1));return t.filter(function(n){return!n.isInsertionMarker()})}clear(){this.isClearing=!0;try{const t=s.getGroup$$module$build$src$core$events$utils();for(t||s.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();s.setGroup$$module$build$src$core$events$utils(t),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(t,i){this.variableMap.renameVariableById(t,i)}createVariable(t,i,n){return this.variableMap.createVariable(t,i,n)}getVariableUsesById(t){return this.variableMap.getVariableUsesById(t)}deleteVariableById(t){this.variableMap.deleteVariableById(t)}getVariable(t,i){return this.variableMap.getVariable(t,i)}getVariableById(t){return this.variableMap.getVariableById(t)}getVariablesOfType(t){return this.variableMap.getVariablesOfType(t)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(t,i){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(t){return this.options.maxInstances?(this.options.maxInstances[t]!==void 0?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0}isCapacityAvailable(t){if(!this.hasBlockLimits())return!0;let i=0;for(const n in t){if(t[n]>this.remainingCapacityOfType(n))return!1;i+=t[n]}return!(i>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(t){var i=t?this.redoStack_:this.undoStack_,n=t?this.undoStack_:this.redoStack_;const c=i.pop();if(c){for(var u=[c];i.length&&c.group&&c.group===i[i.length-1].group;){const g=i.pop();g&&u.push(g)}for(i=0;i<u.length;i++)n.push(u[i]);u=At(u,t),Nt(!1);try{for(n=0;n<u.length;n++)u[n].run(t)}finally{Nt(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Zt()}addChangeListener(t){return this.listeners.push(t),t}removeChangeListener(t){Z(this.listeners,t)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let i=0;i<this.listeners.length;i++)(0,this.listeners[i])(t)}getBlockById(t){return this.blockDB.get(t)||null}setBlockById(t,i){this.blockDB.set(t,i)}removeBlockById(t){this.blockDB.delete(t)}getCommentById(t){let i;return(i=this.commentDB.get(t))!=null?i:null}allInputsFilled(t){const i=this.getTopBlocks(!1);for(let n=0;n<i.length;n++)if(!i[n].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new qm(this)}getVariableMap(){return this.variableMap}setVariableMap(t){this.variableMap=t}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let t=null;const i=this.options.parentWorkspace;return this.isFlyout?i&&i.options&&(t=i.options.parentWorkspace):i&&(t=i),t}static getById(t){return b(t)}static getAll(){return I()}};ha.SCAN_ANGLE=3;var CA=100,cS=class{constructor(t){this.parentWorkspace=t,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(t,i){if(t.length){try{var n=new globalThis.Audio}catch{return}for(let u=0;u<t.length;u++){const g=t[u],E=g.match(/\.(\w+)$/);if(E&&n.canPlayType("audio/"+E[1])){var c=new globalThis.Audio(g);break}}c&&this.sounds.set(i,c)}}preload(){for(const t of this.sounds.values()){t.volume=.01;const i=t.play();if(i!==void 0?i.then(t.pause).catch(function(){}):t.pause(),fl||nI)break}}play(t,i){var n=this.sounds.get(t);n?(t=new Date,this.lastSound_!==null&&t.getTime()-this.lastSound_.getTime()<CA||(this.lastSound_=t,n=fl||yu?n:n.cloneNode(),n.volume=i===void 0?1:i,n.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(t,i)}},wA=20,Is=class extends ha{constructor(t){super(t),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=null,this.metricsManager=new(T(Q.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=t.setMetrics||Is.setTopLevelWorkspaceMetrics_,this.componentManager=new Ze,this.connectionDBList=bl.init(this.connectionChecker),this.audioManager=new cS(t.parentWorkspace),this.grid=this.options.gridPattern?new Lm(this.options.gridPattern,t.gridOptions):null,this.markerManager=new ea(this),ii&&Uh&&this.registerToolboxCategoryCallback(lm,Uh),Tr&&pu&&this.registerToolboxCategoryCallback(Km,pu),Ii&&du&&(this.registerToolboxCategoryCallback(Ku,du),this.addChangeListener(rf)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new rS(this,this.options.theme||Gu),this.themeManager_.subscribeWorkspace(this);let i;this.renderer=af(this.options.renderer||"geras",this.getTheme(),(i=this.options.rendererOverrides)!=null?i:void 0),this.cachedParentSvgSize=new Ee(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(t){this.metricsManager=t,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(t){this.markerManager.setCursorSvg(t)}setMarkerSvg(t){this.markerManager.setMarkerSvg(t)}getMarker(t){return this.markerManager?this.markerManager.getMarker(t):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(t){t||(t=Gu),this.themeManager_.setTheme(t)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(i){return!!i.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const t=new(pt(dl))(this.getTheme().name,this.id);at(t)}updateBlockStyles_(t){for(let i=0,n;n=t[i];i++){const c=n.getStyleName();c&&n.setStyle(c)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM=t.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(t){let i=0,n=0,c=1;(this.getCanvas().contains(t)||this.getBubbleCanvas().contains(t))&&(c=this.scale);do{const u=_(t);(t===this.getCanvas()||t===this.getBubbleCanvas())&&(c=1),i+=u.x*c,n+=u.y*c,t=t.parentNode}while(t&&t!==this.getParentSvg());return new lt(i,n)}getCachedParentSvgSize(){const t=this.cachedParentSvgSize;return new Ee(t.width,t.height)}getOriginOffsetInPixels(){return v(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let t=this.svgGroup_;for(;t;){if((" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=t;break}t=t.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.svgBlockCanvas_}setResizeHandlerWrapper(t){this.resizeHandlerWrapper=t}createDom(t){return this.svgGroup_=A(x.G,{class:"blocklyWorkspace"}),t&&(this.svgBackground_=A(x.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),t==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=A(x.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=A(x.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(y(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),document.body.addEventListener("wheel",function(){}),y(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(T(Q.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(t=T(Q.CURSOR,this.options))&&this.markerManager.setCursor(new t),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&bt(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const t=this.getParentSvg();t&&t.parentNode&&bt(t.parentNode)}this.resizeHandlerWrapper&&(H(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null)}addTrashcan(){this.trashcan=Is.newTrashcan(this);const t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)}static newTrashcan(t){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new mI(this);const t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)}addFlyout(t){const i=new rs({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return i.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(T(Q.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(i):new(T(Q.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(i),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(t)}getFlyout(t){return this.flyout||t?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const t=this.componentManager.getComponents(Ze.Capability.POSITIONABLE,!0),i=this.getMetricsManager().getUiMetrics(),n=[];for(let c=0,u;u=t[c];c++){u.position(i,n);const g=u.getBoundingRectangle();g&&n.push(g)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const t=P();lt.equals(this.lastRecordedPageScroll,t)||(this.lastRecordedPageScroll=t,this.updateScreenCalculations_())}getCanvas(){return this.svgBlockCanvas_}setCachedParentSvgSize(t,i){const n=this.getParentSvg();t!=null&&(this.cachedParentSvgSize.width=t,n.setAttribute("data-cached-width",`${t}`)),i!=null&&(this.cachedParentSvgSize.height=i,n.setAttribute("data-cached-height",`${i}`))}getBubbleCanvas(){return this.svgBubbleCanvas_}getParentSvg(){if(!this.cachedParentSvg){let t=this.svgGroup_;for(;t;){if(t.tagName==="svg"){this.cachedParentSvg=t;break}t=t.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(Dt()){var t=this.scale,i=-this.scrollY,n=-this.scrollX;if(!(t===this.oldScale&&1>Math.abs(i-this.oldTop)&&1>Math.abs(n-this.oldLeft))){var c=new(pt(an))(i,n,t,this.id,this.oldScale);this.oldScale=t,this.oldTop=i,this.oldLeft=n,at(c)}}}translate(t,i){const n="translate("+t+","+i+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",n),this.svgBubbleCanvas_.setAttribute("transform",n),this.grid&&this.grid.moveTo(t,i),this.maybeFireViewportChangeEvent()}getWidth(){const t=this.getMetrics();return t?t.viewWidth/this.scale:0}setVisible(t){this.isVisible_=t,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t||this.hideChaff(!0))}render(){for(var t=this.getAllBlocks(!1),i=t.length-1;0<=i;i--)t[i].queueRender();if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),i=0;i<t.length;i++)t[i].queueRender();Yr().then(()=>void this.markerManager.updateMarkers())}highlightBlock(t,i){if(i===void 0){for(let n=0,c;c=this.highlightedBlocks[n];n++)c.setHighlighted(!1);this.highlightedBlocks.length=0}(t=t?this.getBlockById(t):null)&&((i=i===void 0||i)?this.highlightedBlocks.indexOf(t)===-1&&this.highlightedBlocks.push(t):Z(this.highlightedBlocks,t),t.setHighlighted(i))}paste(t){if(ut("Blockly.WorkspaceSvg.prototype.paste","v10","v11","Blockly.clipboard.paste"),!this.rendered||!t.type&&!t.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0);let n;try{n=t.type?this.pasteBlock_(null,t):t.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(t):this.pasteBlock_(t,null)}finally{s.setGroup$$module$build$src$core$events$utils(i)}return n}pasteBlock_(t,i){s.disable$$module$build$src$core$events$utils();let n;try{let c=0,u=0;if(t){n=tn(t,this);let g;c=parseInt((g=t.getAttribute("x"))!=null?g:"0"),this.RTL&&(c=-c);let E;u=parseInt((E=t.getAttribute("y"))!=null?E:"0")}else i&&(n=en(i,this),c=i.x||10,this.RTL&&(c=this.getWidth()-c),u=i.y||10);if(!isNaN(c)&&!isNaN(u)){let g;do{g=!1;const E=this.getAllBlocks(!1);for(let C=0,G;G=E[C];C++){const dt=G.getRelativeToSurfaceXY();if(1>=Math.abs(c-dt.x)&&1>=Math.abs(u-dt.y)){g=!0;break}}if(!g){const C=n.getConnections_(!1);for(let G=0,dt;dt=C[G];G++)if(dt.closest(s.config$$module$build$src$core$config.snapRadius,new lt(c,u)).connection){g=!0;break}}g&&(c=this.RTL?c-s.config$$module$build$src$core$config.snapRadius:c+s.config$$module$build$src$core$config.snapRadius,u+=2*s.config$$module$build$src$core$config.snapRadius)}while(g);n.moveTo(new lt(c,u))}}finally{s.enable$$module$build$src$core$events$utils()}return Dt()&&!n.isShadow()&&at(new(pt(s.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}pasteWorkspaceComment_(t){s.disable$$module$build$src$core$events$utils();let i;try{i=si.fromXmlRendered(t,this);let n,c=parseInt((n=t.getAttribute("x"))!=null?n:"0"),u,g=parseInt((u=t.getAttribute("y"))!=null?u:"0");isNaN(c)||isNaN(g)||(this.RTL&&(c=-c),i.moveBy(c+50,g+50))}finally{s.enable$$module$build$src$core$events$utils()}return Dt()&&Gs.fireCreateEvent(i),i.select(),i}refreshToolboxSelection(){const t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()}renameVariableById(t,i){super.renameVariableById(t,i),this.refreshToolboxSelection()}deleteVariableById(t){super.deleteVariableById(t),this.refreshToolboxSelection()}createVariable(t,i,n){return t=super.createVariable(t,i,n),this.refreshToolboxSelection(),t}recordDragTargets(){const t=this.componentManager.getComponents(Ze.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let i=0,n;n=t[i];i++){const c=n.getClientRect();c&&this.dragTargetAreas.push({component:n,clientRect:c})}}newBlock(t,i){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(t){for(let i=0,n;n=this.dragTargetAreas[i];i++)if(n.clientRect.contains(t.clientX,t.clientY))return n.component;return null}onMouseDown_(t){const i=this.getGesture(t);i&&i.handleWsStart(t,this)}startDrag(t,i){t=nt(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,this.dragDeltaXY=lt.difference(i,t)}moveDrag(t){return t=nt(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,lt.sum(this.dragDeltaXY,t)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())}onMouseWheel_(t){if(Ao.inProgress())t.preventDefault(),t.stopPropagation();else{var i=this.options.zoomOptions&&this.options.zoomOptions.wheel,n=this.options.moveOptions&&this.options.moveOptions.wheel;if(i||n){var c=rt(t);if(qf)var u=t.metaKey;i&&(t.ctrlKey||u||!n)?(c=-c.y/50,i=nt(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(i.x,i.y,c)):(i=this.scrollX-c.x,n=this.scrollY-c.y,t.shiftKey&&!c.x&&(i=this.scrollX-c.y,n=this.scrollY),this.scroll(i,n)),t.preventDefault()}}}getBlocksBoundingBox(){const t=this.getTopBoundedElements();if(!t.length)return new fe(0,0,0,0);const i=t[0].getBoundingRectangle();for(let c=1;c<t.length;c++){var n=t[c];n.isInsertionMarker&&n.isInsertionMarker()||(n=n.getBoundingRectangle(),n.top<i.top&&(i.top=n.top),n.bottom>i.bottom&&(i.bottom=n.bottom),n.left<i.left&&(i.left=n.left),n.right>i.right&&(i.right=n.right))}return i}cleanUp(){this.setResizesEnabled(!1),s.setGroup$$module$build$src$core$events$utils(!0);const t=this.getTopBlocks(!0);let i=0;for(let n=0,c;c=t[n];n++){if(!c.isMovable())continue;const u=c.getRelativeToSurfaceXY();c.moveBy(-u.x,i-u.y,["cleanup"]),c.snapToGrid(),i=c.getRelativeToSurfaceXY().y+c.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}s.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(t){if(!this.options.readOnly&&!this.isFlyout){var i=ee.registry.getContextMenuOptions(ee.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(i,t),Rc(t,i,this.RTL)}}updateToolbox(t){if(t=zn(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Lh(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(U(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(t,i,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);const c=this.scale*n;if(this.scale!==c){c>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:c<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var u=this.getCanvas().getCTM(),g=this.getParentSvg().createSVGPoint();g.x=t,g.y=i,g=g.matrixTransform(u.inverse()),t=g.x,i=g.y,u=u.translate(t*(1-n),i*(1-n)).scale(n),this.scrollX=u.e,this.scrollY=u.f,this.setScale(c)}}zoomCenter(t){var i=this.getMetrics();let n;this.flyout?(n=i.svgWidth?i.svgWidth/2:0,i=i.svgHeight?i.svgHeight/2:0):(n=i.viewWidth/2+i.absoluteLeft,i=i.viewHeight/2+i.absoluteTop),this.zoom(n,i,t)}zoomToFit(){if(this.isMovable()){var t=this.getMetrics(),i=t.viewWidth;t=t.viewHeight;var n=this.getBlocksBoundingBox(),c=2*wA,u=n.right-n.left+c;if(n=n.bottom-n.top+c,u){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(i+=this.flyout.getWidth(),u+=this.flyout.getWidth()/this.scale)),i/=u,t/=n,s.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(i,t)),this.scrollCenter()}finally{s.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){X(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),X(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}endCanvasTransition(){ft(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),ft(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var t=this.getMetrics(),i=(t.scrollWidth-t.viewWidth)/2,n=(t.scrollHeight-t.viewHeight)/2;i=-i-t.scrollLeft,n=-n-t.scrollTop,this.scroll(i,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(t,i){if(this.isMovable()){var n=t?this.getBlockById(t):null;if(n){t=n.getRelativeToSurfaceXY(),n=i?{height:n.height,width:n.width}:n.getHeightWidth();var c=this.scale;i=(t.x+(this.RTL?-1:1)*n.width/2)*c,t=(t.y+n.height/2)*c,n=this.getMetrics(),this.scroll(-(i-n.viewWidth/2),-(t-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.hideChaff(!1),(t=this.getFlyout(!1))&&t.isVisible()&&(t.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(t,i){this.hideChaff(!0);const n=this.getMetrics();t=Math.min(t,-n.scrollLeft),i=Math.min(i,-n.scrollTop);const c=n.scrollTop+Math.max(0,n.scrollHeight-n.viewHeight);t=Math.max(t,-(n.scrollLeft+Math.max(0,n.scrollWidth-n.viewWidth))),i=Math.max(i,-c),this.scrollX=t,this.scrollY=i,this.scrollbar&&this.scrollbar.set(-(t+n.scrollLeft),-(i+n.scrollTop),!1),t+=n.absoluteLeft,i+=n.absoluteTop,this.translate(t,i)}getBlockById(t){return super.getBlockById(t)}getAllBlocks(t=!1){return super.getAllBlocks(t)}getTopBlocks(t=!1){return super.getTopBlocks(t)}addTopBlock(t){this.addTopBoundedElement(t),super.addTopBlock(t)}removeTopBlock(t){this.removeTopBoundedElement(t),super.removeTopBlock(t)}addTopComment(t){this.addTopBoundedElement(t),super.addTopComment(t)}removeTopComment(t){this.removeTopBoundedElement(t),super.removeTopComment(t)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(t){this.topBoundedElements.push(t)}removeTopBoundedElement(t){Z(this.topBoundedElements,t)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(t){const i=!this.resizesEnabled&&t;this.resizesEnabled=t,i&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(t,i){if(typeof i!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(t,i)}getButtonCallback(t){let i;return(i=this.flyoutButtonCallbacks.get(t))!=null?i:null}removeButtonCallback(t){this.flyoutButtonCallbacks.delete(t)}registerToolboxCategoryCallback(t,i){if(typeof i!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(t,i)}getToolboxCategoryCallback(t){return this.toolboxCategoryCallbacks.get(t)||null}removeToolboxCategoryCallback(t){this.toolboxCategoryCallbacks.delete(t)}getGesture(t){const i=t.type==="pointerdown",n=this.currentGesture_;return n?i&&n.hasStarted()?(console.warn("Tried to start the same gesture twice."),n.cancel(),null):n:i?this.currentGesture_=new Ao(t,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(t=!1){To(),ss(),_s(),this.hideComponents(t)}hideComponents(t=!1){this.getComponentManager().getComponents(Ze.Capability.AUTOHIDEABLE,!0).forEach(i=>i.autoHide(t))}static setTopLevelWorkspaceMetrics_(t){const i=this.getMetrics();typeof t.x=="number"&&(this.scrollX=-(i.scrollLeft+(i.scrollWidth-i.viewWidth)*t.x)),typeof t.y=="number"&&(this.scrollY=-(i.scrollTop+(i.scrollHeight-i.viewHeight)*t.y)),this.translate(this.scrollX+i.absoluteLeft,this.scrollY+i.absoluteTop)}},Zm=class extends Vs{constructor(t,i){super(i),this.type=hl,this.isOpen=t}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new Zm),i.isOpen=t.isOpen,i}};o(Q.EVENT,hl,Zm);var Qm=class extends cr{constructor(t){if(super(t),this.type=s.DELETE$$module$build$src$core$events$utils,t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=Ac(t),this.ids=ne(t),this.wasShadow=t.isShadow(),this.oldJson=Bs(t,{addCoordinates:!0})}}toJson(){const t=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.oldXml=Ps(this.oldXml),t.ids=this.ids,t.wasShadow=this.wasShadow,t.oldJson=this.oldJson,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new Qm),i.oldXml=s.textToDom$$module$build$src$core$utils$xml(t.oldXml),i.ids=t.ids,i.wasShadow=t.wasShadow||i.oldXml.tagName.toLowerCase()==="shadow",i.oldJson=t.oldJson,t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}run(t){const i=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(t)for(t=0;t<this.ids.length;t++){const n=this.ids[t],c=i.getBlockById(n);c?c.dispose(!1):n===this.blockId&&console.warn("Can't delete non-existent block: "+n)}else en(this.oldJson,i)}};o(Q.EVENT,s.DELETE$$module$build$src$core$events$utils,Qm);var Nl=class{constructor(t,i,n){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.isInsertionMarker_=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=t,this.id=n&&!t.getBlockById(n)?n:Ft(),t.setBlockById(this.id,this),this.xy_=new lt(0,0),this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,i){if(this.type=i,n=Li[i],!n||typeof n!="object")throw TypeError("Invalid block definition for type: "+i);Object.assign(this,n)}t.addTopBlock(this),t.addTypedBlock(this),new.target===Nl&&this.doInit_()}doInit_(){const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0);const i=qt();try{typeof this.init=="function"&&(Nt(!1),this.init(),Nt(i)),Dt()&&at(new(pt(s.CREATE$$module$build$src$core$events$utils))(this))}finally{s.setGroup$$module$build$src$core$events$utils(t),Nt(i)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(t){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),Dt()&&at(new(pt(s.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(t=>t.disposeInternal()),this.inputList.forEach(t=>t.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(t=>t.dispose()),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const t of this.inputList)for(const i of t.fieldRow)i.initModel&&i.initModel()}unplug(t){this.outputConnection&&this.unplugFromRow_(t),this.previousConnection&&this.unplugFromStack_(t)}unplugFromRow_(t){let i=null,n;(n=this.outputConnection)!=null&&n.isConnected()&&(i=this.outputConnection.targetConnection,this.outputConnection.disconnect()),i&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&(t=t.targetConnection,t==null||t.disconnect(),this.workspace.connectionChecker.canConnect(t,i,!1)?i.connect(t):t==null||t.onFailedConnect(i))}getOnlyValueConnection_(){let t=null;for(let i=0;i<this.inputList.length;i++){const n=this.inputList[i].connection;if(n&&n.type===Et.INPUT_VALUE&&n.targetConnection){if(t)return null;t=n}}return t}unplugFromStack_(t){let i=null;var n;if((n=this.previousConnection)!=null&&n.isConnected()&&(i=this.previousConnection.targetConnection,this.previousConnection.disconnect()),n=this.getNextBlock(),t&&n&&!n.isShadow()){let c,u;t=(u=(c=this.nextConnection)==null?void 0:c.targetConnection)!=null?u:null,t==null||t.disconnect(),i&&this.workspace.connectionChecker.canConnect(i,t,!1)&&i.connect(t)}}getConnections_(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(let i=0,n;n=this.inputList[i];i++)n.connection&&t.push(n.connection);return t}lastConnectionInStack(t){let i=this.nextConnection;for(;i;){const n=i.targetBlock();if(!n||t&&n.isShadow())return i;i=n.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(t){for(let i=0,n;n=this.inputList[i];i++)if(n.connection&&n.connection.targetBlock()===t)return n;return null}getSurroundParent(){let t=this,i;do if(i=t,t=t.getParent(),!t)return null;while(t.getNextBlock()===i);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let t,i=this;do t=i,i=t.parentBlock_;while(i);return t}getTopStackBlock(){let t=this,i;do i=t.getPreviousBlock();while(i&&i.getNextBlock()===t&&(t=i));return t}getChildren(t){if(!t)return this.childBlocks_;t=[];for(let n=0,c;c=this.inputList[n];n++)if(c.connection){var i=c.connection.targetBlock();i&&t.push(i)}return(i=this.getNextBlock())&&t.push(i),t}setParent(t){if(t!==this.parentBlock_){var i=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),n=!!i;if(n&&t&&i!==t)throw Error("Block connected to superior one that is not new parent.");if(!n&&t)throw Error("Block not connected to new parent.");if(n&&!t)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Z(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(t){const i=[this],n=this.getChildren(t);for(let c,u=0;c=n[u];u++)i.push(...c.getDescendants(t));return i}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(t){this.movable_=t}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(Tt(this,!0)):!0}isShadow(){return this.isShadow_}setShadow(t){this.isShadow_=t}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(t){this.isInsertionMarker_=t}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(t){this.editable_=t;for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)u.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const t of this.inputList)if(t.connection||1<t.fieldRow.length)return!1;return!0}getMatchingConnection(t,i){const n=this.getConnections_(!0);if(t=t.getConnections_(!0),n.length!==t.length)throw Error("Connection lists did not match in length.");for(let c=0;c<t.length;c++)if(t[c]===i)return n[c];return null}setHelpUrl(t){this.helpUrl=t}setTooltip(t){this.tooltip=t}getTooltip(){return el(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(t){t=il(t),this.hue_=t.hue,this.colour_=t.hex}setStyle(t){this.styleName_=t}setOnChange(t){if(t&&typeof t!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=t,this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(t){if(typeof t!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(t===void 0?"nothing":t+" of type "+typeof t)+" instead");for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)if(u.name===t)return u;return null}getVars(){const t=[];for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)u.referencesVariables()&&t.push(u.getValue());return t}getVarModels(){const t=[];for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)if(u.referencesVariables()){const g=this.workspace.getVariableById(u.getValue());g&&t.push(g)}return t}updateVarName(t){for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)u.referencesVariables()&&t.getId()===u.getValue()&&u.refreshVariableName()}renameVarById(t,i){for(let n=0,c;c=this.inputList[n];n++)for(let u=0,g;g=c.fieldRow[u];u++)g.referencesVariables()&&t===g.getValue()&&g.setValue(i)}getFieldValue(t){return(t=this.getField(t))?t.getValue():null}setFieldValue(t,i){const n=this.getField(i);if(!n)throw Error('Field "'+i+'" not found.');n.setValue(t)}setPreviousStatement(t,i){if(t)i===void 0&&(i=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Et.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(i);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(t,i){if(t)i===void 0&&(i=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Et.NEXT_STATEMENT)),this.nextConnection.setCheck(i);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(t,i){if(t)i===void 0&&(i=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Et.OUTPUT_VALUE)),this.outputConnection.setCheck(i);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(t){this.inputsInline!==t&&(at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof js&&this.inputList[t]instanceof js)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof s.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[t]instanceof js)return!0;for(t=0;t<this.inputList.length;t++)if(this.inputList[t]instanceof Lo)return!0;return!1}setOutputShape(t){this.outputShape_=t}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(t){if(this.isEnabled()!==t){const i=this.disabled;this.disabled=!t,at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,i,!t))}}getInheritedDisabled(){let t=this.getSurroundParent();for(;t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(t){this.collapsed_!==t&&(at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)}toString(t,i){i=this.toTokens(i);for(let c=2;c<i.length;c++)i[c-2]==="("&&i[c]===")"&&(i[c-2]=i[c-1],i.splice(c-1,2));let n="";return i=i.reduce((c,u)=>(c=c+(n==="("||u===")"?"":" ")+u,n=u[u.length-1],c),""),i=i.trim()||"???",t&&i.length>t&&(i=i.substring(0,t-3)+"..."),i}toTokens(t="?"){const i=[];for(const c of this.inputList)if(c.name!=Rl){for(const u of c.fieldRow)i.push(u.getText());if(c.connection){const u=c.connection.targetBlock();if(u){var n=c.connection;let g=n.getCheck();!g&&n.targetConnection&&(g=n.targetConnection.getCheck()),(n=!!g&&(g.indexOf("Boolean")!==-1||g.indexOf("Number")!==-1))&&i.push("("),i.push(...u.toTokens(t)),n&&i.push(")")}else i.push(t)}}return i}appendValueInput(t){return this.appendInput(new s.ValueInput$$module$build$src$core$inputs$value_input(t,this))}appendStatementInput(t){return this.statementInputCount++,this.appendInput(new zi(t,this))}appendDummyInput(t=""){return this.appendInput(new js(t,this))}appendEndRowInput(t=""){return this.appendInput(new Lo(t,this))}appendInput(t){return this.inputList.push(t),t}appendInputFromRegistry(t,i){return(t=p(Q.INPUT,t,!1))?this.appendInput(new t(i,this)):null}jsonInit(t){var i=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(i+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(i+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,i):this.jsonInitColour_(t,i);for(var n=0;t["message"+n]!==void 0;)this.interpolate_(t["message"+n],t["args"+n]||[],t["implicitAlign"+n]||t["lastDummyAlign"+n],i),n++;if(t.inputsInline!==void 0&&(s.disable$$module$build$src$core$events$utils(),this.setInputsInline(t.inputsInline),s.enable$$module$build$src$core$events$utils()),t.output!==void 0&&this.setOutput(!0,t.output),t.outputShape!==void 0&&this.setOutputShape(t.outputShape),t.previousStatement!==void 0&&this.setPreviousStatement(!0,t.previousStatement),t.nextStatement!==void 0&&this.setNextStatement(!0,t.nextStatement),t.tooltip!==void 0&&(n=Pe(t.tooltip),this.setTooltip(n)),t.enableContextMenu!==void 0&&(this.contextMenu=!!t.enableContextMenu),t.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!t.suppressPrefixSuffix),t.helpUrl!==void 0&&(n=Pe(t.helpUrl),this.setHelpUrl(n)),typeof t.extensions=="string"&&(console.warn(i+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),t.mutator!==void 0&&cu(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(i=0;i<t.length;i++)cu(t[i],this,!1)}jsonInitColour_(t,i){if("colour"in t)if(t.colour===void 0)console.warn(i+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch{console.warn(i+"Illegal colour value: ",t)}}}jsonInitStyle_(t,i){t=t.style;try{this.setStyle(t)}catch{console.warn(i+"Style does not exist: ",t)}}mixin(t,i){if(i!==void 0&&typeof i!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!i){i=[];for(const n in t)this[n]!==void 0&&i.push(n);if(i.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(i))}Object.assign(this,t)}interpolate_(t,i,n,c){t=Jg(t),this.validateTokens_(t,i.length),i=this.interpolateArguments_(t,i,n),n=[];for(let u=0,g;g=i[u];u++)if(this.isInputKeyword_(g.type)){if(t=this.inputFromJson_(g,c)){for(let E=0,C;C=n[E];E++)t.appendField(C[0],C[1]);n.length=0}}else(t=this.fieldFromJson_(g))&&n.push([t,g.name])}validateTokens_(t,i){const n=[];let c=0;for(let u=0;u<t.length;u++){const g=t[u];if(typeof g=="number"){if(1>g||g>i)throw Error('Block "'+this.type+'": Message index %'+g+" out of range.");if(n[g])throw Error('Block "'+this.type+'": Message index %'+g+" duplicated.");n[g]=!0,c++}}if(c!==i)throw Error('Block "'+this.type+'": Message does not reference all '+i+" arg(s).")}interpolateArguments_(t,i,n){const c=[];for(let g=0;g<t.length;g++){var u=t[g];if(typeof u=="number"&&(u=i[u-1]),typeof u=="string"){if(u===`
`)u={type:"input_end_row"},n&&(u.align=n);else if(u=this.stringToFieldJson_(u),!u)continue}c.push(u)}return(t=c.length)&&!this.isInputKeyword_(c[t-1].type)&&(t={type:"input_dummy"},n&&(t.align=n),c.push(t)),c}fieldFromJson_(t){const i=s.fromJson$$module$build$src$core$field_registry(t);return!i&&t.alt?typeof t.alt=="string"?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):i}inputFromJson_(t,i){var n={LEFT:s.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:s.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:s.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:s.Align$$module$build$src$core$inputs$align.CENTRE};let c;switch(t.type){case"input_value":c=this.appendValueInput(t.name);break;case"input_statement":c=this.appendStatementInput(t.name);break;case"input_dummy":c=this.appendDummyInput(t.name);break;case"input_end_row":c=this.appendEndRowInput(t.name);break;default:c=this.appendInputFromRegistry(t.type,t.name)}return c?(t.check&&c.setCheck(t.check),t.align&&(n=n[t.align.toUpperCase()],n===void 0?console.warn(i+"Illegal align value: ",t.align):c.setAlign(n)),c):null}isInputKeyword_(t){return t==="input_value"||t==="input_statement"||t==="input_dummy"||t==="input_end_row"||d(Q.INPUT,t)}stringToFieldJson_(t){return(t=t.trim())?{type:"field_label",text:t}:null}moveInputBefore(t,i){if(t!==i){var n=-1,c=i?-1:this.inputList.length;for(let u=0,g;g=this.inputList[u];u++)if(g.name===t){if(n=u,c!==-1)break}else if(i&&g.name===i&&(c=u,n!==-1))break;if(n===-1)throw Error('Named input "'+t+'" not found.');if(c===-1)throw Error('Reference input "'+i+'" not found.');this.moveNumberedInputBefore(n,c)}}moveNumberedInputBefore(t,i){if(t===i)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(i>this.inputList.length)throw RangeError("Reference input "+i+" out of bounds.");const n=this.inputList[t];this.inputList.splice(t,1),t<i&&i--,this.inputList.splice(i,0,n)}removeInput(t,i){for(let n=0,c;c=this.inputList[n];n++)if(c.name===t)return c instanceof zi&&this.statementInputCount--,c.dispose(),this.inputList.splice(n,1),!0;if(i)return!1;throw Error("Input not found: "+t)}getInput(t){for(let i=0,n;n=this.inputList[i];i++)if(n.name===t)return n;return null}getInputTargetBlock(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()}getCommentText(){let t,i;return(i=(t=this.getIcon(vi.TYPE))==null?void 0:t.getText())!=null?i:null}setCommentText(t){var i;let n;const c=(n=(i=this.getIcon(vi.TYPE))==null?void 0:i.getText())!=null?n:null;c!==t&&(at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,c,t)),t!==null?((i=this.getIcon(vi.TYPE))||(i=this.addIcon(new vi(this))),i.setText(t)):this.removeIcon(vi.TYPE))}setWarningText(t,i){}setMutator(t){}addIcon(t){if(this.hasIcon(t.getType()))throw new JI(t);return this.icons.push(t),this.icons.sort((i,n)=>i.getWeight()-n.getWeight()),t}removeIcon(t){if(!this.hasIcon(t))return!1;let i;return(i=this.getIcon(t))==null||i.dispose(),this.icons=this.icons.filter(n=>!n.getType().equals(t)),!0}hasIcon(t){return this.icons.some(i=>i.getType().equals(t))}getIcon(t){return t instanceof Mi?this.icons.find(i=>i.getType().equals(t)):this.icons.find(i=>i.getType().toString()===t)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(t,i,n){if(this.parentBlock_)throw Error("Block has parent");const c=new(pt(s.MOVE$$module$build$src$core$events$utils))(this);n&&c.setReason(n),this.xy_.translate(t,i),c.recordNew(),at(c)}makeConnection_(t){return new se(this,t)}allInputsFilled(t){if(t===void 0&&(t=!0),!t&&this.isShadow())return!1;for(let n=0,c;c=this.inputList[n];n++)if(c.connection){var i=c.connection.targetBlock();if(!i||!i.allInputsFilled(t))return!1}return(i=this.getNextBlock())?i.allInputsFilled(t):!0}toDevString(){let t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t}};Nl.COLLAPSED_INPUT_NAME=Rl,Nl.COLLAPSED_FIELD_NAME=qu;var aS=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(t){this.drawer=t}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(t){const i=this.curNode;this.curNode=t,this.drawer&&this.drawer.draw(i,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},t$=class extends aS{constructor(){super(),this.type="cursor"}next(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()===K.types.NEXT||t.getType()===K.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t}in(){var t=this.getCurNode();if(!t)return null;(t.getType()===K.types.PREVIOUS||t.getType()===K.types.OUTPUT)&&(t=t.next());let i,n;return(t=(n=(i=t)==null?void 0:i.in())!=null?n:null)&&this.setCurNode(t),t}prev(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()===K.types.NEXT||t.getType()===K.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t}out(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()===K.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null}};o(Q.CURSOR,Eo,t$);var ua=class extends t${constructor(){super()}next(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null}in(){return this.next()}prev(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null}out(){return this.prev()}getNextNode_(t,i){if(!t)return null;const n=t.in()||t.next();return i(n)?n:n?this.getNextNode_(n,i):(t=this.findSiblingOrParent(t.out()),i(t)?t:t?this.getNextNode_(t,i):null)}getPreviousNode_(t,i){if(!t)return null;let n=t.prev();return n=n?this.getRightMostChild(n):t.out(),i(n)?n:n?this.getPreviousNode_(n,i):null}validNode_(t){let i=!1;return t=t&&t.getType(),(t===K.types.OUTPUT||t===K.types.INPUT||t===K.types.FIELD||t===K.types.NEXT||t===K.types.PREVIOUS||t===K.types.WORKSPACE)&&(i=!0),i}findSiblingOrParent(t){if(!t)return null;const i=t.next();return i||this.findSiblingOrParent(t.out())}getRightMostChild(t){if(!t.in())return t;for(t=t.in();t&&t.next();)t=t.next();return this.getRightMostChild(t)}};ua.registrationName="basicCursor",o(Q.CURSOR,ua.registrationName,ua);var hS=class extends ua{validNode_(t){let i=!1;const n=t&&t.getType();return t&&(t=t.getLocation(),n===K.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(i=!0)),i}},e$=10,Si=class extends se{constructor(t,i){super(t,i),this.targetConnection=this.highlightPath=null,this.db=t.workspace.connectionDBList[i],this.dbOpposite=t.workspace.connectionDBList[dr[i]],this.offsetInBlock=new lt(0,0),this.trackedState=Si.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===Si.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.highlightPath&&(bt(this.highlightPath),this.highlightPath=null)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(t){const i=this.x-t.x;return t=this.y-t.y,Math.sqrt(i*i+t*t)}bumpAwayFrom(t){if(!this.sourceBlock_.workspace.isDragging()){var i=this.sourceBlock_.getRootBlock();if(!i.isInFlyout){var n=!1;if(!i.isMovable()){if(i=t.getSourceBlock().getRootBlock(),!i.isMovable())return;t=this,n=!0}var c=W()==i;c||i.addSelect();var u=t.x+s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*e$)-this.x,g=t.y+s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*e$)-this.y;n&&(g=-g),i.RTL&&(u=t.x-s.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*e$)-this.x),i.moveBy(u,g,["bump"]),c||i.removeSelect()}}}moveTo(t,i){let n=!1;return this.trackedState===Si.TrackedState.WILL_TRACK?(this.db.addConnection(this,i),this.trackedState=Si.TrackedState.TRACKED,n=!0):this.trackedState===Si.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,i),n=!0),this.x=t,this.y=i,n}moveBy(t,i){return this.moveTo(this.x+t,this.y+i)}moveToOffset(t){return this.moveTo(t.x+this.offsetInBlock.x,t.y+this.offsetInBlock.y)}setOffsetInBlock(t,i){this.offsetInBlock.x=t,this.offsetInBlock.y=i}getOffsetInBlock(){return this.offsetInBlock}tighten(){const t=this.targetConnection.x-this.x,i=this.targetConnection.y-this.y;if(t!==0||i!==0){const c=this.targetBlock();var n=c.getSvgRoot();if(!n)throw Error("block is not rendered.");n=_(n),c.translate(n.x-t,n.y-i),c.moveConnections(-t,-i)}}tightenEfficiently(){var t=this.targetConnection;const i=this.targetBlock();t&&i&&(t=lt.difference(this.offsetInBlock,t.offsetInBlock),i.translate(t.x,t.y))}closest(t,i){return this.dbOpposite.searchForClosest(this,t,i)}highlight(){if(!this.highlightPath){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),i=t.shapeFor(this);this.type===Et.INPUT_VALUE||this.type===Et.OUTPUT_VALUE?(t=t.TAB_OFFSET_FROM_TOP,i=ke(0,-t)+$t("v",t)+i.pathDown+$t("v",t)):(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS,i=ke(-t,0)+$t("h",t)+i.pathLeft+$t("h",t)),t=this.offsetInBlock,this.highlightPath=A(x.PATH,{class:"blocklyHighlightedConnectionPath",d:i,transform:`translate(${t.x}, ${t.y})`+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(bt(this.highlightPath),this.highlightPath=null)}setTracking(t){t&&this.trackedState===Si.TrackedState.TRACKED||!t&&this.trackedState===Si.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db.addConnection(this,this.y),this.trackedState=Si.TrackedState.TRACKED):(this.trackedState===Si.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Si.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const t=this.targetBlock().getDescendants(!1);for(let i=0;i<t.length;i++){const n=t[i],c=n.getConnections_(!0);for(let u=0;u<c.length;u++)c[u].setTracking(!1);for(const u of n.getIcons())sn(u)&&u.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let t=[];if(this.type!==Et.INPUT_VALUE&&this.type!==Et.NEXT_STATEMENT)return t;const i=this.targetBlock();if(i){let n;i.isCollapsed()?(n=[],i.outputConnection&&n.push(i.outputConnection),i.nextConnection&&n.push(i.nextConnection),i.previousConnection&&n.push(i.previousConnection)):n=i.getConnections_(!0);for(let c=0;c<n.length;c++)t.push(...n[c].startTrackingAll());t.length||(t=[i])}return t}onFailedConnect(t){const i=this.getSourceBlock();if(qt()){const n=s.getGroup$$module$build$src$core$events$utils();setTimeout((function(){i.isDisposed()||i.getParent()||(s.setGroup$$module$build$src$core$events$utils(n),this.bumpAwayFrom(t),s.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),s.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(t=!0){const{parentConnection:i,childConnection:n}=this.getParentAndChildConnections();if(i&&n){var c=i.getSourceBlock(),u=n.getSourceBlock();super.disconnectInternal(t),c.rendered&&c.queueRender(),u.rendered&&(u.updateDisabled(),u.queueRender(),u.getSvgRoot().style.display="block")}}respawnShadow_(){super.respawnShadow_();const t=this.targetBlock();t&&(t.initSvg(),t.queueRender())}neighbours(t){return this.dbOpposite.getNeighbours(this,t)}connect_(t){super.connect_(t);var i=this.getSourceBlock();t=t.getSourceBlock();const n=i.rendered,c=t.rendered;n&&i.updateDisabled(),c&&t.updateDisabled(),n&&c&&(this.type===Et.NEXT_STATEMENT||this.type===Et.PREVIOUS_STATEMENT?t.queueRender():i.queueRender()),(i=i.getInputWithBlock(t))&&(i=i.isVisible(),t.getSvgRoot().style.display=i?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(t){return super.setCheck(t),this.sourceBlock_.rendered&&this.sourceBlock_.queueRender(),this}};(function(t){t=t.TrackedState||(t.TrackedState={}),t[t.WILL_TRACK=-1]="WILL_TRACK",t[t.UNTRACKED=0]="UNTRACKED",t[t.TRACKED=1]="TRACKED"})(Si||(Si={})),Si.TrackedState;var Js=class extends Nl{constructor(t,i,n){super(t,i,n),this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1,this.translation="",this.bumpNeighboursPid=0,this.relativeCoords=new lt(0,0),this.workspace=t,this.svgGroup_=A(x.G,{}),this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),t=this.pathObject.svgPath,t.tooltip=this,xc(t),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let i=0,n;n=this.inputList[i];i++)n.init();for(var t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||y(t,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(W()!==this){var t=null;if(W()){t=W().id,s.disable$$module$build$src$core$events$utils();try{W().unselect()}finally{s.enable$$module$build$src$core$events$utils()}}t=new(pt(Io))(t,this.id,this.workspace.id),at(t),tt(this),this.addSelect()}}unselect(){if(W()===this){var t=new(pt(Io))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,at(t),tt(null),this.removeSelect()}}setParent(t){const i=this.parentBlock_;if(t!==i){S(),super.setParent(t),R();var n=this.getSvgRoot();if(!this.workspace.isClearing&&n){var c=this.getRelativeToSurfaceXY();t?t.getSvgRoot().appendChild(n):i&&((t=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(n,t):this.workspace.getCanvas().appendChild(n),this.translate(c.x,c.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let t=0,i=0,n=this.getSvgRoot();if(n)do{const c=_(n);t+=c.x,i+=c.y,n=n.parentNode}while(n&&n!==this.workspace.getCanvas());return new lt(t,i)}moveBy(t,i,n){if(this.parentBlock_)throw Error("Block has parent");const c=Dt();let u=null;c&&(u=new(pt(s.MOVE$$module$build$src$core$events$utils))(this),n&&u.setReason(n)),n=this.getRelativeToSurfaceXY(),this.translate(n.x+t,n.y+i),this.moveConnections(t,i),c&&u&&(u.recordNew(),at(u)),this.workspace.resizeContents()}translate(t,i){this.translation=`translate(${t}, ${i})`,this.relativeCoords=new lt(t,i),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(t,i){const n=this.getRelativeToSurfaceXY();this.moveBy(t.x-n.x,t.y-n.y,i)}moveDuringDrag(t){this.translate(t.x,t.y),this.getSvgRoot().setAttribute("transform",this.getTranslation())}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var i=t.getSpacing(),n=i/2,c=this.getRelativeToSurfaceXY();t=Math.round(Math.round((c.x-n)/i)*i+n-c.x),i=Math.round(Math.round((c.y-n)/i)*i+n-c.y),(t||i)&&this.moveBy(t,i,["snap"])}}}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY(),i=this.getHeightWidth();let n,c;return this.RTL?(n=t.x-i.width,c=t.x):(n=t.x,c=t.x+i.width),new fe(t.y,t.y+i.height,n,c)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t=0,i;i=this.inputList[t];t++)i.markDirty()}setCollapsed(t){this.collapsed_!==t&&(super.setCollapsed(t),this.updateCollapsed_())}updateCollapsed_(){var t=this.isCollapsed();const i=Rl,n=qu;for(let u=0,g;g=this.inputList[u];u++)g.name!==i&&g.setVisible(!t);for(var c of this.getIcons())c.updateCollapsed();t?(t=this.toString(xI),(c=this.getField(n))?c.setValue(t):(this.getInput(i)||this.appendDummyInput(i)).appendField(new _r(t),n)):(this.updateDisabled(),this.removeInput(i))}tab(t,i){const n=new hS;n.setCurNode(K.createFieldNode(t)),t=n.getCurNode(),i?n.next():n.prev(),(i=n.getCurNode())&&i!==t&&(i.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(i))}onMouseDown_(t){const i=this.workspace.getGesture(t);i&&i.handleBlockStart(t,this)}showHelp(){const t=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;t&&window.open(t)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const t=ee.registry.getContextMenuOptions(ee.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t}showContextMenu(t){const i=this.generateContextMenu();i&&i.length&&(Rc(t,i,this.RTL),fg(this))}moveConnections(t,i){if(this.rendered){for(var n=this.getConnections_(!1),c=0;c<n.length;c++)n[c].moveBy(t,i);n=this.getIcons(),c=this.getRelativeToSurfaceXY();for(var u of n)u.onLocationChange(c);for(u=0;u<this.childBlocks_.length;u++)this.childBlocks_[u].moveConnections(t,i)}}setDragging(t){t?(this.translation="",rl.push(...this.getConnections_(!0)),X(this.svgGroup_,"blocklyDragging")):(rl.length=0,ft(this.svgGroup_,"blocklyDragging"));for(let i=0;i<this.childBlocks_.length;i++)this.childBlocks_[i].setDragging(t)}setMovable(t){super.setMovable(t),this.pathObject.updateMovable(t)}setEditable(t){super.setEditable(t),t=this.getIcons();for(let i=0;i<t.length;i++)t[i].updateEditable()}setShadow(t){super.setShadow(t),this.applyColour()}setInsertionMarker(t){this.isInsertionMarker_!==t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(t,i){this.isDeadOrDying()||(Wg(),Nc(),i&&this.rendered&&(this.unplug(t),Ng(this)),super.dispose(!!t),bt(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,W()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(t=>clearTimeout(t)),this.warningTextDb.clear(),this.getIcons().forEach(t=>t.dispose()))}checkAndDelete(){this.workspace.isFlyout||(s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),s.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:Kc.TYPE,blockState:Bs(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:Tt(this,!0)}}applyColour(){this.pathObject.applyColour(this);const t=this.getIcons();for(let i=0;i<t.length;i++)t[i].applyColour();for(let i=0,n;n=this.inputList[i];i++)for(let c=0,u;u=n.fieldRow[c];c++)u.applyColour()}updateDisabled(){const t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t){let i;(i=this.getNextBlock())==null||i.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=t;for(const i of this.getChildren(!1))i.updateDisabled()}}getCommentIcon(){ut("getCommentIcon","v10","v11","getIcon");let t;return(t=this.getIcon(vi.TYPE))!=null?t:null}setWarningText(t,i=""){if(i)this.warningTextDb.has(i)&&(clearTimeout(this.warningTextDb.get(i)),this.warningTextDb.delete(i));else{for(var n of this.warningTextDb.values())clearTimeout(n);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(i,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(i),this.setWarningText(t,i))},100));else if(this.isInFlyout&&(t=null),n=this.getIcon(vs.TYPE),t){let c=this.getSurroundParent(),u=null;for(;c;)c.isCollapsed()&&(u=c),c=c.getSurroundParent();u&&u.setWarningText(s.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Js.COLLAPSED_WARNING_ID),n?n.addMessage(t,i):this.addIcon(new vs(this).addMessage(t,i))}else n&&(i?(n.addMessage("",i),n.getText()||this.removeIcon(vs.TYPE)):this.removeIcon(vs.TYPE))}setMutator(t){this.removeIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),t&&this.addIcon(t)}addIcon(t){return super.addIcon(t),t instanceof vs&&(this.warning=t),t instanceof s.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=t),this.rendered&&(t.initView(this.createIconPointerDownListener(t)),t.applyColour(),t.updateEditable(),this.queueRender(),xs(),this.bumpNeighbours()),t}createIconPointerDownListener(t){return i=>{this.isDeadOrDying()||(i=this.workspace.getGesture(i))&&i.setStartIcon(t)}}removeIcon(t){const i=super.removeIcon(t);return t.equals(vs.TYPE)&&(this.warning=null),t.equals(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.rendered&&(this.queueRender(),xs(),this.bumpNeighbours()),i}setEnabled(t){this.isEnabled()!==t&&(super.setEnabled(t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(t){this.rendered&&this.pathObject.updateHighlighted(t)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(t){this.pathObject.updateDraggingDelete(t)}getColour(){return this.style.colourPrimary}setColour(t){super.setColour(t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()}setStyle(t){const i=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,i)this.hat=i.hat,this.pathObject.setStyle(i),this.colour_=i.colourPrimary,this.style=i,this.applyColour();else throw Error("Invalid style name: "+t)}bringToFront(t=!1){let i=this;do{const n=i.getSvgRoot(),c=n.parentNode,u=c.childNodes;if(u[u.length-1]!==n&&c.appendChild(n),t)break;i=i.getParent()}while(i)}setPreviousStatement(t,i){super.setPreviousStatement(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(t,i){super.setNextStatement(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(t,i){super.setOutput(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(t){super.setInputsInline(t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(t,i){return t=super.removeInput(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours()),t}moveNumberedInputBefore(t,i){super.moveNumberedInputBefore(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(t){return super.appendInput(t),this.rendered&&(this.queueRender(),this.bumpNeighbours()),t}setConnectionTracking(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var i=this.nextConnection.targetBlock();i&&i.setConnectionTracking(t)}if(!this.collapsed_)for(i=0;i<this.inputList.length;i++){var n=this.inputList[i].connection;n&&(n.setTracking(t),(n=n.targetBlock())&&n.setConnectionTracking(t))}}getConnections_(t){const i=[];if((t||this.rendered)&&(this.outputConnection&&i.push(this.outputConnection),this.previousConnection&&i.push(this.previousConnection),this.nextConnection&&i.push(this.nextConnection),t||!this.collapsed_))for(let n=0,c;c=this.inputList[n];n++)c.connection&&i.push(c.connection);return i}lastConnectionInStack(t){return super.lastConnectionInStack(t)}getMatchingConnection(t,i){return super.getMatchingConnection(t,i)}makeConnection_(t){return new Si(this,t)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var t=s.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout(()=>{const i=s.getGroup$$module$build$src$core$events$utils();s.setGroup$$module$build$src$core$events$utils(t),this.getRootBlock().bumpNeighboursInternal(),s.setGroup$$module$build$src$core$events$utils(i),this.bumpNeighboursPid=0},s.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const t=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||t.isInFlyout))for(const i of this.getConnections_(!1)){if(i.isSuperior()){let n;(n=i.targetBlock())==null||n.bumpNeighboursInternal()}for(const n of i.neighbours(s.config$$module$build$src$core$config.snapRadius))n.getSourceBlock().getRootBlock()!==t&&(i.isConnected()&&n.isConnected()||(i.isSuperior()?n.bumpAwayFrom(i):i.bumpAwayFrom(n)))}}scheduleSnapAndBump(){const t=s.getGroup$$module$build$src$core$events$utils();setTimeout(()=>{s.setGroup$$module$build$src$core$events$utils(t),this.snapToGrid(),s.setGroup$$module$build$src$core$events$utils(!1)},s.config$$module$build$src$core$config.bumpDelay/2),this.bumpNeighbours()}positionNearConnection(t,i,n){if(t.type===Et.NEXT_STATEMENT||t.type===Et.INPUT_VALUE){let c=i.x;i=i.y,c+=n.x-t.getOffsetInBlock().x,i+=n.y-t.getOffsetInBlock().y,this.moveBy(c,i)}}getChildren(t){return super.getChildren(t)}queueRender(){return Jp(this)}render(){this.queueRender(),xs()}renderEfficiently(){this.rendered=!0,S(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),R(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const t of this.inputList){const i=t.connection;i&&i.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(ea.LOCAL_MARKER).draw();for(const t of this.inputList)for(const i of t.fieldRow)i.updateMarkers_()}updateConnectionAndIconLocations(){const t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(let i=0;i<this.inputList.length;i++){const n=this.inputList[i].connection;n&&(n.moveToOffset(t),n.isConnected()&&n.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten());for(const i of this.getIcons())i.onLocationChange(t)}setCursorSvg(t){this.pathObject.setCursorSvg(t)}setMarkerSvg(t){this.pathObject.setMarkerSvg(t)}getHeightWidth(){let t=this.height,i=this.width;var n=this.getNextBlock();if(n){n=n.getHeightWidth();const c=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=n.height-c,i=Math.max(i,n.width)}return{height:t,width:i}}fadeForReplacement(t){this.pathObject.updateReplacementFade(t)}highlightShapeForInput(t,i){this.pathObject.updateShapeForInputHighlight(t,i)}};Js.INLINE=-1,Js.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var uS=class{constructor(){}onDragEnter(t){}onDragOver(t){}onDragExit(t){}onDrop(t){}getClientRect(){return null}shouldPreventMove(t){return!1}},Zu=class extends uS{constructor(){super(),this.wouldDelete_=!1}wouldDelete(t,i){return t instanceof Js?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!i)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}updateWouldDelete_(t){this.wouldDelete_=t}},dS=class extends Zu{constructor(t){super(),this.workspace=t,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(t=new rs({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(t.toolboxPosition=this.workspace.toolboxPosition===Pt.TOP?Pt.BOTTOM:Pt.TOP,this.flyout=new(T(Q.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(t)):(t.toolboxPosition=this.workspace.toolboxPosition===Pt.RIGHT?Pt.LEFT:Pt.RIGHT,this.flyout=new(T(Q.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(t)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=A(x.G,{class:"blocklyTrash"});let t;const i=String(Math.random()).substring(2);t=A(x.CLIPPATH,{id:"blocklyTrashBodyClipPath"+i},this.svgGroup),A(x.RECT,{width:Ll,height:Qu,y:Ml},t);const n=A(x.IMAGE,{width:Ei.width,x:-i$,height:Ei.height,y:-s$,"clip-path":"url(#blocklyTrashBodyClipPath"+i+")"},this.svgGroup);return n.setAttributeNS(os,"xlink:href",this.workspace.options.pathToMedia+Ei.url),t=A(x.CLIPPATH,{id:"blocklyTrashLidClipPath"+i},this.svgGroup),A(x.RECT,{width:Ll,height:Ml},t),this.svgLid=A(x.IMAGE,{width:Ei.width,x:-i$,height:Ei.height,y:-s$,"clip-path":"url(#blocklyTrashLidClipPath"+i+")"},this.svgGroup),this.svgLid.setAttributeNS(os,"xlink:href",this.workspace.options.pathToMedia+Ei.url),D(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),D(this.svgGroup,"pointerup",this,this.click),D(n,"pointerover",this,this.mouseOver),D(n,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(re(this.flyout.createDom(x.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ze.Capability.AUTOHIDEABLE,Ze.Capability.DELETE_AREA,Ze.Capability.DRAG_TARGET,Ze.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&bt(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var t=this.contents.map(function(n){return JSON.parse(n)}),i=this.workspace.getParentSvg().style;i.cursor="wait",setTimeout(()=>{let n;(n=this.flyout)==null||n.show(t),i.cursor="";let c;(c=this.workspace.scrollbar)==null||c.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var t;(t=this.flyout)==null||t.hide();var i;(i=this.workspace.scrollbar)==null||i.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(t){!t&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(t,i){if(this.initialized){var n=Ph(this.workspace,t);t=xh(n,new Ee(Ll,Qu+Ml),kA,pS,t,this.workspace),i=Bh(t,pS,n.vertical===Oo.TOP?pn.DOWN:pn.UP,i),this.top=i.top,this.left=i.left;var c;(c=this.svgGroup)==null||c.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new fe(this.top,this.top+Qu+Ml,this.left,this.left+Ll)}getClientRect(){if(!this.svgGroup)return null;var t=this.svgGroup.getBoundingClientRect();const i=t.top+s$-td;return t=t.left+i$-td,new fe(i,i+Ml+Qu+2*td,t,t+Ll+2*td)}onDragOver(t){this.setLidOpen(this.wouldDelete_)}onDragExit(t){this.setLidOpen(!1)}onDrop(t){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(t){this.isLidOpen!==t&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=t,this.animateLid())}animateLid(){const t=RA;var i=1/(t+1);this.lidOpen+=this.isLidOpen?i:-i,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*fS),i=gS+this.lidOpen*(NA-gS),this.svgGroup&&(this.svgGroup.style.opacity=`${i}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),AA/t))}setLidAngle(t){const i=this.workspace.toolboxPosition===Pt.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let n;(n=this.svgLid)==null||n.setAttribute("transform","rotate("+(i?-t:t)+","+(i?4:Ll-4)+","+(Ml-2)+")")}setMinOpenness(t){this.minOpenness=t,this.isLidOpen||this.setLidAngle(t*fS)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&this.openFlyout()}fireUiEvent(t){t=new(pt(hl))(t,this.workspace.id),at(t)}blockMouseDownWhenOpenable(t){!this.contentsIsOpen()&&this.hasContents()&&t.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(t){if(!(0>=this.workspace.options.maxTrashcanContents||t.type!==s.DELETE$$module$build$src$core$events$utils||t.type!==s.DELETE$$module$build$src$core$events$utils||t.wasShadow)){if(!t.oldJson)throw Error("Encountered a delete event without proper oldJson");if(t=JSON.stringify(this.cleanBlockJson(t.oldJson)),this.contents.indexOf(t)===-1){for(this.contents.unshift(t);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(OA)}}}cleanBlockJson(t){function i(n){if(n){if(delete n.id,delete n.x,delete n.y,delete n.enabled,n.icons&&n.icons.comment){var c=n.icons.comment;delete c.height,delete c.width,delete c.pinned}c=n.inputs;for(var u in c){var g=c[u];const E=g.block;g=g.shadow,E&&i(E),g&&i(g)}n.next&&(u=n.next,n=u.block,u=u.shadow,n&&i(n),u&&i(u))}}return t=JSON.parse(JSON.stringify(t)),i(t),Object.assign({},{kind:"BLOCK"},t)}},Ll=47,Qu=44,Ml=16,pS=20,kA=20,td=10,i$=0,s$=32,OA=.1,AA=80,RA=4,gS=.4,NA=.8,fS=45,ce=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(t,i){if(this.shortcuts.get(t.name)&&!i)throw Error(`Shortcut named "${t.name}" already exists.`);if(this.shortcuts.set(t.name,t),(i=t.keyCodes)&&0<i.length)for(let n=0;n<i.length;n++)this.addKeyMapping(i[n],t.name,!!t.allowCollision)}unregister(t){return this.shortcuts.get(t)?(this.removeAllKeyMappings(t),this.shortcuts.delete(t),!0):(console.warn(`Keyboard shortcut named "${t}" not found.`),!1)}addKeyMapping(t,i,n){t=`${t}`;const c=this.keyMap.get(t);if(c&&!n)throw Error(`Shortcut named "${i}" collides with shortcuts "${c}"`);c&&n?c.unshift(i):this.keyMap.set(t,[i])}removeKeyMapping(t,i,n){const c=this.keyMap.get(t);if(!c)return n||console.warn(`No keyboard shortcut named "${i}" registered with key code "${t}"`),!1;const u=c.indexOf(i);return-1<u?(c.splice(u,1),c.length===0&&this.keyMap.delete(t),!0):(n||console.warn(`No keyboard shortcut named "${i}" registered with key code "${t}"`),!1)}removeAllKeyMappings(t){for(const i of this.keyMap.keys())this.removeKeyMapping(i,t,!0)}setKeyMap(t){this.keyMap.clear();for(const i in t)this.keyMap.set(i,t[i])}getKeyMap(){const t=Object.create(null);for(const[i,n]of this.keyMap)t[i]=n;return t}getRegistry(){const t=Object.create(null);for(const[i,n]of this.shortcuts)t[i]=n;return bo(Object.create(null),t)}onKeyDown(t,i){var n=this.serializeKeyEvent_(i);if(n=this.getShortcutNamesByKeyCode(n),!n)return!1;for(let c=0,u;u=n[c];c++){const g=this.shortcuts.get(u);let E,C;if((E=g)==null||!E.preconditionFn||(C=g)!=null&&C.preconditionFn(t)){let G,dt;if((G=g)!=null&&G.callback&&((dt=g)!=null&&dt.callback(t,i,g)))return!0}}return!1}getShortcutNamesByKeyCode(t){return this.keyMap.get(t)||[]}getKeyCodesByShortcutName(t){const i=[];for(const[n,c]of this.keyMap)-1<c.indexOf(t)&&i.push(n);return i}serializeKeyEvent_(t){let i="";for(const n in ce.modifierKeys)t.getModifierState(n)&&(i!==""&&(i+="+"),i+=n);return i!==""&&t.keyCode?i=i+"+"+t.keyCode:t.keyCode&&(i=String(t.keyCode)),i}checkModifiers_(t){for(let i=0,n;n=t[i];i++)if(!(n in ce.modifierKeys))throw Error(n+" is not a valid modifier key.")}createSerializedKey(t,i){let n="";if(i){this.checkModifiers_(i);for(const c in ce.modifierKeys)-1<i.indexOf(ce.modifierKeys[c])&&(n!==""&&(n+="+"),n+=c)}return n!==""&&t?n=n+"+"+t:t&&(n=`${t}`),n}};ce.registry=new ce,function(t){t=t.modifierKeys||(t.modifierKeys={}),t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta"}(ce||(ce={}));var qs;(function(t){t.ESCAPE="escape",t.DELETE="delete",t.COPY="copy",t.CUT="cut",t.PASTE="paste",t.UNDO="undo",t.REDO="redo"})(qs||(qs={}));var da=null,ed=null;Ef();var Zs={};Zs.names=qs,Zs.registerCopy=mf,Zs.registerCut=$f,Zs.registerDefaultShortcuts=Ef,Zs.registerDelete=ff,Zs.registerEscape=gf,Zs.registerPaste=_f,Zs.registerRedo=bf,Zs.registerUndo=Tf;var LA=class{constructor(t,i){this.procedureModelClass=t,this.parameterModelClass=i,this.priority=OI}save(t){return t=t.getProcedureMap().getProcedures().map(i=>vf(i)),t.length?t:null}load(t,i){const n=i.getProcedureMap();for(const c of t)n.add(Sf(this.procedureModelClass,this.parameterModelClass,c,i))}clear(t){t.getProcedureMap().clear()}},Dl={};Dl.ProcedureSerializer=LA,Dl.loadParameter=yf,Dl.loadProcedure=Sf,Dl.saveParameter=If,Dl.saveProcedure=vf;var mS=class{constructor(){this.priority=kI}save(t){const i=[];for(const n of t.getAllVariables())t={name:n.name,id:n.getId()},n.type&&(t.type=n.type),i.push(t);return i.length?i:null}load(t,i){for(const n of t)i.createVariable(n.name,n.type,n.id)}clear(t){t.getVariableMap().clear()}};jh("variables",new mS);var $S={};$S.VariableSerializer=mS;var o$={};o$.load=Av,o$.save=Ov;var MA={blocks:Yc,exceptions:lr,priorities:hA,procedures:Dl,registry:dm,variables:$S,workspaces:o$},n$=class{constructor(t,i,n,c,u){this.workspace=t,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,i=i===void 0?!0:i,n=n===void 0?!0:n;const g=i&&n;i&&(this.hScroll=new Ue(t,!0,g,c,u)),n&&(this.vScroll=new Ue(t,!1,g,c,u)),g&&(this.corner_=A(x.RECT,{height:Ue.scrollbarThickness,width:Ue.scrollbarThickness,class:"blocklyScrollbarBackground"}),re(this.corner_,t.getBubbleCanvas()))}dispose(){bt(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const t=this.workspace.getMetrics();if(t){var i=!1,n=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===t.viewWidth&&this.oldHostMetrics_.viewHeight===t.viewHeight&&this.oldHostMetrics_.absoluteTop===t.absoluteTop&&this.oldHostMetrics_.absoluteLeft===t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===t.scrollWidth&&this.oldHostMetrics_.viewLeft===t.viewLeft&&this.oldHostMetrics_.scrollLeft===t.scrollLeft||(i=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===t.scrollHeight&&this.oldHostMetrics_.viewTop===t.viewTop&&this.oldHostMetrics_.scrollTop===t.scrollTop||(n=!0)):n=i=!0,i||n){try{s.disable$$module$build$src$core$events$utils(),this.hScroll&&i&&this.hScroll.resize(t),this.vScroll&&n&&this.vScroll.resize(t)}finally{s.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft){let c;(c=this.corner_)==null||c.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteTop!==t.absoluteTop){let c;(c=this.corner_)==null||c.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=t}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(t,i){this.hScroll&&this.hScroll.setOrigin(t,i),this.vScroll&&this.vScroll.setOrigin(t,i)}set(t,i,n){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(i,!1),(n||n===void 0)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace.setMetrics(t))}setX(t){this.hScroll&&this.hScroll.set(t,!0)}setY(t){this.vScroll&&this.vScroll.set(t,!0)}setContainerVisible(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)}isVisible(){let t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t}setVisible(t){this.hScroll&&this.hScroll.setVisibleInternal(t),this.vScroll&&this.vScroll.setVisibleInternal(t)}resizeContent(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)}resizeView(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)}},r$=class{constructor(t){this.workspace_=t}getDimensionsPx_(t){let i=0,n=0;return t&&(i=t.getWidth(),n=t.getHeight()),new Ee(i,n)}getFlyoutMetrics(t){return t=this.getDimensionsPx_(this.workspace_.getFlyout(t)),{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let t=0;const i=this.getToolboxMetrics(),n=this.getFlyoutMetrics(!0),c=!!this.workspace_.getToolbox(),u=!!this.workspace_.getFlyout(!0);var g=c?i.position:n.position,E=g===Pt.LEFT;return g=g===Pt.TOP,c&&E?t=i.width:u&&E&&(t=n.width),E=0,c&&g?E=i.height:u&&g&&(E=n.height),{top:E,left:t}}getViewMetrics(t){t=t?this.workspace_.scale:1;const i=this.getSvgMetrics(),n=this.getToolboxMetrics(),c=this.getFlyoutMetrics(!0),u=this.workspace_.getToolbox()?n.position:c.position;return this.workspace_.getToolbox()?u===Pt.TOP||u===Pt.BOTTOM?i.height-=n.height:(u===Pt.LEFT||u===Pt.RIGHT)&&(i.width-=n.width):this.workspace_.getFlyout(!0)&&(u===Pt.TOP||u===Pt.BOTTOM?i.height-=c.height:(u===Pt.LEFT||u===Pt.RIGHT)&&(i.width-=c.width)),{height:i.height/t,width:i.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}}getContentMetrics(t){t=t?1:this.workspace_.scale;const i=this.workspace_.getBlocksBoundingBox();return{height:(i.bottom-i.top)*t,width:(i.right-i.left)*t,top:i.top*t,left:i.left*t}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(t){if(!this.hasFixedEdges())return{};const i=this.workspace_.isMovableHorizontally(),n=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);const c={};return n||(c.top=t.top,c.bottom=t.top+t.height),i||(c.left=t.left,c.right=t.left+t.width),c}getPaddedContent_(t,i){const n=i.top+i.height,c=i.left+i.width,u=t.width;t=t.height;const g=u/2,E=t/2;return{top:Math.min(i.top-E,n-t),bottom:Math.max(n+E,i.top+t),left:Math.min(i.left-g,c-u),right:Math.max(c+g,i.left+u)}}getScrollMetrics(t,i,n){t=t?this.workspace_.scale:1,i=i||this.getViewMetrics(!1);var c=n||this.getContentMetrics();n=this.getComputedFixedEdges_(i),i=this.getPaddedContent_(i,c),c=n.top!==void 0?n.top:i.top;const u=n.left!==void 0?n.left:i.left;return{top:c/t,left:u/t,width:((n.right!==void 0?n.right:i.right)-u)/t,height:((n.bottom!==void 0?n.bottom:i.bottom)-c)/t}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const t=this.getToolboxMetrics(),i=this.getFlyoutMetrics(!0),n=this.getSvgMetrics(),c=this.getAbsoluteMetrics(),u=this.getViewMetrics(),g=this.getContentMetrics(),E=this.getScrollMetrics(!1,u,g);return{contentHeight:g.height,contentWidth:g.width,contentTop:g.top,contentLeft:g.left,scrollHeight:E.height,scrollWidth:E.width,scrollTop:E.top,scrollLeft:E.left,viewHeight:u.height,viewWidth:u.width,viewTop:u.top,viewLeft:u.left,absoluteTop:c.top,absoluteLeft:c.left,svgHeight:n.height,svgWidth:n.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:i.width,flyoutHeight:i.height}}};o(Q.METRICS_MANAGER,Eo,r$);var _S=class extends gl{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.type=tr,this.isBlank=!!t,t&&(this.workspaceId=t.id)}};o(Q.EVENT,tr,_S);var l$=class extends Vs{constructor(t,i,n){super(t?t.workspace.id:void 0),this.type=Zn,t&&(this.blockId=t.id,this.isStart=i,this.blocks=n)}toJson(){const t=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new l$),i.isStart=t.isStart,i.blockId=t.blockId,i.blocks=t.blocks,i}};o(Q.EVENT,Zn,l$);var id={};id.bumpIntoBounds=nl,id.bumpIntoBoundsHandler=Cf,id.bumpTopObjectsIntoBounds=gu;var TS=class{constructor(t,i){this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.draggingBlock_=t,this.draggedConnectionManager_=new Yi(this.draggingBlock_),this.workspace_=i,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=wf(t,this.startXY_)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(t,i){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent_(),this.draggingBlock_.bringToFront(!0),S(),this.workspace_.setResizesEnabled(!1),tl(),this.shouldDisconnect_(i)&&this.disconnectBlock_(i,t),this.draggingBlock_.setDragging(!0)}shouldDisconnect_(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(t,i){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(i),t=lt.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),Dg(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const t=new(pt(Zn))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));at(t)}drag(t,i){i=this.pixelsToWorkspaceUnits_(i);var n=lt.sum(this.startXY_,i);this.draggingBlock_.moveDuringDrag(n),this.dragIcons_(i),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(i,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,t!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(t,i){this.drag(t,i),this.dragIconData_=[],this.fireDragEndEvent_(),R(),tl(),t=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(t=this.getNewLocationAfterDrag_(i).delta),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),t?this.updateBlockAfterMove_():nl(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),s.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(t){t=this.pixelsToWorkspaceUnits_(t);const i=lt.sum(this.startXY_,t);return{delta:t,newLocation:i}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),rl.length=0,!0):!1}updateBlockAfterMove_(){this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.queueRender(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const t=new(pt(Zn))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));at(t)}updateToolboxStyle_(t){const i=this.workspace_.getToolbox();if(i){const n=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&typeof i.removeStyle=="function"?i.removeStyle(n):t||typeof i.addStyle!="function"||i.addStyle(n)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var t=new(pt(s.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);t.setReason(["drag"]),t.oldCoordinate=this.startXY_,t.recordNew(),at(t)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(t){return t=new lt(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t}dragIcons_(t){for(const i of this.dragIconData_)i.icon.onLocationChange(lt.sum(i.location,t))}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};o(Q.BLOCK_DRAGGER,Eo,TS);var pa={};pa.Bubble=le,pa.MiniWorkspaceBubble=Ro,pa.TextBubble=Pm,pa.TextInputBubble=YI;var c$=class extends cr{constructor(t,i,n,c){super(t),this.type=ln,this.recordUndo=!1,t&&(this.name=i,this.oldValue=n,this.newValue=c)}toJson(){const t=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new c$),i.name=t.name,i.oldValue=t.oldValue,i.newValue=t.newValue,i}isNull(){return this.oldValue===this.newValue}};o(Q.EVENT,ln,c$);var a$=class extends cr{constructor(t){super(t),this.type=s.MOVE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)}toJson(){const t=super.toJson();return t.oldParentId=this.oldParentId,t.oldInputName=this.oldInputName,this.oldCoordinate&&(t.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),t.newParentId=this.newParentId,t.newInputName=this.newInputName,this.newCoordinate&&(t.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(t.reason=this.reason),this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new a$),i.oldParentId=t.oldParentId,i.oldInputName=t.oldInputName,t.oldCoordinate&&(n=t.oldCoordinate.split(","),i.oldCoordinate=new lt(Number(n[0]),Number(n[1]))),i.newParentId=t.newParentId,i.newInputName=t.newInputName,t.newCoordinate&&(n=t.newCoordinate.split(","),i.newCoordinate=new lt(Number(n[0]),Number(n[1]))),t.reason!==void 0&&(i.reason=t.reason),t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}recordNew(){const t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate}setReason(t){this.reason=t}currentLocation_(){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(!i)throw Error("The block associated with the block move event could not be found");t={};const n=i.getParent();return n?(t.parentId=n.id,(i=n.getInputWithBlock(i))&&(t.inputName=i.name)):t.coordinate=i.getRelativeToSurfaceXY(),t}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&lt.equals(this.oldCoordinate,this.newCoordinate)}run(t){var i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var n=i.getBlockById(this.blockId);if(n){var c=t?this.newParentId:this.oldParentId,u=t?this.newInputName:this.oldInputName;if(t=t?this.newCoordinate:this.oldCoordinate,c){var g=i.getBlockById(c);if(!g){console.warn("Can't connect to non-existent block: "+c);return}}if(n.getParent()&&n.unplug(),t)u=n.getRelativeToSurfaceXY(),n.moveBy(t.x-u.x,t.y-u.y,this.reason);else{i=n.outputConnection,(!i||n.previousConnection&&n.previousConnection.isConnected())&&(i=n.previousConnection);let E,C;n=(C=i)==null?void 0:C.type,u?(n=g.getInput(u))&&(E=n.connection):n===Et.PREVIOUS_STATEMENT&&(E=g.nextConnection),E&&i?i.connect(E):console.warn("Can't connect to non-existent input: "+u)}}else console.warn("Can't move non-existent block: "+this.blockId)}};o(Q.EVENT,s.MOVE$$module$build$src$core$events$utils,a$);var h$=class extends Vs{constructor(t,i,n){super(t?t.workspace.id:void 0),this.type=Hs,t&&(this.blockId=t.id,this.isOpen=i,this.bubbleType=n)}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId||"",t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new h$),i.isOpen=t.isOpen,i.bubbleType=t.bubbleType,i.blockId=t.blockId,i}},u$;(function(t){t.MUTATOR="mutator",t.COMMENT="comment",t.WARNING="warning"})(u$||(u$={})),o(Q.EVENT,Hs,h$);var $n=class extends gl{constructor(t){super(),this.isBlank=!t,t&&(this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=qt())}toJson(){const t=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return t.commentId=this.commentId,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new $n),i.commentId=t.commentId,i}static CommentCreateDeleteHelper(t,i){var n=t.getEventWorkspace_();if(i){if(i=s.createElement$$module$build$src$core$utils$xml("xml"),!t.xml)throw Error("Ecountered a comment event without proper xml");i.appendChild(t.xml),s.domToWorkspace$$module$build$src$core$xml(i,n)}else{if(!t.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(n=n.getCommentById(t.commentId))?n.dispose():console.warn("Can't uncreate non-existent comment: "+t.commentId)}}},d$=class extends $n{constructor(t,i,n){super(t),this.type=pl,t&&(this.oldContents_=typeof i>"u"?"":i,this.newContents_=typeof n>"u"?"":n)}toJson(){const t=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new d$),i.oldContents_=t.oldContents,i.newContents_=t.newContents,i}isNull(){return this.oldContents_===this.newContents_}run(t){var i=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(i=i.getCommentById(this.commentId)){var n=t?this.newContents_:this.oldContents_;if(!n)throw Error(t?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");i.setContent(n)}else console.warn("Can't change non-existent comment: "+this.commentId)}};o(Q.EVENT,pl,d$);var p$=class extends $n{constructor(t){super(t),this.type=hn,t&&(this.xml=t.toXmlWithXY())}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=Ps(this.xml),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new p$),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i}run(t){$n.CommentCreateDeleteHelper(this,t)}};o(Q.EVENT,hn,p$);var g$=class extends $n{constructor(t){super(t),this.type=Qn,t&&(this.xml=t.toXmlWithXY())}run(t){$n.CommentCreateDeleteHelper(this,!t)}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=Ps(this.xml),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new g$),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i}};o(Q.EVENT,Qn,g$);var f$=class extends $n{constructor(t){super(t),this.type=Us,t&&(this.comment_=t,this.oldCoordinate_=t.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(t){this.oldCoordinate_=t}toJson(){const t=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return t.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new f$),n=t.oldCoordinate.split(","),i.oldCoordinate_=new lt(Number(n[0]),Number(n[1])),n=t.newCoordinate.split(","),i.newCoordinate_=new lt(Number(n[0]),Number(n[1])),i}isNull(){return lt.equals(this.oldCoordinate_,this.newCoordinate_)}run(t){var i=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(i=i.getCommentById(this.commentId)){if(t=t?this.newCoordinate_:this.oldCoordinate_,!t)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var n=i.getRelativeToSurfaceXY();i.moveBy(t.x-n.x,t.y-n.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};o(Q.EVENT,Us,f$);var m$=class extends Vs{constructor(t,i,n){super(n),this.type=ul,this.oldItem=t??void 0,this.newItem=i??void 0}toJson(){const t=super.toJson();return t.oldItem=this.oldItem,t.newItem=this.newItem,t}static fromJson(t,i,n){return i=super.fromJson(t,i,n??new m$),i.oldItem=t.oldItem,i.newItem=t.newItem,i}};o(Q.EVENT,ul,m$),s.CHANGE$$module$build$src$core$events$utils,s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,s.CHANGE$$module$build$src$core$events$utils,s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,s.disable$$module$build$src$core$events$utils,s.enable$$module$build$src$core$events$utils,s.getGroup$$module$build$src$core$events$utils,s.setGroup$$module$build$src$core$events$utils;var _t={};_t.Abstract=gl,_t.BLOCK_CHANGE=s.CHANGE$$module$build$src$core$events$utils,_t.BLOCK_CREATE=s.CREATE$$module$build$src$core$events$utils,_t.BLOCK_DELETE=s.DELETE$$module$build$src$core$events$utils,_t.BLOCK_DRAG=Zn,_t.BLOCK_FIELD_INTERMEDIATE_CHANGE=ln,_t.BLOCK_MOVE=s.MOVE$$module$build$src$core$events$utils,_t.BUBBLE_OPEN=Hs,_t.BUMP_EVENTS=Tu,_t.BlockBase=cr,_t.BlockChange=mr,_t.BlockCreate=pm,_t.BlockDelete=Qm,_t.BlockDrag=l$,_t.BlockFieldIntermediateChange=c$,_t.BlockMove=a$,_t.BubbleOpen=h$,_t.BubbleType=u$,_t.CHANGE=s.CHANGE$$module$build$src$core$events$utils,_t.CLICK=So,_t.COMMENT_CHANGE=pl,_t.COMMENT_CREATE=hn,_t.COMMENT_DELETE=Qn,_t.COMMENT_MOVE=Us,_t.CREATE=s.CREATE$$module$build$src$core$events$utils,_t.Click=zf,_t.ClickTarget=Yf,_t.CommentBase=$n,_t.CommentChange=d$,_t.CommentCreate=p$,_t.CommentDelete=g$,_t.CommentMove=f$,_t.DELETE=s.DELETE$$module$build$src$core$events$utils,_t.FINISHED_LOADING=tr,_t.FinishedLoading=_S,_t.MARKER_MOVE=al,_t.MOVE=s.MOVE$$module$build$src$core$events$utils,_t.MarkerMove=zm,_t.SELECTED=Io,_t.Selected=am,_t.THEME_CHANGE=dl,_t.TOOLBOX_ITEM_SELECT=ul,_t.TRASHCAN_OPEN=hl,_t.ThemeChange=gm,_t.ToolboxItemSelect=m$,_t.TrashcanOpen=Zm,_t.UI=_u,_t.UiBase=Vs,_t.VAR_CREATE=cn,_t.VAR_DELETE=qn,_t.VAR_RENAME=cl,_t.VIEWPORT_CHANGE=an,_t.VarBase=Wc,_t.VarCreate=rm,_t.VarDelete=jm,_t.VarRename=Jm,_t.ViewportChange=fm,_t.clearPendingUndo=Zt,_t.disable=s.disable$$module$build$src$core$events$utils,_t.disableOrphans=qe,_t.enable=s.enable$$module$build$src$core$events$utils,_t.filter=At,_t.fire=at,_t.fromJson=We,_t.get=pt,_t.getDescendantIds=ne,_t.getGroup=s.getGroup$$module$build$src$core$events$utils,_t.getRecordUndo=qt,_t.isEnabled=Dt,_t.setGroup=s.setGroup$$module$build$src$core$events$utils,_t.setRecordUndo=Nt;var bS=class extends la{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(t){super.setFontConstants_(t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(t){super.setDynamicProperties_(t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const i=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=i&&!isNaN(i)?i:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&bt(this.selectedGlowFilter),this.replacementGlowFilter&&bt(this.replacementGlowFilter)}makeStartHat(){const t=this.START_HAT_HEIGHT,i=this.START_HAT_WIDTH,n=Ni("c",[vt(25,-t),vt(71,-t),vt(i,0)]);return{height:t,width:i,path:n}}makeHexagonal(){function t(n,c,u){var g=n/2;return g=g>i?i:g,u=u?-1:1,n=(c?-1:1)*n/2,Fs(-u*g,n)+Fs(u*g,n)}const i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(n){return n/=2,n>i?i:n},height(n){return n},connectionOffsetY(n){return n/2},connectionOffsetX(n){return-n},pathDown(n){return t(n,!1,!1)},pathUp(n){return t(n,!0,!1)},pathRightDown(n){return t(n,!1,!0)},pathRightUp(n){return t(n,!1,!0)}}}makeRounded(){function t(c,u,g){const E=c>n?c-n:0;return c=(c>n?n:c)/2,He("a","0 0,1",c,vt((u?-1:1)*c,(u?-1:1)*c))+$t("v",(g?1:-1)*E)+He("a","0 0,1",c,vt((u?1:-1)*c,(u?-1:1)*c))}const i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=2*i;return{type:this.SHAPES.ROUND,isDynamic:!0,width(c){return c/=2,c>i?i:c},height(c){return c},connectionOffsetY(c){return c/2},connectionOffsetX(c){return-c},pathDown(c){return t(c,!1,!1)},pathUp(c){return t(c,!0,!1)},pathRightDown(c){return t(c,!1,!0)},pathRightUp(c){return t(c,!1,!0)}}}makeSquared(){function t(n,c,u){return n-=2*i,He("a","0 0,1",i,vt((c?-1:1)*i,(c?-1:1)*i))+$t("v",(u?1:-1)*n)+He("a","0 0,1",i,vt((c?1:-1)*i,(c?-1:1)*i))}const i=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(n){return i},height(n){return n},connectionOffsetY(n){return n/2},connectionOffsetX(n){return-n},pathDown(n){return t(n,!1,!1)},pathUp(n){return t(n,!0,!1)},pathRightDown(n){return t(n,!1,!0)},pathRightUp(n){return t(n,!1,!0)}}}shapeFor(t){let i=t.getCheck();switch(!i&&t.targetConnection&&(i=t.targetConnection.getCheck()),t.type){case Et.INPUT_VALUE:case Et.OUTPUT_VALUE:if(t=t.getSourceBlock().getOutputShape(),t!==null)switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return i&&i.indexOf("Boolean")!==-1?this.HEXAGONAL:i&&i.indexOf("Number")!==-1?this.ROUNDED:(i&&i.indexOf("String"),this.ROUNDED);case Et.PREVIOUS_STATEMENT:case Et.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function t(dt){return Ni("c",[vt(dt*u/2,0),vt(dt*u*3/4,E/2),vt(dt*u,E)])+sl([vt(dt*u,g)])+Ni("c",[vt(dt*u/4,E/2),vt(dt*u/2,E),vt(dt*u,E)])+$t("h",dt*c)+Ni("c",[vt(dt*u/2,0),vt(dt*u*3/4,-(E/2)),vt(dt*u,-E)])+sl([vt(dt*u,-g)])+Ni("c",[vt(dt*u/4,-(E/2)),vt(dt*u/2,-E),vt(dt*u,-E)])}const i=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,c=i/3,u=c/3,g=n/2,E=g/2,C=t(1),G=t(-1);return{type:this.SHAPES.NOTCH,width:i,height:n,pathLeft:C,pathRight:G}}makeInsideCorners(){const t=this.CORNER_RADIUS,i=He("a","0 0,0",t,vt(-t,t)),n=He("a","0 0,1",t,vt(-t,t)),c=He("a","0 0,0",t,vt(t,t)),u=He("a","0 0,1",t,vt(t,t));return{width:t,height:t,pathTop:i,pathBottom:c,rightWidth:t,rightHeight:t,pathTopRight:n,pathBottomRight:u}}generateSecondaryColour_(t){return Jn("#000",t,.15)||t}generateTertiaryColour_(t){return Jn("#000",t,.25)||t}createDom(t,i,n){super.createDom(t,i,n),t=A(x.DEFS,{},t),i=A(x.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),A(x.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},i),n=A(x.FECOMPONENTTRANSFER,{result:"outBlur"},i),A(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),A(x.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},i),A(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},i),this.selectedGlowFilterId=i.id,this.selectedGlowFilter=i,t=A(x.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),A(x.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),i=A(x.FECOMPONENTTRANSFER,{result:"outBlur"},t),A(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),A(x.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),A(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),A(x.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter=t}getCSS_(t){return[`${t} .blocklyText,`,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${t} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text,`,`${t} .blocklyNonEditableText>g>text,`,`${t} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${t} .blocklyDropdownText {`,"fill: #fff !important;","}",`${t}.blocklyWidgetDiv .goog-menuitem,`,`${t}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${t} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${t} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},ES=class extends ca{constructor(t,i){super(t,i)}draw(){const t=this.block_.pathObject;t.beginDrawing(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(t){if(!(0>=t.height)){if(L.isSpacer(t)){const c=t.precedesStatement;var i=t.followsStatement;if(c||i){const u=this.constants_.INSIDE_CORNERS;var n=u.rightHeight;n=t.height-(c?n:0),i=i?u.pathBottomRight:"",t=0<n?$t("V",t.yPos+n):"",this.outlinePath_+=i+t+(c?u.pathTopRight:"");return}}this.outlinePath_+=$t("V",t.yPos+t.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=ke(t.xPos,this.info_.startY),this.outlinePath_+=$t("h",t.width)}drawFlatBottom_(){const t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=$t("V",t.baseline),this.outlinePath_+=$t("h",-t.width)}drawInlineInput_(t){this.positionInlineInputConnection_(t);const i=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var n=t.width-2*t.connectionWidth;t=ti(t.xPos+t.connectionWidth,t.centerline-t.height/2)+$t("h",n)+t.shape.pathRightDown(t.height)+$t("h",-n)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(i,t)}}drawStatementInput_(t){var i=t.getLastInput();const n=i.xPos+i.notchOffset+i.shape.width,c=this.constants_.INSIDE_CORNERS,u=i.shape.pathRight+$t("h",-(i.notchOffset-c.width))+c.pathTop,g=t.height-2*c.height;i=c.pathBottom+$t("h",i.notchOffset-c.width)+(i.connectedBottomNextConnection?"":i.shape.pathLeft),this.outlinePath_+=$t("H",n)+u+$t("v",g)+i+$t("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}},br=class extends Kt{constructor(t,i,n,c,u,g,E){if(super(Kt.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",n=Number(Pe(n)),i=Number(Pe(i)),isNaN(n)||isNaN(i))throw Error("Height and width values of an image field must cast to numbers.");if(0>=n||0>=i)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Ee(i,n+br.Y_PADDING),this.imageHeight=n,typeof u=="function"&&(this.clickHandler=u),t!==Kt.SKIP_SETUP&&(E?this.configure_(E):(this.flipRtl=!!g,this.altText=Pe(c)||""),this.setValue(Pe(t)))}configure_(t){super.configure_(t),t.flipRtl&&(this.flipRtl=t.flipRtl),t.alt&&(this.altText=Pe(t.alt))}initView(){this.imageElement=A(x.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(os,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(t){return typeof t!="string"?null:t}doValueUpdate_(t){this.value_=t,this.imageElement&&this.imageElement.setAttributeNS(os,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(t){t!==this.altText&&(this.altText=t||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(t){this.clickHandler=t}getText_(){return this.altText}static fromJson(t){if(!t.src||!t.width||!t.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(t.src,t.width,t.height,void 0,void 0,void 0,t)}};br.Y_PADDING=1,Vi("field_image",br),br.prototype.DEFAULT_VALUE="";var ga=class extends Kt{constructor(t,i,n){super(Kt.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.spellcheck!==void 0&&(this.spellcheck_=t.spellcheck)}initView(){if(!this.getSourceBlock())throw new me;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new me;let i;return this.fullBlockClickTarget_=!((i=this.getConstants())==null||!i.FULL_BLOCK_FIELDS)&&t.isSimpleReporter()}doValueInvalid_(t){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&Dt()&&at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,t,this.value_)))}doValueUpdate_(t){this.isTextValid_=this.isDirty_=!0,this.value_=t}applyColour(){const t=this.getSourceBlock();if(!t)throw new me;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",t.style.colourTertiary)):(this.borderRect_.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let t;return(t=this.getConstants())!=null&&t.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){if(super.render_(),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(ft(t,"blocklyInvalidInput"),we(t,ve.INVALID,!1)):(X(t,"blocklyInvalidInput"),we(t,ve.INVALID,!0))}if(t=this.getSourceBlock(),!t)throw new me;this.getConstants().FULL_BLOCK_FIELDS&&t.applyColour()}setSpellcheck(t){t!==this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(t,i=!1){this.workspace_=this.sourceBlock_.workspace,!i&&this.workspace_.options.modalInputs&&(Zf||yu||fl)?this.showPromptEditor_():this.showInlineEditor_(i)}showPromptEditor_(){Hh(s.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),t=>{t!==null&&this.setValue(this.getValueFromEditorText_(t)),this.onFinishEditing_(this.value_)})}showInlineEditor_(t){const i=this.getSourceBlock();if(!i)throw new me;Jh(this,i.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var t=this.getSourceBlock();if(!t)throw new me;s.setGroup$$module$build$src$core$events$utils(!0);const i=jn();var n=this.getClickTarget_();if(!n)throw Error("A click target has not been set.");X(n,"editing"),n=document.createElement("input"),n.className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);const c=this.workspace_.getScale();var u=this.getConstants().FIELD_TEXT_FONTSIZE*c+"pt";return i.style.fontSize=u,n.style.fontSize=u,u=ga.BORDERRADIUS*c+"px",this.isFullBlockField()&&(u=this.getScaledBBox(),u=(u.bottom-u.top)/2+"px",t=t.getParent()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,n.style.border=1*c+"px solid "+t,i.style.borderRadius=u,i.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(i.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*c+"px")),n.style.borderRadius=u,i.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(n),n}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&Dt()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(at(new(pt(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),s.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var t=jn().style;if(t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,t=this.getClickTarget_(),!t)throw Error("A click target has not been set.");ft(t,"editing")}onFinishEditing_(t){}bindInputEvents_(t){this.onKeyDownWrapper_=y(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=y(t,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(H(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(H(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(t){t.key==="Enter"?(ss(),_s()):t.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),ss(),_s()):t.key==="Tab"&&(ss(),_s(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())}onHtmlInputChange_(t){t=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&Dt()&&this.value_!==t&&at(new(pt(ln))(this.sourceBlock_,this.name||null,t,this.value_)),Yr().then(()=>{this.resizeEditor_()})}setEditorValue_(t,i=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t,i)}resizeEditor_(){var t=this.getSourceBlock();if(!t)throw new me;const i=jn(),n=this.getScaledBBox();i.style.width=n.right-n.left+"px",i.style.height=n.bottom-n.top+"px",t=new lt(t.RTL?n.right-i.offsetWidth:n.left,n.top),i.style.left=t.x+"px",i.style.top=t.y+"px"}repositionForWindowResize(){const t=this.getSourceBlock();return t instanceof Js?(nl(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t),this.resizeEditor_(),!0):!1}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(t){return`${t}`}getValueFromEditorText_(t){return t}};ga.BORDERRADIUS=4;var xl=class extends ga{constructor(t,i,n){super(t,i,n)}doClassValidation_(t){return t===void 0?null:`${t}`}static fromJson(t){return new this(Pe(t.text),void 0,t)}};Vi("field_input",xl),xl.prototype.DEFAULT_VALUE="";var vS=class extends Hm{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){return!!t.outputConnection}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},sd=class extends oa{constructor(t,i){if(super(t,i),this.connectedBottomNextConnection=!1,this.connectedBlock){for(t=this.connectedBlock;i=t.getNextBlock();)t=i;t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},IS=class extends Ys{constructor(t){super(t),this.width=this.height=0,this.type|=L.getType("RIGHT_CONNECTION")}},SS=class extends Xm{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){const i=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||i}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},yS=class extends Al{constructor(t,i){super(t,i),this.isInline=!0,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.topRow=new SS(this.constants_),this.bottomRow=new vS(this.constants_),this.isMultiRow=!i.getInputsInline()||i.isCollapsed(),this.hasStatementInput=0<i.statementInputCount,this.rightSide=this.outputConnection?new IS(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(t,i){return i?i instanceof Lo||t instanceof zi||i instanceof zi?!0:t instanceof s.ValueInput$$module$build$src$core$inputs$value_input||t instanceof js||t instanceof Lo?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(t)}getInRowSpacing_(t,i){return t&&i||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&i&&L.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&L.isLeftRoundedCorner(t)&&i&&(L.isPreviousConnection(i)||L.isNextConnection(i))?i.notchOffset-this.constants_.CORNER_RADIUS:t&&L.isLeftSquareCorner(t)&&i&&L.isHat(i)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(t,i){if(L.isTopRow(t)&&L.isBottomRow(i))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const n=L.isInputRow(t)&&t.hasStatement,c=L.isInputRow(i)&&i.hasStatement;return c||n?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),c&&n?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):L.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):L.isBottomRow(i)?this.outputConnection?!i.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(t,i){const n=this.width-this.startX;return L.isInputRow(t)&&t.hasStatement||L.isInputRow(i)&&i.hasStatement?Math.max(n,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):n}getElemCenterline_(t,i){if(t.hasStatement&&!L.isSpacer(i)&&!L.isStatementInput(i))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(L.isInlineInput(i)&&i instanceof mn){const n=i.connectedBlock;if(n&&n.outputConnection&&n.nextConnection)return t.yPos+n.height/2}return super.getElemCenterline_(t,i)}addInput_(t,i){if((t instanceof js||t instanceof Lo)&&i.hasDummyInput&&i.align===s.Align$$module$build$src$core$inputs$align.LEFT&&t.align===s.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(i,t);else if(t instanceof zi){i.elements.push(new sd(this.constants_,t)),i.hasStatement=!0,i.align===null&&(i.align=t.align);return}super.addInput_(t,i)}addAlignmentPadding_(t,i){if(this.rightAlignedDummyInputs.get(t)){let n;for(let c=0;c<t.elements.length;c++){const u=t.elements[c];if(L.isSpacer(u)&&(n=u),L.isField(u)&&u instanceof Ol&&u.parentInput===this.rightAlignedDummyInputs.get(t))break}if(n){n.width+=i,t.width+=i;return}}super.addAlignmentPadding_(t,i)}adjustXPosition_(){const t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let i=t;for(let u=2;u<this.rows.length-1;u+=2){var n=this.rows[u-1];const g=this.rows[u];var c=this.rows[u+1];if(n=u===2?!!this.topRow.hasPreviousConnection:!!n.followsStatement,c=u+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!c.precedesStatement,L.isInputRow(g)&&g.hasStatement){g.measure();let E,C;i=g.width-((C=(E=g.getLastInput())==null?void 0:E.width)!=null?C:0)+t}else if(n&&(u===2||c)&&L.isInputRow(g)&&!g.hasStatement){c=g.xPos,n=null;for(let E=0;E<g.elements.length;E++){const C=g.elements[E];L.isSpacer(C)&&(n=C),n&&(L.isField(C)||L.isInput(C))&&c<i&&!(L.isField(C)&&C instanceof Ol&&(C.field instanceof _r||C.field instanceof br))&&(n.width+=i-c),c+=C.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var t=this.outputConnection.shape;if("isDynamic"in t&&t.isDynamic){for(var i=0,n=0;n<this.rows.length;n++){const c=this.rows[n];c.yPos=i,i+=c.height}this.height=i,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,i=t.height(n),n=t.width(n),this.outputConnection.height=i,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=t.connectionOffsetY(i),this.outputConnection.connectionOffsetX=t.connectionOffsetX(n),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=n,this.rightSide.height=i,this.rightSide.width=t,this.rightSide.centerline=i/2,this.rightSide.xPos=this.width+t),this.startX=n,this.width+=n+t,this.widthWithChildren+=n+t}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t=0,i=0;i<this.rows.length;i++){var n=this.rows[i];if(!L.isInputRow(n))continue;t=n.elements[n.elements.length-2];let c=this.getNegativeSpacing_(n.elements[1]),u=this.getNegativeSpacing_(t);t=c+u;const g=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-t<g&&(t=this.width-g,c=t/2,u=t/2),n.elements.unshift(new Xi(this.constants_,-c)),n.elements.push(new Xi(this.constants_,-u))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,i=0;i<this.rows.length;i++)n=this.rows[i],L.isTopOrBottomRow(n)&&(n.elements[1].width-=t),n.width-=t,n.widthWithConnectedBlocks-=t}}getNegativeSpacing_(t){if(!t||!this.outputConnection)return 0;const i=this.outputConnection.width;var n=this.outputConnection.shape.type;const c=this.constants_;if(1<this.inputRows.length)switch(n){case c.SHAPES.ROUND:return n=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=this.height/2>n?n:this.height/2,i-n*(1-Math.sin(Math.acos((n-this.constants_.SMALL_PADDING)/n)));default:return 0}if(L.isInlineInput(t)&&t instanceof mn){const u=t.connectedBlock;return t=u?u.pathObject.outputShapeType:t.shape.type,t==null||u&&u.outputConnection&&(u.statementInputCount||u.nextConnection)||n===c.SHAPES.HEXAGONAL&&n!==t?0:i-this.constants_.SHAPE_IN_SHAPE_PADDING[n][t]}return L.isField(t)&&t instanceof Ol?n===c.SHAPES.ROUND&&t.field instanceof xl?i-2.75*c.GRID_UNIT:i-this.constants_.SHAPE_IN_SHAPE_PADDING[n][0]:L.isIcon(t)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let c=2;c<this.rows.length-1;c+=2){const u=this.rows[c-1],g=this.rows[c],E=this.rows[c+1];var t=c===2,i=c+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!E.precedesStatement;if(t?this.topRow.hasPreviousConnection:u.followsStatement){var n=g.elements[1];if(n=g.elements.length===3&&n instanceof Ol&&(n.field instanceof _r||n.field instanceof br),!t&&n)u.height-=this.constants_.SMALL_PADDING,E.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.MEDIUM_PADDING;else if(!t&&!i)u.height+=this.constants_.SMALL_PADDING;else if(i){for(t=!1,i=0;i<g.elements.length;i++)if(n=g.elements[i],n instanceof mn&&L.isInlineInput(n)&&n.connectedBlock&&!n.connectedBlock.isShadow()&&40<=n.connectedBlock.getHeightWidth().height){t=!0;break}t&&(u.height-=this.constants_.SMALL_PADDING,E.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},CS=class extends Ym{constructor(t,i,n){super(t,i,n),this.markerCircle=null}showWithInputOutput(t){const i=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle(t.x,t.y),this.setParent_(i),this.showCurrent_()}showWithOutput_(t){this.showWithInputOutput(t)}showWithInput_(t){this.showWithInputOutput(t)}showWithBlock_(t){t=t.getLocation();const i=t.getHeightWidth();this.positionRect_(0,0,i.width,i.height),this.setParent_(t),this.showCurrent_()}positionCircle(t,i){let n;(n=this.markerCircle)==null||n.setAttribute("cx",`${t}`);let c;(c=this.markerCircle)==null||c.setAttribute("cy",`${i}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=A(x.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();A(x.ANIMATE,t,this.markerCircle)}return this.markerSvg_}applyColour_(t){super.applyColour_(t);let i;(i=this.markerCircle)==null||i.setAttribute("fill",this.colour_);let n;if((n=this.markerCircle)==null||n.setAttribute("stroke",this.colour_),this.isCursor()){t=this.colour_+";transparent;transparent;";let c;(c=this.markerCircle)==null||c.firstElementChild.setAttribute("values",t)}}},wS=class extends Ju{constructor(t,i,n){super(t,i,n),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=n}setPath(t){super.setPath(t),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",t)}applyColour(t){super.applyColour(t);const i=t.getParent();t.isShadow()&&i&&this.svgPath.setAttribute("stroke",i.style.colourTertiary);for(const n of this.outlines.values())n.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const t of this.outlines.values())t.setAttribute("transform","scale(-1 1)")}updateSelected(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(t,i){t=t.getParentInput().name,(t=this.getOutlinePath(t))&&(i?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const t of this.outlines.keys())this.remainingOutlines.add(t)}endDrawing(){if(this.remainingOutlines.size)for(const t of this.remainingOutlines)this.removeOutlinePath(t);this.remainingOutlines.clear()}setOutlinePath(t,i){t=this.getOutlinePath(t),t.setAttribute("d",i),t.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(t){return this.outlines.has(t)||this.outlines.set(t,A(x.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(t),this.outlines.get(t)}removeOutlinePath(t){let i,n;(i=this.outlines.get(t))==null||(n=i.parentNode)==null||n.removeChild(this.outlines.get(t)),this.outlines.delete(t)}},kS=class extends aa{constructor(t){super(t)}makeConstants_(){return new bS}makeRenderInfo_(t){return new yS(this,t)}makeDrawer_(t,i){return new ES(t,i)}makeMarkerDrawer(t,i){return new CS(t,this.getConstants(),i)}makePathObject(t,i){return new wS(t,i,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(t){return t.type!==Et.INPUT_VALUE&&t.type!==Et.OUTPUT_VALUE}getConnectionPreviewMethod(t,i,n){return i.type===Et.OUTPUT_VALUE?t.isConnected()?Yi.PREVIEW_TYPE.REPLACEMENT_FADE:Yi.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(t,i,n)}};ol("zelos",kS);var Ss={};Ss.BottomRow=vS,Ss.ConstantProvider=bS,Ss.Drawer=ES,Ss.MarkerSvg=CS,Ss.PathObject=wS,Ss.RenderInfo=yS,Ss.Renderer=kS,Ss.RightConnectionShape=IS,Ss.StatementInput=sd,Ss.TopRow=SS,Gf();var yi={};yi.registerCleanup=Af,yi.registerCollapse=Nf,yi.registerCollapseExpandBlock=Ff,yi.registerComment=Pf,yi.registerDefaultOptions=Gf,yi.registerDelete=Uf,yi.registerDeleteAll=Df,yi.registerDisable=Hf,yi.registerDuplicate=xf,yi.registerExpand=Lf,yi.registerHelp=Vf,yi.registerInline=Bf,yi.registerRedo=Of,yi.registerUndo=kf;var Wt=class extends ga{constructor(t,i,n){super(Kt.SKIP_SETUP),this.clockwise=Wt.CLOCKWISE,this.offset=Wt.OFFSET,this.wrap=Wt.WRAP,this.round=Wt.ROUND,this.boundEvents=[],this.symbol_=this.gauge=this.line=null,t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){switch(super.configure_(t),t.mode){case od.COMPASS:this.clockwise=!0,this.offset=90;break;case od.PROTRACTOR:this.clockwise=!1,this.offset=0}t.clockwise&&(this.clockwise=t.clockwise),t.offset&&(this.offset=t.offset),t.wrap&&(this.wrap=t.wrap),t.round&&(this.round=t.round)}initView(){super.initView(),this.symbol_=A(x.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("°")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph()}showEditor_(t){super.showEditor_(t,Zf||yu||fl),t=this.dropdownCreate(),Zr().appendChild(t),this.sourceBlock_ instanceof Js&&Qh(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),Lc(this,this.dropdownDispose.bind(this)),this.updateGraph()}dropdownCreate(){const t=A(x.SVG,{xmlns:Cu,"xmlns:html":wo,"xmlns:xlink":os,version:"1.1",height:2*Wt.HALF+"px",width:2*Wt.HALF+"px"});t.style.touchAction="none";const i=A(x.CIRCLE,{cx:Wt.HALF,cy:Wt.HALF,r:Wt.RADIUS,class:"blocklyAngleCircle"},t);this.gauge=A(x.PATH,{class:"blocklyAngleGauge"},t),this.line=A(x.LINE,{x1:Wt.HALF,y1:Wt.HALF,class:"blocklyAngleLine"},t);for(let n=0;360>n;n+=15)A(x.LINE,{x1:Wt.HALF+Wt.RADIUS,y1:Wt.HALF,x2:Wt.HALF+Wt.RADIUS-(n%45===0?10:5),y2:Wt.HALF,class:"blocklyAngleMarks",transform:"rotate("+n+","+Wt.HALF+","+Wt.HALF+")"},t);return this.boundEvents.push(y(t,"click",this,this.hide)),this.boundEvents.push(y(i,"pointerdown",this,this.onMouseMove_,!0)),this.boundEvents.push(y(i,"pointermove",this,this.onMouseMove_,!0)),t}dropdownDispose(){for(const t of this.boundEvents)H(t);this.boundEvents.length=0,this.line=this.gauge=null}hide(){Qr(this),ss()}onMouseMove_(t){var i=this.gauge.ownerSVGElement.getBoundingClientRect();const n=t.clientX-i.left-Wt.HALF;t=t.clientY-i.top-Wt.HALF,i=Math.atan(-t/n),isNaN(i)||(i=Tg(i),0>n?i+=180:0<t&&(i+=360),i=this.clockwise?this.offset+360-i:360-(this.offset-i),this.displayMouseOrKeyboardValue(i))}displayMouseOrKeyboardValue(t){if(this.round&&(t=Math.round(t/this.round)*this.round),t=this.wrapValue(t),t!==this.value_){const i=this.value_;this.setEditorValue_(t,!1),this.sourceBlock_&&Dt()&&this.value_!==i&&at(new(pt(ln))(this.sourceBlock_,this.name||null,i,this.value_))}}updateGraph(){if(this.gauge&&this.line){var t=Number(this.getText())+this.offset,i=Jr(t%360);t=["M ",Wt.HALF,",",Wt.HALF];var n=Wt.HALF,c=Wt.HALF;if(!isNaN(i)){const u=Number(this.clockwise),g=Jr(this.offset),E=Math.cos(g)*Wt.RADIUS,C=Math.sin(g)*-Wt.RADIUS;u&&(i=2*g-i),n+=Math.cos(i)*Wt.RADIUS,c-=Math.sin(i)*Wt.RADIUS,i=Math.abs(Math.floor((i-g)/Math.PI)%2),u&&(i=1-i),t.push(" l ",E,",",C," A ",Wt.RADIUS,",",Wt.RADIUS," 0 ",i," ",u," ",n,",",c," z")}this.gauge.setAttribute("d",t.join("")),this.line.setAttribute("x2",`${n}`),this.line.setAttribute("y2",`${c}`)}}onHtmlInputKeyDown_(t){super.onHtmlInputKeyDown_(t);var i=this.getSourceBlock();if(!i)throw new me;let n=0;switch(t.key){case"ArrowLeft":n=i.RTL?1:-1;break;case"ArrowRight":n=i.RTL?-1:1;break;case"ArrowDown":n=-1;break;case"ArrowUp":n=1}n&&(i=this.getValue(),this.displayMouseOrKeyboardValue(i+n*this.round),t.preventDefault(),t.stopPropagation())}doClassValidation_(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue(t)}wrapValue(t){return t%=360,0>t&&(t+=360),t>this.wrap&&(t-=360),t}static fromJson(t){return new this(t.angle,void 0,t)}};Wt.HALF=50,Wt.RADIUS=Wt.HALF-1,Wt.CLOCKWISE=!1,Wt.OFFSET=0,Wt.WRAP=360,Wt.ROUND=15,Vi("field_angle",Wt),Wt.prototype.DEFAULT_VALUE=0,et(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: 0.8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: 0.8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`);var od;(function(t){t.COMPASS="compass",t.PROTRACTOR="protractor"})(od||(od={}));var Er=class extends Kt{constructor(t,i,n){super(Kt.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=Er.CHECK_CHAR,t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.checkCharacter&&(this.checkChar=t.checkCharacter)}saveState(){const t=this.saveLegacyState(Er);return t!==null?t:this.getValueBoolean()}initView(){super.initView();const t=this.getTextElement();X(t,"blocklyCheckbox"),t.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(t){this.checkChar=t||Er.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(t){return t===!0||t==="TRUE"?"TRUE":t===!1||t==="FALSE"?"FALSE":null}doValueUpdate_(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(t){return typeof t=="string"?t==="TRUE":!!t}static fromJson(t){return new this(t.checked,void 0,t)}};Er.CHECK_CHAR="✓",Vi("field_checkbox",Er),Er.prototype.DEFAULT_VALUE=!1;var Ki=class extends Kt{constructor(t,i,n){super(Kt.SKIP_SETUP),this.highlightedIndex=this.picker=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles=this.colours=null,this.columns=0,t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.colourOptions&&(this.colours=t.colourOptions),t.colourTitles&&(this.titles=t.colourTitles),t.columns&&(this.columns=t.columns)}initView(){this.size_=new Ee(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new me;const i=this.getConstants();return t.isSimpleReporter()&&!(i==null||!i.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const t=this.getSourceBlock();if(!t)throw new me;if(this.fieldGroup_){var i=this.borderRect_;if(!i)throw Error("The border rect has not been initialized");this.isFullBlockField()?(i.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getValue()),t.pathObject.svgPath.setAttribute("stroke","#fff")):(i.style.display="block",i.style.fill=this.getValue())}}getSize(){let t;return(t=this.getConstants())!=null&&t.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const t=this.getSourceBlock();if(!t)throw new me;t.applyColour()}updateSize_(t){var i=this.getConstants();this.isFullBlockField()?(t=2*(t??0),i=i.FIELD_TEXT_HEIGHT):(t=i.FIELD_COLOUR_DEFAULT_WIDTH,i=i.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=i,this.size_.width=t,this.positionBorderRect_()}doClassValidation_(t){return typeof t!="string"?null:on(t)}getText(){let t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t}setColours(t,i){return this.colours=t,i&&(this.titles=i),this}setColumns(t){return this.columns=t,this}showEditor_(){this.dropdownCreate(),Zr().appendChild(this.picker),Lc(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(t){t=(t=t.target)&&t.getAttribute("data-colour"),t!==null&&(this.setValue(t),Qr(this))}onKeyDown(t){let i=!0;var n;switch(t.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":(n=this.getHighlighted())&&(n=n.getAttribute("data-colour"),n!==null&&this.setValue(n)),_s();break;default:i=!1}i&&t.stopPropagation()}moveHighlightBy(t,i){if(this.highlightedIndex){var n=this.colours||Ki.COLOURS,c=this.columns||Ki.COLUMNS,u=this.highlightedIndex%c,g=Math.floor(this.highlightedIndex/c);u+=t,g+=i,0>t?0>u&&0<g?(u=c-1,g--):0>u&&(u=0):0<t?u>c-1&&g<Math.floor(n.length/c)-1?(u=0,g++):u>c-1&&u--:0>i?0>g&&(g=0):0<i&&g>Math.floor(n.length/c)-1&&(g=Math.floor(n.length/c)-1),this.setHighlightedCell(this.picker.childNodes[g].childNodes[u],g*c+u)}}onMouseMove(t){const i=(t=t.target)&&Number(t.getAttribute("data-index"));i!==null&&i!==this.highlightedIndex&&this.setHighlightedCell(t,i)}onMouseEnter(){let t;(t=this.picker)==null||t.focus({preventScroll:!0})}onMouseLeave(){var t;(t=this.picker)==null||t.blur(),(t=this.getHighlighted())&&ft(t,"blocklyColourHighlighted")}getHighlighted(){if(!this.highlightedIndex)return null;const t=this.columns||Ki.COLUMNS,i=this.picker.childNodes[Math.floor(this.highlightedIndex/t)];return i?i.childNodes[this.highlightedIndex%t]:null}setHighlightedCell(t,i){const n=this.getHighlighted();n&&ft(n,"blocklyColourHighlighted"),X(t,"blocklyColourHighlighted"),this.highlightedIndex=i,(t=t.getAttribute("id"))&&this.picker&&we(this.picker,ve.ACTIVEDESCENDANT,t)}dropdownCreate(){const t=this.columns||Ki.COLUMNS,i=this.colours||Ki.COLOURS,n=this.titles||Ki.TITLES,c=this.getValue(),u=document.createElement("table");u.className="blocklyColourTable",u.tabIndex=0,u.dir="ltr",$s(u,xi.GRID),we(u,ve.EXPANDED,!0),we(u,ve.ROWCOUNT,Math.floor(i.length/t)),we(u,ve.COLCOUNT,t);let g;for(let E=0;E<i.length;E++){E%t===0&&(g=document.createElement("tr"),$s(g,xi.ROW),u.appendChild(g));const C=document.createElement("td");g.appendChild(C),C.setAttribute("data-colour",i[E]),C.title=n[E]||i[E],C.id=Ct(),C.setAttribute("data-index",`${E}`),$s(C,xi.GRIDCELL),we(C,ve.LABEL,i[E]),we(C,ve.SELECTED,i[E]===c),C.style.backgroundColor=i[E],i[E]===c&&(C.className="blocklyColourSelected",this.highlightedIndex=E)}this.boundEvents.push(y(u,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(y(u,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(y(u,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(y(u,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(y(u,"keydown",this,this.onKeyDown,!1)),this.picker=u}dropdownDispose(){for(const t of this.boundEvents)H(t);this.boundEvents.length=0,this.highlightedIndex=this.picker=null}static fromJson(t){return new this(t.colour,void 0,t)}};Ki.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Ki.TITLES=[],Ki.COLUMNS=7,Ki.prototype.DEFAULT_VALUE=Ki.COLOURS[0],Vi("field_colour",Ki),et(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: 0.5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`);var OS=class extends _r{constructor(t,i,n){super(String(t??""),i,n),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(t){return new this(Pe(t.text),void 0,t)}};Vi("field_label_serializable",OS);var $$=class extends xl{constructor(t,i,n){super(Kt.SKIP_SETUP),this.textGroup=null,this.maxLines_=1/0,this.isOverflowedY_=!1,t!==Kt.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.maxLines&&this.setMaxLines(t.maxLines)}toXml(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t}fromXml(t){this.setValue(t.textContent.replace(/&#10;/g,`
`))}saveState(){const t=this.saveLegacyState($$);return t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(Kt,t)||this.setValue(t)}initView(){this.createBorderRect_(),this.textGroup=A(x.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const t=this.getSourceBlock();if(!t)throw new me;let i=this.getText();if(!i)return Kt.NBSP;const n=i.split(`
`);i="";const c=this.isOverflowedY_?this.maxLines_:n.length;for(let u=0;u<c;u++){let g=n[u];g.length>this.maxDisplayLength?g=g.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&u===c-1&&(g=g.substring(0,g.length-3)+"..."),g=g.replace(/\s/g,Kt.NBSP),i+=g,u!==c-1&&(i+=`
`)}return t.RTL&&(i+="‏"),i}doValueUpdate_(t){super.doValueUpdate_(t),this.value_!==null&&(this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_)}render_(){var t=this.getSourceBlock();if(!t)throw new me;for(var i,n=this.textGroup;i=n.firstChild;)n.removeChild(i);i=this.getDisplayText_().split(`
`);let c=0;for(let u=0;u<i.length;u++){const g=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;A(x.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:c+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},n).appendChild(document.createTextNode(i[u])),c+=g}this.isBeingEdited_&&(n=this.htmlInput_,this.isOverflowedY_?X(n,"blocklyHtmlTextAreaInputOverflowedY"):ft(n,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(t.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(ft(t,"blocklyInvalidInput"),we(t,ve.INVALID,!1)):(X(t,"blocklyInvalidInput"),we(t,ve.INVALID,!0)))}updateSize_(){var t=this.textGroup.childNodes;const i=this.getConstants().FIELD_TEXT_FONTSIZE,n=this.getConstants().FIELD_TEXT_FONTWEIGHT,c=this.getConstants().FIELD_TEXT_FONTFAMILY;let u=0,g=0;for(var E=0;E<t.length;E++){var C=Y(t[E],i,n,c);C>u&&(u=C),g+=this.getConstants().FIELD_TEXT_HEIGHT+(0<E?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(t=String(this.value_).split(`
`),E=A(x.TEXT,{class:"blocklyText blocklyMultilineText"}),C=0;C<t.length;C++){t[C].length>this.maxDisplayLength&&(t[C]=t[C].substring(0,this.maxDisplayLength)),E.textContent=t[C];const G=Y(E,i,n,c);G>u&&(u=G)}u+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(g+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,u+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",`${u}`),this.borderRect_.setAttribute("height",`${g}`)),this.size_.width=u,this.size_.height=g,this.positionBorderRect_()}showEditor_(t,i){super.showEditor_(t,i),this.forceRerender()}widgetCreate_(){const t=jn(),i=this.workspace_.getScale(),n=document.createElement("textarea");n.className="blocklyHtmlInput blocklyHtmlTextAreaInput",n.setAttribute("spellcheck",String(this.spellcheck_));var c=this.getConstants().FIELD_TEXT_FONTSIZE*i+"pt";t.style.fontSize=c,n.style.fontSize=c,n.style.borderRadius=xl.BORDERRADIUS*i+"px",c=this.getConstants().FIELD_BORDER_RECT_X_PADDING*i;const u=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*i/2;return n.style.padding=u+"px "+c+"px "+u+"px "+c+"px",c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n.style.lineHeight=c*i+"px",t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),n.setAttribute("data-old-value",""),Jf?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(n),n}setMaxLines(t){typeof t=="number"&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(t){t.key!=="Enter"&&super.onHtmlInputKeyDown_(t)}static fromJson(t){return new this(Pe(t.text),void 0,t)}};Vi("field_multilinetext",$$),et(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`);var _$=class extends ga{constructor(t,i,n,c,u,g){super(Kt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,t!==Kt.SKIP_SETUP&&(g?this.configure_(g):this.setConstraints(i,n,c),this.setValue(t),u&&this.setValidator(u))}configure_(t){super.configure_(t),this.setMinInternal(t.min),this.setMaxInternal(t.max),this.setPrecisionInternal(t.precision)}setConstraints(t,i,n){this.setMinInternal(t),this.setMaxInternal(i),this.setPrecisionInternal(n),this.setValue(this.getValue())}setMin(t){this.setMinInternal(t),this.setValue(this.getValue())}setMinInternal(t){t==null?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))}getMin(){return this.min_}setMax(t){this.setMaxInternal(t),this.setValue(this.getValue())}setMaxInternal(t){t==null?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))}getMax(){return this.max_}setPrecision(t){this.setPrecisionInternal(t),this.setValue(this.getValue())}setPrecisionInternal(t){this.precision_=Number(t)||0;let i=String(this.precision_);i.indexOf("e")!==-1&&(i=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=i.indexOf(".");this.decimalPlaces=n===-1?t?0:null:i.length-n-1}getPrecision(){return this.precision_}doClassValidation_(t){return t===null||(t=`${t}`.replace(/O/gi,"0"),t=t.replace(/,/g,""),t=t.replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),this.decimalPlaces!==null&&(t=Number(t.toFixed(this.decimalPlaces))),t)}widgetCreate_(){const t=super.widgetCreate_();return-1/0<this.min_&&(t.min=`${this.min_}`,we(t,ve.VALUEMIN,this.min_)),1/0>this.max_&&(t.max=`${this.max_}`,we(t,ve.VALUEMAX,this.max_)),t}static fromJson(t){return new this(t.value,void 0,void 0,void 0,void 0,t)}};Vi("field_number",_$),_$.prototype.DEFAULT_VALUE=0;var fa=class extends zs{constructor(t,i,n,c,u){super(Kt.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=fa.dropdownCreate,this.defaultVariableName=typeof t=="string"?t:"",this.size_=new Ee(0,0),t!==Kt.SKIP_SETUP&&(u?this.configure_(u):this.setTypes(n,c),i&&this.setValidator(i))}configure_(t){super.configure_(t),this.setTypes(t.variableTypes,t.defaultType)}initModel(){var t=this.getSourceBlock();if(!t)throw new me;this.variable||(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(t.getId()))}shouldAddBorderRect_(){const t=this.getSourceBlock();if(!t)throw new me;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||t.type!=="variables_get")}fromXml(t){var i=this.getSourceBlock();if(!i)throw new me;const n=t.getAttribute("id"),c=t.textContent,u=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(i=s.getOrCreateVariablePackage$$module$build$src$core$variables(i.workspace,n,c,u),u!==null&&u!==i.type)throw Error("Serialized variable type with id '"+i.getId()+"' had type "+i.type+", and does not match variable field that references it: "+Ps(t)+".");this.setValue(i.getId())}toXml(t){return this.initModel(),t.id=this.variable.getId(),t.textContent=this.variable.name,this.variable.type&&t.setAttribute("variabletype",this.variable.type),t}saveState(t){var i=this.saveLegacyState(fa);return i!==null||(this.initModel(),i={id:this.variable.getId()},t&&(i.name=this.variable.name,i.type=this.variable.type)),i}loadState(t){const i=this.getSourceBlock();if(!i)throw new me;this.loadLegacyState(fa,t)||(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(i.workspace,t.id||null,t.name,t.type||""),this.setValue(t.getId()))}setSourceBlock(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(t)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(t){if(t===null)return null;var i=this.getSourceBlock();if(!i)throw new me;return i=s.getVariable$$module$build$src$core$variables(i.workspace,t),i?(i=i.type,this.typeIsAllowed(i)?t:(console.warn("Variable type doesn't match this field!  Type was "+i),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)}doValueUpdate_(t){const i=this.getSourceBlock();if(!i)throw new me;this.variable=s.getVariable$$module$build$src$core$variables(i.workspace,t),super.doValueUpdate_(t)}typeIsAllowed(t){const i=this.getVariableTypes();if(!i)return!0;for(let n=0;n<i.length;n++)if(t===i[n])return!0;return!1}getVariableTypes(){var t=this.variableTypes;if(t===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(t=t||[""],t.length===0)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t}setTypes(t=null,i=""){if(Array.isArray(t)){let n=!1;for(let c=0;c<t.length;c++)t[c]===i&&(n=!0);if(!n)throw Error("Invalid default type '"+i+"' in the definition of a FieldVariable")}else if(t!==null)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=i,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(t,i){if(t=i.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t===wm){s.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(t===km){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(t)}referencesVariables(){return!0}static fromJson(t){return new this(Pe(t.variable),void 0,void 0,void 0,t)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const t=this.getText();let i=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var n=this.getVariableTypes(),c=0;c<n.length;c++){const u=this.sourceBlock_.workspace.getVariablesOfType(n[c]);i=i.concat(u)}for(i.sort(Xc.compareByName),n=[],c=0;c<i.length;c++)n[c]=[i[c].name,i[c].getId()];return n.push([s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,wm]),s.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&n.push([s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",t),km]),n}};Vi("field_variable",fa);var ys=class{constructor(t,i,n,c){this.workspace=t,this.targetWorkspace=i,this.isLabel_=c,this.onMouseUpWrapper=null,this.height=this.width=0,this.svgText=this.svgGroup=null,this.text=n.text,this.position=new lt(0,0),this.callbackKey=n.callbackKey||n.callbackkey,this.cssClass=n["web-class"]||null,this.info=n}createDom(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass&&(t+=" "+this.cssClass),this.svgGroup=A(x.G,{class:t},this.workspace.getCanvas());let i;this.isLabel_||(i=A(x.RECT,{class:"blocklyFlyoutButtonShadow",rx:ys.BORDER_RADIUS,ry:ys.BORDER_RADIUS,x:1,y:1},this.svgGroup)),t=A(x.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:ys.BORDER_RADIUS,ry:ys.BORDER_RADIUS},this.svgGroup);const n=A(x.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var c=Pe(this.text);this.workspace.RTL&&(c+="‏"),n.textContent=c,this.isLabel_&&(this.svgText=n,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const u=Ui(n,"fontSize"),g=Ui(n,"fontWeight"),E=Ui(n,"fontFamily");if(this.width=Mt(n,u,g,E),c=ge(c,u,g,E),this.height=c.height,!this.isLabel_){this.width+=2*ys.TEXT_MARGIN_X,this.height+=2*ys.TEXT_MARGIN_Y;let C;(C=i)==null||C.setAttribute("width",String(this.width));let G;(G=i)==null||G.setAttribute("height",String(this.height))}return t.setAttribute("width",String(this.width)),t.setAttribute("height",String(this.height)),n.setAttribute("x",String(this.width/2)),n.setAttribute("y",String(this.height/2-c.height/2+c.baseline)),this.updateTransform(),this.onMouseUpWrapper=y(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(t,i){this.position.x=t,this.position.y=i,this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&H(this.onMouseUpWrapper),this.svgGroup&&bt(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(t){(t=this.targetWorkspace.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(t=this.targetWorkspace.getButtonCallback(this.callbackKey))&&t(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};ys.TEXT_MARGIN_X=5,ys.TEXT_MARGIN_Y=2,ys.BORDER_RADIUS=4,et(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var AS=class extends r${constructor(t,i){super(t),this.flyout_=i}getBoundingBox_(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch{t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(t){const i=this.getBoundingBox_();return t=t?1:this.workspace_.scale,{height:i.height*t,width:i.width*t,top:i.y*t,left:i.x*t}}getScrollMetrics(t,i,n){return i=n||this.getContentMetrics(),n=this.flyout_.MARGIN*this.workspace_.scale,t=t?this.workspace_.scale:1,{height:(i.height+2*n)/t,width:(i.width+i.left+n)/t,top:0,left:0}}},Pl;(function(t){t.BLOCK="block",t.BUTTON="button"})(Pl||(Pl={}));var nd=class extends Zu{constructor(t){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Is(t),this.workspace_.setMetricsManager(new AS(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=Ft(),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(t){return this.svgGroup_=A(t,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=A(x.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new n$(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(y(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper)),this.boundEvents.push(y(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ze.Capability.DELETE_AREA,Ze.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id);for(const t of this.boundEvents)H(t);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&bt(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}isVisible(){return this.isVisible_}setVisible(t){const i=t!==this.isVisible();this.isVisible_=t,i&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay())}setContainerVisible(t){const i=t!==this.containerVisible;this.containerVisible=t,i&&this.updateDisplay()}updateDisplay(){let t;t=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none");let i;(i=this.workspace_.scrollbar)==null||i.setContainerVisible(t)}positionAt_(t,i,n,c){let u;(u=this.svgGroup_)==null||u.setAttribute("width",`${t}`);let g;(g=this.svgGroup_)==null||g.setAttribute("height",`${i}`),this.workspace_.setCachedParentSvgSize(t,i),this.svgGroup_&&$(this.svgGroup_,"translate("+n+"px,"+c+"px)"),(t=this.workspace_.scrollbar)&&(t.setOrigin(n,c),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const t of this.listeners)H(t);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof t=="string"&&(t=this.getDynamicCategoryContents(t)),this.setVisible(!0),t=kc(t),t=this.createFlyoutInfo(t),xs(),this.layout_(t.contents,t.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(t){const i=[],n=[];this.permanentlyDisabled.length=0;const c=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const u of t){if("custom"in u){t=this.getDynamicCategoryContents(u.custom),t=kc(t);const{contents:g,gaps:E}=this.createFlyoutInfo(t);i.push(...g),n.push(...E)}switch(u.kind.toUpperCase()){case"BLOCK":t=u;const g=this.createFlyoutBlock(t);i.push({type:Pl.BLOCK,block:g}),this.addBlockGap(t,n,c);break;case"SEP":this.addSeparatorGap(u,n,c);break;case"LABEL":t=this.createButton(u,!0),i.push({type:Pl.BUTTON,button:t}),n.push(c);break;case"BUTTON":t=this.createButton(u,!1),i.push({type:Pl.BUTTON,button:t}),n.push(c)}}return{contents:i,gaps:n}}getDynamicCategoryContents(t){if(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t),typeof t!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return t(this.workspace_.targetWorkspace)}createButton(t,i){return new ys(this.workspace_,this.targetWorkspace,t,i)}createFlyoutBlock(t){let i;return t.blockxml?(t=typeof t.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,(i=this.getRecycledBlock(t.getAttribute("type")))||(i=tn(t,this.workspace_))):(i=this.getRecycledBlock(t.type),i||(t.enabled===void 0&&(t.enabled=t.disabled!=="true"&&t.disabled!==!0),i=Kr(t,this.workspace_))),i.isEnabled()||this.permanentlyDisabled.push(i),i}getRecycledBlock(t){let i=-1;for(let n=0;n<this.recycledBlocks.length;n++)if(this.recycledBlocks[n].type===t){i=n;break}return i===-1?void 0:this.recycledBlocks.splice(i,1)[0]}addBlockGap(t,i,n){let c;t.gap?c=parseInt(String(t.gap)):t.blockxml&&(t=typeof t.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,c=parseInt(t.getAttribute("gap"))),i.push(!c||isNaN(c)?n:c)}addSeparatorGap(t,i,n){t=parseInt(String(t.gap)),!isNaN(t)&&0<i.length?i[i.length-1]=t:i.push(n)}clearOldBlocks(){var t=this.workspace_.getTopBlocks(!1);for(let n=0,c;c=t[n];n++)this.blockIsRecyclable_(c)?this.recycleBlock(c):c.dispose(!1,!1);for(t=0;t<this.mats.length;t++){const n=this.mats[t];n&&(Vg(n),bt(n))}this.mats.length=0;for(let n=0,c;c=this.buttons_[n];n++)c.dispose();this.buttons_.length=0;let i;(i=this.workspace_.getPotentialVariableMap())==null||i.clear()}emptyRecycledBlocks(){for(let t=0;t<this.recycledBlocks.length;t++)this.recycledBlocks[t].dispose();this.recycledBlocks=[]}blockIsRecyclable_(t){return!1}recycleBlock(t){const i=t.getRelativeToSurfaceXY();t.moveBy(-i.x,-i.y),this.recycledBlocks.push(t)}addBlockListeners_(t,i,n){this.listeners.push(y(t,"pointerdown",null,this.blockMouseDown(i))),this.listeners.push(y(n,"pointerdown",null,this.blockMouseDown(i))),this.listeners.push(D(t,"pointerenter",i,i.addSelect)),this.listeners.push(D(t,"pointerleave",i,i.removeSelect)),this.listeners.push(D(n,"pointerenter",i,i.addSelect)),this.listeners.push(D(n,"pointerleave",i,i.removeSelect))}blockMouseDown(t){return i=>{const n=this.targetWorkspace.getGesture(i);n&&(n.setStartBlock(t),n.handleFlyoutStart(i,this))}}onMouseDown(t){const i=this.targetWorkspace.getGesture(t);i&&i.handleFlyoutStart(t,this)}isBlockCreatable(t){return t.isEnabled()}createBlock(t){let i=null;s.disable$$module$build$src$core$events$utils();var n=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{i=this.placeNewBlock(t)}finally{s.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),t=Wh(this.targetWorkspace,n),Dt()){for(s.setGroup$$module$build$src$core$events$utils(!0),n=0;n<t.length;n++){const c=t[n];at(new(pt(cn))(c))}at(new(pt(s.CREATE$$module$build$src$core$events$utils))(i))}return this.autoClose?this.hide():this.filterForCapacity(),i}initFlyoutButton_(t,i,n){const c=t.createDom();t.moveTo(i,n),t.show(),this.listeners.push(y(c,"pointerdown",this,this.onMouseDown)),this.buttons_.push(t)}createRect_(t,i,n,c,u){return i=A(x.RECT,{"fill-opacity":0,x:i,y:n,height:c.height,width:c.width}),i.tooltip=t,xc(i),this.workspace_.getCanvas().insertBefore(i,t.getSvgRoot()),this.rectMap_.set(t,i),this.mats[u]=i}moveRectToBlock_(t,i){const n=i.getHeightWidth();t.setAttribute("width",String(n.width)),t.setAttribute("height",String(n.height)),i=i.getRelativeToSurfaceXY(),t.setAttribute("y",String(i.y)),t.setAttribute("x",String(this.RTL?i.x-n.width:i.x))}filterForCapacity(){const t=this.workspace_.getTopBlocks(!1);for(let i=0,n;n=t[i];i++)if(this.permanentlyDisabled.indexOf(n)===-1){const c=this.targetWorkspace.isCapacityAvailable(Tt(n));for(;n;)n.setEnabled(c),n=n.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(t){var i=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered");const n=Bs(t);return i.setResizesEnabled(!1),i=en(n,i),this.positionNewBlock(t,i),i}positionNewBlock(t,i){const n=this.targetWorkspace;var c=n.getOriginOffsetInPixels(),u=this.workspace_.getOriginOffsetInPixels();t=t.getRelativeToSurfaceXY(),t.scale(this.workspace_.scale),u=lt.sum(u,t),c=lt.difference(u,c),c.scale(1/n.scale),i.moveTo(new lt(c.x,c.y))}};nd.FlyoutItemType=Pl;var RS=class extends nd{constructor(t){super(t),this.horizontalLayout=!0}setMetrics_(t){if(this.isVisible()){var i=this.workspace_.getMetricsManager(),n=i.getScrollMetrics(),c=i.getViewMetrics();i=i.getAbsoluteMetrics(),typeof t.x=="number"&&(this.workspace_.scrollX=-(n.left+(n.width-c.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+i.left,this.workspace_.scrollY+i.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const i=t.getAbsoluteMetrics(),n=t.getViewMetrics();t=t.getToolboxMetrics();const c=this.toolboxPosition_===Pt.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?c?t.height:n.height-this.height_:c?0:n.height:c?0:n.height+i.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var i=this.getY();this.positionAt_(this.width_,this.height_,t,i)}}setBackgroundPath(t,i){const n=this.toolboxPosition_===Pt.TOP,c=["M 0,"+(n?0:this.CORNER_RADIUS)];n?(c.push("h",t+2*this.CORNER_RADIUS),c.push("v",i),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",-t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),c.push("h",t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",i),c.push("h",-t-2*this.CORNER_RADIUS)),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setX(this.RTL?1/0:0)}wheel_(t){var i=rt(t);if(i=i.x||i.y){const n=this.workspace_.getMetricsManager(),c=n.getScrollMetrics();i=n.getViewMetrics().left-c.left+i;let u;(u=this.workspace_.scrollbar)==null||u.setX(i),ss(),_s()}t.preventDefault(),t.stopPropagation()}layout_(t,i){this.workspace_.scale=this.targetWorkspace.scale;const n=this.MARGIN;let c=n+this.tabWidth_;this.RTL&&(t=t.reverse());for(let C=0,G;G=t[C];C++)if(G.type==="block"){var u=G.block,g=u.getDescendants(!1);for(let Ie=0,$e;$e=g[Ie];Ie++)$e.isInFlyout=!0;g=u.getSvgRoot();const dt=u.getHeightWidth();var E=u.outputConnection?this.tabWidth_:0;E=this.RTL?c+dt.width:c-E,u.moveBy(E,n),E=this.createRect_(u,E,n,dt,C),c+=dt.width+i[C],this.addBlockListeners_(g,u,E)}else G.type==="button"&&(u=G.button,this.initFlyoutButton_(u,c,n),c+=u.width+i[C])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const i=this.dragAngleRange_;return t<90+i&&t>90-i||t>-90-i&&t<-90+i}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),i=t.top;return this.toolboxPosition_===Pt.TOP?new fe(-1e9,i+t.height,-1e9,1e9):new fe(i,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;const i=this.workspace_.getTopBlocks(!1);for(let c=0,u;u=i[c];c++)t=Math.max(t,u.getHeightWidth().height);const n=this.buttons_;for(let c=0,u;u=n[c];c++)t=Math.max(t,u.height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=Ue.scrollbarThickness,this.height_!==t){for(let c=0,u;u=i[c];c++)this.rectMap_.has(u)&&this.moveRectToBlock_(this.rectMap_.get(u),u);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Pt.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.recordDragTargets()}}};o(Q.FLYOUTS_HORIZONTAL_TOOLBOX,Eo,RS);var T$=class extends nd{constructor(t){super(t)}setMetrics_(t){if(this.isVisible()){var i=this.workspace_.getMetricsManager(),n=i.getScrollMetrics(),c=i.getViewMetrics();i=i.getAbsoluteMetrics(),typeof t.y=="number"&&(this.workspace_.scrollY=-(n.top+(n.height-c.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+i.left,this.workspace_.scrollY+i.top)}}getX(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const i=t.getAbsoluteMetrics(),n=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Pt.LEFT?t.width:n.width-this.width_:this.toolboxPosition_===Pt.LEFT?0:n.width:this.toolboxPosition_===Pt.LEFT?0:n.width+i.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var i=this.getY();this.positionAt_(this.width_,this.height_,t,i)}}setBackgroundPath(t,i){const n=this.toolboxPosition_===Pt.RIGHT;var c=t+this.CORNER_RADIUS;c=["M "+(n?c:0)+",0"],c.push("h",n?-t:t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",Math.max(0,i)),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",n?t:-t),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setY(0)}wheel_(t){var i=rt(t);if(i.y){const n=this.workspace_.getMetricsManager(),c=n.getScrollMetrics();i=n.getViewMetrics().top-c.top+i.y;let u;(u=this.workspace_.scrollbar)==null||u.setY(i),ss(),_s()}t.preventDefault(),t.stopPropagation()}layout_(t,i){this.workspace_.scale=this.targetWorkspace.scale;var n=this.MARGIN;const c=this.RTL?n:n+this.tabWidth_;for(let C=0,G;G=t[C];C++)if(G.type==="block"){var u=G.block,g=u.getDescendants(!1);for(let Ie=0,$e;$e=g[Ie];Ie++)$e.isInFlyout=!0;g=u.getSvgRoot();const dt=u.getHeightWidth();var E=u.outputConnection?c-this.tabWidth_:c;u.moveBy(E,n),E=this.createRect_(u,this.RTL?E-dt.width:E,n,dt,C),this.addBlockListeners_(g,u,E),n+=dt.height+i[C]}else G.type==="button"&&(u=G.button,this.initFlyoutButton_(u,c,n),n+=u.height+i[C])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const i=this.dragAngleRange_;return t<i&&t>-i||t<-180+i||t>180-i}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),i=t.left;return this.toolboxPosition_===Pt.LEFT?new fe(-1e9,1e9,-1e9,i+t.width):new fe(-1e9,1e9,i,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;var i=this.workspace_.getTopBlocks(!1);for(let c=0,u;u=i[c];c++){var n=u.getHeightWidth().width;u.outputConnection&&(n-=this.tabWidth_),t=Math.max(t,n)}for(let c=0,u;u=this.buttons_[c];c++)t=Math.max(t,u.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,t+=Ue.scrollbarThickness,this.width_!==t){for(let c=0,u;u=i[c];c++){if(this.RTL){n=u.getRelativeToSurfaceXY().x;let g=t/this.workspace_.scale-this.MARGIN;u.outputConnection||(g-=this.tabWidth_),u.moveBy(g-n,0)}this.rectMap_.has(u)&&this.moveRectToBlock_(this.rectMap_.get(u),u)}if(this.RTL)for(let c=0,u;u=this.buttons_[c];c++)i=u.getPosition().y,u.moveTo(t/this.workspace_.scale-u.width-this.MARGIN-this.tabWidth_,i);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Pt.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.recordDragTargets()}}};T$.registryName="verticalFlyout",o(Q.FLYOUTS_VERTICAL_TOOLBOX,Eo,T$);var NS;s.CodeGenerator$$module$build$src$core$generator=class{constructor(t){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=N());var i=[];this.init(t),t=t.getTopBlocks(!0);for(let n=0,c;c=t[n];n++){let u=this.blockToCode(c);Array.isArray(u)&&(u=u[0]),u&&(c.outputConnection&&(u=this.scrubNakedValue(u),this.STATEMENT_PREFIX&&!c.suppressPrefixSuffix&&(u=this.injectId(this.STATEMENT_PREFIX,c)+u),this.STATEMENT_SUFFIX&&!c.suppressPrefixSuffix&&(u+=this.injectId(this.STATEMENT_SUFFIX,c))),i.push(u))}return i=i.join(`
`),i=this.finish(i),i=i.replace(/^\s+\n/,""),i=i.replace(/\n\s+$/,`
`),i=i.replace(/[ \t]+\n/g,`
`)}prefixLines(t,i){return i+t.replace(/(?!\n$)\n/g,`
`+i)}allNestedComments(t){const i=[];t=t.getDescendants(!0);for(let n=0;n<t.length;n++){const c=t[n].getCommentText();c&&i.push(c)}return i.length&&i.push(""),i.join(`
`)}blockToCode(t,i){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return i?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return i?"":this.blockToCode(t.getChildren(!1)[0]);var n=this.forBlock[t.type];if(!n&&this[t.type]&&(ut("block generator functions on CodeGenerator objects","10.0","11.0","the .forBlock[blockType] dictionary"),n=this[t.type]),typeof n!="function")throw Error(`${this.name_} generator does not know how to generate codefor block type "${t.type}".`);if(n=n.call(t,t,this),Array.isArray(n)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,n[0],i),n[1]]}if(typeof n=="string")return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,t)+n),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,n,i);if(n===null)return"";throw SyntaxError("Invalid code generated: "+n)}valueToCode(t,i,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+t.type);var c=t.getInputTargetBlock(i);if(!c||(i=this.blockToCode(c),i===""))return"";if(!Array.isArray(i))throw TypeError(`Expecting tuple from value block: ${c.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(t=i[0],i=i[1],isNaN(i))throw TypeError("Expecting valid order from value block: "+c.type);if(!t)return"";c=!1;var u=Math.floor(n);const g=Math.floor(i);if(u<=g&&(u!==g||u!==0&&u!==99)){for(c=!0,u=0;u<this.ORDER_OVERRIDES.length;u++)if(this.ORDER_OVERRIDES[u][0]===n&&this.ORDER_OVERRIDES[u][1]===i){c=!1;break}}return c&&(t="("+t+")"),t}statementToCode(t,i){if(t=t.getInputTargetBlock(i),i=this.blockToCode(t),typeof i!="string")throw TypeError("Expecting code from statement block: "+(t&&t.type));return i&&(i=this.prefixLines(i,this.INDENT)),i}addLoopTrap(t,i){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,i),this.INDENT)+t),this.STATEMENT_SUFFIX&&!i.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,i),this.INDENT)+t),this.STATEMENT_PREFIX&&!i.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,i),this.INDENT)),t}injectId(t,i){return i=i.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+i+"'")}addReservedWords(t){this.RESERVED_WORDS_+=t+","}provideFunction_(t,i){if(!this.definitions_[t]){const n=this.nameDB_.getDistinctName(t,s.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=n,Array.isArray(i)&&(i=i.join(`
`)),i=i.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);let c;for(;c!==i;)c=i,i=i.replace(/^(( {2})*) {2}/gm,"$1\0");i=i.replace(/\0/g,this.INDENT),this.definitions_[t]=i}return this.functionNames_[t]}getVariableName(t){return this.getName(t,s.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(t){return this.getName(t,s.NameType$$module$build$src$core$names.PROCEDURE)}getName(t,i){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(t,i)}init(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(t,i,n){return i}finish(t){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),t}scrubNakedValue(t){return t}},NS={},NS.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator;var LS=!1,_n={};_n.Align=s.Align$$module$build$src$core$inputs$align,_n.DummyInput=js,_n.EndRowInput=Lo,_n.Input=Ks,_n.StatementInput=zi,_n.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input,_n.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types;var MS=class extends la{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(t){return super.getCSS_(t).concat([`${t} .blocklyInsertionMarker>.blocklyPathLight,`,`${t} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},DS=class{constructor(t){this.inlineSteps_=this.steps_="",this.info_=t,this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(t){this.steps_+=ke(t.xPos,this.info_.startY);for(let i=0,n;n=t.elements[i];i++)L.isLeftSquareCorner(n)?this.steps_+=this.highlightConstants_.START_POINT:L.isLeftRoundedCorner(n)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):L.isPreviousConnection(n)?this.steps_+=this.notchPaths_.pathLeft:L.isHat(n)?this.steps_+=this.startPaths_.path(this.RTL_):L.isSpacer(n)&&n.width!==0&&(this.steps_+=$t("H",n.xPos+n.width-this.highlightOffset));this.steps_+=$t("H",t.xPos+t.width-this.highlightOffset)}drawJaggedEdge_(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+$t("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(t){const i=t.getLastInput();if(this.RTL_){const n=t.height-i.connectionHeight;this.steps_+=ti(i.xPos+i.width-this.highlightOffset,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+$t("v",n)}else this.steps_+=ti(i.xPos+i.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(t){const i=t.getLastInput();if(i)if(this.RTL_){const n=t.height-2*this.insideCornerPaths_.height;this.steps_+=ti(i.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+$t("v",n)+this.insideCornerPaths_.pathBottom(this.RTL_)+Fs(t.width-i.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=ti(i.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Fs(t.width-i.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(t){const i=t.xPos+t.width-this.highlightOffset;t instanceof Wm&&t.followsStatement&&(this.steps_+=$t("H",i)),this.RTL_&&(this.steps_+=$t("H",i),t.height>this.highlightOffset&&(this.steps_+=$t("V",t.yPos+t.height-this.highlightOffset)))}drawBottomRow(t){if(this.RTL_)this.steps_+=$t("V",t.baseline-this.highlightOffset);else{const i=this.info_.bottomRow.elements[0];L.isLeftSquareCorner(i)?this.steps_+=ti(t.xPos+this.highlightOffset,t.baseline-this.highlightOffset):L.isLeftRoundedCorner(i)&&(this.steps_+=ti(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=ti(this.info_.startX,t):(this.steps_+=ti(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=$t("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,L.isLeftRoundedCorner(t.elements[0])?this.steps_+=$t("V",this.outsideCornerPaths_.height):this.steps_+=$t("V",t.capline+this.highlightOffset))}drawInlineInput(t){const i=this.highlightOffset,n=t.xPos+t.connectionWidth;var c=t.centerline-t.height/2;const u=t.width-t.connectionWidth,g=c+i;this.RTL_?(c=t.connectionOffsetY-i,t=t.height-(t.connectionOffsetY+t.connectionHeight)+i,this.inlineSteps_+=ti(n-i,g)+$t("v",c)+this.puzzleTabPaths_.pathDown(this.RTL_)+$t("v",t)+$t("h",u)):this.inlineSteps_+=ti(t.xPos+t.width+i,g)+$t("v",t.height)+$t("h",-u)+ti(n,c+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},xS=class extends ca{constructor(t,i){super(t,i),this.highlighter_=new DS(i)}draw(){this.drawOutline_(),this.drawInternals_();const t=this.block_.pathObject;t.setPath(this.outlinePath_+`
`+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(t){this.highlighter_.drawJaggedEdge_(t),super.drawJaggedEdge_(t)}drawValueInput_(t){this.highlighter_.drawValueInput(t),super.drawValueInput_(t)}drawStatementInput_(t){this.highlighter_.drawStatementInput(t),super.drawStatementInput_(t)}drawRightSideRow_(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=$t("H",t.xPos+t.width)+$t("V",t.yPos+t.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(t){this.highlighter_.drawInlineInput(t),super.drawInlineInput_(t)}positionInlineInputConnection_(t){const i=t.centerline-t.height/2;if(t.connectionModel){let n=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,i+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(t){const i=t.getLastInput();if(i!=null&&i.connectionModel){let n=t.xPos+t.statementEdge+i.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,i.connectionModel.setOffsetInBlock(n,t.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(t){const i=t.getLastInput();if(i&&i.connectionModel){let n=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),i.connectionModel.setOffsetInBlock(n,t.yPos)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const i=t.connection,n=i.xPos;i.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}}},PS=class{constructor(t){this.OFFSET=.5,this.constantProvider=t,this.START_POINT=ke(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const t=this.constantProvider.CORNER_RADIUS,i=this.OFFSET,n=(1-Math.SQRT1_2)*(t+i)-i,c=ke(n,n)+He("a","0 0,0",t,vt(-n-i,t-n)),u=He("a","0 0,0",t+i,vt(t+i,t+i)),g=ke(n,-n)+He("a","0 0,0",t+i,vt(t-n,n+i));return{width:t+i,height:t,pathTop(E){return E?c:""},pathBottom(E){return E?u:g}}}makeOutsideCorner(){const t=this.constantProvider.CORNER_RADIUS,i=this.OFFSET,n=(1-Math.SQRT1_2)*(t-i)+i,c=ke(n,n)+He("a","0 0,1",t-i,vt(t-n,-n+i)),u=ke(i,t)+He("a","0 0,1",t-i,vt(t,-t+i)),g=-n,E=ke(n,g)+He("a","0 0,1",t-i,vt(-n+i,-g-t));return{height:t,topLeft(C){return C?c:u},bottomLeft(){return E}}}makePuzzleTab(){const t=this.constantProvider.TAB_WIDTH,i=this.constantProvider.TAB_HEIGHT,n=ke(-2,-i+3.4)+Fs(-.45*t,-2.1),c=$t("v",2.5)+ke(.97*-t,2.5)+Ni("q",[vt(.05*-t,10),vt(.3*t,9.5)])+ke(.67*t,-1.9)+$t("v",2.5),u=$t("v",-1.5)+ke(-.92*t,-.5)+Ni("q",[vt(-.19*t,-5.5),vt(0,-11)])+ke(.92*t,1),g=ke(-5,i-.7)+Fs(.46*t,-2.1);return{width:t,height:i,pathUp(E){return E?n:u},pathDown(E){return E?c:g}}}makeNotch(){return{pathLeft:$t("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Fs(5.1,2.6)+ke(-10.2,6.8)+Fs(5.1,2.6),height:12,width:10.2}}makeStartHat(){const t=this.constantProvider.START_HAT.height,i=ke(25,-8.7)+Ni("c",[vt(29.7,-6.2),vt(57.2,-.5),vt(75,8.7)]),n=Ni("c",[vt(17.8,-9.2),vt(45.3,-14.9),vt(75,-8.7)])+ti(100.5,t+.5);return{path(c){return c?i:n}}}},BS=class extends Vm{constructor(t,i){super(t,i),this.constants_=t,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},FS=class extends oa{constructor(t,i){super(t,i),this.constants_=t,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},HS=class extends Al{constructor(t,i){super(t,i),this.renderer_=t}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof zi||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(t,i){this.isInline&&t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new BS(this.constants_,t)),i.hasInlineInput=!0):t instanceof zi?(i.elements.push(new FS(this.constants_,t)),i.hasStatement=!0):t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new ju(this.constants_,t)),i.hasExternalInput=!0):(t instanceof js||t instanceof Lo)&&(i.minHeight=Math.max(i.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),i.hasDummyInput=!0),this.isInline||i.align!==null||(i.align=t.align)}addElemSpacing_(){let t=!1;for(let n=0,c;c=this.rows[n];n++)c.hasExternalInput&&(t=!0);for(let n=0,c;c=this.rows[n];n++){var i=c.elements;if(c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new Xi(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let u=0;u<i.length-1;u++){c.elements.push(i[u]);const g=this.getInRowSpacing_(i[u],i[u+1]);c.elements.push(new Xi(this.constants_,g))}c.elements.push(i[i.length-1]),c.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),t&&c.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),c.elements.push(new Xi(this.constants_,i)))}}}getInRowSpacing_(t,i){if(!t)return i&&L.isField(i)&&i.isEditable?this.constants_.MEDIUM_PADDING:i&&L.isInlineInput(i)?this.constants_.MEDIUM_LARGE_PADDING:i&&L.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!L.isInput(t)&&(!i||L.isStatementInput(i)))return L.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:L.isIcon(t)?2*this.constants_.LARGE_PADDING+1:L.isHat(t)?this.constants_.NO_PADDING:L.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:L.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:L.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(L.isInput(t)&&!i){if(L.isExternalInput(t))return this.constants_.NO_PADDING;if(L.isInlineInput(t))return this.constants_.LARGE_PADDING;if(L.isStatementInput(t))return this.constants_.NO_PADDING}if(!L.isInput(t)&&i&&L.isInput(i)){if(L.isField(t)&&t.isEditable){if(L.isInlineInput(i)||L.isExternalInput(i))return this.constants_.SMALL_PADDING}else{if(L.isInlineInput(i)||L.isExternalInput(i))return this.constants_.MEDIUM_LARGE_PADDING;if(L.isStatementInput(i))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(L.isIcon(t)&&i&&!L.isInput(i))return this.constants_.LARGE_PADDING;if(L.isInlineInput(t)&&i&&L.isField(i))return i.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(L.isLeftSquareCorner(t)&&i){if(L.isHat(i))return this.constants_.NO_PADDING;if(L.isPreviousConnection(i))return i.notchOffset;if(L.isNextConnection(i))return i.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(L.isLeftRoundedCorner(t)&&i){if(L.isPreviousConnection(i))return i.notchOffset-this.constants_.CORNER_RADIUS;if(L.isNextConnection(i))return i.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return L.isField(t)&&i&&L.isField(i)&&t.isEditable===i.isEditable||i&&L.isJaggedEdge(i)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,i){return L.isTopRow(t)&&L.isBottomRow(i)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:L.isTopRow(t)||L.isBottomRow(i)?this.constants_.NO_PADDING:t.hasExternalInput&&i.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&i.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&i.hasStatement||!t.hasStatement&&i.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){if(L.isSpacer(i))return t.yPos+i.height/2;if(L.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,L.isNextConnection(i)?t+i.height/2:t-i.height/2;if(L.isTopRow(t))return L.isHat(i)?t.capline-i.height/2:t.capline+i.height/2;let n=t.yPos;return L.isField(i)||L.isIcon(i)?(n+=i.height/2,(t.hasInlineInput||t.hasStatement)&&i.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(n+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):n=L.isInlineInput(i)?n+i.height/2:n+t.height/2,n}alignRowElements_(){if(this.isInline){var t=0,i=new WeakMap,n=null;for(let c=this.rows.length-1,u;u=this.rows[c];c--)i.set(u,t),L.isInputRow(u)&&(u.hasStatement&&this.alignStatementRow_(u),n&&n.hasStatement&&u.width<n.width?i.set(u,n.width):t=u.hasStatement?u.width:Math.max(t,u.width),n=u);t=0;for(let c=0,u;u=this.rows[c];c++)u.hasStatement?t=this.getDesiredRowWidth_(u):L.isSpacer(u)?u.width=Math.max(t,i.get(u)):(n=u.width,t=Math.max(t,i.get(u))-n,0<t&&this.addAlignmentPadding_(u,t),t=u.width)}else super.alignRowElements_()}getDesiredRowWidth_(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(t)}finalize_(){let t=0,i=0;for(let c=0,u;u=this.rows[c];c++){u.yPos=i,u.xPos=this.startX,i+=u.height,t=Math.max(t,u.widthWithConnectedBlocks);var n=i-this.topRow.ascenderHeight;u===this.bottomRow&&n<this.constants_.MIN_BLOCK_HEIGHT&&(n=this.constants_.MIN_BLOCK_HEIGHT-n,this.bottomRow.height+=n,i+=n),this.recordElemPositions_(u)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,n.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=i-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=i+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},US=class extends Ju{constructor(t,i,n){super(t,i,n),this.constants=n,this.colourDark="#000000",this.svgPathDark=A(x.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=A(x.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)}setHighlightPath(t){this.svgPathLight.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(t){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(t),this.svgPath.setAttribute("stroke","none")}setStyle(t){this.style=t,this.colourDark=Jn("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(t){if(t){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(t){super.updateDisabled_(t),t&&this.svgPath.setAttribute("stroke","none")}},VS=class extends aa{constructor(t){super(t),this.highlightConstants=null}init(t,i){super.init(t,i),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(t,i){super.refreshDom(t,i),this.getHighlightConstants().init()}makeConstants_(){return new MS}makeRenderInfo_(t){return new HS(this,t)}makeDrawer_(t,i){return new xS(t,i)}makePathObject(t,i){return new US(t,i,this.getConstants())}makeHighlightConstants_(){return new PS(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};ol("geras",VS);var Qs={};Qs.ConstantProvider=MS,Qs.Drawer=xS,Qs.HighlightConstantProvider=PS,Qs.Highlighter=DS,Qs.InlineInput=BS,Qs.PathObject=US,Qs.RenderInfo=HS,Qs.Renderer=VS,Qs.StatementInput=FS;var GS=class extends la{constructor(){super(),ut("Blockly.minimalist.ConstantProvider","v10","v11","Blockly.blockRendering.ConstantProvider")}},WS=class extends ca{constructor(t,i){super(t,i),ut("Blockly.minimalist.Drawer","v10","v11","Blockly.blockRendering.Drawer")}},XS=class extends Al{constructor(t,i){super(t,i),ut("Blockly.minimalist.RenderInfo","v10","v11","Blockly.blockRendering.RenderInfo")}getRenderer(){return this.renderer_}},zS=class extends aa{constructor(t){super(t),ut("Blockly.minimalist.Renderer","v10","v11","Blockly.blockRendering.Renderer")}makeConstants_(){return new GS}makeRenderInfo_(t){return new XS(this,t)}makeDrawer_(t,i){return new WS(t,i)}};ol("minimalist",zS);var ma={};ma.ConstantProvider=GS,ma.Drawer=WS,ma.RenderInfo=XS,ma.Renderer=zS;var YS=class extends Al{constructor(t,i){super(t,i)}getRenderer(){return this.renderer_}addElemSpacing_(){let t=!1;for(var i=0;i<this.rows.length;i++)if(this.rows[i].hasExternalInput){t=!0;break}for(i=0;i<this.rows.length;i++){const c=this.rows[i];var n=c.elements;if(c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new Xi(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let u=0;u<n.length-1;u++){c.elements.push(n[u]);const g=this.getInRowSpacing_(n[u],n[u+1]);c.elements.push(new Xi(this.constants_,g))}c.elements.push(n[n.length-1]),c.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),t&&c.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),c.elements.push(new Xi(this.constants_,n)))}}}getInRowSpacing_(t,i){if(!t)return i&&L.isField(i)&&i.isEditable?this.constants_.MEDIUM_PADDING:i&&L.isInlineInput(i)?this.constants_.MEDIUM_LARGE_PADDING:i&&L.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!L.isInput(t)&&!i)return L.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:L.isIcon(t)?2*this.constants_.LARGE_PADDING+1:L.isHat(t)?this.constants_.NO_PADDING:L.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:L.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:L.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(L.isInput(t)&&!i){if(L.isExternalInput(t))return this.constants_.NO_PADDING;if(L.isInlineInput(t))return this.constants_.LARGE_PADDING;if(L.isStatementInput(t))return this.constants_.NO_PADDING}if(!L.isInput(t)&&i&&L.isInput(i)){if(L.isField(t)&&t.isEditable){if(L.isInlineInput(i)||L.isExternalInput(i))return this.constants_.SMALL_PADDING}else{if(L.isInlineInput(i)||L.isExternalInput(i))return this.constants_.MEDIUM_LARGE_PADDING;if(L.isStatementInput(i))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(L.isIcon(t)&&i&&!L.isInput(i))return this.constants_.LARGE_PADDING;if(L.isInlineInput(t)&&i&&L.isField(i))return i.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(L.isLeftSquareCorner(t)&&i){if(L.isHat(i))return this.constants_.NO_PADDING;if(L.isPreviousConnection(i)||L.isNextConnection(i))return i.notchOffset}return L.isLeftRoundedCorner(t)&&i?i.notchOffset-this.constants_.CORNER_RADIUS:L.isField(t)&&i&&L.isField(i)&&t.isEditable===i.isEditable||i&&L.isJaggedEdge(i)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,i){return L.isTopRow(t)&&L.isBottomRow(i)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:L.isTopRow(t)||L.isBottomRow(i)?this.constants_.NO_PADDING:t.hasExternalInput&&i.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&i.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&i.hasStatement||t.hasDummyInput||i.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){if(L.isSpacer(i))return t.yPos+i.height/2;if(L.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,L.isNextConnection(i)?t+i.height/2:t-i.height/2;if(L.isTopRow(t))return L.isHat(i)?t.capline-i.height/2:t.capline+i.height/2;let n=t.yPos;return n=L.isField(i)&&t.hasStatement?n+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+i.height/2):n+t.height/2}finalize_(){let t=0,i=0;for(var n=0;n<this.rows.length;n++){const u=this.rows[n];u.yPos=i,u.xPos=this.startX,i+=u.height,t=Math.max(t,u.widthWithConnectedBlocks);var c=i-this.topRow.ascenderHeight;u===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,i+=c),this.recordElemPositions_(u)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,n.getHeightWidth().width)),this.bottomRow.baseline=i-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=i,this.startY=this.topRow.capline}},KS=class extends aa{constructor(t){super(t)}makeRenderInfo_(t){return new YS(this,t)}};ol("thrasos",KS);var b$={};b$.RenderInfo=YS,b$.Renderer=KS;var DA={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},xA={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},PA=new fr("zelos",DA,xA),BA={Classic:Gu,Zelos:PA},E$=class{constructor(t,i,n){this.id_=t.toolboxitemid||Ct(),this.level_=(this.parent_=n||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=i,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(t){}},Cs=class extends E${constructor(t,i,n){super(t,i,n),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let i=0;i<t.length;i++){const n=t[i];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(n)}}parseCategoryDef_(t){this.name_="name"in t?Pe(t.name):"",this.colour_=this.getColour_(t),Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),$s(this.htmlDiv_,xi.TREEITEM),we(this.htmlDiv_,ve.SELECTED,!1),we(this.htmlDiv_,ve.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),$s(this.iconDom_,xi.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const t=this.labelDom_.getAttribute("id");return t&&we(this.htmlDiv_,ve.LABELLEDBY,t),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const t=document.createElement("div"),i=this.cssConfig_.container;return i&&X(t,i),t}createRowContainer_(){const t=document.createElement("div");var i=this.cssConfig_.row;return i&&X(t,i),i=`${Cs.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?t.style.paddingRight=i:t.style.paddingLeft=i,t}createRowContentsContainer_(){const t=document.createElement("div"),i=this.cssConfig_.rowcontentcontainer;return i&&X(t,i),t}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const i=this.cssConfig_.icon;i&&X(t,i)}return t.style.display="inline-block",t}createLabelDom_(t){const i=document.createElement("span");return i.setAttribute("id",this.getId()+".label"),i.textContent=t,(t=this.cssConfig_.label)&&X(i,t),i}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(t){t&&(t=Cs.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)}getColour_(t){const i=t.categorystyle||t.categoryStyle;if((t=t.colour)&&i)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(i)return this.getColourfromStyle_(i);if(t)return this.parseColour_(t)}return""}getColourfromStyle_(t){var i=this.workspace_.getTheme();if(t&&i){if((i=i.categoryStyles[t])&&i.colour)return this.parseColour_(i.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(t){if(t=Pe(t),t==null||t==="")return"";var i=Number(t);return isNaN(i)?(i=on(t))?i:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):jg(i)}openIcon_(t){if(t){var i=this.cssConfig_.closedicon;i&&kt(t,i),(i=this.cssConfig_.openicon)&&X(t,i)}}closeIcon_(t){if(t){var i=this.cssConfig_.openicon;i&&kt(t,i),(i=this.cssConfig_.closedicon)&&X(t,i)}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let t=this;for(;t.getParent();)if(t=t.getParent(),!t.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(t){}setSelected(t){if(this.rowDiv_){var i=this.cssConfig_.selected;if(t){const n=this.parseColour_(Cs.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||n,i&&X(this.rowDiv_,i)}else this.rowDiv_.style.backgroundColor="",i&&ft(this.rowDiv_,i);we(this.htmlDiv_,ve.SELECTED,t)}}setDisabled(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",`${t}`),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(t){this.flyoutItems_=[],this.toolboxItemDef_=typeof t=="string"?{kind:this.toolboxItemDef_.kind,custom:t,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:kc(t),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){bt(this.htmlDiv_)}};Cs.registrationName="category",Cs.nestedPadding=19,Cs.borderWidth=8,Cs.defaultBackgroundColour="#57e",et(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),o(Q.TOOLBOX_ITEM,Cs.registrationName,Cs);var $a=class extends E${constructor(t,i){super(t,i),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}init(){this.createDom_()}createDom_(){const t=document.createElement("div"),i=this.cssConfig_.container;return i&&X(t,i),this.htmlDiv_=t}getDiv(){return this.htmlDiv_}dispose(){bt(this.htmlDiv_)}};$a.registrationName="sep",et(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),o(Q.TOOLBOX_ITEM,$a.registrationName,$a);var Bl=class extends Cs{constructor(t,i,n){super(t,i,n),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const t=super.makeDefaultCssConfig_();return t.contents="blocklyToolboxContents",t}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{const i=t.contents;if(i){this.flyoutItems_=[],t=!0;for(let n=0;n<i.length;n++){const c=i[n];!d(Q.TOOLBOX_ITEM,c.kind)||c.kind.toLowerCase()===$a.registrationName&&t?(this.flyoutItems_.push(c),t=!0):(this.createToolboxItem_(c),t=!1)}}}}createToolboxItem_(t){let i=t.kind;i.toUpperCase()==="CATEGORY"&&Mh(t)&&(i=Bl.registrationName),t=new(p(Q.TOOLBOX_ITEM,i))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),$s(this.subcategoriesDiv_,xi.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),we(this.htmlDiv_,ve.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const i=this.cssConfig_.icon;i&&X(t,i),t.style.visibility="visible"}return t.style.display="inline-block",t}createSubCategoriesDom_(t){const i=document.createElement("div");i.style.display="none";var n=this.cssConfig_.contents;for(n&&X(i,n),n=0;n<t.length;n++){const c=t[n];c.init();const u=c.getDiv();if(i.appendChild(u),c.getClickTarget){let g;(g=c.getClickTarget())==null||g.setAttribute("id",c.getId())}}return i}setExpanded(t){if(this.expanded_!==t){if(this.expanded_=t)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let i;(i=this.parentToolbox_.getFlyout())==null||i.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}we(this.htmlDiv_,ve.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";const i=this.getChildToolboxItems();for(let n=0;n<i.length;n++)i[n].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(t){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Bl.registrationName="collapsibleCategory",o(Q.TOOLBOX_ITEM,Bl.registrationName,Bl);var jS=class extends Zu{constructor(t){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.RTL=t.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition}onShortcut(t){return!1}init(){var t=this.workspace_;const i=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),re(this.flyout_.createDom("svg"),i),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),t=t.getThemeManager(),t.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ze.Capability.AUTOHIDEABLE,Ze.Capability.DELETE_AREA,Ze.Capability.DRAG_TARGET]})}createDom_(t){t=t.getParentSvg();const i=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,$s(this.contentsDiv_,xi.TREE),i.appendChild(this.contentsDiv_),t.parentNode.insertBefore(i,t),this.attachEvents_(i,this.contentsDiv_),i}createContainer_(){const t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),X(t,"blocklyToolboxDiv"),X(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t}createContentsContainer_(){const t=document.createElement("div");return X(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t}attachEvents_(t,i){t=y(t,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(t),i=y(i,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(i)}onClick_(t){if(z(t)||t.target===this.HtmlDiv)N().hideChaff(!1);else{var i=t.target.getAttribute("id");i&&(i=this.getToolboxItemById(i),i.isSelectable()&&(this.setSelectedItem(i),i.onClick(t))),N().hideChaff(!0)}Te()}onKeyDown_(t){let i=!1;switch(t.key){case"ArrowDown":i=this.selectNext_();break;case"ArrowUp":i=this.selectPrevious_();break;case"ArrowLeft":i=this.selectParent_();break;case"ArrowRight":i=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),i=!0);break;default:i=!1}!i&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(i=this.selectedItem_.onKeyDown(t)),i&&t.preventDefault()}createFlyout_(){const t=this.workspace_,i=new rs({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return i.toolboxPosition=t.options.toolboxPosition,new(t.horizontalLayout?T(Q.FLYOUTS_HORIZONTAL_TOOLBOX,t.options,!0):T(Q.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(i)}render(t){this.toolboxDef_=t;for(let i=0;i<this.contents_.length;i++){const n=this.contents_[i];n&&n.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){const i=document.createDocumentFragment();for(let n=0;n<t.length;n++)this.createToolboxItem_(t[n],i);this.contentsDiv_.appendChild(i)}createToolboxItem_(t,i){var n=t.kind;n.toUpperCase()==="CATEGORY"&&Mh(t)&&(n=Bl.registrationName),(n=p(Q.TOOLBOX_ITEM,n.toLowerCase()))&&(t=new n(t,this),t.init(),this.addToolboxItem_(t),(n=t.getDiv())&&i.appendChild(n),t.getClickTarget()&&t.getClickTarget().setAttribute("id",t.getId()))}addToolboxItem_(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible()){t=t.getChildToolboxItems();for(let i=0;i<t.length;i++)this.addToolboxItem_(t[i])}}getToolboxItems(){return this.contents_}addStyle(t){t&&this.HtmlDiv&&X(this.HtmlDiv,t)}removeStyle(t){t&&this.HtmlDiv&&ft(this.HtmlDiv,t)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect();const i=t.top,n=i+t.height,c=t.left;return t=c+t.width,this.toolboxPosition===Pt.TOP?new fe(-1e7,n,-1e7,1e7):this.toolboxPosition===Pt.BOTTOM?new fe(i,1e7,-1e7,1e7):this.toolboxPosition===Pt.LEFT?new fe(-1e7,1e7,-1e7,t):new fe(-1e7,1e7,c,1e7)}wouldDelete(t,i){return t instanceof Js?this.updateWouldDelete_(!t.getParent()&&t.isDeletable()):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}onDragEnter(t){this.updateCursorDeleteStyle_(!0)}onDragExit(t){this.updateCursorDeleteStyle_(!1)}onDrop(t){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(t){const i=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(i):this.removeStyle(i)}getToolboxItemById(t){return this.contentMap_[t]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const t=this.workspace_.getMetrics(),i=this.HtmlDiv;i&&(this.horizontalLayout_?(i.style.left="0",i.style.height="auto",i.style.width="100%",this.height_=i.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition===Pt.TOP?i.style.top="0":i.style.bottom="0"):(this.toolboxPosition===Pt.RIGHT?i.style.right="0":i.style.left="0",i.style.height="100%",this.width_=i.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const t=this.workspace_,i=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition===Pt.LEFT?t.scrollX+i.width:t.scrollX,this.toolboxPosition===Pt.TOP?t.scrollY+i.height:t.scrollY),it(t)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let t=0;t<this.contents_.length;t++){const i=this.contents_[t];i.refreshTheme&&i.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())}autoHide(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(t){const i=this.selectedItem_;!t&&!i||t&&!Gv(t)||(this.shouldDeselectItem_(i,t)&&i!==null&&this.deselectItem_(i),this.shouldSelectItem_(i,t)&&t!==null&&this.selectItem_(i,t),this.updateFlyout_(i,t),this.fireSelectEvent_(i,t))}shouldDeselectItem_(t,i){return t!==null&&(!t.isCollapsible()||t!==i)}shouldSelectItem_(t,i){return i!==null&&i!==t}deselectItem_(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),we(this.contentsDiv_,ve.ACTIVEDESCENDANT,"")}selectItem_(t,i){this.selectedItem_=i,this.previouslySelectedItem_=t,i.setSelected(!0),we(this.contentsDiv_,ve.ACTIVEDESCENDANT,i.getId())}selectItemByPosition(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t],t.isSelectable()&&this.setSelectedItem(t))}updateFlyout_(t,i){i&&(t!==i||i.isCollapsible())&&i.getContents().length?(this.flyout_.show(i.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(t,i){const n=t&&t.getName();let c=i&&i.getName();t===i&&(c=null),t=new(pt(ul))(n,c,this.workspace_.id),at(t)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){let i=this.contents_[t];for(;i&&!i.isSelectable();)i=this.contents_[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){let i=this.contents_[t];for(;i&&!i.isSelectable();)i=this.contents_[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)H(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),bt(this.HtmlDiv))}};et(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),o(Q.TOOLBOX,Eo,jS);var FA="10.2.2",HA=s.Align$$module$build$src$core$inputs$align.LEFT,UA=s.Align$$module$build$src$core$inputs$align.CENTRE,VA=s.Align$$module$build$src$core$inputs$align.RIGHT,GA=Et.INPUT_VALUE,WA=Et.OUTPUT_VALUE,XA=Et.NEXT_STATEMENT,zA=Et.PREVIOUS_STATEMENT,YA=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,KA=Pt.TOP,jA=Pt.BOTTOM,JA=Pt.LEFT,qA=Pt.RIGHT;ha.prototype.newBlock=function(t,i){return new Nl(this,t,i)},Is.prototype.newBlock=function(t,i){return new Js(this,t,i)},Is.newTrashcan=function(t){return new dS(t)},si.prototype.showContextMenu=function(t){if(!this.workspace.options.readOnly){var i=[];this.isDeletable()&&this.isMovable()&&(i.push(_g(this)),i.push($g(this))),Rc(t,i,this.RTL)}},Ro.prototype.newWorkspaceSvg=function(t){return new Is(t)},s.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=uu(t),t=t[0].concat(t[1]);for(let i=0;i<t.length;i++)this.getName(t[i][0],s.Names$$module$build$src$core$names.NameType.PROCEDURE)};var ZA=Et,V={ALIGN_CENTRE:UA,ALIGN_LEFT:HA,ALIGN_RIGHT:VA};return V.ASTNode=K,V.BasicCursor=ua,V.Block=Nl,V.BlockDragger=TS,V.BlockSvg=Js,V.Blocks=Li,V.Bubble=le,V.BubbleDragger=DI,V.COLLAPSED_FIELD_NAME=qu,V.COLLAPSED_INPUT_NAME=Rl,V.COLLAPSE_CHARS=xI,V.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator,V.CollapsibleToolboxCategory=Bl,V.ComponentManager=Ze,V.Connection=se,V.ConnectionChecker=lS,V.ConnectionDB=bl,V.ConnectionType=Et,V.ContextMenu=Xs,V.ContextMenuItems=yi,V.ContextMenuRegistry=ee,V.Css=em,V.Cursor=t$,V.DELETE_VARIABLE_ID=km,V.DRAG_STACK=PI,V.DUMMY_INPUT=YA,V.DeleteArea=Zu,V.DragTarget=uS,V.DropDownDiv=ui,V.Events=_t,V.Extensions=Es,V.Field=Kt,V.FieldAngle=Wt,V.FieldCheckbox=Er,V.FieldColour=Ki,V.FieldDropdown=zs,V.FieldImage=br,V.FieldLabel=_r,V.FieldLabelSerializable=OS,V.FieldMultilineInput=$$,V.FieldNumber=_$,V.FieldTextInput=xl,V.FieldVariable=fa,V.Flyout=nd,V.FlyoutButton=ys,V.FlyoutMetricsManager=AS,V.Generator=s.CodeGenerator$$module$build$src$core$generator,V.Gesture=Ao,V.Grid=Lm,V.HorizontalFlyout=RS,V.INPUT_VALUE=GA,V.Input=Ks,V.InsertionMarkerManager=Yi,V.Marker=aS,V.MarkerManager=ea,V.Menu=bm,V.MenuItem=Em,V.MetricsManager=r$,V.Msg=s.Msg$$module$build$src$core$msg,V.NEXT_STATEMENT=XA,V.Names=s.Names$$module$build$src$core$names,V.OPPOSITE_TYPE=dr,V.OUTPUT_VALUE=WA,V.Options=rs,V.PREVIOUS_STATEMENT=zA,V.PROCEDURE_CATEGORY_NAME=Ku,V.Procedures=Ii,V.RENAME_VARIABLE_ID=wm,V.RenderedConnection=Si,V.Scrollbar=Ue,V.ScrollbarPair=n$,V.ShortcutItems=Zs,V.ShortcutRegistry=ce,V.TOOLBOX_AT_BOTTOM=jA,V.TOOLBOX_AT_LEFT=JA,V.TOOLBOX_AT_RIGHT=qA,V.TOOLBOX_AT_TOP=KA,V.TabNavigateCursor=hS,V.Theme=fr,V.ThemeManager=rS,V.Themes=BA,V.Toolbox=jS,V.ToolboxCategory=Cs,V.ToolboxItem=E$,V.ToolboxSeparator=$a,V.Tooltip=Gi,V.Touch=sr,V.Trashcan=dS,V.UnattachedFieldError=me,V.VARIABLE_CATEGORY_NAME=lm,V.VARIABLE_DYNAMIC_CATEGORY_NAME=Km,V.VERSION=FA,V.VariableMap=qm,V.VariableModel=Xc,V.Variables=ii,V.VariablesDynamic=Tr,V.VerticalFlyout=T$,V.WidgetDiv=Ws,V.Workspace=ha,V.WorkspaceAudio=cS,V.WorkspaceComment=Gs,V.WorkspaceCommentSvg=si,V.WorkspaceDragger=VI,V.WorkspaceSvg=Is,V.Xml=Di,V.ZoomControls=mI,V.blockAnimations=Zc,V.blockRendering=he,V.browserEvents=yo,V.bubbles=pa,V.bumpObjects=id,V.clipboard=ar,V.common=ei,V.config=s.config$$module$build$src$core$config,V.connectionTypes=ZA,V.constants=yA,V.defineBlocksWithJsonArray=It,V.dialog=rr,V.fieldRegistry=Xu,V.geras=Qs,V.getMainWorkspace=N,V.getSelected=W,V.hasBubble=sn,V.hideChaff=Wv,V.icons=fn,V.inject=Mv,V.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types,V.inputs=_n,V.isCopyable=Fc,V.isIcon=Uv,V.isObservable=lu,V.isPaster=Vv,V.isSerializable=Kh,V.isVariableBackedParameterModel=Xp,V.minimalist=ma,V.procedures=Ii,V.registry=vo,V.renderManagement=Mu,V.serialization=MA,V.setLocale=nm,V.setParentContainer=st,V.svgResize=it,V.thrasos=b$,V.uiPosition=nr,V.utils=Le,V.zelos=Ss,Object.defineProperties(V,{HSV_SATURATION:{get:function(){return ut("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.getHsvSaturation()"),iu()},set:function(t){ut("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.setHsvSaturation()"),Yg(t)}},HSV_VALUE:{get:function(){return ut("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.getHsvValue()"),su()},set:function(t){ut("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.setHsvValue()"),Kg(t)}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:EI}),V.__namespace__=s,V})}(N$)),N$.exports}var Ny;function aM(){return Ny||(Ny=1,function(r,e){(function(s,o){r.exports=o(ob())})(as,function(s){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})}(R$)),R$.exports}var Ly;function nb(){return Ly||(Ly=1,function(r,e){(function(s,o){r.exports=o(aM())})(as,function(s){return s})}(A$)),A$.exports}var L$={exports:{}},My;function hM(){return My||(My=1,function(r,e){(function(s,o){r.exports=o()})(as,function(){var s=s||{Msg:Object.create(null)};return s.Msg.ADD_COMMENT="Add Comment",s.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",s.Msg.CHANGE_VALUE_TITLE="Change value:",s.Msg.CLEAN_UP="Clean up Blocks",s.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",s.Msg.COLLAPSE_ALL="Collapse Blocks",s.Msg.COLLAPSE_BLOCK="Collapse Block",s.Msg.COLOUR_BLEND_COLOUR1="colour 1",s.Msg.COLOUR_BLEND_COLOUR2="colour 2",s.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",s.Msg.COLOUR_BLEND_RATIO="ratio",s.Msg.COLOUR_BLEND_TITLE="blend",s.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",s.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",s.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",s.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",s.Msg.COLOUR_RANDOM_TITLE="random colour",s.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",s.Msg.COLOUR_RGB_BLUE="blue",s.Msg.COLOUR_RGB_GREEN="green",s.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",s.Msg.COLOUR_RGB_RED="red",s.Msg.COLOUR_RGB_TITLE="colour with",s.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",s.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",s.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",s.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",s.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",s.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",s.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",s.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",s.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",s.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",s.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",s.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",s.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",s.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",s.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",s.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",s.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",s.Msg.CONTROLS_IF_MSG_ELSE="else",s.Msg.CONTROLS_IF_MSG_ELSEIF="else if",s.Msg.CONTROLS_IF_MSG_IF="if",s.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",s.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",s.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",s.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",s.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",s.Msg.CONTROLS_REPEAT_INPUT_DO="do",s.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",s.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",s.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",s.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",s.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",s.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",s.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",s.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",s.Msg.DELETE_BLOCK="Delete Block",s.Msg.DELETE_VARIABLE="Delete the '%1' variable",s.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",s.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",s.Msg.DIALOG_CANCEL="Cancel",s.Msg.DIALOG_OK="OK",s.Msg.DISABLE_BLOCK="Disable Block",s.Msg.DUPLICATE_BLOCK="Duplicate",s.Msg.DUPLICATE_COMMENT="Duplicate Comment",s.Msg.ENABLE_BLOCK="Enable Block",s.Msg.EXPAND_ALL="Expand Blocks",s.Msg.EXPAND_BLOCK="Expand Block",s.Msg.EXTERNAL_INPUTS="External Inputs",s.Msg.HELP="Help",s.Msg.INLINE_INPUTS="Inline Inputs",s.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",s.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",s.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",s.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",s.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",s.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",s.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",s.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",s.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",s.Msg.LISTS_GET_INDEX_FIRST="first",s.Msg.LISTS_GET_INDEX_FROM_END="# from end",s.Msg.LISTS_GET_INDEX_FROM_START="#",s.Msg.LISTS_GET_INDEX_GET="get",s.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",s.Msg.LISTS_GET_INDEX_LAST="last",s.Msg.LISTS_GET_INDEX_RANDOM="random",s.Msg.LISTS_GET_INDEX_REMOVE="remove",s.Msg.LISTS_GET_INDEX_TAIL="",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",s.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",s.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",s.Msg.LISTS_GET_SUBLIST_END_LAST="to last",s.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",s.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",s.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",s.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",s.Msg.LISTS_GET_SUBLIST_TAIL="",s.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",s.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",s.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",s.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",s.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",s.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",s.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",s.Msg.LISTS_INLIST="in list",s.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",s.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",s.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",s.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",s.Msg.LISTS_LENGTH_TITLE="length of %1",s.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",s.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",s.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",s.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",s.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",s.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",s.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",s.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",s.Msg.LISTS_SET_INDEX_INPUT_TO="as",s.Msg.LISTS_SET_INDEX_INSERT="insert at",s.Msg.LISTS_SET_INDEX_SET="set",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",s.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",s.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",s.Msg.LISTS_SORT_ORDER_DESCENDING="descending",s.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",s.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",s.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",s.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",s.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",s.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",s.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",s.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",s.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",s.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",s.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",s.Msg.LOGIC_BOOLEAN_FALSE="false",s.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",s.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",s.Msg.LOGIC_BOOLEAN_TRUE="true",s.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",s.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",s.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",s.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",s.Msg.LOGIC_NEGATE_TITLE="not %1",s.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",s.Msg.LOGIC_NULL="null",s.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",s.Msg.LOGIC_NULL_TOOLTIP="Returns null.",s.Msg.LOGIC_OPERATION_AND="and",s.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",s.Msg.LOGIC_OPERATION_OR="or",s.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",s.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",s.Msg.LOGIC_TERNARY_CONDITION="test",s.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",s.Msg.LOGIC_TERNARY_IF_FALSE="if false",s.Msg.LOGIC_TERNARY_IF_TRUE="if true",s.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",s.Msg.MATH_ADDITION_SYMBOL="+",s.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",s.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",s.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",s.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",s.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",s.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",s.Msg.MATH_CHANGE_TITLE="change %1 by %2",s.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",s.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",s.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",s.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",s.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",s.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",s.Msg.MATH_DIVISION_SYMBOL="÷",s.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",s.Msg.MATH_IS_EVEN="is even",s.Msg.MATH_IS_NEGATIVE="is negative",s.Msg.MATH_IS_ODD="is odd",s.Msg.MATH_IS_POSITIVE="is positive",s.Msg.MATH_IS_PRIME="is prime",s.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",s.Msg.MATH_IS_WHOLE="is whole",s.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",s.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",s.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",s.Msg.MATH_MULTIPLICATION_SYMBOL="×",s.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",s.Msg.MATH_NUMBER_TOOLTIP="A number.",s.Msg.MATH_ONLIST_HELPURL="",s.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",s.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",s.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",s.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",s.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",s.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",s.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",s.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",s.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",s.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",s.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",s.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",s.Msg.MATH_POWER_SYMBOL="^",s.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",s.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",s.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",s.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",s.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",s.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",s.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",s.Msg.MATH_ROUND_OPERATOR_ROUND="round",s.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",s.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",s.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",s.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",s.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",s.Msg.MATH_SINGLE_OP_ROOT="square root",s.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",s.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",s.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",s.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",s.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",s.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",s.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",s.Msg.MATH_SUBTRACTION_SYMBOL="-",s.Msg.MATH_TRIG_ACOS="acos",s.Msg.MATH_TRIG_ASIN="asin",s.Msg.MATH_TRIG_ATAN="atan",s.Msg.MATH_TRIG_COS="cos",s.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",s.Msg.MATH_TRIG_SIN="sin",s.Msg.MATH_TRIG_TAN="tan",s.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",s.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",s.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",s.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",s.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",s.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",s.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",s.Msg.NEW_NUMBER_VARIABLE="Create number variable...",s.Msg.NEW_STRING_VARIABLE="Create string variable...",s.Msg.NEW_VARIABLE="Create variable...",s.Msg.NEW_VARIABLE_TITLE="New variable name:",s.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",s.Msg.ORDINAL_NUMBER_SUFFIX="",s.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",s.Msg.PROCEDURES_BEFORE_PARAMS="with:",s.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",s.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",s.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",s.Msg.PROCEDURES_CREATE_DO="Create '%1'",s.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",s.Msg.PROCEDURES_DEFNORETURN_DO="",s.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",s.Msg.PROCEDURES_DEFNORETURN_TITLE="to",s.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",s.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_DEFRETURN_RETURN="return",s.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",s.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",s.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",s.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",s.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",s.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",s.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",s.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",s.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",s.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",s.Msg.REDO="Redo",s.Msg.REMOVE_COMMENT="Remove Comment",s.Msg.RENAME_VARIABLE="Rename variable...",s.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",s.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",s.Msg.TEXT_APPEND_TITLE="to %1 append text %2",s.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",s.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",s.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",s.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",s.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",s.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",s.Msg.TEXT_CHARAT_FIRST="get first letter",s.Msg.TEXT_CHARAT_FROM_END="get letter # from end",s.Msg.TEXT_CHARAT_FROM_START="get letter #",s.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",s.Msg.TEXT_CHARAT_LAST="get last letter",s.Msg.TEXT_CHARAT_RANDOM="get random letter",s.Msg.TEXT_CHARAT_TAIL="",s.Msg.TEXT_CHARAT_TITLE="in text %1 %2",s.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",s.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",s.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",s.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",s.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",s.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",s.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",s.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",s.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",s.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",s.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",s.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",s.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",s.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",s.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",s.Msg.TEXT_GET_SUBSTRING_TAIL="",s.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",s.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",s.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",s.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",s.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",s.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",s.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",s.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",s.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",s.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",s.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",s.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",s.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",s.Msg.TEXT_LENGTH_TITLE="length of %1",s.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",s.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",s.Msg.TEXT_PRINT_TITLE="print %1",s.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",s.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",s.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",s.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",s.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",s.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",s.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",s.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",s.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",s.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",s.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",s.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",s.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",s.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",s.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",s.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",s.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",s.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",s.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",s.Msg.TODAY="Today",s.Msg.UNDO="Undo",s.Msg.UNNAMED_KEY="unnamed",s.Msg.VARIABLES_DEFAULT_NAME="item",s.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",s.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",s.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",s.Msg.VARIABLES_SET="set %1 to %2",s.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",s.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",s.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",s.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",s.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",s.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",s.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",s.Msg.CONTROLS_FOREACH_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_FOR_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=s.Msg.CONTROLS_IF_MSG_ELSEIF,s.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=s.Msg.CONTROLS_IF_MSG_ELSE,s.Msg.CONTROLS_IF_IF_TITLE_IF=s.Msg.CONTROLS_IF_MSG_IF,s.Msg.CONTROLS_IF_MSG_THEN=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.LISTS_CREATE_WITH_ITEM_TITLE=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.LISTS_GET_INDEX_HELPURL=s.Msg.LISTS_INDEX_OF_HELPURL,s.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.MATH_CHANGE_TITLE_ITEM=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.PROCEDURES_DEFRETURN_COMMENT=s.Msg.PROCEDURES_DEFNORETURN_COMMENT,s.Msg.PROCEDURES_DEFRETURN_DO=s.Msg.PROCEDURES_DEFNORETURN_DO,s.Msg.PROCEDURES_DEFRETURN_PROCEDURE=s.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,s.Msg.PROCEDURES_DEFRETURN_TITLE=s.Msg.PROCEDURES_DEFNORETURN_TITLE,s.Msg.TEXT_APPEND_VARIABLE=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.MATH_HUE="230",s.Msg.LOOPS_HUE="120",s.Msg.LISTS_HUE="260",s.Msg.LOGIC_HUE="210",s.Msg.VARIABLES_HUE="330",s.Msg.TEXTS_HUE="160",s.Msg.PROCEDURES_HUE="290",s.Msg.COLOUR_HUE="20",s.Msg.VARIABLES_DYNAMIC_HUE="310",s.Msg})}(L$)),L$.exports}var M$={exports:{}},D$={exports:{}},Dy;function uM(){return Dy||(Dy=1,function(r,e){(function(s,o){r.exports=o(ob())})(as,function(s){var o=s.__namespace__,l=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),a={customContextMenu:function($){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(R={text:o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:h(this)},B=this.getField("VAR").getText(),B={text:o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",B),enabled:!0,callback:d(this)},$.unshift(R),$.unshift(B));else{if(this.type==="variables_get_dynamic")var S="variables_set_dynamic",R=o.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else S="variables_get_dynamic",R=o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var B=this.getField("VAR");S={type:S,fields:{VAR:B.saveState(!0)}},$.push({enabled:0<this.workspace.remainingCapacity(),text:R.replace("%1",B.getText()),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,S)})}},onchange:function($){$=this.getFieldValue("VAR"),$=o.getVariable$$module$build$src$core$variables(this.workspace,$),this.type==="variables_get_dynamic"?this.outputConnection.setCheck($.type):this.getInput("VALUE").connection.setCheck($.type)}},h=function($){return function(){const S=$.workspace,R=$.getField("VAR").getVariable();o.renameVariable$$module$build$src$core$variables(S,R)}},d=function($){return function(){const S=$.workspace,R=$.getField("VAR").getVariable();S.deleteVariableById(R.getId()),S.refreshToolboxSelection()}};o.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",a),o.defineBlocks$$module$build$src$core$common(l);var p={blocks:l},f=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),m={customContextMenu:function($){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(R={text:o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:T(this)},B=this.getField("VAR").getText(),B={text:o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",B),enabled:!0,callback:b(this)},$.unshift(R),$.unshift(B));else{if(this.type==="variables_get")var S="variables_set",R=o.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else S="variables_get",R=o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var B=this.getField("VAR");S={type:S,fields:{VAR:B.saveState(!0)}},$.push({enabled:0<this.workspace.remainingCapacity(),text:R.replace("%1",B.getText()),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,S)})}}},T=function($){return function(){const S=$.workspace,R=$.getField("VAR").getVariable();o.renameVariable$$module$build$src$core$variables(S,R)}},b=function($){return function(){const S=$.workspace,R=$.getField("VAR").getVariable();S.deleteVariableById(R.getId()),S.refreshToolboxSelection()}};o.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",m),o.defineBlocks$$module$build$src$core$common(f);var I={blocks:f},w=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),M={init:function(){this.WHERE_OPTIONS_1=[[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");var S=this.getInput("AT1")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return $.setAttribute("at1",`${S}`),S=this.getInput("AT2")instanceof o.ValueInput$$module$build$src$core$inputs$value_input,$.setAttribute("at2",`${S}`),$},domToMutation:function($){const S=$.getAttribute("at1")==="true";$=$.getAttribute("at2")==="true",this.updateAt_(1,S),this.updateAt_(2,$)},updateAt_:function($,S){this.removeInput("AT"+$),this.removeInput("ORDINAL"+$,!0),S?(this.appendValueInput("AT"+$).setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+$).appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+$),$===2&&o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const R=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+$]});R.setValidator(function(B){const Y=B==="FROM_START"||B==="FROM_END";if(Y!==S){const Mt=this.getSourceBlock();return Mt.updateAt_($,Y),Mt.setFieldValue(B,"WHERE"+$),null}}),this.getInput("AT"+$).appendField(R,"WHERE"+$),$===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};w.text_getSubstring=M,w.text_changeCase={init:function(){const $=[[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},w.text_trim={init:function(){const $=[[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},w.text_print={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var N={updateType_:function($){this.outputConnection.setCheck($==="NUMBER"?"Number":"String")},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("type",this.getFieldValue("TYPE")),$},domToMutation:function($){this.updateType_($.getAttribute("type"))}};w.text_prompt_ext=Object.assign({},N,{init:function(){var $=[[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),$=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),$.setValidator(S=>{this.updateType_(S)}),this.appendValueInput("TEXT").appendField($,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});var U=Object.assign({},N,{init:function(){this.mixin(W);var $=[[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),$=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),$.setValidator(S=>{this.updateType_(S)}),this.appendDummyInput().appendField($,"TYPE").appendField(this.newQuote_(!0)).appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});w.text_prompt=U,w.text_count={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},w.text_replace={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},w.text_reverse={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var W={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function($){for(let S=0,R;R=this.inputList[S];S++)for(let B=0,Y;Y=R.fieldRow[B];B++)if($===Y.name){R.insertFieldAt(B,this.newQuote_(!0)),R.insertFieldAt(B+2,this.newQuote_(!1));return}console.warn('field named "'+$+'" not found in '+this.toDevString())},newQuote_:function($){return $=this.RTL?!$:$,o.fromJson$$module$build$src$core$field_registry({type:"field_image",src:$?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:$?"“":"”"})}},tt=function(){this.mixin(W),this.quoteField_("TEXT")},F={itemCount_:0,mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("items",`${this.itemCount_}`),$},domToMutation:function($){this.itemCount_=parseInt($.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function($){this.itemCount_=$.itemCount,this.updateShape_()},decompose:function($){const S=$.newBlock("text_create_join_container");S.initSvg();let R=S.getInput("STACK").connection;for(let B=0;B<this.itemCount_;B++){const Y=$.newBlock("text_create_join_item");Y.initSvg(),R.connect(Y.previousConnection),R=Y.nextConnection}return S},compose:function($){var S=$.getInputTargetBlock("STACK");for($=[];S;)S.isInsertionMarker()||$.push(S.valueConnection_),S=S.getNextBlock();for(S=0;S<this.itemCount_;S++){const R=this.getInput("ADD"+S).connection.targetConnection;R&&$.indexOf(R)===-1&&R.disconnect()}for(this.itemCount_=$.length,this.updateShape_(),S=0;S<this.itemCount_;S++){let R;(R=$[S])==null||R.reconnect(this,"ADD"+S)}},saveConnections:function($){$=$.getInputTargetBlock("STACK");let S=0;for(;$;){if($.isInsertionMarker()){$=$.getNextBlock();continue}const R=this.getInput("ADD"+S);$.valueConnection_=R&&R.connection.targetConnection,$=$.getNextBlock(),S++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var $=0;$<this.itemCount_;$++)if(!this.getInput("ADD"+$)){const S=this.appendValueInput("ADD"+$).setAlign(o.Align$$module$build$src$core$inputs$align.RIGHT);$===0&&S.appendField(o.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for($=this.itemCount_;this.getInput("ADD"+$);$++)this.removeInput("ADD"+$)}},st=function(){this.mixin(W),this.itemCount_=2,this.updateShape_(),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};o.register$$module$build$src$core$extensions("text_append_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var it=function(){this.setTooltip(()=>o.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))},Tt={isAt_:!1,mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("at",`${this.isAt_}`),$},domToMutation:function($){$=$.getAttribute("at")!=="false",this.updateAt_($)},updateAt_:function($){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),$&&(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=$}},Lt=function(){this.getField("WHERE").setValidator(function($){$=$==="FROM_START"||$==="FROM_END";const S=this.getSourceBlock();$!==S.isAt_&&S.updateAt_($)}),this.updateAt_(!0),this.setTooltip(()=>{var $=this.getFieldValue("WHERE");let S=o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return($==="FROM_START"||$==="FROM_END")&&($=$==="FROM_START"?o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(S+="  "+$.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),S})};o.register$$module$build$src$core$extensions("text_indexOf_tooltip",it),o.register$$module$build$src$core$extensions("text_quotes",tt),o.registerMutator$$module$build$src$core$extensions("text_join_mutator",F,st),o.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",Tt,Lt),o.defineBlocks$$module$build$src$core$common(w);var It={blocks:w},mt={},Ct={setStatements_:function($){this.hasStatements_!==$&&($?(this.appendStatementInput("STACK").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=$)},updateParams_:function(){let $="";this.arguments_.length&&($=o.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),o.disable$$module$build$src$core$events$utils();try{this.setFieldValue($,"PARAMS")}finally{o.enable$$module$build$src$core$events$utils()}},mutationToDom:function($){const S=o.createElement$$module$build$src$core$utils$xml("mutation");$&&S.setAttribute("name",this.getFieldValue("NAME"));for(let R=0;R<this.argumentVarModels_.length;R++){const B=o.createElement$$module$build$src$core$utils$xml("arg"),Y=this.argumentVarModels_[R];B.setAttribute("name",Y.name),B.setAttribute("varid",Y.getId()),$&&this.paramIds_&&B.setAttribute("paramId",this.paramIds_[R]),S.appendChild(B)}return this.hasStatements_||S.setAttribute("statements","false"),S},domToMutation:function($){this.arguments_=[],this.argumentVarModels_=[];for(let R=0,B;B=$.childNodes[R];R++)if(B.nodeName.toLowerCase()==="arg"){var S=B;const Y=S.getAttribute("name");S=S.getAttribute("varid")||S.getAttribute("varId"),this.arguments_.push(Y),S=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,S,Y,""),S!==null?this.argumentVarModels_.push(S):console.log(`Failed to create a variable named "${Y}", ignoring.`)}this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_($.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const $=Object.create(null);if(this.argumentVarModels_.length){$.params=[];for(let S=0;S<this.argumentVarModels_.length;S++)$.params.push({name:this.argumentVarModels_[S].name,id:this.argumentVarModels_[S].getId()})}return this.hasStatements_||($.hasStatements=!1),$},loadExtraState:function($){if(this.arguments_=[],this.argumentVarModels_=[],$.params)for(let R=0;R<$.params.length;R++){var S=$.params[R];S=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,S.id,S.name,""),this.arguments_.push(S.name),this.argumentVarModels_.push(S)}this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_($.hasStatements!==!1)},decompose:function($){const S=o.createElement$$module$build$src$core$utils$xml("block");S.setAttribute("type","procedures_mutatorcontainer");var R=o.createElement$$module$build$src$core$utils$xml("statement");R.setAttribute("name","STACK"),S.appendChild(R);for(let Y=0;Y<this.arguments_.length;Y++){const Mt=o.createElement$$module$build$src$core$utils$xml("block");Mt.setAttribute("type","procedures_mutatorarg");var B=o.createElement$$module$build$src$core$utils$xml("field");B.setAttribute("name","NAME");const ge=o.createTextNode$$module$build$src$core$utils$xml(this.arguments_[Y]);B.appendChild(ge),Mt.appendChild(B),B=o.createElement$$module$build$src$core$utils$xml("next"),Mt.appendChild(B),R.appendChild(Mt),R=B}return $=o.domToBlock$$module$build$src$core$xml(S,$),this.type==="procedures_defreturn"?$.setFieldValue(this.hasStatements_,"STATEMENTS"):$.removeInput("STATEMENT_INPUT"),o.mutateCallers$$module$build$src$core$procedures(this),$},compose:function($){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let S=$.getInputTargetBlock("STACK");for(;S&&!S.isInsertionMarker();){var R=S.getFieldValue("NAME");this.arguments_.push(R),R=this.workspace.getVariable(R,""),this.argumentVarModels_.push(R),this.paramIds_.push(S.id),S=S.nextConnection&&S.nextConnection.targetBlock()}if(this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),$=$.getFieldValue("STATEMENTS"),$!==null&&($=$==="TRUE",this.hasStatements_!==$))if($){this.setStatements_(!0);var B;(B=this.statementConnection_)==null||B.reconnect(this,"STACK"),this.statementConnection_=null}else B=this.getInput("STACK").connection,(this.statementConnection_=B.targetConnection)&&(B=B.targetBlock(),B.unplug(),B.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function($,S){var R=this.workspace.getVariableById($);if(R.type===""){R=R.name,S=this.workspace.getVariableById(S);var B=!1;for(let Y=0;Y<this.argumentVarModels_.length;Y++)this.argumentVarModels_[Y].getId()===$&&(this.arguments_[Y]=S.name,this.argumentVarModels_[Y]=S,B=!0);B&&(this.displayRenamedVar_(R,S.name),o.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function($){const S=$.name;let R=!1,B;for(let Y=0;Y<this.argumentVarModels_.length;Y++)this.argumentVarModels_[Y].getId()===$.getId()&&(B=this.arguments_[Y],this.arguments_[Y]=S,R=!0);R&&(this.displayRenamedVar_(B,S),o.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function($,S){this.updateParams_();var R=this.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(R&&R.bubbleIsVisible()){R=R.getWorkspace().getAllBlocks(!1);for(let B=0,Y;Y=R[B];B++)Y.type==="procedures_mutatorarg"&&o.Names$$module$build$src$core$names.equals($,Y.getFieldValue("NAME"))&&Y.setFieldValue(S,"NAME")}},customContextMenu:function($){if(!this.isInFlyout){var S=this.getFieldValue("NAME"),R={type:this.callType_,extraState:{name:S,params:this.arguments_}};if($.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",S),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,R)}),!this.isCollapsed())for(S=0;S<this.argumentVarModels_.length;S++){R=this.argumentVarModels_[S];const B={type:"variables_get",fields:{VAR:{name:R.name,id:R.getId(),type:R.type}}};$.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",R.name),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,B)})}}}};mt.procedures_defnoreturn=Object.assign({},Ct,{init:function(){var $=o.findLegalName$$module$build$src$core$procedures("",this);$=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:$}),$.setValidator(o.rename$$module$build$src$core$procedures),$.setSpellcheck(!1),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField($,"NAME").appendField("","PARAMS"),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),mt.procedures_defreturn=Object.assign({},Ct,{init:function(){var $=o.findLegalName$$module$build$src$core$procedures("",this);$=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:$}),$.setValidator(o.rename$$module$build$src$core$procedures),$.setSpellcheck(!1),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField($,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(o.Align$$module$build$src$core$inputs$input.RIGHT).appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var Ft={init:function(){this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};mt.procedures_mutatorcontainer=Ft;var Nt={init:function(){const $=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:o.DEFAULT_ARG$$module$build$src$core$procedures});$.setValidator(this.validator_),$.oldShowEditorFn_=$.showEditor_,$.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField($,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,$.onFinishEditing_=this.deleteIntermediateVars_,$.createdVariables_=[],$.onFinishEditing_("x")},validator_:function($){var S=this.getSourceBlock();const R=S.workspace.getRootWorkspace();if($=$.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!$)return null;const B=(S.workspace.targetWorkspace||S.workspace).getAllBlocks(!1),Y=$.toLowerCase();for(let Mt=0;Mt<B.length;Mt++){if(B[Mt].id===this.getSourceBlock().id)continue;const ge=B[Mt].getFieldValue("NAME");if(ge&&ge.toLowerCase()===Y)return null}return S.isInFlyout||((S=R.getVariable($,""))&&S.name!==$&&R.renameVariableById(S.getId(),$),S||(S=R.createVariable($,""))&&this.createdVariables_&&this.createdVariables_.push(S)),$},deleteIntermediateVars_:function($){const S=this.getSourceBlock().workspace.getRootWorkspace();if(S)for(let R=0;R<this.createdVariables_.length;R++){const B=this.createdVariables_[R];B.name!==$&&S.deleteVariableById(B.getId())}}};mt.procedures_mutatorarg=Nt;var qt={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function($,S){o.Names$$module$build$src$core$names.equals($,this.getProcedureCall())&&(this.setFieldValue(S,"NAME"),this.setTooltip((this.outputConnection?o.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:o.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",S)))},setProcedureParameters_:function($,S){var R=o.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((R=(R=R&&R.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&R.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),$.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=S;else{if(S.length!==$.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let Y=0;Y<this.arguments_.length;Y++){var B=this.getInput("ARG"+Y);B&&(B=B.connection.targetConnection,this.quarkConnections_[this.quarkIds_[Y]]=B,R&&B&&S.indexOf(this.quarkIds_[Y])===-1&&(B.disconnect(),B.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat($),this.argumentVarModels_=[],$=0;$<this.arguments_.length;$++)R=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[$],""),this.argumentVarModels_.push(R);if(this.updateShape_(),this.quarkIds_=S){for(S=0;S<this.arguments_.length;S++)if($=this.quarkIds_[S],$ in this.quarkConnections_){let Y;(Y=this.quarkConnections_[$])!=null&&Y.reconnect(this,"ARG"+S)||delete this.quarkConnections_[$]}}}},updateShape_:function(){for(var $=0;$<this.arguments_.length;$++){var S=this.getField("ARGNAME"+$);if(S){o.disable$$module$build$src$core$events$utils();try{S.setValue(this.arguments_[$])}finally{o.enable$$module$build$src$core$events$utils()}}else S=o.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[$]}),this.appendValueInput("ARG"+$).setAlign(o.Align$$module$build$src$core$inputs$input.RIGHT).appendField(S,"ARGNAME"+$).init()}for($=this.arguments_.length;this.getInput("ARG"+$);$++)this.removeInput("ARG"+$);($=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||($.appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),$.init()):this.getField("WITH")&&$.removeField("WITH"))},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");$.setAttribute("name",this.getProcedureCall());for(let S=0;S<this.arguments_.length;S++){const R=o.createElement$$module$build$src$core$utils$xml("arg");R.setAttribute("name",this.arguments_[S]),$.appendChild(R)}return $},domToMutation:function($){var S=$.getAttribute("name");this.renameProcedure(this.getProcedureCall(),S),S=[];const R=[];for(let B=0,Y;Y=$.childNodes[B];B++)Y.nodeName.toLowerCase()==="arg"&&(S.push(Y.getAttribute("name")),R.push(Y.getAttribute("paramId")));this.setProcedureParameters_(S,R)},saveExtraState:function(){const $=Object.create(null);return $.name=this.getProcedureCall(),this.arguments_.length&&($.params=this.arguments_),$},loadExtraState:function($){if(this.renameProcedure(this.getProcedureCall(),$.name),$=$.params){const S=[];S.length=$.length,S.fill(null),this.setProcedureParameters_($,S)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function($){if(this.workspace&&!this.workspace.isFlyout&&$.recordUndo)if($.type===o.CREATE$$module$build$src$core$events$utils&&$.ids.indexOf(this.id)!==-1){var S=this.getProcedureCall();if(S=o.getDefinition$$module$build$src$core$procedures(S,this.workspace),!S||S.type===this.defType_&&JSON.stringify(S.getVars())===JSON.stringify(this.arguments_)||(S=null),!S){o.setGroup$$module$build$src$core$events$utils($.group),$=o.createElement$$module$build$src$core$utils$xml("xml"),S=o.createElement$$module$build$src$core$utils$xml("block"),S.setAttribute("type",this.defType_);var R=this.getRelativeToSurfaceXY(),B=R.y+2*o.config$$module$build$src$core$config.snapRadius;S.setAttribute("x",`${R.x+o.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),S.setAttribute("y",`${B}`),R=this.mutationToDom(),S.appendChild(R),R=o.createElement$$module$build$src$core$utils$xml("field"),R.setAttribute("name","NAME"),B=this.getProcedureCall();const Y=o.findLegalName$$module$build$src$core$procedures(B,this);B!==Y&&this.renameProcedure(B,Y),R.appendChild(o.createTextNode$$module$build$src$core$utils$xml(B)),S.appendChild(R),$.appendChild(S),o.domToWorkspace$$module$build$src$core$xml($,this.workspace),o.setGroup$$module$build$src$core$events$utils(!1)}}else $.type===o.DELETE$$module$build$src$core$events$utils?(S=this.getProcedureCall(),o.getDefinition$$module$build$src$core$procedures(S,this.workspace)||(o.setGroup$$module$build$src$core$events$utils($.group),this.dispose(!0),o.setGroup$$module$build$src$core$events$utils(!1))):$.type===o.CHANGE$$module$build$src$core$events$utils&&$.element==="disabled"&&(S=this.getProcedureCall(),(S=o.getDefinition$$module$build$src$core$procedures(S,this.workspace))&&S.id===$.blockId&&((S=o.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),o.setGroup$$module$build$src$core$events$utils($.group),$.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),o.setGroup$$module$build$src$core$events$utils(S)))},customContextMenu:function($){if(this.workspace.isMovable()){var S=this.getProcedureCall(),R=this.workspace;$.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const B=o.getDefinition$$module$build$src$core$procedures(S,R);B&&(R.centerOnBlock(B.id),B.select())}})}}};mt.procedures_callnoreturn=Object.assign({},qt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),mt.procedures_callreturn=Object.assign({},qt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"});var at={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("value",String(Number(this.hasReturnValue_))),$},domToMutation:function($){this.hasReturnValue_=$.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function($){if(!(this.workspace.isDragging&&this.workspace.isDragging()||$.type!==o.MOVE$$module$build$src$core$events$utils)){var S=!1,R=this;do{if(this.FUNCTION_TYPES.indexOf(R.type)!==-1){S=!0;break}R=R.getSurroundParent()}while(R);S?(R.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):R.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(R=o.getGroup$$module$build$src$core$events$utils(),o.setGroup$$module$build$src$core$events$utils($.group),this.setEnabled(S),o.setGroup$$module$build$src$core$events$utils(R))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};mt.procedures_ifreturn=at,o.defineBlocks$$module$build$src$core$common(mt);var Bt={blocks:mt},xt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),At={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};o.register$$module$build$src$core$extensions("math_op_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("OP",At));var Zt={mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation"),S=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return $.setAttribute("divisor_input",String(S)),$},domToMutation:function($){$=$.getAttribute("divisor_input")==="true",this.updateShape_($)},updateShape_:function($){const S=this.getInput("DIVISOR");$?S||this.appendValueInput("DIVISOR").setCheck("Number"):S&&this.removeInput("DIVISOR")}},Dt=function(){this.getField("PROPERTY").setValidator(function($){$=$==="DIVISIBLE_BY",this.getSourceBlock().updateShape_($)})};o.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",Zt,Dt),o.register$$module$build$src$core$extensions("math_change_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var Ce={updateType_:function($){$==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("op",this.getFieldValue("OP")),$},domToMutation:function($){if($=$.getAttribute("op"),$===null)throw new TypeError("xmlElement had no op attribute");this.updateType_($)}},ne=function(){this.getField("OP").setValidator((function($){this.updateType_($)}).bind(this))};o.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",Ce,ne),o.defineBlocks$$module$build$src$core$common(xt);var We={blocks:xt},pt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),qe={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};o.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",qe));var xe={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};o.register$$module$build$src$core$extensions("controls_flow_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",xe));var Ne={customContextMenu:function($){if(!this.isInFlyout){var S=this.getField("VAR"),R=S.getVariable().name;this.isCollapsed()||R===null||(S={type:"variables_get",fields:{VAR:S.saveState(!0)}},$.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",R),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,S)}))}}};o.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",Ne),o.register$$module$build$src$core$extensions("controls_for_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),o.register$$module$build$src$core$extensions("controls_forEach_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var Te=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),Xe={getSurroundLoop:function(){let $=this;do{if(Te.has($.type))return $;$=$.getSurroundParent()}while($);return null},onchange:function($){var S=this.workspace;if(S.isDragging&&!S.isDragging()&&$.type===o.MOVE$$module$build$src$core$events$utils&&(S=!!this.getSurroundLoop(),this.setWarningText(S?null:o.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const R=o.getGroup$$module$build$src$core$events$utils();o.setGroup$$module$build$src$core$events$utils($.group),this.setEnabled(S),o.setGroup$$module$build$src$core$events$utils(R)}}};o.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",Xe),o.defineBlocks$$module$build$src$core$common(pt);var ai={blocks:pt,loopTypes:Te},hi=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),y={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};o.register$$module$build$src$core$extensions("logic_op_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("OP",y));var D={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const $=o.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&$.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&$.setAttribute("else","1"),$},domToMutation:function($){this.elseifCount_=parseInt($.getAttribute("elseif"),10)||0,this.elseCount_=parseInt($.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const $=Object.create(null);return this.elseifCount_&&($.elseIfCount=this.elseifCount_),this.elseCount_&&($.hasElse=!0),$},loadExtraState:function($){this.elseifCount_=$.elseIfCount||0,this.elseCount_=$.hasElse?1:0,this.updateShape_()},decompose:function($){const S=$.newBlock("controls_if_if");S.initSvg();let R=S.nextConnection;for(let B=1;B<=this.elseifCount_;B++){const Y=$.newBlock("controls_if_elseif");Y.initSvg(),R.connect(Y.previousConnection),R=Y.nextConnection}return this.elseCount_&&($=$.newBlock("controls_if_else"),$.initSvg(),R.connect($.previousConnection)),S},compose:function($){$=$.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const S=[null],R=[null];let B=null;for(;$;){if(!$.isInsertionMarker())switch($.type){case"controls_if_elseif":this.elseifCount_++,S.push($.valueConnection_),R.push($.statementConnection_);break;case"controls_if_else":this.elseCount_++,B=$.statementConnection_;break;default:throw TypeError("Unknown block type: "+$.type)}$=$.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(S,R,B)},saveConnections:function($){$=$.nextConnection.targetBlock();let S=1;for(;$;){if(!$.isInsertionMarker())switch($.type){case"controls_if_elseif":var R=this.getInput("IF"+S);const B=this.getInput("DO"+S);$.valueConnection_=R&&R.connection.targetConnection,$.statementConnection_=B&&B.connection.targetConnection,S++;break;case"controls_if_else":R=this.getInput("ELSE"),$.statementConnection_=R&&R.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+$.type)}$=$.getNextBlock()}},rebuildShape_:function(){const $=[null],S=[null];let R=null;this.getInput("ELSE")&&(R=this.getInput("ELSE").connection.targetConnection);for(let B=1;this.getInput("IF"+B);B++){const Y=this.getInput("IF"+B),Mt=this.getInput("DO"+B);$.push(Y.connection.targetConnection),S.push(Mt.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_($,S,R)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var $=1;this.getInput("IF"+$);$++)this.removeInput("IF"+$),this.removeInput("DO"+$);for($=1;$<=this.elseifCount_;$++)this.appendValueInput("IF"+$).setCheck("Boolean").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+$).appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function($,S,R){for(let B=1;B<=this.elseifCount_;B++){let Y;(Y=$[B])==null||Y.reconnect(this,"IF"+B);let Mt;(Mt=S[B])==null||Mt.reconnect(this,"DO"+B)}R==null||R.reconnect(this,"ELSE")}};o.registerMutator$$module$build$src$core$extensions("controls_if_mutator",D,null,["controls_if_elseif","controls_if_else"]);var H=function(){this.setTooltip((function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4}else return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1;return""}).bind(this))};o.register$$module$build$src$core$extensions("controls_if_tooltip",H);var j={onchange:function($){this.prevBlocks_||(this.prevBlocks_=[null,null]);var S=this.getInputTargetBlock("A");const R=this.getInputTargetBlock("B");S&&R&&!this.workspace.connectionChecker.doTypeChecks(S.outputConnection,R.outputConnection)&&(o.setGroup$$module$build$src$core$events$utils($.group),$=this.prevBlocks_[0],$!==S&&(S.unplug(),!$||$.isDisposed()||$.isShadow()||this.getInput("A").connection.connect($.outputConnection)),S=this.prevBlocks_[1],S!==R&&(R.unplug(),!S||S.isDisposed()||S.isShadow()||this.getInput("B").connection.connect(S.outputConnection)),this.bumpNeighbours(),o.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},z=function(){this.mixin(j)};o.register$$module$build$src$core$extensions("logic_compare",z);var nt={prevParentConnection_:null,onchange:function($){const S=this.getInputTargetBlock("THEN"),R=this.getInputTargetBlock("ELSE"),B=this.outputConnection.targetConnection;if((S||R)&&B)for(let Y=0;2>Y;Y++){const Mt=Y===1?S:R;Mt&&!Mt.workspace.connectionChecker.doTypeChecks(Mt.outputConnection,B)&&(o.setGroup$$module$build$src$core$events$utils($.group),B===this.prevParentConnection_?(this.unplug(),B.getSourceBlock().bumpNeighbours()):(Mt.unplug(),Mt.bumpNeighbours()),o.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=B}};o.registerMixin$$module$build$src$core$extensions("logic_ternary",nt),o.defineBlocks$$module$build$src$core$common(hi);var rt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),Z={init:function(){this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("items",String(this.itemCount_)),$},domToMutation:function($){if($=$.getAttribute("items"),!$)throw new TypeError("element did not have items");this.itemCount_=parseInt($,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function($){this.itemCount_=$.itemCount,this.updateShape_()},decompose:function($){const S=$.newBlock("lists_create_with_container");S.initSvg();let R=S.getInput("STACK").connection;for(let B=0;B<this.itemCount_;B++){const Y=$.newBlock("lists_create_with_item");if(Y.initSvg(),!Y.previousConnection)throw Error("itemBlock has no previousConnection");R.connect(Y.previousConnection),R=Y.nextConnection}return S},compose:function($){var S=$.getInputTargetBlock("STACK");for($=[];S;)S.isInsertionMarker()||$.push(S.valueConnection_),S=S.getNextBlock();for(S=0;S<this.itemCount_;S++){const R=this.getInput("ADD"+S).connection.targetConnection;R&&$.indexOf(R)===-1&&R.disconnect()}for(this.itemCount_=$.length,this.updateShape_(),S=0;S<this.itemCount_;S++){let R;(R=$[S])==null||R.reconnect(this,"ADD"+S)}},saveConnections:function($){$=$.getInputTargetBlock("STACK");let S=0;for(;$;){if($.isInsertionMarker()){$=$.getNextBlock();continue}const R=this.getInput("ADD"+S);let B;$.valueConnection_=(B=R)==null?void 0:B.connection.targetConnection,$=$.getNextBlock(),S++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var $=0;$<this.itemCount_;$++)if(!this.getInput("ADD"+$)){const S=this.appendValueInput("ADD"+$).setAlign(o.Align$$module$build$src$core$inputs$align.RIGHT);$===0&&S.appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for($=this.itemCount_;this.getInput("ADD"+$);$++)this.removeInput("ADD"+$)}};rt.lists_create_with=Z;var et={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};rt.lists_create_with_container=et;var q={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};rt.lists_create_with_item=q;var ut={init:function(){var $=[[o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),$=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),!$)throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField($,"END"),this.setInputsInline(!0),this.setTooltip(()=>o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}};rt.lists_indexOf=ut;var A={init:function(){var $=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),$=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),$.setValidator(function(S){S=S==="REMOVE",this.getSourceBlock().updateStatement_(S)}),this.appendValueInput("VALUE").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField($,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const S=this.getFieldValue("MODE"),R=this.getFieldValue("WHERE");let B="";switch(S+" "+R){case"GET FROM_START":case"GET FROM_END":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":B=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(R==="FROM_START"||R==="FROM_END")&&(B+="  "+(R==="FROM_START"?o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),B})},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");$.setAttribute("statement",String(!this.outputConnection));const S=this.getInput("AT")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return $.setAttribute("at",String(S)),$},domToMutation:function($){const S=$.getAttribute("statement")==="true";this.updateStatement_(S),$=$.getAttribute("at")!=="false",this.updateAt_($)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function($){$.isStatement?this.updateStatement_(!0):typeof $=="string"&&this.domToMutation(o.textToDom$$module$build$src$core$utils$xml($))},updateStatement_:function($){$!==!this.outputConnection&&(this.unplug(!0,!0),$?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function($){this.removeInput("AT"),this.removeInput("ORDINAL",!0),$?(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const S=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});S.setValidator(function(R){const B=R==="FROM_START"||R==="FROM_END";if(B!==$){const Y=this.getSourceBlock();return Y.updateAt_(B),Y.setFieldValue(R,"WHERE"),null}}),this.getInput("AT").appendField(S,"WHERE"),o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};rt.lists_getIndex=A;var X={init:function(){var $=[[o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),$=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:$}),this.appendDummyInput().appendField($,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const S=this.getFieldValue("MODE"),R=this.getFieldValue("WHERE");let B="";switch(S+" "+R){case"SET FROM_START":case"SET FROM_END":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":B=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(R==="FROM_START"||R==="FROM_END")&&(B+="  "+o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),B})},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation"),S=this.getInput("AT")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return $.setAttribute("at",String(S)),$},domToMutation:function($){$=$.getAttribute("at")!=="false",this.updateAt_($)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function($){this.removeInput("AT"),this.removeInput("ORDINAL",!0),$?(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const S=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});S.setValidator(function(R){const B=R==="FROM_START"||R==="FROM_END";if(B!==$){const Y=this.getSourceBlock();return Y.updateAt_(B),Y.setFieldValue(R,"WHERE"),null}}),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(S,"WHERE")}};rt.lists_setIndex=X;var kt={init:function(){this.WHERE_OPTIONS_1=[[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");var S=this.getInput("AT1")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return $.setAttribute("at1",String(S)),S=this.getInput("AT2")instanceof o.ValueInput$$module$build$src$core$inputs$value_input,$.setAttribute("at2",String(S)),$},domToMutation:function($){const S=$.getAttribute("at1")==="true";$=$.getAttribute("at2")==="true",this.updateAt_(1,S),this.updateAt_(2,$)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function($,S){this.removeInput("AT"+$),this.removeInput("ORDINAL"+$,!0),S?(this.appendValueInput("AT"+$).setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+$).appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+$);const R=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+$]});R.setValidator(function(B){const Y=B==="FROM_START"||B==="FROM_END";if(Y!==S){const Mt=this.getSourceBlock();return Mt.updateAt_($,Y),Mt.setFieldValue(B,"WHERE"+$),null}}),this.getInput("AT"+$).appendField(R,"WHERE"+$),$===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};rt.lists_getSublist=kt,rt.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},rt.lists_split={init:function(){const $=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[o.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!$)throw Error("field_dropdown not found");$.setValidator(S=>{this.updateType_(S)}),this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField($,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(o.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const S=this.getFieldValue("MODE");if(S==="SPLIT")return o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if(S==="JOIN")return o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+S)})},updateType_:function($){if(this.getFieldValue("MODE")!==$){const S=this.getInput("INPUT").connection;S.setShadowDom(null);const R=S.targetBlock();R&&(S.disconnect(),R.isShadow()?R.dispose(!1):this.bumpNeighbours())}$==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const $=o.createElement$$module$build$src$core$utils$xml("mutation");return $.setAttribute("mode",this.getFieldValue("MODE")),$},domToMutation:function($){this.updateType_($.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},o.defineBlocks$$module$build$src$core$common(rt);var ft={blocks:rt},Yt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]);o.defineBlocks$$module$build$src$core$common(Yt);var bt={blocks:Yt},re=Object.assign({},Yt,rt,hi,pt,xt,mt,f,l),O={blocks:re,colour:bt,lists:ft,loops:ai,math:We,procedures:Bt,texts:It,variables:I,variablesDynamic:p};return O.__namespace__=o,O})}(D$)),D$.exports}var xy;function dM(){return xy||(xy=1,function(r,e){(function(s,o){r.exports=o(uM())})(as,function(s){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})}(M$)),M$.exports}var x$={exports:{}},P$={exports:{}},Py;function pM(){return Py||(Py=1,function(r,e){(function(s,o){r.exports=o(ob())})(as,function(s){var o=s.__namespace__,l=function(_,v){return[v.quote_(_.getFieldValue("COLOUR")),O.ATOMIC]},a=function(_,v){return[v.provideFunction_("colourRandom",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",O.FUNCTION_CALL]},h=function(_,v){const k=v.valueToCode(_,"RED",O.NONE)||0,P=v.valueToCode(_,"GREEN",O.NONE)||0;return _=v.valueToCode(_,"BLUE",O.NONE)||0,[v.provideFunction_("colourRgb",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+k+", "+P+", "+_+")",O.FUNCTION_CALL]},d=function(_,v){const k=v.valueToCode(_,"COLOUR1",O.NONE)||"'#000000'",P=v.valueToCode(_,"COLOUR2",O.NONE)||"'#000000'";return _=v.valueToCode(_,"RATIO",O.NONE)||.5,[v.provideFunction_("colourBlend",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+k+", "+P+", "+_+")",O.FUNCTION_CALL]},p=function(_,v){return["[]",O.ATOMIC]},f=function(_,v){const k=Array(_.itemCount_);for(let P=0;P<_.itemCount_;P++)k[P]=v.valueToCode(_,"ADD"+P,O.NONE)||"null";return["["+k.join(", ")+"]",O.ATOMIC]},m=function(_,v){const k=v.provideFunction_("listsRepeat",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),P=v.valueToCode(_,"ITEM",O.NONE)||"null";return _=v.valueToCode(_,"NUM",O.NONE)||"0",[k+"("+P+", "+_+")",O.FUNCTION_CALL]},T=function(_,v){return[(v.valueToCode(_,"VALUE",O.MEMBER)||"[]")+".length",O.MEMBER]},b=function(_,v){return["!"+(v.valueToCode(_,"VALUE",O.MEMBER)||"[]")+".length",O.LOGICAL_NOT]},I=function(_,v){const k=_.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",P=v.valueToCode(_,"FIND",O.NONE)||"''";return v=(v.valueToCode(_,"VALUE",O.MEMBER)||"[]")+"."+k+"("+P+")",_.workspace.options.oneBasedIndex?[v+" + 1",O.ADDITION]:[v,O.FUNCTION_CALL]},w=function(_,v){const k=_.getFieldValue("MODE")||"GET",P=_.getFieldValue("WHERE")||"FROM_START";var J=v.valueToCode(_,"VALUE",P==="RANDOM"?O.NONE:O.MEMBER)||"[]";switch(P){case"FIRST":if(k==="GET")return[J+"[0]",O.MEMBER];if(k==="GET_REMOVE")return[J+".shift()",O.MEMBER];if(k==="REMOVE")return J+`.shift();
`;break;case"LAST":if(k==="GET")return[J+".slice(-1)[0]",O.MEMBER];if(k==="GET_REMOVE")return[J+".pop()",O.MEMBER];if(k==="REMOVE")return J+`.pop();
`;break;case"FROM_START":if(_=v.getAdjusted(_,"AT"),k==="GET")return[J+"["+_+"]",O.MEMBER];if(k==="GET_REMOVE")return[J+".splice("+_+", 1)[0]",O.FUNCTION_CALL];if(k==="REMOVE")return J+".splice("+_+`, 1);
`;break;case"FROM_END":if(_=v.getAdjusted(_,"AT",1,!0),k==="GET")return[J+".slice("+_+")[0]",O.FUNCTION_CALL];if(k==="GET_REMOVE")return[J+".splice("+_+", 1)[0]",O.FUNCTION_CALL];if(k==="REMOVE")return J+".splice("+_+", 1);";break;case"RANDOM":if(J=v.provideFunction_("listsGetRandomItem",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+J+", "+(k!=="GET")+")",k==="GET"||k==="GET_REMOVE")return[J,O.FUNCTION_CALL];if(k==="REMOVE")return J+`;
`}throw Error("Unhandled combination (lists_getIndex).")},M=function(_,v){function k(){if(P.match(/^\w+$/))return"";const Fe=v.nameDB_.getDistinctName("tmpList",o.NameType$$module$build$src$core$names.VARIABLE),Xn="var "+Fe+" = "+P+`;
`;return P=Fe,Xn}let P=v.valueToCode(_,"LIST",O.MEMBER)||"[]";const J=_.getFieldValue("MODE")||"GET";var St=_.getFieldValue("WHERE")||"FROM_START";const Xt=v.valueToCode(_,"TO",O.ASSIGNMENT)||"null";switch(St){case"FIRST":if(J==="SET")return P+"[0] = "+Xt+`;
`;if(J==="INSERT")return P+".unshift("+Xt+`);
`;break;case"LAST":if(J==="SET")return k()+(P+"["+P+".length - 1] = "+Xt+`;
`);if(J==="INSERT")return P+".push("+Xt+`);
`;break;case"FROM_START":if(_=v.getAdjusted(_,"AT"),J==="SET")return P+"["+_+"] = "+Xt+`;
`;if(J==="INSERT")return P+".splice("+_+", 0, "+Xt+`);
`;break;case"FROM_END":if(_=v.getAdjusted(_,"AT",1,!1,O.SUBTRACTION),St=k(),J==="SET")return St+(P+"["+P+".length - "+_+"] = "+Xt+`;
`);if(J==="INSERT")return St+(P+".splice("+P+".length - "+_+", 0, "+Xt+`);
`);break;case"RANDOM":if(_=k(),St=v.nameDB_.getDistinctName("tmpX",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+St+" = Math.floor(Math.random() * "+P+`.length);
`,J==="SET")return _+(P+"["+St+"] = "+Xt+`;
`);if(J==="INSERT")return _+(P+".splice("+St+", 0, "+Xt+`);
`)}throw Error("Unhandled combination (lists_setIndex).")},N=function(_,v){var k=v.valueToCode(_,"LIST",O.MEMBER)||"[]",P=_.getFieldValue("WHERE1");const J=_.getFieldValue("WHERE2");if(P==="FIRST"&&J==="LAST")k+=".slice(0)";else if(k.match(/^\w+$/)||P!=="FROM_END"&&J==="FROM_START"){switch(P){case"FROM_START":P=v.getAdjusted(_,"AT1");break;case"FROM_END":P=v.getAdjusted(_,"AT1",1,!1,O.SUBTRACTION),P=k+".length - "+P;break;case"FIRST":P="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(J){case"FROM_START":v=v.getAdjusted(_,"AT2",1);break;case"FROM_END":v=v.getAdjusted(_,"AT2",0,!1,O.SUBTRACTION),v=k+".length - "+v;break;case"LAST":v=k+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}k=k+".slice("+P+", "+v+")"}else{const St=v.getAdjusted(_,"AT1");_=v.getAdjusted(_,"AT2");const Xt={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};k=v.provideFunction_("subsequence"+Xt[P]+Xt[J],`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(sequence${P==="FROM_END"||P==="FROM_START"?", at1":""}${J==="FROM_END"||J==="FROM_START"?", at2":""}) {
  var start = ${R("sequence",P,"at1")};
  var end = ${R("sequence",J,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+k+(P==="FROM_END"||P==="FROM_START"?", "+St:"")+(J==="FROM_END"||J==="FROM_START"?", "+_:"")+")"}return[k,O.FUNCTION_CALL]},U=function(_,v){const k=v.valueToCode(_,"LIST",O.FUNCTION_CALL)||"[]",P=_.getFieldValue("DIRECTION")==="1"?1:-1;return _=_.getFieldValue("TYPE"),v=v.provideFunction_("listsGetSortCompare",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return String(a) > String(b) ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `),[k+".slice().sort("+v+'("'+_+'", '+P+"))",O.FUNCTION_CALL]},W=function(_,v){let k=v.valueToCode(_,"INPUT",O.MEMBER);if(v=v.valueToCode(_,"DELIM",O.NONE)||"''",_=_.getFieldValue("MODE"),_==="SPLIT")k||(k="''"),_="split";else if(_==="JOIN")k||(k="[]"),_="join";else throw Error("Unknown mode: "+_);return[k+"."+_+"("+v+")",O.FUNCTION_CALL]},tt=function(_,v){return[(v.valueToCode(_,"LIST",O.FUNCTION_CALL)||"[]")+".slice().reverse()",O.FUNCTION_CALL]},F=function(_,v){var k=0;let P="";v.STATEMENT_PREFIX&&(P+=v.injectId(v.STATEMENT_PREFIX,_));do{const J=v.valueToCode(_,"IF"+k,O.NONE)||"false";let St=v.statementToCode(_,"DO"+k);v.STATEMENT_SUFFIX&&(St=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,_),v.INDENT)+St),P+=(0<k?" else ":"")+"if ("+J+`) {
`+St+"}",k++}while(_.getInput("IF"+k));return(_.getInput("ELSE")||v.STATEMENT_SUFFIX)&&(k=v.statementToCode(_,"ELSE"),v.STATEMENT_SUFFIX&&(k=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,_),v.INDENT)+k),P+=` else {
`+k+"}"),P+`
`},st=function(_,v){const k={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[_.getFieldValue("OP")],P=k==="=="||k==="!="?O.EQUALITY:O.RELATIONAL,J=v.valueToCode(_,"A",P)||"0";return _=v.valueToCode(_,"B",P)||"0",[J+" "+k+" "+_,P]},it=function(_,v){const k=_.getFieldValue("OP")==="AND"?"&&":"||",P=k==="&&"?O.LOGICAL_AND:O.LOGICAL_OR;let J=v.valueToCode(_,"A",P);return _=v.valueToCode(_,"B",P),J||_?(v=k==="&&"?"true":"false",J||(J=v),_||(_=v)):_=J="false",[J+" "+k+" "+_,P]},Tt=function(_,v){const k=O.LOGICAL_NOT;return["!"+(v.valueToCode(_,"BOOL",k)||"true"),k]},Lt=function(_,v){return[_.getFieldValue("BOOL")==="TRUE"?"true":"false",O.ATOMIC]},It=function(_,v){return["null",O.ATOMIC]},mt=function(_,v){const k=v.valueToCode(_,"IF",O.CONDITIONAL)||"false",P=v.valueToCode(_,"THEN",O.CONDITIONAL)||"null";return _=v.valueToCode(_,"ELSE",O.CONDITIONAL)||"null",[k+" ? "+P+" : "+_,O.CONDITIONAL]},Ct=function(_,v){let k;k=_.getField("TIMES")?String(Number(_.getFieldValue("TIMES"))):v.valueToCode(_,"TIMES",O.ASSIGNMENT)||"0";let P=v.statementToCode(_,"DO");P=v.addLoopTrap(P,_),_="";const J=v.nameDB_.getDistinctName("count",o.NameType$$module$build$src$core$names.VARIABLE);let St=k;return k.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(k)||(St=v.nameDB_.getDistinctName("repeat_end",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+St+" = "+k+`;
`),_+("for (var "+J+" = 0; "+J+" < "+St+"; "+J+`++) {
`+P+`}
`)},Ft=function(_,v){const k=_.getFieldValue("MODE")==="UNTIL";let P=v.valueToCode(_,"BOOL",k?O.LOGICAL_NOT:O.NONE)||"false",J=v.statementToCode(_,"DO");return J=v.addLoopTrap(J,_),k&&(P="!"+P),"while ("+P+`) {
`+J+`}
`},Nt=function(_,v){var k=v.getVariableName(_.getFieldValue("VAR")),P=v.valueToCode(_,"FROM",O.ASSIGNMENT)||"0",J=v.valueToCode(_,"TO",O.ASSIGNMENT)||"0";const St=v.valueToCode(_,"BY",O.ASSIGNMENT)||"1";let Xt=v.statementToCode(_,"DO");if(Xt=v.addLoopTrap(Xt,_),o.isNumber$$module$build$src$core$utils$string(P)&&o.isNumber$$module$build$src$core$utils$string(J)&&o.isNumber$$module$build$src$core$utils$string(St))v=Number(P)<=Number(J),_="for ("+k+" = "+P+"; "+k+(v?" <= ":" >= ")+J+"; "+k,k=Math.abs(Number(St)),_=k===1?_+(v?"++":"--"):_+((v?" += ":" -= ")+k),_+=`) {
`+Xt+`}
`;else{_="";let Fe=P;P.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(P)||(Fe=v.nameDB_.getDistinctName(k+"_start",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+Fe+" = "+P+`;
`),P=J,J.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(J)||(P=v.nameDB_.getDistinctName(k+"_end",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+P+" = "+J+`;
`),J=v.nameDB_.getDistinctName(k+"_inc",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+J+" = ",_=o.isNumber$$module$build$src$core$utils$string(St)?_+(Math.abs(St)+`;
`):_+("Math.abs("+St+`);
`),_+="if ("+Fe+" > "+P+`) {
`,_+=v.INDENT+J+" = -"+J+`;
`,_=_+`}
for (`+(k+" = "+Fe+"; "+J+" >= 0 ? "+k+" <= "+P+" : "+k+" >= "+P+"; "+k+" += "+J+`) {
`+Xt+`}
`)}return _},qt=function(_,v){const k=v.getVariableName(_.getFieldValue("VAR"));var P=v.valueToCode(_,"LIST",O.ASSIGNMENT)||"[]";let J=v.statementToCode(_,"DO");J=v.addLoopTrap(J,_),_="";let St=P;return P.match(/^\w+$/)||(St=v.nameDB_.getDistinctName(k+"_list",o.NameType$$module$build$src$core$names.VARIABLE),_+="var "+St+" = "+P+`;
`),P=v.nameDB_.getDistinctName(k+"_index",o.NameType$$module$build$src$core$names.VARIABLE),J=v.INDENT+k+" = "+St+"["+P+`];
`+J,_+("for (var "+P+" in "+St+`) {
`+J+`}
`)},at=function(_,v){let k="";if(v.STATEMENT_PREFIX&&(k+=v.injectId(v.STATEMENT_PREFIX,_)),v.STATEMENT_SUFFIX&&(k+=v.injectId(v.STATEMENT_SUFFIX,_)),v.STATEMENT_PREFIX){const P=_.getSurroundLoop();P&&!P.suppressPrefixSuffix&&(k+=v.injectId(v.STATEMENT_PREFIX,P))}switch(_.getFieldValue("FLOW")){case"BREAK":return k+`break;
`;case"CONTINUE":return k+`continue;
`}throw Error("Unknown flow statement.")},Bt=function(_,v){return _=Number(_.getFieldValue("NUM")),[_,0<=_?O.ATOMIC:O.UNARY_NEGATION]},xt=function(_,v){var k={ADD:[" + ",O.ADDITION],MINUS:[" - ",O.SUBTRACTION],MULTIPLY:[" * ",O.MULTIPLICATION],DIVIDE:[" / ",O.DIVISION],POWER:[null,O.NONE]}[_.getFieldValue("OP")];const P=k[0];k=k[1];const J=v.valueToCode(_,"A",k)||"0";return _=v.valueToCode(_,"B",k)||"0",P?[J+P+_,k]:["Math.pow("+J+", "+_+")",O.FUNCTION_CALL]},At=function(_,v){const k=_.getFieldValue("OP");let P;if(k==="NEG")return _=v.valueToCode(_,"NUM",O.UNARY_NEGATION)||"0",_[0]==="-"&&(_=" "+_),["-"+_,O.UNARY_NEGATION];switch(_=k==="SIN"||k==="COS"||k==="TAN"?v.valueToCode(_,"NUM",O.DIVISION)||"0":v.valueToCode(_,"NUM",O.NONE)||"0",k){case"ABS":P="Math.abs("+_+")";break;case"ROOT":P="Math.sqrt("+_+")";break;case"LN":P="Math.log("+_+")";break;case"EXP":P="Math.exp("+_+")";break;case"POW10":P="Math.pow(10,"+_+")";break;case"ROUND":P="Math.round("+_+")";break;case"ROUNDUP":P="Math.ceil("+_+")";break;case"ROUNDDOWN":P="Math.floor("+_+")";break;case"SIN":P="Math.sin("+_+" / 180 * Math.PI)";break;case"COS":P="Math.cos("+_+" / 180 * Math.PI)";break;case"TAN":P="Math.tan("+_+" / 180 * Math.PI)"}if(P)return[P,O.FUNCTION_CALL];switch(k){case"LOG10":P="Math.log("+_+") / Math.log(10)";break;case"ASIN":P="Math.asin("+_+") / Math.PI * 180";break;case"ACOS":P="Math.acos("+_+") / Math.PI * 180";break;case"ATAN":P="Math.atan("+_+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+k)}return[P,O.DIVISION]},Zt=function(_,v){return{PI:["Math.PI",O.MEMBER],E:["Math.E",O.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",O.DIVISION],SQRT2:["Math.SQRT2",O.MEMBER],SQRT1_2:["Math.SQRT1_2",O.MEMBER],INFINITY:["Infinity",O.ATOMIC]}[_.getFieldValue("CONSTANT")]},Dt=function(_,v){var k={EVEN:[" % 2 === 0",O.MODULUS,O.EQUALITY],ODD:[" % 2 === 1",O.MODULUS,O.EQUALITY],WHOLE:[" % 1 === 0",O.MODULUS,O.EQUALITY],POSITIVE:[" > 0",O.RELATIONAL,O.RELATIONAL],NEGATIVE:[" < 0",O.RELATIONAL,O.RELATIONAL],DIVISIBLE_BY:[null,O.MODULUS,O.EQUALITY],PRIME:[null,O.NONE,O.FUNCTION_CALL]};const P=_.getFieldValue("PROPERTY"),[J,St,Xt]=k[P];return k=v.valueToCode(_,"NUMBER_TO_CHECK",St)||"0",P==="PRIME"?_=v.provideFunction_("mathIsPrime",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+k+")":P==="DIVISIBLE_BY"?(_=v.valueToCode(_,"DIVISOR",O.MODULUS)||"0",_=k+" % "+_+" === 0"):_=k+J,[_,Xt]},Ce=function(_,v){const k=v.valueToCode(_,"DELTA",O.ADDITION)||"0";return _=v.getVariableName(_.getFieldValue("VAR")),_+" = (typeof "+_+" === 'number' ? "+_+" : 0) + "+k+`;
`},ne=function(_,v){var k=_.getFieldValue("OP");switch(k){case"SUM":_=v.valueToCode(_,"LIST",O.MEMBER)||"[]",_+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":_=v.valueToCode(_,"LIST",O.NONE)||"[]",_="Math.min.apply(null, "+_+")";break;case"MAX":_=v.valueToCode(_,"LIST",O.NONE)||"[]",_="Math.max.apply(null, "+_+")";break;case"AVERAGE":k=v.provideFunction_("mathMean",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),_=v.valueToCode(_,"LIST",O.NONE)||"[]",_=k+"("+_+")";break;case"MEDIAN":k=v.provideFunction_("mathMedian",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),_=v.valueToCode(_,"LIST",O.NONE)||"[]",_=k+"("+_+")";break;case"MODE":k=v.provideFunction_("mathModes",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),_=v.valueToCode(_,"LIST",O.NONE)||"[]",_=k+"("+_+")";break;case"STD_DEV":k=v.provideFunction_("mathStandardDeviation",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),_=v.valueToCode(_,"LIST",O.NONE)||"[]",_=k+"("+_+")";break;case"RANDOM":k=v.provideFunction_("mathRandomList",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),_=v.valueToCode(_,"LIST",O.NONE)||"[]",_=k+"("+_+")";break;default:throw Error("Unknown operator: "+k)}return[_,O.FUNCTION_CALL]},We=function(_,v){const k=v.valueToCode(_,"DIVIDEND",O.MODULUS)||"0";return _=v.valueToCode(_,"DIVISOR",O.MODULUS)||"0",[k+" % "+_,O.MODULUS]},pt=function(_,v){const k=v.valueToCode(_,"VALUE",O.NONE)||"0",P=v.valueToCode(_,"LOW",O.NONE)||"0";return _=v.valueToCode(_,"HIGH",O.NONE)||"Infinity",["Math.min(Math.max("+k+", "+P+"), "+_+")",O.FUNCTION_CALL]},qe=function(_,v){const k=v.valueToCode(_,"FROM",O.NONE)||"0";return _=v.valueToCode(_,"TO",O.NONE)||"0",[v.provideFunction_("mathRandomInt",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+k+", "+_+")",O.FUNCTION_CALL]},xe=function(_,v){return["Math.random()",O.FUNCTION_CALL]},Ne=function(_,v){const k=v.valueToCode(_,"X",O.NONE)||"0";return["Math.atan2("+(v.valueToCode(_,"Y",O.NONE)||"0")+", "+k+") / Math.PI * 180",O.DIVISION]},Te=function(_,v){const k=v.getProcedureName(_.getFieldValue("NAME"));var P="";v.STATEMENT_PREFIX&&(P+=v.injectId(v.STATEMENT_PREFIX,_)),v.STATEMENT_SUFFIX&&(P+=v.injectId(v.STATEMENT_SUFFIX,_)),P&&(P=v.prefixLines(P,v.INDENT));let J="";v.INFINITE_LOOP_TRAP&&(J=v.prefixLines(v.injectId(v.INFINITE_LOOP_TRAP,_),v.INDENT));const St=v.statementToCode(_,"STACK");let Xt=v.valueToCode(_,"RETURN",O.NONE)||"",Fe="";St&&Xt&&(Fe=P),Xt&&(Xt=v.INDENT+"return "+Xt+`;
`);const Xn=[],zn=_.getVars();for(let Yn=0;Yn<zn.length;Yn++)Xn[Yn]=v.getVariableName(zn[Yn]);return P="function "+k+"("+Xn.join(", ")+`) {
`+P+J+St+Fe+Xt+"}",P=v.scrub_(_,P),v.definitions_["%"+k]=P,null},Xe=function(_,v){const k=v.getProcedureName(_.getFieldValue("NAME")),P=[],J=_.getVars();for(let St=0;St<J.length;St++)P[St]=v.valueToCode(_,"ARG"+St,O.NONE)||"null";return[k+"("+P.join(", ")+")",O.FUNCTION_CALL]},ai=function(_,v){return v.forBlock.procedures_callreturn(_,v)[0]+`;
`},hi=function(_,v){let k="if ("+(v.valueToCode(_,"CONDITION",O.NONE)||"false")+`) {
`;return v.STATEMENT_SUFFIX&&(k+=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,_),v.INDENT)),_.hasReturnValue_?(_=v.valueToCode(_,"VALUE",O.NONE)||"null",k+=v.INDENT+"return "+_+`;
`):k+=v.INDENT+`return;
`,k+`}
`},y=function(_,v){return[v.quote_(_.getFieldValue("TEXT")),O.ATOMIC]},D=function(_,v){return _=v.multiline_quote_(_.getFieldValue("TEXT")),v=_.indexOf("+")!==-1?O.ADDITION:O.ATOMIC,[_,v]},H=function(_,v){switch(_.itemCount_){case 0:return["''",O.ATOMIC];case 1:return _=v.valueToCode(_,"ADD0",O.NONE)||"''",Zo(_);case 2:var k=v.valueToCode(_,"ADD0",O.NONE)||"''";return _=v.valueToCode(_,"ADD1",O.NONE)||"''",[Zo(k)[0]+" + "+Zo(_)[0],O.ADDITION];default:k=Array(_.itemCount_);for(let P=0;P<_.itemCount_;P++)k[P]=v.valueToCode(_,"ADD"+P,O.NONE)||"''";return["["+k.join(",")+"].join('')",O.FUNCTION_CALL]}},j=function(_,v){const k=v.getVariableName(_.getFieldValue("VAR"));return _=v.valueToCode(_,"TEXT",O.NONE)||"''",k+" += "+Zo(_)[0]+`;
`},z=function(_,v){return[(v.valueToCode(_,"VALUE",O.MEMBER)||"''")+".length",O.MEMBER]},nt=function(_,v){return["!"+(v.valueToCode(_,"VALUE",O.MEMBER)||"''")+".length",O.LOGICAL_NOT]},rt=function(_,v){const k=_.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",P=v.valueToCode(_,"FIND",O.NONE)||"''";return v=(v.valueToCode(_,"VALUE",O.MEMBER)||"''")+"."+k+"("+P+")",_.workspace.options.oneBasedIndex?[v+" + 1",O.ADDITION]:[v,O.FUNCTION_CALL]},Z=function(_,v){const k=_.getFieldValue("WHERE")||"FROM_START",P=v.valueToCode(_,"VALUE",k==="RANDOM"?O.NONE:O.MEMBER)||"''";switch(k){case"FIRST":return[P+".charAt(0)",O.FUNCTION_CALL];case"LAST":return[P+".slice(-1)",O.FUNCTION_CALL];case"FROM_START":return _=v.getAdjusted(_,"AT"),[P+".charAt("+_+")",O.FUNCTION_CALL];case"FROM_END":return _=v.getAdjusted(_,"AT",1,!0),[P+".slice("+_+").charAt(0)",O.FUNCTION_CALL];case"RANDOM":return[v.provideFunction_("textRandomLetter",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+P+")",O.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},et=function(_,v){var k=_.getFieldValue("WHERE1");const P=_.getFieldValue("WHERE2");var J=k!=="FROM_END"&&k!=="LAST"&&P!=="FROM_END"&&P!=="LAST",St=v.valueToCode(_,"STRING",J?O.MEMBER:O.NONE)||"''";if(k==="FIRST"&&P==="LAST")return[St,O.NONE];if(St.match(/^'?\w+'?$/)||J){switch(k){case"FROM_START":k=v.getAdjusted(_,"AT1");break;case"FROM_END":k=v.getAdjusted(_,"AT1",1,!1,O.SUBTRACTION),k=St+".length - "+k;break;case"FIRST":k="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(P){case"FROM_START":v=v.getAdjusted(_,"AT2",1);break;case"FROM_END":v=v.getAdjusted(_,"AT2",0,!1,O.SUBTRACTION),v=St+".length - "+v;break;case"LAST":v=St+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}St=St+".slice("+k+", "+v+")"}else{J=v.getAdjusted(_,"AT1"),_=v.getAdjusted(_,"AT2");const Xt={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};St=v.provideFunction_("subsequence"+Xt[k]+Xt[P],`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(sequence${k==="FROM_END"||k==="FROM_START"?", at1":""}${P==="FROM_END"||P==="FROM_START"?", at2":""}) {
  var start = ${Ui("sequence",k,"at1")};
  var end = ${Ui("sequence",P,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+St+(k==="FROM_END"||k==="FROM_START"?", "+J:"")+(P==="FROM_END"||P==="FROM_START"?", "+_:"")+")"}return[St,O.FUNCTION_CALL]},q=function(_,v){const k={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[_.getFieldValue("CASE")];return _=v.valueToCode(_,"TEXT",k?O.MEMBER:O.NONE)||"''",[k?_+k:v.provideFunction_("textToTitleCase",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+_+")",O.FUNCTION_CALL]},ut=function(_,v){const k={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[_.getFieldValue("MODE")];return[(v.valueToCode(_,"TEXT",O.MEMBER)||"''")+k,O.FUNCTION_CALL]},A=function(_,v){return"window.alert("+(v.valueToCode(_,"TEXT",O.NONE)||"''")+`);
`},X=function(_,v){return v="window.prompt("+(_.getField("TEXT")?v.quote_(_.getFieldValue("TEXT")):v.valueToCode(_,"TEXT",O.NONE)||"''")+")",_.getFieldValue("TYPE")==="NUMBER"&&(v="Number("+v+")"),[v,O.FUNCTION_CALL]},kt=function(_,v){const k=v.valueToCode(_,"TEXT",O.NONE)||"''";return _=v.valueToCode(_,"SUB",O.NONE)||"''",[v.provideFunction_("textCount",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+k+", "+_+")",O.FUNCTION_CALL]},ft=function(_,v){const k=v.valueToCode(_,"TEXT",O.NONE)||"''",P=v.valueToCode(_,"FROM",O.NONE)||"''";return _=v.valueToCode(_,"TO",O.NONE)||"''",[v.provideFunction_("textReplace",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+k+", "+P+", "+_+")",O.FUNCTION_CALL]},Yt=function(_,v){return[(v.valueToCode(_,"TEXT",O.MEMBER)||"''")+".split('').reverse().join('')",O.FUNCTION_CALL]},bt=function(_,v){return[v.getVariableName(_.getFieldValue("VAR")),O.ATOMIC]},re=function(_,v){const k=v.valueToCode(_,"VALUE",O.ASSIGNMENT)||"0";return v.getVariableName(_.getFieldValue("VAR"))+" = "+k+`;
`},O={ATOMIC:0,NEW:1.1,MEMBER:1.2,FUNCTION_CALL:2,INCREMENT:3,DECREMENT:3,BITWISE_NOT:4.1,UNARY_PLUS:4.2,UNARY_NEGATION:4.3,LOGICAL_NOT:4.4,TYPEOF:4.5,VOID:4.6,DELETE:4.7,AWAIT:4.8,EXPONENTIATION:5,MULTIPLICATION:5.1,DIVISION:5.2,MODULUS:5.3,SUBTRACTION:6.1,ADDITION:6.2,BITWISE_SHIFT:7,RELATIONAL:8,IN:8,INSTANCEOF:8,EQUALITY:9,BITWISE_AND:10,BITWISE_XOR:11,BITWISE_OR:12,LOGICAL_AND:13,LOGICAL_OR:14,CONDITIONAL:15,ASSIGNMENT:16,YIELD:17,COMMA:18,NONE:99},$=class extends o.CodeGenerator$$module$build$src$core$generator{constructor(_){super(_??"JavaScript"),this.ORDER_OVERRIDES=[[O.FUNCTION_CALL,O.MEMBER],[O.FUNCTION_CALL,O.FUNCTION_CALL],[O.MEMBER,O.MEMBER],[O.MEMBER,O.FUNCTION_CALL],[O.LOGICAL_NOT,O.LOGICAL_NOT],[O.MULTIPLICATION,O.MULTIPLICATION],[O.ADDITION,O.ADDITION],[O.LOGICAL_AND,O.LOGICAL_AND],[O.LOGICAL_OR,O.LOGICAL_OR]],this.isInitialized=!1;for(const v in O)this["ORDER_"+v]=O[v];this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(_){super.init(_),this.nameDB_?this.nameDB_.reset():this.nameDB_=new o.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(_.getVariableMap()),this.nameDB_.populateVariables(_),this.nameDB_.populateProcedures(_);const v=[];var k=o.allDeveloperVariables$$module$build$src$core$variables(_);for(let P=0;P<k.length;P++)v.push(this.nameDB_.getName(k[P],o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(_=o.allUsedVarModels$$module$build$src$core$variables(_),k=0;k<_.length;k++)v.push(this.nameDB_.getName(_[k].getId(),o.NameType$$module$build$src$core$names.VARIABLE));v.length&&(this.definitions_.variables="var "+v.join(", ")+";"),this.isInitialized=!0}finish(_){const v=Object.values(this.definitions_);return super.finish(_),this.isInitialized=!1,this.nameDB_.reset(),v.join(`

`)+`


`+_}scrubNakedValue(_){return _+`;
`}quote_(_){return _=_.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+_+"'"}multiline_quote_(_){return _.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)}scrub_(_,v,k){let P="";if(!_.outputConnection||!_.outputConnection.targetConnection){var J=_.getCommentText();J&&(J=o.wrap$$module$build$src$core$utils$string(J,this.COMMENT_WRAP-3),P+=this.prefixLines(J+`
`,"// "));for(let St=0;St<_.inputList.length;St++)_.inputList[St].type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(J=_.inputList[St].connection.targetBlock())&&(J=this.allNestedComments(J))&&(P+=this.prefixLines(J,"// "))}return _=_.nextConnection&&_.nextConnection.targetBlock(),k=k?"":this.blockToCode(_),P+v+k}getAdjusted(_,v,k,P,J){k=k||0,J=J||this.ORDER_NONE,_.workspace.options.oneBasedIndex&&k--;const St=_.workspace.options.oneBasedIndex?"1":"0";let Xt,Fe=J;return 0<k?Xt=Fe=this.ORDER_ADDITION:0>k?Xt=Fe=this.ORDER_SUBTRACTION:P&&(Xt=Fe=this.ORDER_UNARY_NEGATION),_=this.valueToCode(_,v,Fe)||St,o.isNumber$$module$build$src$core$utils$string(_)?(_=Number(_)+k,P&&(_=-_)):(0<k?_=_+" + "+k:0>k&&(_=_+" - "+-k),P&&(_=k?"-("+_+")":"-"+_),Xt=Math.floor(Xt),J=Math.floor(J),Xt&&J>=Xt&&(_="("+_+")")),_}},S={};S.colour_blend=d,S.colour_picker=l,S.colour_random=a,S.colour_rgb=h;var R=function(_,v,k){return v==="FIRST"?"0":v==="FROM_END"?_+".length - 1 - "+k:v==="LAST"?_+".length - 1":k},B={};B.lists_create_empty=p,B.lists_create_with=f,B.lists_getIndex=w,B.lists_getSublist=N,B.lists_indexOf=I,B.lists_isEmpty=b,B.lists_length=T,B.lists_repeat=m,B.lists_reverse=tt,B.lists_setIndex=M,B.lists_sort=U,B.lists_split=W;var Y={};Y.controls_if=F,Y.controls_ifelse=F,Y.logic_boolean=Lt,Y.logic_compare=st,Y.logic_negate=Tt,Y.logic_null=It,Y.logic_operation=it,Y.logic_ternary=mt;var Mt={};Mt.controls_flow_statements=at,Mt.controls_for=Nt,Mt.controls_forEach=qt,Mt.controls_repeat=Ct,Mt.controls_repeat_ext=Ct,Mt.controls_whileUntil=Ft;var ge={};ge.math_arithmetic=xt,ge.math_atan2=Ne,ge.math_change=Ce,ge.math_constant=Zt,ge.math_constrain=pt,ge.math_modulo=We,ge.math_number=Bt,ge.math_number_property=Dt,ge.math_on_list=ne,ge.math_random_float=xe,ge.math_random_int=qe,ge.math_round=At,ge.math_single=At,ge.math_trig=At;var is={};is.procedures_callnoreturn=ai,is.procedures_callreturn=Xe,is.procedures_defnoreturn=Te,is.procedures_defreturn=Te,is.procedures_ifreturn=hi;var Nh=/^\s*'([^']|\\')*'\s*$/,Zo=function(_){return Nh.test(_)?[_,O.ATOMIC]:["String("+_+")",O.FUNCTION_CALL]},Ui=function(_,v,k){return v==="FIRST"?"0":v==="FROM_END"?_+".length - 1 - "+k:v==="LAST"?_+".length - 1":k},be={};be.text=y,be.text_append=j,be.text_changeCase=q,be.text_charAt=Z,be.text_count=kt,be.text_getSubstring=et,be.text_indexOf=rt,be.text_isEmpty=nt,be.text_join=H,be.text_length=z,be.text_multiline=D,be.text_print=A,be.text_prompt=X,be.text_prompt_ext=X,be.text_replace=ft,be.text_reverse=Yt,be.text_trim=ut;var Vn={};Vn.variables_get=bt,Vn.variables_set=re;var Gn={};Gn.variables_get_dynamic=bt,Gn.variables_set_dynamic=re;var Wn=new $;Object.assign(Wn.forBlock,S,B,Y,Mt,ge,is,be,Vn,Gn);var _o={};return _o.JavascriptGenerator=$,_o.Order=O,_o.javascriptGenerator=Wn,_o.__namespace__=o,_o})}(P$)),P$.exports}var By;function gM(){return By||(By=1,function(r,e){(function(s,o){r.exports=o(nb(),pM())})(as,function(s,o){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return o})}(x$)),x$.exports}var Fy;function fM(){return Fy||(Fy=1,function(r,e){(function(s,o){r.exports=o(nb(),hM(),dM(),gM())})(as,function(s,o,l,a){return s.setLocale(o),s})}(O$)),O$.exports}(function(r,e){(function(s,o){r.exports=o(fM())})(as,function(s){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})})(Lk);var Mk=Lk.exports;const Pd=cM(Mk),mM=Pd.common.createBlockDefinitionsFromJsonArray([{type:"add",message0:"add %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"addi",message0:"add %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"field_number",name:"immediate",value:0,min:0,max:63},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"sub",message0:"subtract %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lli",message0:"set lower 8 bits of register %1 to %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"field_number",name:"immediate",value:0,min:0,max:255}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lui",message0:"set upper 8 bits of register %1 to %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"field_number",name:"immediate",value:0,min:0,max:255}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"and",message0:'Do bit-wise "and" between  %1 and %2 and store result to %3',args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"or",message0:'Do bit-wise "or" between  %1 and %2 and store result to %3',args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"not",message0:'Do bit-wise "not" on %1 and store result to %2',args0:[{type:"input_value",name:"rs",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"shf",message0:"shift register %1 by %2 bits and store result to %3",args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lw",message0:"load word from address %1 + %2 %3 and store result to %4",args0:[{type:"input_value",name:"rs",check:"register"},{type:"field_number",name:"offset",value:0,min:0,max:15},{type:"input_dummy"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:120,tooltip:"",helpUrl:""},{type:"sw",message0:"store %1 to memory address %2 + %3",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"rs",check:"register"},{type:"field_number",name:"offset",value:0,min:0,max:15}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:120,tooltip:"",helpUrl:""},{type:"in",message0:"read input to register %1",args0:[{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:330,tooltip:"",helpUrl:""},{type:"out",message0:"output register %1",args0:[{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:330,tooltip:"",helpUrl:""},{type:"bez",message0:"if  %1 is zero, jump to label %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"Label",check:"label"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"bgz",message0:"if  %1 is greater than zero, jump to label %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"label",check:"label"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"jalr",message0:"store PC+1 to  %1 and jump to label %2",args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"label",check:"label"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"halt",message0:"halt",previousStatement:null,colour:0,tooltip:"",helpUrl:""},{type:"start",message0:"start",nextStatement:null,colour:0,tooltip:"",helpUrl:""},{type:"register",message0:"register %1",args0:[{type:"field_number",name:"registerNr",value:0,min:0,max:15}],output:"register",colour:122,tooltip:"",helpUrl:""},{type:"labelsection",message0:"Label %1 %2",args0:[{type:"input_value",name:"label",check:"label"},{type:"input_statement",name:"statements"}],previousStatement:null,nextStatement:null,colour:20,tooltip:"",helpUrl:""},{type:"labeldescriptor",message0:"%1",args0:[{type:"field_input",name:"label_name",text:"loop1"}],output:"label",colour:65,tooltip:"label name",helpUrl:""}]),Oe=new Mk.Generator("ANNA"),Jt={ATOMIC:0};Oe.scrub_=function(r,e,s){const o=r.nextConnection&&r.nextConnection.targetBlock();return r.parentBlock_==null&&r.type!=="start"?null:o&&!s?e.length==0?`${e}${Oe.blockToCode(o)}`:`${e}
${Oe.blockToCode(o)}`:e};Oe.forBlock.add=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"rs2",Jt.ATOMIC),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`add ${l} ${s} ${o}`;return a};Oe.forBlock.register=function(r,e){var s=r.getFieldValue("registerNr"),o=`r${s}`;return[o,Jt.ATOMIC]};Oe.forBlock.addi=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=r.getFieldValue("immediate"),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`addi ${l} ${s} ${o}`;return a};Oe.forBlock.sub=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"rs2",Jt.ATOMIC),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`sub ${l} ${s} ${o}`;return a};Oe.forBlock.lli=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=r.getFieldValue("immediate"),l=`lli ${s} ${o}`;return l};Oe.forBlock.lui=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=r.getFieldValue("immediate"),l=`lui ${s} ${o}`;return l};Oe.forBlock.and=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"rs2",Jt.ATOMIC),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`and ${l} ${s} ${o}`;return a};Oe.forBlock.or=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"rs2",Jt.ATOMIC),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`or ${l} ${s} ${o}`;return a};Oe.forBlock.not=function(r,e){var s=e.valueToCode(r,"rs",Jt.ATOMIC),o=e.valueToCode(r,"rd",Jt.ATOMIC),l=`not ${o} ${s}`;return l};Oe.forBlock.shf=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"rs2",Jt.ATOMIC),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`shf ${l} ${s} ${o}`;return a};Oe.forBlock.lw=function(r,e){var s=e.valueToCode(r,"rs",Jt.ATOMIC),o=r.getFieldValue("offset"),l=e.valueToCode(r,"rd",Jt.ATOMIC),a=`lw ${l} ${s} ${o}`;return a};Oe.forBlock.sw=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=e.valueToCode(r,"rs",Jt.ATOMIC),l=r.getFieldValue("offset"),a=`sw ${s} ${o} ${l}`;return a};Oe.forBlock.in=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=`in ${s}`;return o};Oe.forBlock.out=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=`out ${s}`;return o};Oe.forBlock.bez=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=e.valueToCode(r,"Label",Jt.ATOMIC),l=`bez ${s} &${o}`;return l};Oe.forBlock.bgz=function(r,e){var s=e.valueToCode(r,"rd",Jt.ATOMIC),o=e.valueToCode(r,"label",Jt.ATOMIC),l=`bgz ${s} &${o}`;return l};Oe.forBlock.jalr=function(r,e){var s=e.valueToCode(r,"rs1",Jt.ATOMIC),o=e.valueToCode(r,"label",Jt.ATOMIC),l=`jalr ${s} &${o}`;return l};Oe.forBlock.halt=function(r,e){var s=".halt";return s};Oe.forBlock.start=function(r,e){var s="";return s};Oe.forBlock.register=function(r,e){var s=r.getFieldValue("registerNr"),o=`r${s}`;return[o,Jt.ATOMIC]};Oe.forBlock.labelsection=function(r,e){let s=e.valueToCode(r,"label",Jt.ATOMIC),o=e.statementToCode(r,"statements");return`${s}: ${o} 
`};Oe.forBlock.labeldescriptor=function(r,e){var s=r.getFieldValue("label_name");return[s,Jt.ATOMIC]};const $M=`
############################
# Generated Assembler Code #
############################
`,_M=(r,e)=>{const s=r.split(`
`);let o="";for(let l of s)o+=TM(l,e);return`${$M}
${o}`.trim()},TM=(r,e)=>{let s="";if(bM(r)){let o=`${r.split(":")[0].trim()}:`,l=r.split(":")[1].trim();s=`
${o.padEnd(e," ")}${l}`}else s="".padStart(e," ")+r.trim();return`${s}
`},bM=r=>r.indexOf(":")!=-1;var Bd=nb();const Dk="blocksambler-local-storage",EM=function(r){var s;const e=Bd.serialization.workspaces.save(r);(s=window.localStorage)==null||s.setItem(Dk,JSON.stringify(e))},vM=function(r){var s;const e=(s=window.localStorage)==null?void 0:s.getItem(Dk);e&&(Bd.Events.disable(),Bd.serialization.workspaces.load(JSON.parse(e),r,!1),Bd.Events.enable())};class IM{constructor(e,s,o,l){this.instructionFactory=o,this.interruptHandler=l,this.addressSize=s,this.memorySize=2**s,this.loadedProgramSize=0,this.isRunning=!1,this.output=[],this.registers={pc:Ut.fromSignedIntValue(0,this.addressSize),...e},this.memory=[],this.initMemory(this.memorySize)}print(e){this.output.push(e)}getInstructionFactory(){return this.instructionFactory}initMemory(){this.memory=[];for(let e=0;e<this.memorySize;e++)this.memory[e]=Ut.fromSignedIntValue(0,this.addressSize),this.memory[e].id=e}getMemoryFragment(e,s){let o=[];for(let l=e;l<s;l++)o.push({address:l,word:this.memory[l]});return o}loadProgramm(e){this.loadedProgramSize=e.length;for(let s in e){let o=e[s].toMachineCode();this.memory[s].set(Ut.fromString(o))}}executeNextInstruction(){let e=this.loadNextInstruction();this.registers.pc.set(this.registers.pc.addImmedate(1)),e.executeOn(this)}loadNextInstruction(){let e=this.registers.pc.toUnsignedIntValue(),s=this.memory[e].toBitString();return this.instructionFactory.createFromOpCode(s)}storeToMemory(e,s){this.memory[e].set(s)}loadFromMemory(e){return this.memory[e]}callInterrupt(e,...s){return this.interruptHandler[e](this,...s)}resetMemory(){this.loadedProgramSize=0;for(let e in this.memory)this.memory[e].set(Ut.fromSignedIntValue(0,this.addressSize))}resetRegisters(){for(let e in this.registers)this.registers[e].set(Ut.fromSignedIntValue(0,this.addressSize))}halt(){this.isRunning=!1}}class Ut{constructor(){Qt(this,"bits",[])}static fromString(e){return Ut.fromBitArray([...e].reverse())}static fromBitArray(e){let s=new Ut;return s.bits=e.map(o=>parseInt(o)),s}static fromSignedIntValue(e,s=16){let o=new Ut;return e<0?o.bits=Ut.integerToTwoCompliment(Math.abs(e),s):o.bits=Ut.integerToBitArray(e,s),o}static integerToTwoCompliment(e,s){let o=Ut.integerToBitArray(e-1,s);return Ut.invertBits(o)}static integerToBitArray(e,s){let o=[...e.toString(2)].map(l=>parseInt(l)).reverse();for(;o.length<s;)o.push(0);return o.length>s&&(o=o.slice(0,s)),o}static invertBits(e){return e.map(s=>s==1?0:1)}toSignedIntValue(){let e=this.bits[this.bits.length-1]==1,s=[...this.bits].reverse();if(e){let o=Ut.invertBits(s).reduce((l,a)=>l.toString()+a.toString());return(parseInt(o,2)+1)*-1}return parseInt(s.reduce((o,l)=>o.toString()+l.toString()),2)}toUnsignedIntValue(){let e=[...this.bits].reverse().join("");return parseInt(e,2)}set(e){this.bits=[...e.bits]}add(e){let s=this.toSignedIntValue()+e.toSignedIntValue();return Ut.fromSignedIntValue(s,this.size)}addImmedate(e){let s=Ut.fromSignedIntValue(e);return this.add(s)}subtract(e){let s=this.toSignedIntValue()-e.toSignedIntValue();return Ut.fromSignedIntValue(s,this.size)}invert(){return Ut.fromBitArray(Ut.invertBits(this.bits))}or(e){let s=this.toSignedIntValue()|e.toSignedIntValue();return Ut.fromSignedIntValue(s,this.bits.length)}and(e){let s=this.toSignedIntValue()&e.toSignedIntValue();return Ut.fromSignedIntValue(s,this.bits.length)}shift(e){let s=this.bits.length,o=Ut.fromBitArray(this.bits);e>0&&o.bits.reverse();for(let l=0;l<Math.abs(e);l++)o.bits.shift();for(;o.bits.length<s;)o.bits.push(0);return e>0&&o.bits.reverse(),o}toBitString(){return[...this.bits].reverse().join("")}toString(){return`${this.toSignedIntValue()}`}}class xo extends Ut{static fromString(e){return xo.fromBitArray([...e].reverse())}static fromBitArray(e){let s=new xo;return s.bits=e.map(o=>parseInt(o)),s}static fromSignedIntValue(e,s=16){let o=new xo;return e<0?o.bits=xo.integerToTwoCompliment(Math.abs(e),s):o.bits=xo.integerToBitArray(e,s),o}static integerToTwoCompliment(e,s){let o=xo.integerToBitArray(e-1,s);return xo.invertBits(o)}static integerToBitArray(e,s){let o=[...e.toString(2)].map(l=>parseInt(l)).reverse();for(;o.length<s;)o.push(0);return o.length>s&&(o=o.slice(0,s)),o}static invertBits(e){return e.map(s=>s==1?0:1)}set(e){console.log("set instruction on immutable word prevented!")}}const On=(r,e,s="0")=>{let o="";for(;r.length+o.length<e;)o+="0";return`${o}${r}`};class rb{constructor(e){this.meta=e}}class SM{createFromMnemonic(e,s){let o=this.getInstructionClassByMnemonic(e);return new o(s)}getInstructionClassByMnemonic(e){return Hy.filter(s=>s.mnemonic==e)[0]}createFromOpCode(e){return e=="1111000000000000"?ep.fromMachineCode(e):this.getInstructionClassByOpCode(e.slice(0,4)).fromMachineCode(e)}getInstructionClassByOpCode(e){return Hy.filter(s=>s.opCode==e)[0]}}class Jo extends rb{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get rs1(){return this.meta.args[1]?parseInt(this.meta.args[1][1]):0}get rs2(){return this.meta.args[2]?parseInt(this.meta.args[2][1]):0}toMachineCode(){let e=this.constructor.opCode+On(this.rd.toString(2),3);return e+=On(this.rs1.toString(2),3),e+=On(this.rs2.toString(2),3),e+="000",e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} r${this.rs1} r${this.rs2}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2),l=parseInt(e.slice(10,13),2);return{args:[`r${s}`,`r${o}`,`r${l}`]}}}class dh extends rb{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get rs(){return this.meta.args[1]?parseInt(this.meta.args[1][1]):0}get imm(){return this.meta.args[2]?parseInt(this.meta.args[2]):0}toMachineCode(){let e=this.constructor.opCode+On(this.rd.toString(2),3);return e+=On(this.rs.toString(2),3),e+=Ut.fromSignedIntValue(this.imm,6).toBitString(),e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} r${this.rs} #${this.imm}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2),l=e.slice(10,16),a=Ut.fromString(l).toSignedIntValue();return{args:[`r${s}`,`r${o}`,a]}}}class Ap extends rb{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get imm(){return this.meta.args[1]?parseInt(this.meta.args[1]):0}toMachineCode(){let e=this.constructor.opCode+On(this.rd.toString(2),3);return e+="0",e+=Ut.fromSignedIntValue(this.imm,8).toBitString(),e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} #${this.imm}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=e.slice(8,16),l=Ut.fromString(o).toSignedIntValue();return{args:[`r${s}`,l]}}}const Wa=class Wa extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.add(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new Wa(s)}};Qt(Wa,"mnemonic","add"),Qt(Wa,"opCode","0000");let A_=Wa;const Xa=class Xa extends dh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm),a=o.addImmedate(l);s.set(a)}static fromMachineCode(e){let s=dh.extractMeta(e);return new Xa(s)}};Qt(Xa,"mnemonic","addi"),Qt(Xa,"opCode","1100");let R_=Xa;const za=class za extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.subtract(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new za(s)}};Qt(za,"mnemonic","sub"),Qt(za,"opCode","0001");let N_=za;const Ya=class Ya extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.and(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new Ya(s)}};Qt(Ya,"mnemonic","and"),Qt(Ya,"opCode","0010");let L_=Ya;const Ka=class Ka extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.or(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new Ka(s)}};Qt(Ka,"mnemonic","or"),Qt(Ka,"opCode","0011");let M_=Ka;const ja=class ja extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1];s.set(o.invert())}static fromMachineCode(e){let s=this.extractMeta(e);return new ja(s)}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2);return{args:[`r${s}`,`r${o}`]}}};Qt(ja,"mnemonic","not"),Qt(ja,"opCode","0100");let D_=ja;const Ja=class Ja extends dh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm);s.set(o.shift(l))}static fromMachineCode(e){let s=this.extractMeta(e);return new Ja(s)}};Qt(Ja,"mnemonic","shf"),Qt(Ja,"opCode","0101");let x_=Ja;const qa=class qa extends Ap{executeOn(e){let s=e.registers[this.rd],o=Number(this.imm),l=Ut.fromString("0000000011111111"),a=Ut.fromSignedIntValue(o).and(l);s.set(s.and(l.invert()).or(a))}static fromMachineCode(e){let s=this.extractMeta(e);return new qa(s)}};Qt(qa,"mnemonic","lli"),Qt(qa,"opCode","0110");let P_=qa;const Za=class Za extends Ap{executeOn(e){let s=e.registers[this.rd],o=Number(this.imm),l=Ut.fromString("0000000011111111"),a=Ut.fromSignedIntValue(o).and(l).shift(8);s.set(s.and(l).or(a))}static fromMachineCode(e){let s=this.extractMeta(e);return new Za(s)}};Qt(Za,"mnemonic","lui"),Qt(Za,"opCode","0111");let B_=Za;const Qa=class Qa extends dh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm);s.set(e.loadFromMemory(o.toSignedIntValue()+l))}static fromMachineCode(e){let s=this.extractMeta(e);return new Qa(s)}};Qt(Qa,"mnemonic","lw"),Qt(Qa,"opCode","1000");let F_=Qa;const th=class th extends dh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=this.imm;e.storeToMemory(o.toSignedIntValue()+l,s)}static fromMachineCode(e){let s=this.extractMeta(e);return new th(s)}};Qt(th,"mnemonic","sw"),Qt(th,"opCode","1001");let H_=th;const eh=class eh extends Ap{executeOn(e){if(e.registers[this.rd].toSignedIntValue()==0){let o=e.registers.pc.toSignedIntValue();e.registers.pc.set(Ut.fromSignedIntValue(o+this.imm))}}static fromMachineCode(e){let s=this.extractMeta(e);return new eh(s)}};Qt(eh,"mnemonic","bez"),Qt(eh,"opCode","1010");let U_=eh;const ih=class ih extends Ap{executeOn(e){if(e.registers[this.rd].toSignedIntValue()>0){let o=e.registers.pc.toSignedIntValue();e.registers.pc.set(Ut.fromSignedIntValue(o+this.imm))}}static fromMachineCode(e){let s=this.extractMeta(e);return new ih(s)}};Qt(ih,"mnemonic","bgz"),Qt(ih,"opCode","1011");let V_=ih;const sh=class sh extends Jo{executeOn(e){let s=e.registers[this.rd];e.registers[this.rs1].set(e.registers.pc.add(Ut.fromSignedIntValue(1))),e.registers.pc.set(s)}static fromMachineCode(e){let s=this.extractMeta(e);return new sh(s)}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2);return{args:[`r${s}`,`r${o}`]}}};Qt(sh,"mnemonic","jalr"),Qt(sh,"opCode","1101");let G_=sh;const oh=class oh extends Jo{executeOn(e){let s=e.registers[this.rd],o=e.callInterrupt("input");s.set(Ut.fromSignedIntValue(o))}static fromMachineCode(e){let s=this.extractMeta(e);return new oh(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};Qt(oh,"mnemonic","in"),Qt(oh,"opCode","1110");let W_=oh;const nh=class nh extends Jo{executeOn(e){let s=e.registers[this.rd];e.callInterrupt("output",s)}static fromMachineCode(e){let s=this.extractMeta(e);return new nh(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};Qt(nh,"mnemonic","out"),Qt(nh,"opCode","1111");let X_=nh;const rh=class rh extends Jo{executeOn(e){e.callInterrupt("halt")}toMachineCode(){return"1111000000000000"}static fromMachineCode(e){let s=this.extractMeta(e);return new rh(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};Qt(rh,"mnemonic",".halt"),Qt(rh,"opCode","1111");let ep=rh;const Hy=[U_,V_,G_,A_,R_,N_,L_,M_,D_,x_,P_,B_,W_,X_,F_,H_,ep],Mo=16,yM={0:xo.fromSignedIntValue(0,Mo),1:Ut.fromSignedIntValue(0,Mo),2:Ut.fromSignedIntValue(0,Mo),3:Ut.fromSignedIntValue(0,Mo),4:Ut.fromSignedIntValue(0,Mo),5:Ut.fromSignedIntValue(0,Mo),6:Ut.fromSignedIntValue(0,Mo),7:Ut.fromSignedIntValue(0,Mo)},CM={input:(r,e)=>parseInt(prompt("Enter a value")),output:(r,e)=>{r.print(e)},halt:()=>{emulator.halt()}};class wM extends IM{constructor(){super(yM,Mo,new SM,CM)}}class kM{constructor(e){this.instructionFactory=e}parseCode(e){let s=e.split(`
`).map(l=>l.trim()),o=[];return s.forEach(l=>{let a=this.trimComments(l);a&&o.push(this.parseInstructionLine(a))}),this.resolveLabels(o)}trimComments(e){return e.split("#")[0]}parseInstructionLine(e){let s=e.split(" ").filter(d=>d.length>0),o=this.extractLabel(s),l=this.extractType(s),h={label:o,args:s};return this.instructionFactory.createFromMnemonic(l,h)}extractLabel(e){if(e[0].endsWith(":")){let s=e.splice(0,1)[0];return s=s.slice(0,s.length-1),s}return null}extractType(e){return e.splice(0,1)[0]}resolveLabels(e){let s={};return e.forEach((o,l)=>{o.meta.label&&(s[o.meta.label]=l)}),e.forEach((o,l)=>{for(let a in o.meta.args){let h=o.meta.args;if(h[a][0]=="&"){let d=s[h[a].slice(1)]-l-1;h[a]=d}}}),e}}const Ba=Ls(""),wi=fo(new wM),xk=fo(new kM(wi.getInstructionFactory()));const OM={class:"p-0 m-0"},AM={__name:"BaseBlocklyEditor",props:["options","assemblerCode"],setup(r,{expose:e}){const s=r,o=Ls(),l=Ls(),a=HR();return e({workspace:a}),qT(()=>{Pd.common.defineBlocks(mM);const h=s.options||{};h.toolbox||(h.toolbox=o.value),a.value=Pd.inject(l.value,h);const d=()=>{Ba.value=_M(Oe.workspaceToCode(a.value),10)};vM(a.value),d(),a.value.addChangeListener(p=>{p.isUiEvent||EM(a.value)}),a.value.addChangeListener(p=>{p.isUiEvent||p.type==Pd.Events.FINISHED_LOADING||a.value.isDragging()||d()})}),(h,d)=>(jt(),te("div",OM,[ht("div",{class:"blocklyDiv p-0 m-0",ref_key:"blocklyDiv",ref:l},null,512)]))}},RM=Sh(AM,[["__scopeId","data-v-cfc7904e"]]);class pe{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,s,o){let l=[];return this.decompose(0,e,l,2),o.length&&o.decompose(0,o.length,l,3),this.decompose(s,this.length,l,1),co.from(l,this.length-(s-e)+o.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,s=this.length){let o=[];return this.decompose(e,s,o,0),co.from(o,s-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let s=this.scanIdentical(e,1),o=this.length-this.scanIdentical(e,-1),l=new Fa(this),a=new Fa(e);for(let h=s,d=s;;){if(l.next(h),a.next(h),h=0,l.lineBreak!=a.lineBreak||l.done!=a.done||l.value!=a.value)return!1;if(d+=l.value.length,l.done||d>=o)return!0}}iter(e=1){return new Fa(this,e)}iterRange(e,s=this.length){return new Pk(this,e,s)}iterLines(e,s){let o;if(e==null)o=this.iter();else{s==null&&(s=this.lines+1);let l=this.line(e).from;o=this.iterRange(l,Math.max(l,s==this.lines+1?this.length:s<=1?0:this.line(s-1).to))}return new Bk(o)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?pe.empty:e.length<=32?new Ge(e):co.from(Ge.split(e,[]))}}class Ge extends pe{constructor(e,s=NM(e)){super(),this.text=e,this.length=s}get lines(){return this.text.length}get children(){return null}lineInner(e,s,o,l){for(let a=0;;a++){let h=this.text[a],d=l+h.length;if((s?o:d)>=e)return new LM(l,d,o,h);l=d+1,o++}}decompose(e,s,o,l){let a=e<=0&&s>=this.length?this:new Ge(Uy(this.text,e,s),Math.min(s,this.length)-Math.max(0,e));if(l&1){let h=o.pop(),d=Fd(a.text,h.text.slice(),0,a.length);if(d.length<=32)o.push(new Ge(d,h.length+a.length));else{let p=d.length>>1;o.push(new Ge(d.slice(0,p)),new Ge(d.slice(p)))}}else o.push(a)}replace(e,s,o){if(!(o instanceof Ge))return super.replace(e,s,o);let l=Fd(this.text,Fd(o.text,Uy(this.text,0,e)),s),a=this.length+o.length-(s-e);return l.length<=32?new Ge(l,a):co.from(Ge.split(l,[]),a)}sliceString(e,s=this.length,o=`
`){let l="";for(let a=0,h=0;a<=s&&h<this.text.length;h++){let d=this.text[h],p=a+d.length;a>e&&h&&(l+=o),e<p&&s>a&&(l+=d.slice(Math.max(0,e-a),s-a)),a=p+1}return l}flatten(e){for(let s of this.text)e.push(s)}scanIdentical(){return 0}static split(e,s){let o=[],l=-1;for(let a of e)o.push(a),l+=a.length+1,o.length==32&&(s.push(new Ge(o,l)),o=[],l=-1);return l>-1&&s.push(new Ge(o,l)),s}}class co extends pe{constructor(e,s){super(),this.children=e,this.length=s,this.lines=0;for(let o of e)this.lines+=o.lines}lineInner(e,s,o,l){for(let a=0;;a++){let h=this.children[a],d=l+h.length,p=o+h.lines-1;if((s?p:d)>=e)return h.lineInner(e,s,o,l);l=d+1,o=p+1}}decompose(e,s,o,l){for(let a=0,h=0;h<=s&&a<this.children.length;a++){let d=this.children[a],p=h+d.length;if(e<=p&&s>=h){let f=l&((h<=e?1:0)|(p>=s?2:0));h>=e&&p<=s&&!f?o.push(d):d.decompose(e-h,s-h,o,f)}h=p+1}}replace(e,s,o){if(o.lines<this.lines)for(let l=0,a=0;l<this.children.length;l++){let h=this.children[l],d=a+h.length;if(e>=a&&s<=d){let p=h.replace(e-a,s-a,o),f=this.lines-h.lines+p.lines;if(p.lines<f>>5-1&&p.lines>f>>5+1){let m=this.children.slice();return m[l]=p,new co(m,this.length-(s-e)+o.length)}return super.replace(a,d,p)}a=d+1}return super.replace(e,s,o)}sliceString(e,s=this.length,o=`
`){let l="";for(let a=0,h=0;a<this.children.length&&h<=s;a++){let d=this.children[a],p=h+d.length;h>e&&a&&(l+=o),e<p&&s>h&&(l+=d.sliceString(e-h,s-h,o)),h=p+1}return l}flatten(e){for(let s of this.children)s.flatten(e)}scanIdentical(e,s){if(!(e instanceof co))return 0;let o=0,[l,a,h,d]=s>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;l+=s,a+=s){if(l==h||a==d)return o;let p=this.children[l],f=e.children[a];if(p!=f)return o+p.scanIdentical(f,s);o+=p.length+1}}static from(e,s=e.reduce((o,l)=>o+l.length+1,-1)){let o=0;for(let I of e)o+=I.lines;if(o<32){let I=[];for(let w of e)w.flatten(I);return new Ge(I,s)}let l=Math.max(32,o>>5),a=l<<1,h=l>>1,d=[],p=0,f=-1,m=[];function T(I){let w;if(I.lines>a&&I instanceof co)for(let M of I.children)T(M);else I.lines>h&&(p>h||!p)?(b(),d.push(I)):I instanceof Ge&&p&&(w=m[m.length-1])instanceof Ge&&I.lines+w.lines<=32?(p+=I.lines,f+=I.length+1,m[m.length-1]=new Ge(w.text.concat(I.text),w.length+1+I.length)):(p+I.lines>l&&b(),p+=I.lines,f+=I.length+1,m.push(I))}function b(){p!=0&&(d.push(m.length==1?m[0]:co.from(m,f)),f=-1,p=m.length=0)}for(let I of e)T(I);return b(),d.length==1?d[0]:new co(d,s)}}pe.empty=new Ge([""],0);function NM(r){let e=-1;for(let s of r)e+=s.length+1;return e}function Fd(r,e,s=0,o=1e9){for(let l=0,a=0,h=!0;a<r.length&&l<=o;a++){let d=r[a],p=l+d.length;p>=s&&(p>o&&(d=d.slice(0,o-l)),l<s&&(d=d.slice(s-l)),h?(e[e.length-1]+=d,h=!1):e.push(d)),l=p+1}return e}function Uy(r,e,s){return Fd(r,[""],e,s)}class Fa{constructor(e,s=1){this.dir=s,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[s>0?1:(e instanceof Ge?e.text.length:e.children.length)<<1]}nextInner(e,s){for(this.done=this.lineBreak=!1;;){let o=this.nodes.length-1,l=this.nodes[o],a=this.offsets[o],h=a>>1,d=l instanceof Ge?l.text.length:l.children.length;if(h==(s>0?d:0)){if(o==0)return this.done=!0,this.value="",this;s>0&&this.offsets[o-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(s>0?0:1)){if(this.offsets[o]+=s,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(l instanceof Ge){let p=l.text[h+(s<0?-1:0)];if(this.offsets[o]+=s,p.length>Math.max(0,e))return this.value=e==0?p:s>0?p.slice(e):p.slice(0,p.length-e),this;e-=p.length}else{let p=l.children[h+(s<0?-1:0)];e>p.length?(e-=p.length,this.offsets[o]+=s):(s<0&&this.offsets[o]--,this.nodes.push(p),this.offsets.push(s>0?1:(p instanceof Ge?p.text.length:p.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Pk{constructor(e,s,o){this.value="",this.done=!1,this.cursor=new Fa(e,s>o?-1:1),this.pos=s>o?e.length:0,this.from=Math.min(s,o),this.to=Math.max(s,o)}nextInner(e,s){if(s<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,s<0?this.pos-this.to:this.from-this.pos);let o=s<0?this.pos-this.from:this.to-this.pos;e>o&&(e=o),o-=e;let{value:l}=this.cursor.next(e);return this.pos+=(l.length+e)*s,this.value=l.length<=o?l:s<0?l.slice(l.length-o):l.slice(0,o),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Bk{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:s,lineBreak:o,value:l}=this.inner.next(e);return s?(this.done=!0,this.value=""):o?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=l,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(pe.prototype[Symbol.iterator]=function(){return this.iter()},Fa.prototype[Symbol.iterator]=Pk.prototype[Symbol.iterator]=Bk.prototype[Symbol.iterator]=function(){return this});class LM{constructor(e,s,o,l){this.from=e,this.to=s,this.number=o,this.text=l}get length(){return this.to-this.from}}let ic="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<ic.length;r++)ic[r]+=ic[r-1];function MM(r){for(let e=1;e<ic.length;e+=2)if(ic[e]>r)return ic[e-1]<=r;return!1}function Vy(r){return r>=127462&&r<=127487}const Gy=8205;function Po(r,e,s=!0,o=!0){return(s?Fk:DM)(r,e,o)}function Fk(r,e,s){if(e==r.length)return e;e&&Hk(r.charCodeAt(e))&&Uk(r.charCodeAt(e-1))&&e--;let o=B$(r,e);for(e+=Wy(o);e<r.length;){let l=B$(r,e);if(o==Gy||l==Gy||s&&MM(l))e+=Wy(l),o=l;else if(Vy(l)){let a=0,h=e-2;for(;h>=0&&Vy(B$(r,h));)a++,h-=2;if(a%2==0)break;e+=2}else break}return e}function DM(r,e,s){for(;e>0;){let o=Fk(r,e-2,s);if(o<e)return o;e--}return 0}function Hk(r){return r>=56320&&r<57344}function Uk(r){return r>=55296&&r<56320}function B$(r,e){let s=r.charCodeAt(e);if(!Uk(s)||e+1==r.length)return s;let o=r.charCodeAt(e+1);return Hk(o)?(s-55296<<10)+(o-56320)+65536:s}function Wy(r){return r<65536?1:2}const z_=/\r\n?|\n/;var Ji=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(Ji||(Ji={}));class Ho{constructor(e){this.sections=e}get length(){let e=0;for(let s=0;s<this.sections.length;s+=2)e+=this.sections[s];return e}get newLength(){let e=0;for(let s=0;s<this.sections.length;s+=2){let o=this.sections[s+1];e+=o<0?this.sections[s]:o}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let s=0,o=0,l=0;s<this.sections.length;){let a=this.sections[s++],h=this.sections[s++];h<0?(e(o,l,a),l+=a):l+=h,o+=a}}iterChangedRanges(e,s=!1){Y_(this,e,s)}get invertedDesc(){let e=[];for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++];l<0?e.push(o,l):e.push(l,o)}return new Ho(e)}composeDesc(e){return this.empty?e:e.empty?this:Vk(this,e)}mapDesc(e,s=!1){return e.empty?this:K_(this,e,s)}mapPos(e,s=-1,o=Ji.Simple){let l=0,a=0;for(let h=0;h<this.sections.length;){let d=this.sections[h++],p=this.sections[h++],f=l+d;if(p<0){if(f>e)return a+(e-l);a+=d}else{if(o!=Ji.Simple&&f>=e&&(o==Ji.TrackDel&&l<e&&f>e||o==Ji.TrackBefore&&l<e||o==Ji.TrackAfter&&f>e))return null;if(f>e||f==e&&s<0&&!d)return e==l||s<0?a:a+p;a+=p}l=f}if(e>l)throw new RangeError(`Position ${e} is out of range for changeset of length ${l}`);return a}touchesRange(e,s=e){for(let o=0,l=0;o<this.sections.length&&l<=s;){let a=this.sections[o++],h=this.sections[o++],d=l+a;if(h>=0&&l<=s&&d>=e)return l<e&&d>s?"cover":!0;l=d}return!1}toString(){let e="";for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++];e+=(e?" ":"")+o+(l>=0?":"+l:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(s=>typeof s!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ho(e)}static create(e){return new Ho(e)}}class Qe extends Ho{constructor(e,s){super(e),this.inserted=s}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Y_(this,(s,o,l,a,h)=>e=e.replace(l,l+(o-s),h),!1),e}mapDesc(e,s=!1){return K_(this,e,s,!0)}invert(e){let s=this.sections.slice(),o=[];for(let l=0,a=0;l<s.length;l+=2){let h=s[l],d=s[l+1];if(d>=0){s[l]=d,s[l+1]=h;let p=l>>1;for(;o.length<p;)o.push(pe.empty);o.push(h?e.slice(a,a+h):pe.empty)}a+=h}return new Qe(s,o)}compose(e){return this.empty?e:e.empty?this:Vk(this,e,!0)}map(e,s=!1){return e.empty?this:K_(this,e,s,!0)}iterChanges(e,s=!1){Y_(this,e,s)}get desc(){return Ho.create(this.sections)}filter(e){let s=[],o=[],l=[],a=new ph(this);t:for(let h=0,d=0;;){let p=h==e.length?1e9:e[h++];for(;d<p||d==p&&a.len==0;){if(a.done)break t;let m=Math.min(a.len,p-d);di(l,m,-1);let T=a.ins==-1?-1:a.off==0?a.ins:0;di(s,m,T),T>0&&Sn(o,s,a.text),a.forward(m),d+=m}let f=e[h++];for(;d<f;){if(a.done)break t;let m=Math.min(a.len,f-d);di(s,m,-1),di(l,m,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(m),d+=m}}return{changes:new Qe(s,o),filtered:Ho.create(l)}}toJSON(){let e=[];for(let s=0;s<this.sections.length;s+=2){let o=this.sections[s],l=this.sections[s+1];l<0?e.push(o):l==0?e.push([o]):e.push([o].concat(this.inserted[s>>1].toJSON()))}return e}static of(e,s,o){let l=[],a=[],h=0,d=null;function p(m=!1){if(!m&&!l.length)return;h<s&&di(l,s-h,-1);let T=new Qe(l,a);d=d?d.compose(T.map(d)):T,l=[],a=[],h=0}function f(m){if(Array.isArray(m))for(let T of m)f(T);else if(m instanceof Qe){if(m.length!=s)throw new RangeError(`Mismatched change set length (got ${m.length}, expected ${s})`);p(),d=d?d.compose(m.map(d)):m}else{let{from:T,to:b=T,insert:I}=m;if(T>b||T<0||b>s)throw new RangeError(`Invalid change range ${T} to ${b} (in doc of length ${s})`);let w=I?typeof I=="string"?pe.of(I.split(o||z_)):I:pe.empty,M=w.length;if(T==b&&M==0)return;T<h&&p(),T>h&&di(l,T-h,-1),di(l,b-T,M),Sn(a,l,w),h=b}}return f(e),p(!d),d}static empty(e){return new Qe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let s=[],o=[];for(let l=0;l<e.length;l++){let a=e[l];if(typeof a=="number")s.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((h,d)=>d&&typeof h!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)s.push(a[0],0);else{for(;o.length<l;)o.push(pe.empty);o[l]=pe.of(a.slice(1)),s.push(a[0],o[l].length)}}}return new Qe(s,o)}static createSet(e,s){return new Qe(e,s)}}function di(r,e,s,o=!1){if(e==0&&s<=0)return;let l=r.length-2;l>=0&&s<=0&&s==r[l+1]?r[l]+=e:e==0&&r[l]==0?r[l+1]+=s:o?(r[l]+=e,r[l+1]+=s):r.push(e,s)}function Sn(r,e,s){if(s.length==0)return;let o=e.length-2>>1;if(o<r.length)r[r.length-1]=r[r.length-1].append(s);else{for(;r.length<o;)r.push(pe.empty);r.push(s)}}function Y_(r,e,s){let o=r.inserted;for(let l=0,a=0,h=0;h<r.sections.length;){let d=r.sections[h++],p=r.sections[h++];if(p<0)l+=d,a+=d;else{let f=l,m=a,T=pe.empty;for(;f+=d,m+=p,p&&o&&(T=T.append(o[h-2>>1])),!(s||h==r.sections.length||r.sections[h+1]<0);)d=r.sections[h++],p=r.sections[h++];e(l,f,a,m,T),l=f,a=m}}}function K_(r,e,s,o=!1){let l=[],a=o?[]:null,h=new ph(r),d=new ph(e);for(let p=-1;;)if(h.ins==-1&&d.ins==-1){let f=Math.min(h.len,d.len);di(l,f,-1),h.forward(f),d.forward(f)}else if(d.ins>=0&&(h.ins<0||p==h.i||h.off==0&&(d.len<h.len||d.len==h.len&&!s))){let f=d.len;for(di(l,d.ins,-1);f;){let m=Math.min(h.len,f);h.ins>=0&&p<h.i&&h.len<=m&&(di(l,0,h.ins),a&&Sn(a,l,h.text),p=h.i),h.forward(m),f-=m}d.next()}else if(h.ins>=0){let f=0,m=h.len;for(;m;)if(d.ins==-1){let T=Math.min(m,d.len);f+=T,m-=T,d.forward(T)}else if(d.ins==0&&d.len<m)m-=d.len,d.next();else break;di(l,f,p<h.i?h.ins:0),a&&p<h.i&&Sn(a,l,h.text),p=h.i,h.forward(h.len-m)}else{if(h.done&&d.done)return a?Qe.createSet(l,a):Ho.create(l);throw new Error("Mismatched change set lengths")}}function Vk(r,e,s=!1){let o=[],l=s?[]:null,a=new ph(r),h=new ph(e);for(let d=!1;;){if(a.done&&h.done)return l?Qe.createSet(o,l):Ho.create(o);if(a.ins==0)di(o,a.len,0,d),a.next();else if(h.len==0&&!h.done)di(o,0,h.ins,d),l&&Sn(l,o,h.text),h.next();else{if(a.done||h.done)throw new Error("Mismatched change set lengths");{let p=Math.min(a.len2,h.len),f=o.length;if(a.ins==-1){let m=h.ins==-1?-1:h.off?0:h.ins;di(o,p,m,d),l&&m&&Sn(l,o,h.text)}else h.ins==-1?(di(o,a.off?0:a.len,p,d),l&&Sn(l,o,a.textBit(p))):(di(o,a.off?0:a.len,h.off?0:h.ins,d),l&&!h.off&&Sn(l,o,h.text));d=(a.ins>p||h.ins>=0&&h.len>p)&&(d||o.length>f),a.forward2(p),h.forward(p)}}}}class ph{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,s=this.i-2>>1;return s>=e.length?pe.empty:e[s]}textBit(e){let{inserted:s}=this.set,o=this.i-2>>1;return o>=s.length&&!e?pe.empty:s[o].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class kr{constructor(e,s,o){this.from=e,this.to=s,this.flags=o}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,s=-1){let o,l;return this.empty?o=l=e.mapPos(this.from,s):(o=e.mapPos(this.from,1),l=e.mapPos(this.to,-1)),o==this.from&&l==this.to?this:new kr(o,l,this.flags)}extend(e,s=e){if(e<=this.anchor&&s>=this.anchor)return wt.range(e,s);let o=Math.abs(e-this.anchor)>Math.abs(s-this.anchor)?e:s;return wt.range(this.anchor,o)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return wt.range(e.anchor,e.head)}static create(e,s,o){return new kr(e,s,o)}}class wt{constructor(e,s){this.ranges=e,this.mainIndex=s}map(e,s=-1){return e.empty?this:wt.create(this.ranges.map(o=>o.map(e,s)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new wt([this.main],0)}addRange(e,s=!0){return wt.create([e].concat(this.ranges),s?0:this.mainIndex+1)}replaceRange(e,s=this.mainIndex){let o=this.ranges.slice();return o[s]=e,wt.create(o,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new wt(e.ranges.map(s=>kr.fromJSON(s)),e.main)}static single(e,s=e){return new wt([wt.range(e,s)],0)}static create(e,s=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let o=0,l=0;l<e.length;l++){let a=e[l];if(a.empty?a.from<=o:a.from<o)return wt.normalized(e.slice(),s);o=a.to}return new wt(e,s)}static cursor(e,s=0,o,l){return kr.create(e,e,(s==0?0:s<0?8:16)|(o==null?7:Math.min(6,o))|(l??16777215)<<6)}static range(e,s,o,l){let a=(o??16777215)<<6|(l==null?7:Math.min(6,l));return s<e?kr.create(s,e,48|a):kr.create(e,s,(s>e?8:0)|a)}static normalized(e,s=0){let o=e[s];e.sort((l,a)=>l.from-a.from),s=e.indexOf(o);for(let l=1;l<e.length;l++){let a=e[l],h=e[l-1];if(a.empty?a.from<=h.to:a.from<h.to){let d=h.from,p=Math.max(a.to,h.to);l<=s&&s--,e.splice(--l,2,a.anchor>a.head?wt.range(p,d):wt.range(d,p))}}return new wt(e,s)}}function Gk(r,e){for(let s of r.ranges)if(s.to>e)throw new RangeError("Selection points outside of document")}let lb=0;class Vt{constructor(e,s,o,l,a){this.combine=e,this.compareInput=s,this.compare=o,this.isStatic=l,this.id=lb++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new Vt(e.combine||(s=>s),e.compareInput||((s,o)=>s===o),e.compare||(e.combine?(s,o)=>s===o:cb),!!e.static,e.enables)}of(e){return new Hd([],this,0,e)}compute(e,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hd(e,this,1,s)}computeN(e,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hd(e,this,2,s)}from(e,s){return s||(s=o=>o),this.compute([e],o=>s(o.field(e)))}}function cb(r,e){return r==e||r.length==e.length&&r.every((s,o)=>s===e[o])}class Hd{constructor(e,s,o,l){this.dependencies=e,this.facet=s,this.type=o,this.value=l,this.id=lb++}dynamicSlot(e){var s;let o=this.value,l=this.facet.compareInput,a=this.id,h=e[a]>>1,d=this.type==2,p=!1,f=!1,m=[];for(let T of this.dependencies)T=="doc"?p=!0:T=="selection"?f=!0:((s=e[T.id])!==null&&s!==void 0?s:1)&1||m.push(e[T.id]);return{create(T){return T.values[h]=o(T),1},update(T,b){if(p&&b.docChanged||f&&(b.docChanged||b.selection)||j_(T,m)){let I=o(T);if(d?!Xy(I,T.values[h],l):!l(I,T.values[h]))return T.values[h]=I,1}return 0},reconfigure:(T,b)=>{let I,w=b.config.address[a];if(w!=null){let M=sp(b,w);if(this.dependencies.every(N=>N instanceof Vt?b.facet(N)===T.facet(N):N instanceof Bn?b.field(N,!1)==T.field(N,!1):!0)||(d?Xy(I=o(T),M,l):l(I=o(T),M)))return T.values[h]=M,0}else I=o(T);return T.values[h]=I,1}}}}function Xy(r,e,s){if(r.length!=e.length)return!1;for(let o=0;o<r.length;o++)if(!s(r[o],e[o]))return!1;return!0}function j_(r,e){let s=!1;for(let o of e)Ha(r,o)&1&&(s=!0);return s}function xM(r,e,s){let o=s.map(p=>r[p.id]),l=s.map(p=>p.type),a=o.filter(p=>!(p&1)),h=r[e.id]>>1;function d(p){let f=[];for(let m=0;m<o.length;m++){let T=sp(p,o[m]);if(l[m]==2)for(let b of T)f.push(b);else f.push(T)}return e.combine(f)}return{create(p){for(let f of o)Ha(p,f);return p.values[h]=d(p),1},update(p,f){if(!j_(p,a))return 0;let m=d(p);return e.compare(m,p.values[h])?0:(p.values[h]=m,1)},reconfigure(p,f){let m=j_(p,o),T=f.config.facets[e.id],b=f.facet(e);if(T&&!m&&cb(s,T))return p.values[h]=b,0;let I=d(p);return e.compare(I,b)?(p.values[h]=b,0):(p.values[h]=I,1)}}}const zy=Vt.define({static:!0});class Bn{constructor(e,s,o,l,a){this.id=e,this.createF=s,this.updateF=o,this.compareF=l,this.spec=a,this.provides=void 0}static define(e){let s=new Bn(lb++,e.create,e.update,e.compare||((o,l)=>o===l),e);return e.provide&&(s.provides=e.provide(s)),s}create(e){let s=e.facet(zy).find(o=>o.field==this);return((s==null?void 0:s.create)||this.createF)(e)}slot(e){let s=e[this.id]>>1;return{create:o=>(o.values[s]=this.create(o),1),update:(o,l)=>{let a=o.values[s],h=this.updateF(a,l);return this.compareF(a,h)?0:(o.values[s]=h,1)},reconfigure:(o,l)=>l.config.address[this.id]!=null?(o.values[s]=l.field(this),0):(o.values[s]=this.create(o),1)}}init(e){return[this,zy.of({field:this,create:e})]}get extension(){return this}}const wr={lowest:4,low:3,default:2,high:1,highest:0};function Ta(r){return e=>new Xk(e,r)}const Wk={highest:Ta(wr.highest),high:Ta(wr.high),default:Ta(wr.default),low:Ta(wr.low),lowest:Ta(wr.lowest)};class Xk{constructor(e,s){this.inner=e,this.prec=s}}class Rp{of(e){return new J_(this,e)}reconfigure(e){return Rp.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class J_{constructor(e,s){this.compartment=e,this.inner=s}}class ip{constructor(e,s,o,l,a,h){for(this.base=e,this.compartments=s,this.dynamicSlots=o,this.address=l,this.staticValues=a,this.facets=h,this.statusTemplate=[];this.statusTemplate.length<o.length;)this.statusTemplate.push(0)}staticFacet(e){let s=this.address[e.id];return s==null?e.default:this.staticValues[s>>1]}static resolve(e,s,o){let l=[],a=Object.create(null),h=new Map;for(let b of PM(e,s,h))b instanceof Bn?l.push(b):(a[b.facet.id]||(a[b.facet.id]=[])).push(b);let d=Object.create(null),p=[],f=[];for(let b of l)d[b.id]=f.length<<1,f.push(I=>b.slot(I));let m=o==null?void 0:o.config.facets;for(let b in a){let I=a[b],w=I[0].facet,M=m&&m[b]||[];if(I.every(N=>N.type==0))if(d[w.id]=p.length<<1|1,cb(M,I))p.push(o.facet(w));else{let N=w.combine(I.map(U=>U.value));p.push(o&&w.compare(N,o.facet(w))?o.facet(w):N)}else{for(let N of I)N.type==0?(d[N.id]=p.length<<1|1,p.push(N.value)):(d[N.id]=f.length<<1,f.push(U=>N.dynamicSlot(U)));d[w.id]=f.length<<1,f.push(N=>xM(N,w,I))}}let T=f.map(b=>b(d));return new ip(e,h,T,d,p,a)}}function PM(r,e,s){let o=[[],[],[],[],[]],l=new Map;function a(h,d){let p=l.get(h);if(p!=null){if(p<=d)return;let f=o[p].indexOf(h);f>-1&&o[p].splice(f,1),h instanceof J_&&s.delete(h.compartment)}if(l.set(h,d),Array.isArray(h))for(let f of h)a(f,d);else if(h instanceof J_){if(s.has(h.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(h.compartment)||h.inner;s.set(h.compartment,f),a(f,d)}else if(h instanceof Xk)a(h.inner,h.prec);else if(h instanceof Bn)o[d].push(h),h.provides&&a(h.provides,d);else if(h instanceof Hd)o[d].push(h),h.facet.extensions&&a(h.facet.extensions,wr.default);else{let f=h.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${h}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(f,d)}}return a(r,wr.default),o.reduce((h,d)=>h.concat(d))}function Ha(r,e){if(e&1)return 2;let s=e>>1,o=r.status[s];if(o==4)throw new Error("Cyclic dependency between fields and/or facets");if(o&2)return o;r.status[s]=4;let l=r.computeSlot(r,r.config.dynamicSlots[s]);return r.status[s]=2|l}function sp(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const zk=Vt.define(),Yk=Vt.define({combine:r=>r.some(e=>e),static:!0}),Kk=Vt.define({combine:r=>r.length?r[0]:void 0,static:!0}),jk=Vt.define(),Jk=Vt.define(),qk=Vt.define(),Zk=Vt.define({combine:r=>r.length?r[0]:!1});class Ic{constructor(e,s){this.type=e,this.value=s}static define(){return new BM}}class BM{of(e){return new Ic(this,e)}}class FM{constructor(e){this.map=e}of(e){return new Je(this,e)}}class Je{constructor(e,s){this.type=e,this.value=s}map(e){let s=this.type.map(this.value,e);return s===void 0?void 0:s==this.value?this:new Je(this.type,s)}is(e){return this.type==e}static define(e={}){return new FM(e.map||(s=>s))}static mapEffects(e,s){if(!e.length)return e;let o=[];for(let l of e){let a=l.map(s);a&&o.push(a)}return o}}Je.reconfigure=Je.define();Je.appendConfig=Je.define();class mi{constructor(e,s,o,l,a,h){this.startState=e,this.changes=s,this.selection=o,this.effects=l,this.annotations=a,this.scrollIntoView=h,this._doc=null,this._state=null,o&&Gk(o,s.newLength),a.some(d=>d.type==mi.time)||(this.annotations=a.concat(mi.time.of(Date.now())))}static create(e,s,o,l,a,h){return new mi(e,s,o,l,a,h)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let s of this.annotations)if(s.type==e)return s.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let s=this.annotation(mi.userEvent);return!!(s&&(s==e||s.length>e.length&&s.slice(0,e.length)==e&&s[e.length]=="."))}}mi.time=Ic.define();mi.userEvent=Ic.define();mi.addToHistory=Ic.define();mi.remote=Ic.define();function HM(r,e){let s=[];for(let o=0,l=0;;){let a,h;if(o<r.length&&(l==e.length||e[l]>=r[o]))a=r[o++],h=r[o++];else if(l<e.length)a=e[l++],h=e[l++];else return s;!s.length||s[s.length-1]<a?s.push(a,h):s[s.length-1]<h&&(s[s.length-1]=h)}}function Qk(r,e,s){var o;let l,a,h;return s?(l=e.changes,a=Qe.empty(e.changes.length),h=r.changes.compose(e.changes)):(l=e.changes.map(r.changes),a=r.changes.mapDesc(e.changes,!0),h=r.changes.compose(l)),{changes:h,selection:e.selection?e.selection.map(a):(o=r.selection)===null||o===void 0?void 0:o.map(l),effects:Je.mapEffects(r.effects,l).concat(Je.mapEffects(e.effects,a)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function q_(r,e,s){let o=e.selection,l=sc(e.annotations);return e.userEvent&&(l=l.concat(mi.userEvent.of(e.userEvent))),{changes:e.changes instanceof Qe?e.changes:Qe.of(e.changes||[],s,r.facet(Kk)),selection:o&&(o instanceof wt?o:wt.single(o.anchor,o.head)),effects:sc(e.effects),annotations:l,scrollIntoView:!!e.scrollIntoView}}function t0(r,e,s){let o=q_(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(s=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(s=!1);let h=!!e[a].sequential;o=Qk(o,q_(r,e[a],h?o.changes.newLength:r.doc.length),h)}let l=mi.create(r,o.changes,o.selection,o.effects,o.annotations,o.scrollIntoView);return VM(s?UM(l):l)}function UM(r){let e=r.startState,s=!0;for(let l of e.facet(jk)){let a=l(r);if(a===!1){s=!1;break}Array.isArray(a)&&(s=s===!0?a:HM(s,a))}if(s!==!0){let l,a;if(s===!1)a=r.changes.invertedDesc,l=Qe.empty(e.doc.length);else{let h=r.changes.filter(s);l=h.changes,a=h.filtered.mapDesc(h.changes).invertedDesc}r=mi.create(e,l,r.selection&&r.selection.map(a),Je.mapEffects(r.effects,a),r.annotations,r.scrollIntoView)}let o=e.facet(Jk);for(let l=o.length-1;l>=0;l--){let a=o[l](r);a instanceof mi?r=a:Array.isArray(a)&&a.length==1&&a[0]instanceof mi?r=a[0]:r=t0(e,sc(a),!1)}return r}function VM(r){let e=r.startState,s=e.facet(qk),o=r;for(let l=s.length-1;l>=0;l--){let a=s[l](r);a&&Object.keys(a).length&&(o=Qk(o,q_(e,a,r.changes.newLength),!0))}return o==r?r:mi.create(e,r.changes,r.selection,o.effects,o.annotations,o.scrollIntoView)}const GM=[];function sc(r){return r==null?GM:Array.isArray(r)?r:[r]}var Bo=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(Bo||(Bo={}));const WM=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Z_;try{Z_=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function XM(r){if(Z_)return Z_.test(r);for(let e=0;e<r.length;e++){let s=r[e];if(/\w/.test(s)||s>""&&(s.toUpperCase()!=s.toLowerCase()||WM.test(s)))return!0}return!1}function zM(r){return e=>{if(!/\S/.test(e))return Bo.Space;if(XM(e))return Bo.Word;for(let s=0;s<r.length;s++)if(e.indexOf(r[s])>-1)return Bo.Word;return Bo.Other}}class de{constructor(e,s,o,l,a,h){this.config=e,this.doc=s,this.selection=o,this.values=l,this.status=e.statusTemplate.slice(),this.computeSlot=a,h&&(h._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)Ha(this,d<<1);this.computeSlot=null}field(e,s=!0){let o=this.config.address[e.id];if(o==null){if(s)throw new RangeError("Field is not present in this state");return}return Ha(this,o),sp(this,o)}update(...e){return t0(this,e,!0)}applyTransaction(e){let s=this.config,{base:o,compartments:l}=s;for(let h of e.effects)h.is(Rp.reconfigure)?(s&&(l=new Map,s.compartments.forEach((d,p)=>l.set(p,d)),s=null),l.set(h.value.compartment,h.value.extension)):h.is(Je.reconfigure)?(s=null,o=h.value):h.is(Je.appendConfig)&&(s=null,o=sc(o).concat(h.value));let a;s?a=e.startState.values.slice():(s=ip.resolve(o,l,this),a=new de(s,this.doc,this.selection,s.dynamicSlots.map(()=>null),(d,p)=>p.reconfigure(d,this),null).values),new de(s,e.newDoc,e.newSelection,a,(h,d)=>d.update(h,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:e},range:wt.cursor(s.from+e.length)}))}changeByRange(e){let s=this.selection,o=e(s.ranges[0]),l=this.changes(o.changes),a=[o.range],h=sc(o.effects);for(let d=1;d<s.ranges.length;d++){let p=e(s.ranges[d]),f=this.changes(p.changes),m=f.map(l);for(let b=0;b<d;b++)a[b]=a[b].map(m);let T=l.mapDesc(f,!0);a.push(p.range.map(T)),l=l.compose(m),h=Je.mapEffects(h,m).concat(Je.mapEffects(sc(p.effects),T))}return{changes:l,selection:wt.create(a,s.mainIndex),effects:h}}changes(e=[]){return e instanceof Qe?e:Qe.of(e,this.doc.length,this.facet(de.lineSeparator))}toText(e){return pe.of(e.split(this.facet(de.lineSeparator)||z_))}sliceDoc(e=0,s=this.doc.length){return this.doc.sliceString(e,s,this.lineBreak)}facet(e){let s=this.config.address[e.id];return s==null?e.default:(Ha(this,s),sp(this,s))}toJSON(e){let s={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let o in e){let l=e[o];l instanceof Bn&&this.config.address[l.id]!=null&&(s[o]=l.spec.toJSON(this.field(e[o]),this))}return s}static fromJSON(e,s={},o){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let l=[];if(o){for(let a in o)if(Object.prototype.hasOwnProperty.call(e,a)){let h=o[a],d=e[a];l.push(h.init(p=>h.spec.fromJSON(d,p)))}}return de.create({doc:e.doc,selection:wt.fromJSON(e.selection),extensions:s.extensions?l.concat([s.extensions]):l})}static create(e={}){let s=ip.resolve(e.extensions||[],new Map),o=e.doc instanceof pe?e.doc:pe.of((e.doc||"").split(s.staticFacet(de.lineSeparator)||z_)),l=e.selection?e.selection instanceof wt?e.selection:wt.single(e.selection.anchor,e.selection.head):wt.single(0);return Gk(l,o.length),s.staticFacet(Yk)||(l=l.asSingle()),new de(s,o,l,s.dynamicSlots.map(()=>null),(a,h)=>h.create(a),null)}get tabSize(){return this.facet(de.tabSize)}get lineBreak(){return this.facet(de.lineSeparator)||`
`}get readOnly(){return this.facet(Zk)}phrase(e,...s){for(let o of this.facet(de.phrases))if(Object.prototype.hasOwnProperty.call(o,e)){e=o[e];break}return s.length&&(e=e.replace(/\$(\$|\d*)/g,(o,l)=>{if(l=="$")return"$";let a=+(l||1);return!a||a>s.length?o:s[a-1]})),e}languageDataAt(e,s,o=-1){let l=[];for(let a of this.facet(zk))for(let h of a(this,s,o))Object.prototype.hasOwnProperty.call(h,e)&&l.push(h[e]);return l}charCategorizer(e){return zM(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:s,from:o,length:l}=this.doc.lineAt(e),a=this.charCategorizer(e),h=e-o,d=e-o;for(;h>0;){let p=Po(s,h,!1);if(a(s.slice(p,h))!=Bo.Word)break;h=p}for(;d<l;){let p=Po(s,d);if(a(s.slice(d,p))!=Bo.Word)break;d=p}return h==d?null:wt.range(h+o,d+o)}}de.allowMultipleSelections=Yk;de.tabSize=Vt.define({combine:r=>r.length?r[0]:4});de.lineSeparator=Kk;de.readOnly=Zk;de.phrases=Vt.define({compare(r,e){let s=Object.keys(r),o=Object.keys(e);return s.length==o.length&&s.every(l=>r[l]==e[l])}});de.languageData=zk;de.changeFilter=jk;de.transactionFilter=Jk;de.transactionExtender=qk;Rp.reconfigure=Je.define();function YM(r,e,s={}){let o={};for(let l of r)for(let a of Object.keys(l)){let h=l[a],d=o[a];if(d===void 0)o[a]=h;else if(!(d===h||h===void 0))if(Object.hasOwnProperty.call(s,a))o[a]=s[a](d,h);else throw new Error("Config merge conflict for field "+a)}for(let l in e)o[l]===void 0&&(o[l]=e[l]);return o}class cc{eq(e){return this==e}range(e,s=e){return Q_.create(e,s,this)}}cc.prototype.startSide=cc.prototype.endSide=0;cc.prototype.point=!1;cc.prototype.mapMode=Ji.TrackDel;let Q_=class e0{constructor(e,s,o){this.from=e,this.to=s,this.value=o}static create(e,s,o){return new e0(e,s,o)}};function tT(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class ab{constructor(e,s,o,l){this.from=e,this.to=s,this.value=o,this.maxPoint=l}get length(){return this.to[this.to.length-1]}findIndex(e,s,o,l=0){let a=o?this.to:this.from;for(let h=l,d=a.length;;){if(h==d)return h;let p=h+d>>1,f=a[p]-e||(o?this.value[p].endSide:this.value[p].startSide)-s;if(p==h)return f>=0?h:d;f>=0?d=p:h=p+1}}between(e,s,o,l){for(let a=this.findIndex(s,-1e9,!0),h=this.findIndex(o,1e9,!1,a);a<h;a++)if(l(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,s){let o=[],l=[],a=[],h=-1,d=-1;for(let p=0;p<this.value.length;p++){let f=this.value[p],m=this.from[p]+e,T=this.to[p]+e,b,I;if(m==T){let w=s.mapPos(m,f.startSide,f.mapMode);if(w==null||(b=I=w,f.startSide!=f.endSide&&(I=s.mapPos(m,f.endSide),I<b)))continue}else if(b=s.mapPos(m,f.startSide),I=s.mapPos(T,f.endSide),b>I||b==I&&f.startSide>0&&f.endSide<=0)continue;(I-b||f.endSide-f.startSide)<0||(h<0&&(h=b),f.point&&(d=Math.max(d,I-b)),o.push(f),l.push(b-h),a.push(I-h))}return{mapped:o.length?new ab(l,a,o,d):null,pos:h}}}class _e{constructor(e,s,o,l){this.chunkPos=e,this.chunk=s,this.nextLayer=o,this.maxPoint=l}static create(e,s,o,l){return new _e(e,s,o,l)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let s of this.chunk)e+=s.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:s=[],sort:o=!1,filterFrom:l=0,filterTo:a=this.length}=e,h=e.filter;if(s.length==0&&!h)return this;if(o&&(s=s.slice().sort(tT)),this.isEmpty)return s.length?_e.of(s):this;let d=new i0(this,null,-1).goto(0),p=0,f=[],m=new gh;for(;d.value||p<s.length;)if(p<s.length&&(d.from-s[p].from||d.startSide-s[p].value.startSide)>=0){let T=s[p++];m.addInner(T.from,T.to,T.value)||f.push(T)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==s.length||this.chunkEnd(d.chunkIndex)<s[p].from)&&(!h||l>this.chunkEnd(d.chunkIndex)||a<this.chunkPos[d.chunkIndex])&&m.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!h||l>d.to||a<d.from||h(d.from,d.to,d.value))&&(m.addInner(d.from,d.to,d.value)||f.push(Q_.create(d.from,d.to,d.value))),d.next());return m.finishInner(this.nextLayer.isEmpty&&!f.length?_e.empty:this.nextLayer.update({add:f,filter:h,filterFrom:l,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let s=[],o=[],l=-1;for(let h=0;h<this.chunk.length;h++){let d=this.chunkPos[h],p=this.chunk[h],f=e.touchesRange(d,d+p.length);if(f===!1)l=Math.max(l,p.maxPoint),s.push(p),o.push(e.mapPos(d));else if(f===!0){let{mapped:m,pos:T}=p.map(d,e);m&&(l=Math.max(l,m.maxPoint),s.push(m),o.push(T))}}let a=this.nextLayer.map(e);return s.length==0?a:new _e(o,s,a||_e.empty,l)}between(e,s,o){if(!this.isEmpty){for(let l=0;l<this.chunk.length;l++){let a=this.chunkPos[l],h=this.chunk[l];if(s>=a&&e<=a+h.length&&h.between(a,e-a,s-a,o)===!1)return}this.nextLayer.between(e,s,o)}}iter(e=0){return fh.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,s=0){return fh.from(e).goto(s)}static compare(e,s,o,l,a=-1){let h=e.filter(T=>T.maxPoint>0||!T.isEmpty&&T.maxPoint>=a),d=s.filter(T=>T.maxPoint>0||!T.isEmpty&&T.maxPoint>=a),p=Yy(h,d,o),f=new ba(h,p,a),m=new ba(d,p,a);o.iterGaps((T,b,I)=>Ky(f,T,m,b,I,l)),o.empty&&o.length==0&&Ky(f,0,m,0,0,l)}static eq(e,s,o=0,l){l==null&&(l=1e9-1);let a=e.filter(m=>!m.isEmpty&&s.indexOf(m)<0),h=s.filter(m=>!m.isEmpty&&e.indexOf(m)<0);if(a.length!=h.length)return!1;if(!a.length)return!0;let d=Yy(a,h),p=new ba(a,d,0).goto(o),f=new ba(h,d,0).goto(o);for(;;){if(p.to!=f.to||!eT(p.active,f.active)||p.point&&(!f.point||!p.point.eq(f.point)))return!1;if(p.to>l)return!0;p.next(),f.next()}}static spans(e,s,o,l,a=-1){let h=new ba(e,null,a).goto(s),d=s,p=h.openStart;for(;;){let f=Math.min(h.to,o);if(h.point){let m=h.activeForPoint(h.to),T=h.pointFrom<s?m.length+1:Math.min(m.length,p);l.point(d,f,h.point,m,T,h.pointRank),p=Math.min(h.openEnd(f),m.length)}else f>d&&(l.span(d,f,h.active,p),p=h.openEnd(f));if(h.to>o)return p+(h.point&&h.to>o?1:0);d=h.to,h.next()}}static of(e,s=!1){let o=new gh;for(let l of e instanceof Q_?[e]:s?KM(e):e)o.add(l.from,l.to,l.value);return o.finish()}}_e.empty=new _e([],[],null,-1);function KM(r){if(r.length>1)for(let e=r[0],s=1;s<r.length;s++){let o=r[s];if(tT(e,o)>0)return r.slice().sort(tT);e=o}return r}_e.empty.nextLayer=_e.empty;class gh{finishChunk(e){this.chunks.push(new ab(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,s,o){this.addInner(e,s,o)||(this.nextLayer||(this.nextLayer=new gh)).add(e,s,o)}addInner(e,s,o){let l=e-this.lastTo||o.startSide-this.last.endSide;if(l<=0&&(e-this.lastFrom||o.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return l<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(s-this.chunkStart),this.last=o,this.lastFrom=e,this.lastTo=s,this.value.push(o),o.point&&(this.maxPoint=Math.max(this.maxPoint,s-e)),!0)}addChunk(e,s){if((e-this.lastTo||s.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,s.maxPoint),this.chunks.push(s),this.chunkPos.push(e);let o=s.value.length-1;return this.last=s.value[o],this.lastFrom=s.from[o]+e,this.lastTo=s.to[o]+e,!0}finish(){return this.finishInner(_e.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let s=_e.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,s}}function Yy(r,e,s){let o=new Map;for(let a of r)for(let h=0;h<a.chunk.length;h++)a.chunk[h].maxPoint<=0&&o.set(a.chunk[h],a.chunkPos[h]);let l=new Set;for(let a of e)for(let h=0;h<a.chunk.length;h++){let d=o.get(a.chunk[h]);d!=null&&(s?s.mapPos(d):d)==a.chunkPos[h]&&!(s!=null&&s.touchesRange(d,d+a.chunk[h].length))&&l.add(a.chunk[h])}return l}class i0{constructor(e,s,o,l=0){this.layer=e,this.skip=s,this.minPoint=o,this.rank=l}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,s=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,s,!1),this}gotoInner(e,s,o){for(;this.chunkIndex<this.layer.chunk.length;){let l=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(l)||this.layer.chunkEnd(this.chunkIndex)<e||l.maxPoint<this.minPoint))break;this.chunkIndex++,o=!1}if(this.chunkIndex<this.layer.chunk.length){let l=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],s,!0);(!o||this.rangeIndex<l)&&this.setRangeIndex(l)}this.next()}forward(e,s){(this.to-e||this.endSide-s)<0&&this.gotoInner(e,s,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],s=this.layer.chunk[this.chunkIndex],o=e+s.from[this.rangeIndex];if(this.from=o,this.to=e+s.to[this.rangeIndex],this.value=s.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class fh{constructor(e){this.heap=e}static from(e,s=null,o=-1){let l=[];for(let a=0;a<e.length;a++)for(let h=e[a];!h.isEmpty;h=h.nextLayer)h.maxPoint>=o&&l.push(new i0(h,s,o,a));return l.length==1?l[0]:new fh(l)}get startSide(){return this.value?this.value.startSide:0}goto(e,s=-1e9){for(let o of this.heap)o.goto(e,s);for(let o=this.heap.length>>1;o>=0;o--)F$(this.heap,o);return this.next(),this}forward(e,s){for(let o of this.heap)o.forward(e,s);for(let o=this.heap.length>>1;o>=0;o--)F$(this.heap,o);(this.to-e||this.value.endSide-s)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),F$(this.heap,0)}}}function F$(r,e){for(let s=r[e];;){let o=(e<<1)+1;if(o>=r.length)break;let l=r[o];if(o+1<r.length&&l.compare(r[o+1])>=0&&(l=r[o+1],o++),s.compare(l)<0)break;r[o]=s,r[e]=l,e=o}}class ba{constructor(e,s,o){this.minPoint=o,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=fh.from(e,s,o)}goto(e,s=-1e9){return this.cursor.goto(e,s),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=s,this.openStart=-1,this.next(),this}forward(e,s){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-s)<0;)this.removeActive(this.minActive);this.cursor.forward(e,s)}removeActive(e){dd(this.active,e),dd(this.activeTo,e),dd(this.activeRank,e),this.minActive=jy(this.active,this.activeTo)}addActive(e){let s=0,{value:o,to:l,rank:a}=this.cursor;for(;s<this.activeRank.length&&this.activeRank[s]<=a;)s++;pd(this.active,s,o),pd(this.activeTo,s,l),pd(this.activeRank,s,a),e&&pd(e,s,this.cursor.from),this.minActive=jy(this.active,this.activeTo)}next(){let e=this.to,s=this.point;this.point=null;let o=this.openStart<0?[]:null;for(;;){let l=this.minActive;if(l>-1&&(this.activeTo[l]-this.cursor.from||this.active[l].endSide-this.cursor.startSide)<0){if(this.activeTo[l]>e){this.to=this.activeTo[l],this.endSide=this.active[l].endSide;break}this.removeActive(l),o&&dd(o,l)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(o),this.cursor.next();else if(s&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(o){this.openStart=0;for(let l=o.length-1;l>=0&&o[l]<e;l--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let s=[];for(let o=this.active.length-1;o>=0&&!(this.activeRank[o]<this.pointRank);o--)(this.activeTo[o]>e||this.activeTo[o]==e&&this.active[o].endSide>=this.point.endSide)&&s.push(this.active[o]);return s.reverse()}openEnd(e){let s=0;for(let o=this.activeTo.length-1;o>=0&&this.activeTo[o]>e;o--)s++;return s}}function Ky(r,e,s,o,l,a){r.goto(e),s.goto(o);let h=o+l,d=o,p=o-e;for(;;){let f=r.to+p-s.to||r.endSide-s.endSide,m=f<0?r.to+p:s.to,T=Math.min(m,h);if(r.point||s.point?r.point&&s.point&&(r.point==s.point||r.point.eq(s.point))&&eT(r.activeForPoint(r.to),s.activeForPoint(s.to))||a.comparePoint(d,T,r.point,s.point):T>d&&!eT(r.active,s.active)&&a.compareRange(d,T,r.active,s.active),m>h)break;d=m,f<=0&&r.next(),f>=0&&s.next()}}function eT(r,e){if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!=e[s]&&!r[s].eq(e[s]))return!1;return!0}function dd(r,e){for(let s=e,o=r.length-1;s<o;s++)r[s]=r[s+1];r.pop()}function pd(r,e,s){for(let o=r.length-1;o>=e;o--)r[o+1]=r[o];r[e]=s}function jy(r,e){let s=-1,o=1e9;for(let l=0;l<e.length;l++)(e[l]-o||r[l].endSide-r[s].endSide)<0&&(s=l,o=e[l]);return s}function jM(r,e,s,o){for(let l=0,a=0;;){if(a>=e)return l;if(l==r.length)break;a+=r.charCodeAt(l)==9?s-a%s:1,l=Po(r,l)}return o===!0?-1:r.length}const iT="ͼ",Jy=typeof Symbol>"u"?"__"+iT:Symbol.for(iT),sT=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),qy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ln{constructor(e,s){this.rules=[];let{finish:o}=s||{};function l(h){return/^@/.test(h)?[h]:h.split(/,\s*/)}function a(h,d,p,f){let m=[],T=/^@(\w+)\b/.exec(h[0]),b=T&&T[1]=="keyframes";if(T&&d==null)return p.push(h[0]+";");for(let I in d){let w=d[I];if(/&/.test(I))a(I.split(/,\s*/).map(M=>h.map(N=>M.replace(/&/,N))).reduce((M,N)=>M.concat(N)),w,p);else if(w&&typeof w=="object"){if(!T)throw new RangeError("The value of a property ("+I+") should be a primitive value.");a(l(I),w,m,b)}else w!=null&&m.push(I.replace(/_.*/,"").replace(/[A-Z]/g,M=>"-"+M.toLowerCase())+": "+w+";")}(m.length||b)&&p.push((o&&!T&&!f?h.map(o):h).join(", ")+" {"+m.join(" ")+"}")}for(let h in e)a(l(h),e[h],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=qy[Jy]||1;return qy[Jy]=e+1,iT+e.toString(36)}static mount(e,s,o){let l=e[sT],a=o&&o.nonce;l?a&&l.setNonce(a):l=new JM(e,a),l.mount(Array.isArray(s)?s:[s])}}let Zy=new Map;class JM{constructor(e,s){let o=e.ownerDocument||e,l=o.defaultView;if(!e.head&&e.adoptedStyleSheets&&l.CSSStyleSheet){let a=Zy.get(o);if(a)return e.adoptedStyleSheets=[a.sheet,...e.adoptedStyleSheets],e[sT]=a;this.sheet=new l.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],Zy.set(o,this)}else{this.styleTag=o.createElement("style"),s&&this.styleTag.setAttribute("nonce",s);let a=e.head||e;a.insertBefore(this.styleTag,a.firstChild)}this.modules=[],e[sT]=this}mount(e){let s=this.sheet,o=0,l=0;for(let a=0;a<e.length;a++){let h=e[a],d=this.modules.indexOf(h);if(d<l&&d>-1&&(this.modules.splice(d,1),l--,d=-1),d==-1){if(this.modules.splice(l++,0,h),s)for(let p=0;p<h.rules.length;p++)s.insertRule(h.rules[p],o++)}else{for(;l<d;)o+=this.modules[l++].rules.length;o+=h.rules.length,l++}}if(!s){let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var ac={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},oT={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};for(var ri=0;ri<10;ri++)ac[48+ri]=ac[96+ri]=String(ri);for(var ri=1;ri<=24;ri++)ac[ri+111]="F"+ri;for(var ri=65;ri<=90;ri++)ac[ri]=String.fromCharCode(ri+32),oT[ri]=String.fromCharCode(ri);for(var H$ in ac)oT.hasOwnProperty(H$)||(oT[H$]=ac[H$]);function op(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function nT(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function qM(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Ud(r,e){if(!e.anchorNode)return!1;try{return nT(r,e.anchorNode)}catch{return!1}}function mh(r){return r.nodeType==3?Br(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function np(r,e,s,o){return s?Qy(r,e,s,o,-1)||Qy(r,e,s,o,1):!1}function $h(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function Qy(r,e,s,o,l){for(;;){if(r==s&&e==o)return!0;if(e==(l<0?0:Wo(r))){if(r.nodeName=="DIV")return!1;let a=r.parentNode;if(!a||a.nodeType!=1)return!1;e=$h(r)+(l<0?0:1),r=a}else if(r.nodeType==1){if(r=r.childNodes[e+(l<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=l<0?Wo(r):0}else return!1}}function Wo(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function hb(r,e){let s=e?r.left:r.right;return{left:s,right:s,top:r.top,bottom:r.bottom}}function ZM(r){return{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function QM(r,e,s,o,l,a,h,d){let p=r.ownerDocument,f=p.defaultView||window;for(let m=r,T=!1;m&&!T;)if(m.nodeType==1){let b,I=m==p.body,w=1,M=1;if(I)b=ZM(f);else{if(/^(fixed|sticky)$/.test(getComputedStyle(m).position)&&(T=!0),m.scrollHeight<=m.clientHeight&&m.scrollWidth<=m.clientWidth){m=m.assignedSlot||m.parentNode;continue}let W=m.getBoundingClientRect();w=W.width/m.offsetWidth,M=W.height/m.offsetHeight,b={left:W.left,right:W.left+m.clientWidth*w,top:W.top,bottom:W.top+m.clientHeight*M}}let N=0,U=0;if(l=="nearest")e.top<b.top?(U=-(b.top-e.top+h),s>0&&e.bottom>b.bottom+U&&(U=e.bottom-b.bottom+U+h)):e.bottom>b.bottom&&(U=e.bottom-b.bottom+h,s<0&&e.top-U<b.top&&(U=-(b.top+U-e.top+h)));else{let W=e.bottom-e.top,tt=b.bottom-b.top;U=(l=="center"&&W<=tt?e.top+W/2-tt/2:l=="start"||l=="center"&&s<0?e.top-h:e.bottom-tt+h)-b.top}if(o=="nearest"?e.left<b.left?(N=-(b.left-e.left+a),s>0&&e.right>b.right+N&&(N=e.right-b.right+N+a)):e.right>b.right&&(N=e.right-b.right+a,s<0&&e.left<b.left+N&&(N=-(b.left+N-e.left+a))):N=(o=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:o=="start"==d?e.left-a:e.right-(b.right-b.left)+a)-b.left,N||U)if(I)f.scrollBy(N,U);else{let W=0,tt=0;if(U){let F=m.scrollTop;m.scrollTop+=U/M,tt=(m.scrollTop-F)*M}if(N){let F=m.scrollLeft;m.scrollLeft+=N/w,W=(m.scrollLeft-F)*w}e={left:e.left-W,top:e.top-tt,right:e.right-W,bottom:e.bottom-tt},W&&Math.abs(W-N)<1&&(o="nearest"),tt&&Math.abs(tt-U)<1&&(l="nearest")}if(I)break;m=m.assignedSlot||m.parentNode}else if(m.nodeType==11)m=m.host;else break}function tD(r){let e=r.ownerDocument;for(let s=r.parentNode;s&&s!=e.body;)if(s.nodeType==1){if(s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth)return s;s=s.assignedSlot||s.parentNode}else if(s.nodeType==11)s=s.host;else break;return null}class eD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:s,focusNode:o}=e;this.set(s,Math.min(e.anchorOffset,s?Wo(s):0),o,Math.min(e.focusOffset,o?Wo(o):0))}set(e,s,o,l){this.anchorNode=e,this.anchorOffset=s,this.focusNode=o,this.focusOffset=l}}let Vl=null;function s0(r){if(r.setActive)return r.setActive();if(Vl)return r.focus(Vl);let e=[];for(let s=r;s&&(e.push(s,s.scrollTop,s.scrollLeft),s!=s.ownerDocument);s=s.parentNode);if(r.focus(Vl==null?{get preventScroll(){return Vl={preventScroll:!0},!0}}:void 0),!Vl){Vl=!1;for(let s=0;s<e.length;){let o=e[s++],l=e[s++],a=e[s++];o.scrollTop!=l&&(o.scrollTop=l),o.scrollLeft!=a&&(o.scrollLeft=a)}}}let tC;function Br(r,e,s=e){let o=tC||(tC=document.createRange());return o.setEnd(r,s),o.setStart(r,e),o}function oc(r,e,s){let o={key:e,code:e,keyCode:s,which:s,cancelable:!0},l=new KeyboardEvent("keydown",o);l.synthetic=!0,r.dispatchEvent(l);let a=new KeyboardEvent("keyup",o);return a.synthetic=!0,r.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function iD(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function o0(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function sD(r,e){let s=e.focusNode,o=e.focusOffset;if(!s||e.anchorNode!=s||e.anchorOffset!=o)return!1;for(o=Math.min(o,Wo(s));;)if(o){if(s.nodeType!=1)return!1;let l=s.childNodes[o-1];l.contentEditable=="false"?o--:(s=l,o=Wo(s))}else{if(s==r)return!0;o=$h(s),s=s.parentNode}}function n0(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}class gi{constructor(e,s,o=!0){this.node=e,this.offset=s,this.precise=o}static before(e,s){return new gi(e.parentNode,$h(e),s)}static after(e,s){return new gi(e.parentNode,$h(e)+1,s)}}const ub=[];class Re{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let s=this.posAtStart;for(let o of this.children){if(o==e)return s;s+=o.length+o.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,s){if(this.flags&2){let o=this.dom,l=null,a;for(let h of this.children){if(h.flags&7){if(!h.dom&&(a=l?l.nextSibling:o.firstChild)){let d=Re.get(a);(!d||!d.parent&&d.canReuseDOM(h))&&h.reuseDOM(a)}h.sync(e,s),h.flags&=-8}if(a=l?l.nextSibling:o.firstChild,s&&!s.written&&s.node==o&&a!=h.dom&&(s.written=!0),h.dom.parentNode==o)for(;a&&a!=h.dom;)a=eC(a);else o.insertBefore(h.dom,a);l=h.dom}for(a=l?l.nextSibling:o.firstChild,a&&s&&s.node==o&&(s.written=!0);a;)a=eC(a)}else if(this.flags&1)for(let o of this.children)o.flags&7&&(o.sync(e,s),o.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,s){let o;if(e==this.dom)o=this.dom.childNodes[s];else{let l=Wo(e)==0?0:s==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;l==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?l=-1:l=1),e=a}l<0?o=e:o=e.nextSibling}if(o==this.dom.firstChild)return 0;for(;o&&!Re.get(o);)o=o.nextSibling;if(!o)return this.length;for(let l=0,a=0;;l++){let h=this.children[l];if(h.dom==o)return a;a+=h.length+h.breakAfter}}domBoundsAround(e,s,o=0){let l=-1,a=-1,h=-1,d=-1;for(let p=0,f=o,m=o;p<this.children.length;p++){let T=this.children[p],b=f+T.length;if(f<e&&b>s)return T.domBoundsAround(e,s,f);if(b>=e&&l==-1&&(l=p,a=f),f>s&&T.dom.parentNode==this.dom){h=p,d=m;break}m=b,f=b+T.breakAfter}return{from:a,to:d<0?o+this.length:d,startDOM:(l?this.children[l-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:h<this.children.length&&h>=0?this.children[h].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let s=this.parent;s;s=s.parent){if(e&&(s.flags|=2),s.flags&1)return;s.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let s=e.parent;if(!s)return e;e=s}}replaceChildren(e,s,o=ub){this.markDirty();for(let l=e;l<s;l++){let a=this.children[l];a.parent==this&&a.destroy()}this.children.splice(e,s-e,...o);for(let l=0;l<o.length;l++)o[l].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new r0(this.children,e,this.children.length)}childPos(e,s=1){return this.childCursor().findPos(e,s)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,s,o,l,a,h){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){this.parent=null}}Re.prototype.breakAfter=0;function eC(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class r0{constructor(e,s,o){this.children=e,this.pos=s,this.i=o,this.off=0}findPos(e,s=1){for(;;){if(e>this.pos||e==this.pos&&(s>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let o=this.children[--this.i];this.pos-=o.length+o.breakAfter}}}function l0(r,e,s,o,l,a,h,d,p){let{children:f}=r,m=f.length?f[e]:null,T=a.length?a[a.length-1]:null,b=T?T.breakAfter:h;if(!(e==o&&m&&!h&&!b&&a.length<2&&m.merge(s,l,a.length?T:null,s==0,d,p))){if(o<f.length){let I=f[o];I&&(l<I.length||I.breakAfter&&(T!=null&&T.breakAfter))?(e==o&&(I=I.split(l),l=0),!b&&T&&I.merge(0,l,T,!0,0,p)?a[a.length-1]=I:((l||I.children.length&&!I.children[0].length)&&I.merge(0,l,null,!1,0,p),a.push(I))):I!=null&&I.breakAfter&&(T?T.breakAfter=1:h=1),o++}for(m&&(m.breakAfter=h,s>0&&(!h&&a.length&&m.merge(s,m.length,a[0],!1,d,0)?m.breakAfter=a.shift().breakAfter:(s<m.length||m.children.length&&m.children[m.children.length-1].length==0)&&m.merge(s,m.length,null,!1,d,0),e++));e<o&&a.length;)if(f[o-1].become(a[a.length-1]))o--,a.pop(),p=a.length?0:d;else if(f[e].become(a[0]))e++,a.shift(),d=a.length?0:p;else break;!a.length&&e&&o<f.length&&!f[e-1].breakAfter&&f[o].merge(0,0,f[e-1],!1,d,p)&&e--,(e<o||a.length)&&r.replaceChildren(e,o,a)}}function c0(r,e,s,o,l,a){let h=r.childCursor(),{i:d,off:p}=h.findPos(s,1),{i:f,off:m}=h.findPos(e,-1),T=e-s;for(let b of o)T+=b.length;r.length+=T,l0(r,f,m,d,p,o,0,l,a)}let qi=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},rT=typeof document<"u"?document:{documentElement:{style:{}}};const lT=/Edge\/(\d+)/.exec(qi.userAgent),a0=/MSIE \d/.test(qi.userAgent),cT=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(qi.userAgent),Np=!!(a0||cT||lT),iC=!Np&&/gecko\/(\d+)/i.test(qi.userAgent),U$=!Np&&/Chrome\/(\d+)/.exec(qi.userAgent),sC="webkitFontSmoothing"in rT.documentElement.style,h0=!Np&&/Apple Computer/.test(qi.vendor),oC=h0&&(/Mobile\/\w+/.test(qi.userAgent)||qi.maxTouchPoints>2);var Ot={mac:oC||/Mac/.test(qi.platform),windows:/Win/.test(qi.platform),linux:/Linux|X11/.test(qi.platform),ie:Np,ie_version:a0?rT.documentMode||6:cT?+cT[1]:lT?+lT[1]:0,gecko:iC,gecko_version:iC?+(/Firefox\/(\d+)/.exec(qi.userAgent)||[0,0])[1]:0,chrome:!!U$,chrome_version:U$?+U$[1]:0,ios:oC,android:/Android\b/.test(qi.userAgent),webkit:sC,safari:h0,webkit_version:sC?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:rT.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const oD=256;class Xo extends Re{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,s){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(s&&s.node==this.dom&&(s.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,s,o){return this.flags&8||o&&(!(o instanceof Xo)||this.length-(s-e)+o.length>oD||o.flags&8)?!1:(this.text=this.text.slice(0,e)+(o?o.text:"")+this.text.slice(s),this.markDirty(),!0)}split(e){let s=new Xo(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),s.flags|=this.flags&8,s}localPosFromDOM(e,s){return e==this.dom?s:s?this.text.length:0}domAtPos(e){return new gi(this.dom,e)}domBoundsAround(e,s,o){return{from:o,to:o+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,s){return nD(this.dom,e,s)}}class zo extends Re{constructor(e,s=[],o=0){super(),this.mark=e,this.children=s,this.length=o;for(let l of s)l.setParent(this)}setAttrs(e){if(o0(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let s in this.mark.attrs)e.setAttribute(s,this.mark.attrs[s]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,s){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,s)}merge(e,s,o,l,a,h){return o&&(!(o instanceof zo&&o.mark.eq(this.mark))||e&&a<=0||s<this.length&&h<=0)?!1:(c0(this,e,s,o?o.children:[],a-1,h-1),this.markDirty(),!0)}split(e){let s=[],o=0,l=-1,a=0;for(let d of this.children){let p=o+d.length;p>e&&s.push(o<e?d.split(e-o):d),l<0&&o>=e&&(l=a),o=p,a++}let h=this.length-e;return this.length=e,l>-1&&(this.children.length=l,this.markDirty()),new zo(this.mark,s,h)}domAtPos(e){return u0(this,e)}coordsAt(e,s){return p0(this,e,s)}}function nD(r,e,s){let o=r.nodeValue.length;e>o&&(e=o);let l=e,a=e,h=0;e==0&&s<0||e==o&&s>=0?Ot.chrome||Ot.gecko||(e?(l--,h=1):a<o&&(a++,h=-1)):s<0?l--:a<o&&a++;let d=Br(r,l,a).getClientRects();if(!d.length)return null;let p=d[(h?h<0:s>=0)?0:d.length-1];return Ot.safari&&!h&&p.width==0&&(p=Array.prototype.find.call(d,f=>f.width)||p),h?hb(p,h<0):p||null}class Or extends Re{static create(e,s,o){return new Or(e,s,o)}constructor(e,s,o){super(),this.widget=e,this.length=s,this.side=o,this.prevWidget=null}split(e){let s=Or.create(this.widget,this.length-e,this.side);return this.length-=e,s}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,s,o,l,a,h){return o&&(!(o instanceof Or)||!this.widget.compare(o.widget)||e>0&&a<=0||s<this.length&&h<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-s),!0)}become(e){return e instanceof Or&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return pe.empty;let e=this;for(;e.parent;)e=e.parent;let{view:s}=e,o=s&&s.state.doc,l=this.posAtStart;return o?o.slice(l,l+this.length):pe.empty}domAtPos(e){return(this.length?e==0:this.side>0)?gi.before(this.dom):gi.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,s){let o=this.widget.coordsAt(this.dom,e,s);if(o)return o;let l=this.dom.getClientRects(),a=null;if(!l.length)return null;let h=this.side?this.side<0:e>0;for(let d=h?l.length-1:0;a=l[d],!(e>0?d==0:d==l.length-1||a.top<a.bottom);d+=h?-1:1);return hb(a,!h)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class hc extends Re{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof hc&&e.side==this.side}split(){return new hc(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?gi.before(this.dom):gi.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return pe.empty}get isHidden(){return!0}}Xo.prototype.children=Or.prototype.children=hc.prototype.children=ub;function u0(r,e){let s=r.dom,{children:o}=r,l=0;for(let a=0;l<o.length;l++){let h=o[l],d=a+h.length;if(!(d==a&&h.getSide()<=0)){if(e>a&&e<d&&h.dom.parentNode==s)return h.domAtPos(e-a);if(e<=a)break;a=d}}for(let a=l;a>0;a--){let h=o[a-1];if(h.dom.parentNode==s)return h.domAtPos(h.length)}for(let a=l;a<o.length;a++){let h=o[a];if(h.dom.parentNode==s)return h.domAtPos(0)}return new gi(s,0)}function d0(r,e,s){let o,{children:l}=r;s>0&&e instanceof zo&&l.length&&(o=l[l.length-1])instanceof zo&&o.mark.eq(e.mark)?d0(o,e.children[0],s-1):(l.push(e),e.setParent(r)),r.length+=e.length}function p0(r,e,s){let o=null,l=-1,a=null,h=-1;function d(f,m){for(let T=0,b=0;T<f.children.length&&b<=m;T++){let I=f.children[T],w=b+I.length;w>=m&&(I.children.length?d(I,m-b):(!a||a.isHidden&&s>0)&&(w>m||b==w&&I.getSide()>0)?(a=I,h=m-b):(b<m||b==w&&I.getSide()<0&&!I.isHidden)&&(o=I,l=m-b)),b=w}}d(r,e);let p=(s<0?o:a)||o||a;return p?p.coordsAt(Math.max(0,p==o?l:h),s):rD(r)}function rD(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let s=mh(e);return s[s.length-1]||null}function aT(r,e){for(let s in r)s=="class"&&e.class?e.class+=" "+r.class:s=="style"&&e.style?e.style+=";"+r.style:e[s]=r[s];return e}const nC=Object.create(null);function db(r,e,s){if(r==e)return!0;r||(r=nC),e||(e=nC);let o=Object.keys(r),l=Object.keys(e);if(o.length-(s&&o.indexOf(s)>-1?1:0)!=l.length-(s&&l.indexOf(s)>-1?1:0))return!1;for(let a of o)if(a!=s&&(l.indexOf(a)==-1||r[a]!==e[a]))return!1;return!0}function hT(r,e,s){let o=!1;if(e)for(let l in e)s&&l in s||(o=!0,l=="style"?r.style.cssText="":r.removeAttribute(l));if(s)for(let l in s)e&&e[l]==s[l]||(o=!0,l=="style"?r.style.cssText=s[l]:r.setAttribute(l,s[l]));return o}function lD(r){let e=Object.create(null);for(let s=0;s<r.attributes.length;s++){let o=r.attributes[s];e[o.name]=o.value}return e}class je extends Re{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,s,o,l,a,h){if(o){if(!(o instanceof je))return!1;this.dom||o.transferDOM(this)}return l&&this.setDeco(o?o.attrs:null),c0(this,e,s,o?o.children:[],a,h),!0}split(e){let s=new je;if(s.breakAfter=this.breakAfter,this.length==0)return s;let{i:o,off:l}=this.childPos(e);l&&(s.append(this.children[o].split(l),0),this.children[o].merge(l,this.children[o].length,null,!1,0,0),o++);for(let a=o;a<this.children.length;a++)s.append(this.children[a],0);for(;o>0&&this.children[o-1].length==0;)this.children[--o].destroy();return this.children.length=o,this.markDirty(),this.length=e,s}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){db(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,s){d0(this,e,s)}addLineDeco(e){let s=e.spec.attributes,o=e.spec.class;s&&(this.attrs=aT(s,this.attrs||{})),o&&(this.attrs=aT({class:o},this.attrs||{}))}domAtPos(e){return u0(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,s){var o;this.dom?this.flags&4&&(o0(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(hT(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,s);let l=this.dom.lastChild;for(;l&&Re.get(l)instanceof zo;)l=l.lastChild;if(!l||!this.length||l.nodeName!="BR"&&((o=Re.get(l))===null||o===void 0?void 0:o.isEditable)==!1&&(!Ot.ios||!this.children.some(a=>a instanceof Xo))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,s;for(let o of this.children){if(!(o instanceof Xo)||/[^ -~]/.test(o.text))return null;let l=mh(o.dom);if(l.length!=1)return null;e+=l[0].width,s=l[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:s}:null}coordsAt(e,s){let o=p0(this,e,s);if(!this.children.length&&o&&this.parent){let{heightOracle:l}=this.parent.view.viewState,a=o.bottom-o.top;if(Math.abs(a-l.lineHeight)<2&&l.textHeight<a){let h=(a-l.textHeight)/2;return{top:o.top+h,bottom:o.bottom-h,left:o.left,right:o.left}}}return o}become(e){return!1}covers(){return!0}static find(e,s){for(let o=0,l=0;o<e.children.length;o++){let a=e.children[o],h=l+a.length;if(h>=s){if(a instanceof je)return a;if(h>s)break}l=h+a.breakAfter}return null}}class An extends Re{constructor(e,s,o){super(),this.widget=e,this.length=s,this.deco=o,this.breakAfter=0,this.prevWidget=null}merge(e,s,o,l,a,h){return o&&(!(o instanceof An)||!this.widget.compare(o.widget)||e>0&&a<=0||s<this.length&&h<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-s),!0)}domAtPos(e){return e==0?gi.before(this.dom):gi.after(this.dom,e==this.length)}split(e){let s=this.length-e;this.length=e;let o=new An(this.widget,s,this.deco);return o.breakAfter=this.breakAfter,o}get children(){return ub}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):pe.empty}domBoundsAround(){return null}become(e){return e instanceof An&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,s){return this.widget.coordsAt(this.dom,e,s)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:s,endSide:o}=this.deco;return s==o?!1:e<0?s<0:o>0}}class pb{eq(e){return!1}updateDOM(e,s){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,s,o){return null}get isHidden(){return!1}destroy(e){}}var Ns=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Ns||(Ns={}));class Zi extends cc{constructor(e,s,o,l){super(),this.startSide=e,this.endSide=s,this.widget=o,this.spec=l}get heightRelevant(){return!1}static mark(e){return new yh(e)}static widget(e){let s=Math.max(-1e4,Math.min(1e4,e.side||0)),o=!!e.block;return s+=o&&!e.inlineOrder?s>0?3e8:-4e8:s>0?1e8:-1e8,new Mn(e,s,s,o,e.widget||null,!1)}static replace(e){let s=!!e.block,o,l;if(e.isBlockGap)o=-5e8,l=4e8;else{let{start:a,end:h}=g0(e,s);o=(a?s?-3e8:-1:5e8)-1,l=(h?s?2e8:1:-6e8)+1}return new Mn(e,o,l,s,e.widget||null,!0)}static line(e){return new Ch(e)}static set(e,s=!1){return _e.of(e,s)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Zi.none=_e.empty;class yh extends Zi{constructor(e){let{start:s,end:o}=g0(e);super(s?-1:5e8,o?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var s,o;return this==e||e instanceof yh&&this.tagName==e.tagName&&(this.class||((s=this.attrs)===null||s===void 0?void 0:s.class))==(e.class||((o=e.attrs)===null||o===void 0?void 0:o.class))&&db(this.attrs,e.attrs,"class")}range(e,s=e){if(e>=s)throw new RangeError("Mark decorations may not be empty");return super.range(e,s)}}yh.prototype.point=!1;class Ch extends Zi{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ch&&this.spec.class==e.spec.class&&db(this.spec.attributes,e.spec.attributes)}range(e,s=e){if(s!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,s)}}Ch.prototype.mapMode=Ji.TrackBefore;Ch.prototype.point=!0;class Mn extends Zi{constructor(e,s,o,l,a,h){super(s,o,a,e),this.block=l,this.isReplace=h,this.mapMode=l?s<=0?Ji.TrackBefore:Ji.TrackAfter:Ji.TrackDel}get type(){return this.startSide!=this.endSide?Ns.WidgetRange:this.startSide<=0?Ns.WidgetBefore:Ns.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Mn&&cD(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,s=e){if(this.isReplace&&(e>s||e==s&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&s!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,s)}}Mn.prototype.point=!0;function g0(r,e=!1){let{inclusiveStart:s,inclusiveEnd:o}=r;return s==null&&(s=r.inclusive),o==null&&(o=r.inclusive),{start:s??e,end:o??e}}function cD(r,e){return r==e||!!(r&&e&&r.compare(e))}function uT(r,e,s,o=0){let l=s.length-1;l>=0&&s[l]+o>=r?s[l]=Math.max(s[l],e):s.push(r,e)}class Ua{constructor(e,s,o,l){this.doc=e,this.pos=s,this.end=o,this.disallowBlockEffectsFor=l,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=s}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof An&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new je),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(gd(new hc(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof An)&&this.getLine()}buildText(e,s,o){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:h,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(h){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let l=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(s.slice(s.length-o)),this.getLine().append(gd(new Xo(this.text.slice(this.textOff,this.textOff+l)),s),o),this.atCursorPos=!0,this.textOff+=l,e-=l,o=0}}span(e,s,o,l){this.buildText(s-e,o,l),this.pos=s,this.openStart<0&&(this.openStart=l)}point(e,s,o,l,a,h){if(this.disallowBlockEffectsFor[h]&&o instanceof Mn){if(o.block)throw new RangeError("Block decorations may not be specified via plugins");if(s>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=s-e;if(o instanceof Mn)if(o.block)o.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new An(o.widget||new rC("div"),d,o));else{let p=Or.create(o.widget||new rC("span"),d,d?0:o.startSide),f=this.atCursorPos&&!p.isEditable&&a<=l.length&&(e<s||o.startSide>0),m=!p.isEditable&&(e<s||a>l.length||o.startSide<=0),T=this.getLine();this.pendingBuffer==2&&!f&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(l),f&&(T.append(gd(new hc(1),l),a),a=l.length+Math.max(0,a-l.length)),T.append(gd(p,l),a),this.atCursorPos=m,this.pendingBuffer=m?e<s||a>l.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=l.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(o);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=s),this.openStart<0&&(this.openStart=a)}static build(e,s,o,l,a){let h=new Ua(e,s,o,a);return h.openEnd=_e.spans(l,s,o,h),h.openStart<0&&(h.openStart=h.openEnd),h.finish(h.openEnd),h}}function gd(r,e){for(let s of e)r=new zo(s,[r],r.length);return r}class rC extends pb{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const f0=Vt.define(),m0=Vt.define(),$0=Vt.define(),_0=Vt.define(),dT=Vt.define(),T0=Vt.define(),b0=Vt.define(),E0=Vt.define({combine:r=>r.some(e=>e)}),aD=Vt.define({combine:r=>r.some(e=>e)});class rp{constructor(e,s="nearest",o="nearest",l=5,a=5){this.range=e,this.y=s,this.x=o,this.yMargin=l,this.xMargin=a}map(e){return e.empty?this:new rp(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const lC=Je.define({map:(r,e)=>r.map(e)});function Mr(r,e,s){let o=r.facet(_0);o.length?o[0](e):window.onerror?window.onerror(String(e),s,void 0,void 0,e):s?console.error(s+":",e):console.error(e)}const Lp=Vt.define({combine:r=>r.length?r[0]:!0});let hD=0;const ka=Vt.define();class Yo{constructor(e,s,o,l,a){this.id=e,this.create=s,this.domEventHandlers=o,this.domEventObservers=l,this.extension=a(this)}static define(e,s){const{eventHandlers:o,eventObservers:l,provide:a,decorations:h}=s||{};return new Yo(hD++,e,o,l,d=>{let p=[ka.of(d)];return h&&p.push(_h.of(f=>{let m=f.plugin(d);return m?h(m):Zi.none})),a&&p.push(a(d)),p})}static fromClass(e,s){return Yo.define(o=>new e(o),s)}}class V${constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let s=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(s)}catch(o){if(Mr(s.state,o,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(s){Mr(e.state,s,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var s;if(!((s=this.value)===null||s===void 0)&&s.destroy)try{this.value.destroy()}catch(o){Mr(e.state,o,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const v0=Vt.define(),gb=Vt.define(),_h=Vt.define(),fb=Vt.define(),I0=Vt.define();function cC(r,e,s){let o=r.state.facet(I0);if(!o.length)return o;let l=o.map(h=>h instanceof Function?h(r):h),a=[];return _e.spans(l,e,s,{point(){},span(h,d,p,f){let m=a;for(let T=p.length-1;T>=0;T--,f--){let b=p[T].spec.bidiIsolate,I;if(b!=null)if(f>0&&m.length&&(I=m[m.length-1]).to==h&&I.direction==b)I.to=d,m=I.inner;else{let w={from:h,to:d,direction:b,inner:[]};m.push(w),m=w.inner}}}}),a}const S0=Vt.define();function y0(r){let e=0,s=0,o=0,l=0;for(let a of r.state.facet(S0)){let h=a(r);h&&(h.left!=null&&(e=Math.max(e,h.left)),h.right!=null&&(s=Math.max(s,h.right)),h.top!=null&&(o=Math.max(o,h.top)),h.bottom!=null&&(l=Math.max(l,h.bottom)))}return{left:e,right:s,top:o,bottom:l}}const Oa=Vt.define();class hs{constructor(e,s,o,l){this.fromA=e,this.toA=s,this.fromB=o,this.toB=l}join(e){return new hs(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let s=e.length,o=this;for(;s>0;s--){let l=e[s-1];if(!(l.fromA>o.toA)){if(l.toA<o.fromA)break;o=o.join(l),e.splice(s-1,1)}}return e.splice(s,0,o),e}static extendWithRanges(e,s){if(s.length==0)return e;let o=[];for(let l=0,a=0,h=0,d=0;;l++){let p=l==e.length?null:e[l],f=h-d,m=p?p.fromB:1e9;for(;a<s.length&&s[a]<m;){let T=s[a],b=s[a+1],I=Math.max(d,T),w=Math.min(m,b);if(I<=w&&new hs(I+f,w+f,I,w).addToSet(o),b>m)break;a+=2}if(!p)return o;new hs(p.fromA,p.toA,p.fromB,p.toB).addToSet(o),h=p.toA,d=p.toB}}}class lp{constructor(e,s,o){this.view=e,this.state=s,this.transactions=o,this.flags=0,this.startState=e.state,this.changes=Qe.empty(this.startState.doc.length);for(let a of o)this.changes=this.changes.compose(a.changes);let l=[];this.changes.iterChangedRanges((a,h,d,p)=>l.push(new hs(a,h,d,p))),this.changedRanges=l}static create(e,s,o){return new lp(e,s,o)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var $i=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}($i||($i={}));const Th=$i.LTR,C0=$i.RTL;function w0(r){let e=[];for(let s=0;s<r.length;s++)e.push(1<<+r[s]);return e}const uD=w0("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),dD=w0("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),pT=Object.create(null),eo=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),s=r.charCodeAt(1);pT[e]=s,pT[s]=-e}function pD(r){return r<=247?uD[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?dD[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8203?256:64336<=r&&r<=65023?4:r==8204?256:1}const gD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class yn{get dir(){return this.level%2?C0:Th}constructor(e,s,o){this.from=e,this.to=s,this.level=o}side(e,s){return this.dir==s==e?this.to:this.from}static find(e,s,o,l){let a=-1;for(let h=0;h<e.length;h++){let d=e[h];if(d.from<=s&&d.to>=s){if(d.level==o)return h;(a<0||(l!=0?l<0?d.from<s:d.to>s:e[a].level>d.level))&&(a=h)}}if(a<0)throw new RangeError("Index out of range");return a}}function k0(r,e){if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++){let o=r[s],l=e[s];if(o.from!=l.from||o.to!=l.to||o.direction!=l.direction||!k0(o.inner,l.inner))return!1}return!0}const Se=[];function fD(r,e,s,o,l){for(let a=0;a<=o.length;a++){let h=a?o[a-1].to:e,d=a<o.length?o[a].from:s,p=a?256:l;for(let f=h,m=p,T=p;f<d;f++){let b=pD(r.charCodeAt(f));b==512?b=m:b==8&&T==4&&(b=16),Se[f]=b==4?2:b,b&7&&(T=b),m=b}for(let f=h,m=p,T=p;f<d;f++){let b=Se[f];if(b==128)f<d-1&&m==Se[f+1]&&m&24?b=Se[f]=m:Se[f]=256;else if(b==64){let I=f+1;for(;I<d&&Se[I]==64;)I++;let w=f&&m==8||I<s&&Se[I]==8?T==1?1:8:256;for(let M=f;M<I;M++)Se[M]=w;f=I-1}else b==8&&T==1&&(Se[f]=1);m=b,b&7&&(T=b)}}}function mD(r,e,s,o,l){let a=l==1?2:1;for(let h=0,d=0,p=0;h<=o.length;h++){let f=h?o[h-1].to:e,m=h<o.length?o[h].from:s;for(let T=f,b,I,w;T<m;T++)if(I=pT[b=r.charCodeAt(T)])if(I<0){for(let M=d-3;M>=0;M-=3)if(eo[M+1]==-I){let N=eo[M+2],U=N&2?l:N&4?N&1?a:l:0;U&&(Se[T]=Se[eo[M]]=U),d=M;break}}else{if(eo.length==189)break;eo[d++]=T,eo[d++]=b,eo[d++]=p}else if((w=Se[T])==2||w==1){let M=w==l;p=M?0:1;for(let N=d-3;N>=0;N-=3){let U=eo[N+2];if(U&2)break;if(M)eo[N+2]|=2;else{if(U&4)break;eo[N+2]|=4}}}}}function $D(r,e,s,o){for(let l=0,a=o;l<=s.length;l++){let h=l?s[l-1].to:r,d=l<s.length?s[l].from:e;for(let p=h;p<d;){let f=Se[p];if(f==256){let m=p+1;for(;;)if(m==d){if(l==s.length)break;m=s[l++].to,d=l<s.length?s[l].from:e}else if(Se[m]==256)m++;else break;let T=a==1,b=(m<e?Se[m]:o)==1,I=T==b?T?1:2:o;for(let w=m,M=l,N=M?s[M-1].to:r;w>p;)w==N&&(w=s[--M].from,N=M?s[M-1].to:r),Se[--w]=I;p=m}else a=f,p++}}}function gT(r,e,s,o,l,a,h){let d=o%2?2:1;if(o%2==l%2)for(let p=e,f=0;p<s;){let m=!0,T=!1;if(f==a.length||p<a[f].from){let M=Se[p];M!=d&&(m=!1,T=M==16)}let b=!m&&d==1?[]:null,I=m?o:o+1,w=p;t:for(;;)if(f<a.length&&w==a[f].from){if(T)break t;let M=a[f];if(!m)for(let N=M.to,U=f+1;;){if(N==s)break t;if(U<a.length&&a[U].from==N)N=a[U++].to;else{if(Se[N]==d)break t;break}}if(f++,b)b.push(M);else{M.from>p&&h.push(new yn(p,M.from,I));let N=M.direction==Th!=!(I%2);fT(r,N?o+1:o,l,M.inner,M.from,M.to,h),p=M.to}w=M.to}else{if(w==s||(m?Se[w]!=d:Se[w]==d))break;w++}b?gT(r,p,w,o+1,l,b,h):p<w&&h.push(new yn(p,w,I)),p=w}else for(let p=s,f=a.length;p>e;){let m=!0,T=!1;if(!f||p>a[f-1].to){let M=Se[p-1];M!=d&&(m=!1,T=M==16)}let b=!m&&d==1?[]:null,I=m?o:o+1,w=p;t:for(;;)if(f&&w==a[f-1].to){if(T)break t;let M=a[--f];if(!m)for(let N=M.from,U=f;;){if(N==e)break t;if(U&&a[U-1].to==N)N=a[--U].from;else{if(Se[N-1]==d)break t;break}}if(b)b.push(M);else{M.to<p&&h.push(new yn(M.to,p,I));let N=M.direction==Th!=!(I%2);fT(r,N?o+1:o,l,M.inner,M.from,M.to,h),p=M.from}w=M.from}else{if(w==e||(m?Se[w-1]!=d:Se[w-1]==d))break;w--}b?gT(r,w,p,o+1,l,b,h):w<p&&h.push(new yn(w,p,I)),p=w}}function fT(r,e,s,o,l,a,h){let d=e%2?2:1;fD(r,l,a,o,d),mD(r,l,a,o,d),$D(l,a,o,d),gT(r,l,a,e,s,o,h)}function _D(r,e,s){if(!r)return[new yn(0,0,e==C0?1:0)];if(e==Th&&!s.length&&!gD.test(r))return O0(r.length);if(s.length)for(;r.length>Se.length;)Se[Se.length]=256;let o=[],l=e==Th?0:1;return fT(r,l,l,s,0,r.length,o),o}function O0(r){return[new yn(0,r,0)]}let A0="";function TD(r,e,s,o,l){var a;let h=o.head-r.from,d=-1;if(h==0){if(!l||!r.length)return null;e[0].level!=s&&(h=e[0].side(!1,s),d=0)}else if(h==r.length){if(l)return null;let b=e[e.length-1];b.level!=s&&(h=b.side(!0,s),d=e.length-1)}d<0&&(d=yn.find(e,h,(a=o.bidiLevel)!==null&&a!==void 0?a:-1,o.assoc));let p=e[d];h==p.side(l,s)&&(p=e[d+=l?1:-1],h=p.side(!l,s));let f=l==(p.dir==s),m=Po(r.text,h,f);if(A0=r.text.slice(Math.min(h,m),Math.max(h,m)),m!=p.side(l,s))return wt.cursor(m+r.from,f?-1:1,p.level);let T=d==(l?e.length-1:0)?null:e[d+(l?1:-1)];return!T&&p.level!=s?wt.cursor(l?r.to:r.from,l?-1:1,s):T&&T.level<p.level?wt.cursor(T.side(!l,s)+r.from,l?1:-1,T.level):wt.cursor(m+r.from,l?-1:1,p.level)}class aC extends Re{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new je],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new hs(0,0,0,e.state.doc.length)],0,null)}update(e){var s;let o=e.changedRanges;this.minWidth>0&&o.length&&(o.every(({fromA:f,toA:m})=>m<this.minWidthFrom||f>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let l=-1;this.view.inputState.composing>=0&&(!((s=this.domChanged)===null||s===void 0)&&s.newSel?l=this.domChanged.newSel.head:!CD(e.changes,this.hasComposition)&&!e.selectionSet&&(l=e.state.selection.main.head));let a=l>-1?ED(this.view,e.changes,l):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:f,to:m}=this.hasComposition;o=new hs(f,m,e.changes.mapPos(f,-1),e.changes.mapPos(m,1)).addToSet(o.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(Ot.ie||Ot.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let h=this.decorations,d=this.updateDeco(),p=SD(h,d,e.changes);return o=hs.extendWithRanges(o,p),!(this.flags&7)&&o.length==0?!1:(this.updateInner(o,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,s,o){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,s,o);let{observer:l}=this.view;l.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let h=Ot.chrome||Ot.ios?{node:l.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,h),this.flags&=-8,h&&(h.written||l.selectionRange.focusNode!=h.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(h=>h.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let h of this.children)h instanceof An&&h.widget instanceof hC&&a.push(h.dom);l.updateGaps(a)}updateChildren(e,s,o){let l=o?o.range.addToSet(e.slice()):e,a=this.childCursor(s);for(let h=l.length-1;;h--){let d=h>=0?l[h]:null;if(!d)break;let{fromA:p,toA:f,fromB:m,toB:T}=d,b,I,w,M;if(o&&o.range.fromB<T&&o.range.toB>m){let F=Ua.build(this.view.state.doc,m,o.range.fromB,this.decorations,this.dynamicDecorationMap),st=Ua.build(this.view.state.doc,o.range.toB,T,this.decorations,this.dynamicDecorationMap);I=F.breakAtStart,w=F.openStart,M=st.openEnd;let it=this.compositionView(o);st.breakAtStart?it.breakAfter=1:st.content.length&&it.merge(it.length,it.length,st.content[0],!1,st.openStart,0)&&(it.breakAfter=st.content[0].breakAfter,st.content.shift()),F.content.length&&it.merge(0,0,F.content[F.content.length-1],!0,0,F.openEnd)&&F.content.pop(),b=F.content.concat(it).concat(st.content)}else({content:b,breakAtStart:I,openStart:w,openEnd:M}=Ua.build(this.view.state.doc,m,T,this.decorations,this.dynamicDecorationMap));let{i:N,off:U}=a.findPos(f,1),{i:W,off:tt}=a.findPos(p,-1);l0(this,W,tt,N,U,b,I,w,M)}o&&this.fixCompositionDOM(o)}compositionView(e){let s=new Xo(e.text.nodeValue);s.flags|=8;for(let{deco:l}of e.marks)s=new zo(l,[s],s.length);let o=new je;return o.append(s,0),o}fixCompositionDOM(e){let s=(a,h)=>{h.flags|=8|(h.children.some(p=>p.flags&7)?1:0),this.markedForComposition.add(h);let d=Re.get(a);d&&d!=h&&(d.dom=null),h.setDOM(a)},o=this.childPos(e.range.fromB,1),l=this.children[o.i];s(e.line,l);for(let a=e.marks.length-1;a>=-1;a--)o=l.childPos(o.off,1),l=l.children[o.i],s(a>=0?e.marks[a].node:e.text,l)}updateSelection(e=!1,s=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let o=this.view.root.activeElement,l=o==this.dom,a=!l&&Ud(this.dom,this.view.observer.selectionRange)&&!(o&&this.dom.contains(o));if(!(l||s||a))return;let h=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.moveToLine(this.domAtPos(d.anchor)),f=d.empty?p:this.moveToLine(this.domAtPos(d.head));if(Ot.gecko&&d.empty&&!this.hasComposition&&bD(p)){let T=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(T,p.node.childNodes[p.offset]||null)),p=f=new gi(T,0),h=!0}let m=this.view.observer.selectionRange;(h||!m.focusNode||!np(p.node,p.offset,m.anchorNode,m.anchorOffset)||!np(f.node,f.offset,m.focusNode,m.focusOffset))&&(this.view.observer.ignore(()=>{Ot.android&&Ot.chrome&&this.dom.contains(m.focusNode)&&yD(m.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let T=op(this.view.root);if(T)if(d.empty){if(Ot.gecko){let b=vD(p.node,p.offset);if(b&&b!=3){let I=N0(p.node,p.offset,b==1?1:-1);I&&(p=new gi(I.node,I.offset))}}T.collapse(p.node,p.offset),d.bidiLevel!=null&&T.caretBidiLevel!==void 0&&(T.caretBidiLevel=d.bidiLevel)}else if(T.extend){T.collapse(p.node,p.offset);try{T.extend(f.node,f.offset)}catch{}}else{let b=document.createRange();d.anchor>d.head&&([p,f]=[f,p]),b.setEnd(f.node,f.offset),b.setStart(p.node,p.offset),T.removeAllRanges(),T.addRange(b)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),o&&o.focus())}),this.view.observer.setSelectionRange(p,f)),this.impreciseAnchor=p.precise?null:new gi(m.anchorNode,m.anchorOffset),this.impreciseHead=f.precise?null:new gi(m.focusNode,m.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,s=e.state.selection.main,o=op(e.root),{anchorNode:l,anchorOffset:a}=e.observer.selectionRange;if(!o||!s.empty||!s.assoc||!o.modify)return;let h=je.find(this,s.head);if(!h)return;let d=h.posAtStart;if(s.head==d||s.head==d+h.length)return;let p=this.coordsAt(s.head,-1),f=this.coordsAt(s.head,1);if(!p||!f||p.bottom>f.top)return;let m=this.domAtPos(s.head+s.assoc);o.collapse(m.node,m.offset),o.modify("move",s.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let T=e.observer.selectionRange;e.docView.posFromDOM(T.anchorNode,T.anchorOffset)!=s.from&&o.collapse(l,a)}moveToLine(e){let s=this.dom,o;if(e.node!=s)return e;for(let l=e.offset;!o&&l<s.childNodes.length;l++){let a=Re.get(s.childNodes[l]);a instanceof je&&(o=a.domAtPos(0))}for(let l=e.offset-1;!o&&l>=0;l--){let a=Re.get(s.childNodes[l]);a instanceof je&&(o=a.domAtPos(a.length))}return o?new gi(o.node,o.offset,!0):e}nearest(e){for(let s=e;s;){let o=Re.get(s);if(o&&o.rootView==this)return o;s=s.parentNode}return null}posFromDOM(e,s){let o=this.nearest(e);if(!o)throw new RangeError("Trying to find position for a DOM position outside of the document");return o.localPosFromDOM(e,s)+o.posAtStart}domAtPos(e){let{i:s,off:o}=this.childCursor().findPos(e,-1);for(;s<this.children.length-1;){let l=this.children[s];if(o<l.length||l instanceof je)break;s++,o=0}return this.children[s].domAtPos(o)}coordsAt(e,s){let o=null,l=0;for(let a=this.length,h=this.children.length-1;h>=0;h--){let d=this.children[h],p=a-d.breakAfter,f=p-d.length;if(p<e)break;f<=e&&(f<e||d.covers(-1))&&(p>e||d.covers(1))&&(!o||d instanceof je&&!(o instanceof je&&s>=0))&&(o=d,l=f),a=f}return o?o.coordsAt(e-l,s):null}coordsForChar(e){let{i:s,off:o}=this.childPos(e,1),l=this.children[s];if(!(l instanceof je))return null;for(;l.children.length;){let{i:d,off:p}=l.childPos(o,1);for(;;d++){if(d==l.children.length)return null;if((l=l.children[d]).length)break}o=p}if(!(l instanceof Xo))return null;let a=Po(l.text,o);if(a==o)return null;let h=Br(l.dom,o,a).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}return null}measureVisibleLineHeights(e){let s=[],{from:o,to:l}=e,a=this.view.contentDOM.clientWidth,h=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==$i.LTR;for(let f=0,m=0;m<this.children.length;m++){let T=this.children[m],b=f+T.length;if(b>l)break;if(f>=o){let I=T.dom.getBoundingClientRect();if(s.push(I.height),h){let w=T.dom.lastChild,M=w?mh(w):[];if(M.length){let N=M[M.length-1],U=p?N.right-I.left:I.right-N.left;U>d&&(d=U,this.minWidth=a,this.minWidthFrom=f,this.minWidthTo=b)}}}f=b+T.breakAfter}return s}textDirectionAt(e){let{i:s}=this.childPos(e,1);return getComputedStyle(this.children[s].dom).direction=="rtl"?$i.RTL:$i.LTR}measureTextSize(){for(let a of this.children)if(a instanceof je){let h=a.measureTextSize();if(h)return h}let e=document.createElement("div"),s,o,l;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=mh(e.firstChild)[0];s=e.getBoundingClientRect().height,o=a?a.width/27:7,l=a?a.height:s,e.remove()}),{lineHeight:s,charWidth:o,textHeight:l}}childCursor(e=this.length){let s=this.children.length;return s&&(e-=this.children[--s].length),new r0(this.children,e,s)}computeBlockGapDeco(){let e=[],s=this.view.viewState;for(let o=0,l=0;;l++){let a=l==s.viewports.length?null:s.viewports[l],h=a?a.from-1:this.length;if(h>o){let d=(s.lineBlockAt(h).bottom-s.lineBlockAt(o).top)/this.view.scaleY;e.push(Zi.replace({widget:new hC(d),block:!0,inclusive:!0,isBlockGap:!0}).range(o,h))}if(!a)break;o=a.to+1}return Zi.set(e)}updateDeco(){let e=this.view.state.facet(_h).map((s,o)=>(this.dynamicDecorationMap[o]=typeof s=="function")?s(this.view):s);for(let s=e.length;s<e.length+3;s++)this.dynamicDecorationMap[s]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:s}=e,o=this.coordsAt(s.head,s.empty?s.assoc:s.head>s.anchor?-1:1),l;if(!o)return;!s.empty&&(l=this.coordsAt(s.anchor,s.anchor>s.head?-1:1))&&(o={left:Math.min(o.left,l.left),top:Math.min(o.top,l.top),right:Math.max(o.right,l.right),bottom:Math.max(o.bottom,l.bottom)});let a=y0(this.view),h={left:o.left-a.left,top:o.top-a.top,right:o.right+a.right,bottom:o.bottom+a.bottom};QM(this.view.scrollDOM,h,s.head<s.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==$i.LTR)}}function bD(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}class hC extends pb{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function R0(r,e){let s=r.observer.selectionRange,o=s.focusNode&&N0(s.focusNode,s.focusOffset,0);if(!o)return null;let l=e-o.offset;return{from:l,to:l+o.node.nodeValue.length,node:o.node}}function ED(r,e,s){let o=R0(r,s);if(!o)return null;let{node:l,from:a,to:h}=o,d=l.nodeValue;if(/[\n\r]/.test(d)||r.state.doc.sliceString(o.from,o.to)!=d)return null;let p=e.invertedDesc,f=new hs(p.mapPos(a),p.mapPos(h),a,h),m=[];for(let T=l.parentNode;;T=T.parentNode){let b=Re.get(T);if(b instanceof zo)m.push({node:T,deco:b.mark});else{if(b instanceof je||T.nodeName=="DIV"&&T.parentNode==r.contentDOM)return{range:f,text:l,marks:m,line:T};if(T!=r.contentDOM)m.push({node:T,deco:new yh({inclusive:!0,attributes:lD(T),tagName:T.tagName.toLowerCase()})});else return null}}}function N0(r,e,s){if(s<=0)for(let o=r,l=e;;){if(o.nodeType==3)return{node:o,offset:l};if(o.nodeType==1&&l>0)o=o.childNodes[l-1],l=Wo(o);else break}if(s>=0)for(let o=r,l=e;;){if(o.nodeType==3)return{node:o,offset:l};if(o.nodeType==1&&l<o.childNodes.length&&s>=0)o=o.childNodes[l],l=0;else break}return null}function vD(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let ID=class{constructor(){this.changes=[]}compareRange(e,s){uT(e,s,this.changes)}comparePoint(e,s){uT(e,s,this.changes)}};function SD(r,e,s){let o=new ID;return _e.compare(r,e,s,o),o.changes}function yD(r,e){for(let s=r;s&&s!=e;s=s.assignedSlot||s.parentNode)if(s.nodeType==1&&s.contentEditable=="false")return!0;return!1}function CD(r,e){let s=!1;return e&&r.iterChangedRanges((o,l)=>{o<e.to&&l>e.from&&(s=!0)}),s}function wD(r,e,s=1){let o=r.charCategorizer(e),l=r.doc.lineAt(e),a=e-l.from;if(l.length==0)return wt.cursor(e);a==0?s=1:a==l.length&&(s=-1);let h=a,d=a;s<0?h=Po(l.text,a,!1):d=Po(l.text,a);let p=o(l.text.slice(h,d));for(;h>0;){let f=Po(l.text,h,!1);if(o(l.text.slice(f,h))!=p)break;h=f}for(;d<l.length;){let f=Po(l.text,d);if(o(l.text.slice(d,f))!=p)break;d=f}return wt.range(h+l.from,d+l.from)}function kD(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function OD(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function G$(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function uC(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function dC(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function mT(r,e,s){let o,l,a,h,d=!1,p,f,m,T;for(let w=r.firstChild;w;w=w.nextSibling){let M=mh(w);for(let N=0;N<M.length;N++){let U=M[N];l&&G$(l,U)&&(U=uC(dC(U,l.bottom),l.top));let W=kD(e,U),tt=OD(s,U);if(W==0&&tt==0)return w.nodeType==3?pC(w,e,s):mT(w,e,s);if(!o||h>tt||h==tt&&a>W){o=w,l=U,a=W,h=tt;let F=tt?s<U.top?-1:1:W?e<U.left?-1:1:0;d=!F||(F>0?N<M.length-1:N>0)}W==0?s>U.bottom&&(!m||m.bottom<U.bottom)?(p=w,m=U):s<U.top&&(!T||T.top>U.top)&&(f=w,T=U):m&&G$(m,U)?m=dC(m,U.bottom):T&&G$(T,U)&&(T=uC(T,U.top))}}if(m&&m.bottom>=s?(o=p,l=m):T&&T.top<=s&&(o=f,l=T),!o)return{node:r,offset:0};let b=Math.max(l.left,Math.min(l.right,e));if(o.nodeType==3)return pC(o,b,s);if(d&&o.contentEditable!="false")return mT(o,b,s);let I=Array.prototype.indexOf.call(r.childNodes,o)+(e>=(l.left+l.right)/2?1:0);return{node:r,offset:I}}function pC(r,e,s){let o=r.nodeValue.length,l=-1,a=1e9,h=0;for(let d=0;d<o;d++){let p=Br(r,d,d+1).getClientRects();for(let f=0;f<p.length;f++){let m=p[f];if(m.top==m.bottom)continue;h||(h=e-m.left);let T=(m.top>s?m.top-s:s-m.bottom)-1;if(m.left-1<=e&&m.right+1>=e&&T<a){let b=e>=(m.left+m.right)/2,I=b;if((Ot.chrome||Ot.gecko)&&Br(r,d).getBoundingClientRect().left==m.right&&(I=!b),T<=0)return{node:r,offset:d+(I?1:0)};l=d+(I?1:0),a=T}}}return{node:r,offset:l>-1?l:h>0?r.nodeValue.length:0}}function L0(r,e,s,o=-1){var l,a;let h=r.contentDOM.getBoundingClientRect(),d=h.top+r.viewState.paddingTop,p,{docHeight:f}=r.viewState,{x:m,y:T}=e,b=T-d;if(b<0)return 0;if(b>f)return r.state.doc.length;for(let F=r.viewState.heightOracle.textHeight/2,st=!1;p=r.elementAtHeight(b),p.type!=Ns.Text;)for(;b=o>0?p.bottom+F:p.top-F,!(b>=0&&b<=f);){if(st)return s?null:0;st=!0,o=-o}T=d+b;let I=p.from;if(I<r.viewport.from)return r.viewport.from==0?0:s?null:gC(r,h,p,m,T);if(I>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:s?null:gC(r,h,p,m,T);let w=r.dom.ownerDocument,M=r.root.elementFromPoint?r.root:w,N=M.elementFromPoint(m,T);N&&!r.contentDOM.contains(N)&&(N=null),N||(m=Math.max(h.left+1,Math.min(h.right-1,m)),N=M.elementFromPoint(m,T),N&&!r.contentDOM.contains(N)&&(N=null));let U,W=-1;if(N&&((l=r.docView.nearest(N))===null||l===void 0?void 0:l.isEditable)!=!1){if(w.caretPositionFromPoint){let F=w.caretPositionFromPoint(m,T);F&&({offsetNode:U,offset:W}=F)}else if(w.caretRangeFromPoint){let F=w.caretRangeFromPoint(m,T);F&&({startContainer:U,startOffset:W}=F,(!r.contentDOM.contains(U)||Ot.safari&&AD(U,W,m)||Ot.chrome&&RD(U,W,m))&&(U=void 0))}}if(!U||!r.docView.dom.contains(U)){let F=je.find(r.docView,I);if(!F)return b>p.top+p.height/2?p.to:p.from;({node:U,offset:W}=mT(F.dom,m,T))}let tt=r.docView.nearest(U);if(!tt)return null;if(tt.isWidget&&((a=tt.dom)===null||a===void 0?void 0:a.nodeType)==1){let F=tt.dom.getBoundingClientRect();return e.y<F.top||e.y<=F.bottom&&e.x<=(F.left+F.right)/2?tt.posAtStart:tt.posAtEnd}else return tt.localPosFromDOM(U,W)+tt.posAtStart}function gC(r,e,s,o,l){let a=Math.round((o-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&s.height>r.defaultLineHeight*1.5){let d=r.viewState.heightOracle.textHeight,p=Math.floor((l-s.top-(r.defaultLineHeight-d)*.5)/d);a+=p*r.viewState.heightOracle.lineLength}let h=r.state.sliceDoc(s.from,s.to);return s.from+jM(h,a,r.state.tabSize)}function AD(r,e,s){let o;if(r.nodeType!=3||e!=(o=r.nodeValue.length))return!1;for(let l=r.nextSibling;l;l=l.nextSibling)if(l.nodeType!=1||l.nodeName!="BR")return!1;return Br(r,o-1,o).getBoundingClientRect().left>s}function RD(r,e,s){if(e!=0)return!1;for(let l=r;;){let a=l.parentNode;if(!a||a.nodeType!=1||a.firstChild!=l)return!1;if(a.classList.contains("cm-line"))break;l=a}let o=r.nodeType==1?r.getBoundingClientRect():Br(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return s-o.left>5}function ND(r,e){let s=r.lineBlockAt(e);if(Array.isArray(s.type)){for(let o of s.type)if(o.to>e||o.to==e&&(o.to==s.to||o.type==Ns.Text))return o}return s}function LD(r,e,s,o){let l=ND(r,e.head),a=!o||l.type!=Ns.Text||!(r.lineWrapping||l.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>l.from?e.head-1:e.head);if(a){let h=r.dom.getBoundingClientRect(),d=r.textDirectionAt(l.from),p=r.posAtCoords({x:s==(d==$i.LTR)?h.right-1:h.left+1,y:(a.top+a.bottom)/2});if(p!=null)return wt.cursor(p,s?-1:1)}return wt.cursor(s?l.to:l.from,s?-1:1)}function fC(r,e,s,o){let l=r.state.doc.lineAt(e.head),a=r.bidiSpans(l),h=r.textDirectionAt(l.from);for(let d=e,p=null;;){let f=TD(l,a,h,d,s),m=A0;if(!f){if(l.number==(s?r.state.doc.lines:1))return d;m=`
`,l=r.state.doc.line(l.number+(s?1:-1)),a=r.bidiSpans(l),f=wt.cursor(s?l.from:l.to)}if(p){if(!p(m))return d}else{if(!o)return f;p=o(m)}d=f}}function MD(r,e,s){let o=r.state.charCategorizer(e),l=o(s);return a=>{let h=o(a);return l==Bo.Space&&(l=h),l==h}}function DD(r,e,s,o){let l=e.head,a=s?1:-1;if(l==(s?r.state.doc.length:0))return wt.cursor(l,e.assoc);let h=e.goalColumn,d,p=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(l,e.assoc||-1),m=r.documentTop;if(f)h==null&&(h=f.left-p.left),d=a<0?f.top:f.bottom;else{let I=r.viewState.lineBlockAt(l);h==null&&(h=Math.min(p.right-p.left,r.defaultCharacterWidth*(l-I.from))),d=(a<0?I.top:I.bottom)+m}let T=p.left+h,b=o??r.viewState.heightOracle.textHeight>>1;for(let I=0;;I+=10){let w=d+(b+I)*a,M=L0(r,{x:T,y:w},!1,a);if(w<p.top||w>p.bottom||(a<0?M<l:M>l)){let N=r.docView.coordsForChar(M),U=!N||w<N.top?-1:1;return wt.cursor(M,U,void 0,h)}}}function Vd(r,e,s){for(;;){let o=0;for(let l of r)l.between(e-1,e+1,(a,h,d)=>{if(e>a&&e<h){let p=o||s||(e-a<h-e?-1:1);e=p<0?a:h,o=p}});if(!o)return e}}function W$(r,e,s){let o=Vd(r.state.facet(fb).map(l=>l(r)),s.from,e.head>s.from?-1:1);return o==s.from?s:wt.cursor(o,o<s.from?1:-1)}class xD{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Ot.safari&&e.contentDOM.addEventListener("input",()=>null),Ot.gecko&&QD(e.contentDOM.ownerDocument)}handleEvent(e){!XD(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,s){let o=this.handlers[e];if(o){for(let l of o.observers)l(this.view,s);for(let l of o.handlers){if(s.defaultPrevented)break;if(l(this.view,s)){s.preventDefault();break}}}}ensureHandlers(e){let s=PD(e),o=this.handlers,l=this.view.contentDOM;for(let a in s)if(a!="scroll"){let h=!s[a].handlers.length,d=o[a];d&&h!=!d.handlers.length&&(l.removeEventListener(a,this.handleEvent),d=null),d||l.addEventListener(a,this.handleEvent,{passive:h})}for(let a in o)a!="scroll"&&!s[a]&&l.removeEventListener(a,this.handleEvent);this.handlers=s}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&FD.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),Ot.android&&Ot.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let s;return Ot.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((s=M0.find(o=>o.keyCode==e.keyCode))&&!e.ctrlKey||BD.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=s||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,oc(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Ot.safari&&!Ot.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function mC(r,e){return(s,o)=>{try{return e.call(r,o,s)}catch(l){Mr(s.state,l)}}}function PD(r){let e=Object.create(null);function s(o){return e[o]||(e[o]={observers:[],handlers:[]})}for(let o of r){let l=o.spec;if(l&&l.domEventHandlers)for(let a in l.domEventHandlers){let h=l.domEventHandlers[a];h&&s(a).handlers.push(mC(o.value,h))}if(l&&l.domEventObservers)for(let a in l.domEventObservers){let h=l.domEventObservers[a];h&&s(a).observers.push(mC(o.value,h))}}for(let o in mo)s(o).handlers.push(mo[o]);for(let o in Ms)s(o).observers.push(Ms[o]);return e}const M0=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],BD="dthko",FD=[16,17,18,20,91,92,224,225],fd=6;function md(r){return Math.max(0,r)*.7+8}function HD(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class UD{constructor(e,s,o,l){this.view=e,this.startEvent=s,this.style=o,this.mustSelect=l,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=s,this.scrollParent=tD(e.contentDOM),this.atoms=e.state.facet(fb).map(h=>h(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=s.shiftKey,this.multiple=e.state.facet(de.allowMultipleSelections)&&VD(e,s),this.dragging=WD(e,s)&&B0(s)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var s;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&HD(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let o=0,l=0,a=((s=this.scrollParent)===null||s===void 0?void 0:s.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},h=y0(this.view);e.clientX-h.left<=a.left+fd?o=-md(a.left-e.clientX):e.clientX+h.right>=a.right-fd&&(o=md(e.clientX-a.right)),e.clientY-h.top<=a.top+fd?l=-md(a.top-e.clientY):e.clientY+h.bottom>=a.bottom-fd&&(l=md(e.clientY-a.bottom)),this.setScrollSpeed(o,l)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,s){this.scrollSpeed={x:e,y:s},e||s?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let s=null;for(let o=0;o<e.ranges.length;o++){let l=e.ranges[o],a=null;if(l.empty){let h=Vd(this.atoms,l.from,0);h!=l.from&&(a=wt.cursor(h,-1))}else{let h=Vd(this.atoms,l.from,-1),d=Vd(this.atoms,l.to,1);(h!=l.from||d!=l.to)&&(a=wt.range(l.from==l.anchor?h:d,l.from==l.head?h:d))}a&&(s||(s=e.ranges.slice()),s[o]=a)}return s?wt.create(s,e.mainIndex):e}select(e){let{view:s}=this,o=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!o.eq(s.state.selection)||o.main.assoc!=s.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:o,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function VD(r,e){let s=r.state.facet(f0);return s.length?s[0](e):Ot.mac?e.metaKey:e.ctrlKey}function GD(r,e){let s=r.state.facet(m0);return s.length?s[0](e):Ot.mac?!e.altKey:!e.ctrlKey}function WD(r,e){let{main:s}=r.state.selection;if(s.empty)return!1;let o=op(r.root);if(!o||o.rangeCount==0)return!0;let l=o.getRangeAt(0).getClientRects();for(let a=0;a<l.length;a++){let h=l[a];if(h.left<=e.clientX&&h.right>=e.clientX&&h.top<=e.clientY&&h.bottom>=e.clientY)return!0}return!1}function XD(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let s=e.target,o;s!=r.contentDOM;s=s.parentNode)if(!s||s.nodeType==11||(o=Re.get(s))&&o.ignoreEvent(e))return!1;return!0}const mo=Object.create(null),Ms=Object.create(null),D0=Ot.ie&&Ot.ie_version<15||Ot.ios&&Ot.webkit_version<604;function zD(r){let e=r.dom.parentNode;if(!e)return;let s=e.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus(),setTimeout(()=>{r.focus(),s.remove(),x0(r,s.value)},50)}function x0(r,e){let{state:s}=r,o,l=1,a=s.toText(e),h=a.lines==s.selection.ranges.length;if($T!=null&&s.selection.ranges.every(p=>p.empty)&&$T==a.toString()){let p=-1;o=s.changeByRange(f=>{let m=s.doc.lineAt(f.from);if(m.from==p)return{range:f};p=m.from;let T=s.toText((h?a.line(l++).text:e)+s.lineBreak);return{changes:{from:m.from,insert:T},range:wt.cursor(f.from+T.length)}})}else h?o=s.changeByRange(p=>{let f=a.line(l++);return{changes:{from:p.from,to:p.to,insert:f.text},range:wt.cursor(p.from+f.length)}}):o=s.replaceSelection(a);r.dispatch(o,{userEvent:"input.paste",scrollIntoView:!0})}Ms.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};mo.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&(r.inputState.lastEscPress=Date.now()),!1);Ms.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Ms.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};mo.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let s=null;for(let o of r.state.facet($0))if(s=o(r,e),s)break;if(!s&&e.button==0&&(s=jD(r,e)),s){let o=!r.hasFocus;r.inputState.startMouseSelection(new UD(r,e,s,o)),o&&r.observer.ignore(()=>s0(r.contentDOM));let l=r.inputState.mouseSelection;if(l)return l.start(e),l.dragging===!1}return!1};function $C(r,e,s,o){if(o==1)return wt.cursor(e,s);if(o==2)return wD(r.state,e,s);{let l=je.find(r.docView,e),a=r.state.doc.lineAt(l?l.posAtEnd:e),h=l?l.posAtStart:a.from,d=l?l.posAtEnd:a.to;return d<r.state.doc.length&&d==a.to&&d++,wt.range(h,d)}}let P0=(r,e)=>r>=e.top&&r<=e.bottom,_C=(r,e,s)=>P0(e,s)&&r>=s.left&&r<=s.right;function YD(r,e,s,o){let l=je.find(r.docView,e);if(!l)return 1;let a=e-l.posAtStart;if(a==0)return 1;if(a==l.length)return-1;let h=l.coordsAt(a,-1);if(h&&_C(s,o,h))return-1;let d=l.coordsAt(a,1);return d&&_C(s,o,d)?1:h&&P0(o,h)?-1:1}function TC(r,e){let s=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:s,bias:YD(r,s,e.clientX,e.clientY)}}const KD=Ot.ie&&Ot.ie_version<=11;let bC=null,EC=0,vC=0;function B0(r){if(!KD)return r.detail;let e=bC,s=vC;return bC=r,vC=Date.now(),EC=!e||s>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(EC+1)%3:1}function jD(r,e){let s=TC(r,e),o=B0(e),l=r.state.selection;return{update(a){a.docChanged&&(s.pos=a.changes.mapPos(s.pos),l=l.map(a.changes))},get(a,h,d){let p=TC(r,a),f,m=$C(r,p.pos,p.bias,o);if(s.pos!=p.pos&&!h){let T=$C(r,s.pos,s.bias,o),b=Math.min(T.from,m.from),I=Math.max(T.to,m.to);m=b<m.from?wt.range(b,I):wt.range(I,b)}return h?l.replaceRange(l.main.extend(m.from,m.to)):d&&o==1&&l.ranges.length>1&&(f=JD(l,p.pos))?f:d?l.addRange(m):wt.create([m])}}}function JD(r,e){for(let s=0;s<r.ranges.length;s++){let{from:o,to:l}=r.ranges[s];if(o<=e&&l>=e)return wt.create(r.ranges.slice(0,s).concat(r.ranges.slice(s+1)),r.mainIndex==s?0:r.mainIndex-(r.mainIndex>s?1:0))}return null}mo.dragstart=(r,e)=>{let{selection:{main:s}}=r.state,{mouseSelection:o}=r.inputState;return o&&(o.dragging=s),e.dataTransfer&&(e.dataTransfer.setData("Text",r.state.sliceDoc(s.from,s.to)),e.dataTransfer.effectAllowed="copyMove"),!1};function IC(r,e,s,o){if(!s)return;let l=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{mouseSelection:a}=r.inputState,h=o&&a&&a.dragging&&GD(r,e)?{from:a.dragging.from,to:a.dragging.to}:null,d={from:l,insert:s},p=r.state.changes(h?[h,d]:d);r.focus(),r.dispatch({changes:p,selection:{anchor:p.mapPos(l,-1),head:p.mapPos(l,1)},userEvent:h?"move.drop":"input.drop"})}mo.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let s=e.dataTransfer.files;if(s&&s.length){let o=Array(s.length),l=0,a=()=>{++l==s.length&&IC(r,e,o.filter(h=>h!=null).join(r.state.lineBreak),!1)};for(let h=0;h<s.length;h++){let d=new FileReader;d.onerror=a,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(o[h]=d.result),a()},d.readAsText(s[h])}return!0}else{let o=e.dataTransfer.getData("Text");if(o)return IC(r,e,o,!0),!0}return!1};mo.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let s=D0?null:e.clipboardData;return s?(x0(r,s.getData("text/plain")||s.getData("text/uri-text")),!0):(zD(r),!1)};function qD(r,e){let s=r.dom.parentNode;if(!s)return;let o=s.appendChild(document.createElement("textarea"));o.style.cssText="position: fixed; left: -10000px; top: 10px",o.value=e,o.focus(),o.selectionEnd=e.length,o.selectionStart=0,setTimeout(()=>{o.remove(),r.focus()},50)}function ZD(r){let e=[],s=[],o=!1;for(let l of r.selection.ranges)l.empty||(e.push(r.sliceDoc(l.from,l.to)),s.push(l));if(!e.length){let l=-1;for(let{from:a}of r.selection.ranges){let h=r.doc.lineAt(a);h.number>l&&(e.push(h.text),s.push({from:h.from,to:Math.min(r.doc.length,h.to+1)})),l=h.number}o=!0}return{text:e.join(r.lineBreak),ranges:s,linewise:o}}let $T=null;mo.copy=mo.cut=(r,e)=>{let{text:s,ranges:o,linewise:l}=ZD(r.state);if(!s&&!l)return!1;$T=l?s:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"});let a=D0?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",s),!0):(qD(r,s),!1)};const F0=Ic.define();function H0(r,e){let s=[];for(let o of r.facet(b0)){let l=o(r,e);l&&s.push(l)}return s?r.update({effects:s,annotations:F0.of(!0)}):null}function U0(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let s=H0(r.state,e);s?r.dispatch(s):r.update([])}},10)}Ms.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),U0(r)};Ms.blur=r=>{r.observer.clearSelectionRange(),U0(r)};Ms.compositionstart=Ms.compositionupdate=r=>{r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0)};Ms.compositionend=r=>{r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,Ot.chrome&&Ot.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50)};Ms.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};mo.beforeinput=(r,e)=>{var s;let o;if(Ot.chrome&&Ot.android&&(o=M0.find(l=>l.inputType==e.inputType))&&(r.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let l=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return!1};const SC=new Set;function QD(r){SC.has(r)||(SC.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const yC=["pre-wrap","normal","pre-line","break-spaces"];class tx{constructor(e){this.lineWrapping=e,this.doc=pe.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,s){let o=this.doc.lineAt(s).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(o+=Math.max(0,Math.ceil((s-e-o*this.lineLength*.5)/this.lineLength))),this.lineHeight*o}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return yC.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let s=!1;for(let o=0;o<e.length;o++){let l=e[o];l<0?o++:this.heightSamples[Math.floor(l*10)]||(s=!0,this.heightSamples[Math.floor(l*10)]=!0)}return s}refresh(e,s,o,l,a,h){let d=yC.indexOf(e)>-1,p=Math.round(s)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=s,this.charWidth=o,this.textHeight=l,this.lineLength=a,p){this.heightSamples={};for(let f=0;f<h.length;f++){let m=h[f];m<0?f++:this.heightSamples[Math.floor(m*10)]=!0}}return p}}class ex{constructor(e,s){this.from=e,this.heights=s,this.index=0}get more(){return this.index<this.heights.length}}class ao{constructor(e,s,o,l,a){this.from=e,this.length=s,this.top=o,this.height=l,this._content=a}get type(){return typeof this._content=="number"?Ns.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Mn?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let s=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new ao(this.from,this.length+e.length,this.top,this.height+e.height,s)}}var Ae=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Ae||(Ae={}));const Gd=.001;class Oi{constructor(e,s,o=2){this.length=e,this.height=s,this.flags=o}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,s){this.height!=s&&(Math.abs(this.height-s)>Gd&&(e.heightChanged=!0),this.height=s)}replace(e,s,o){return Oi.of(o)}decomposeLeft(e,s){s.push(this)}decomposeRight(e,s){s.push(this)}applyChanges(e,s,o,l){let a=this,h=o.doc;for(let d=l.length-1;d>=0;d--){let{fromA:p,toA:f,fromB:m,toB:T}=l[d],b=a.lineAt(p,Ae.ByPosNoHeight,o.setDoc(s),0,0),I=b.to>=f?b:a.lineAt(f,Ae.ByPosNoHeight,o,0,0);for(T+=I.to-f,f=I.to;d>0&&b.from<=l[d-1].toA;)p=l[d-1].fromA,m=l[d-1].fromB,d--,p<b.from&&(b=a.lineAt(p,Ae.ByPosNoHeight,o,0,0));m+=b.from-p,p=b.from;let w=mb.build(o.setDoc(h),e,m,T);a=a.replace(p,f,w)}return a.updateHeight(o,0)}static empty(){return new ji(0,0)}static of(e){if(e.length==1)return e[0];let s=0,o=e.length,l=0,a=0;for(;;)if(s==o)if(l>a*2){let d=e[s-1];d.break?e.splice(--s,1,d.left,null,d.right):e.splice(--s,1,d.left,d.right),o+=1+d.break,l-=d.size}else if(a>l*2){let d=e[o];d.break?e.splice(o,1,d.left,null,d.right):e.splice(o,1,d.left,d.right),o+=2+d.break,a-=d.size}else break;else if(l<a){let d=e[s++];d&&(l+=d.size)}else{let d=e[--o];d&&(a+=d.size)}let h=0;return e[s-1]==null?(h=1,s--):e[s]==null&&(h=1,o++),new ix(Oi.of(e.slice(0,s)),h,Oi.of(e.slice(o)))}}Oi.prototype.size=1;class V0 extends Oi{constructor(e,s,o){super(e,s),this.deco=o}blockAt(e,s,o,l){return new ao(l,this.length,o,this.height,this.deco||0)}lineAt(e,s,o,l,a){return this.blockAt(0,o,l,a)}forEachLine(e,s,o,l,a,h){e<=a+this.length&&s>=a&&h(this.blockAt(0,o,l,a))}updateHeight(e,s=0,o=!1,l){return l&&l.from<=s&&l.more&&this.setHeight(e,l.heights[l.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ji extends V0{constructor(e,s){super(e,s,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,s,o,l){return new ao(l,this.length,o,this.height,this.breaks)}replace(e,s,o){let l=o[0];return o.length==1&&(l instanceof ji||l instanceof oi&&l.flags&4)&&Math.abs(this.length-l.length)<10?(l instanceof oi?l=new ji(l.length,this.height):l.height=this.height,this.outdated||(l.outdated=!1),l):Oi.of(o)}updateHeight(e,s=0,o=!1,l){return l&&l.from<=s&&l.more?this.setHeight(e,l.heights[l.index++]):(o||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class oi extends Oi{constructor(e){super(e,0)}heightMetrics(e,s){let o=e.doc.lineAt(s).number,l=e.doc.lineAt(s+this.length).number,a=l-o+1,h,d=0;if(e.lineWrapping){let p=Math.min(this.height,e.lineHeight*a);h=p/a,this.length>a+1&&(d=(this.height-p)/(this.length-a-1))}else h=this.height/a;return{firstLine:o,lastLine:l,perLine:h,perChar:d}}blockAt(e,s,o,l){let{firstLine:a,lastLine:h,perLine:d,perChar:p}=this.heightMetrics(s,l);if(s.lineWrapping){let f=l+Math.round(Math.max(0,Math.min(1,(e-o)/this.height))*this.length),m=s.doc.lineAt(f),T=d+m.length*p,b=Math.max(o,e-T/2);return new ao(m.from,m.length,b,T,0)}else{let f=Math.max(0,Math.min(h-a,Math.floor((e-o)/d))),{from:m,length:T}=s.doc.line(a+f);return new ao(m,T,o+d*f,d,0)}}lineAt(e,s,o,l,a){if(s==Ae.ByHeight)return this.blockAt(e,o,l,a);if(s==Ae.ByPosNoHeight){let{from:I,to:w}=o.doc.lineAt(e);return new ao(I,w-I,0,0,0)}let{firstLine:h,perLine:d,perChar:p}=this.heightMetrics(o,a),f=o.doc.lineAt(e),m=d+f.length*p,T=f.number-h,b=l+d*T+p*(f.from-a-T);return new ao(f.from,f.length,Math.max(l,Math.min(b,l+this.height-m)),m,0)}forEachLine(e,s,o,l,a,h){e=Math.max(e,a),s=Math.min(s,a+this.length);let{firstLine:d,perLine:p,perChar:f}=this.heightMetrics(o,a);for(let m=e,T=l;m<=s;){let b=o.doc.lineAt(m);if(m==e){let w=b.number-d;T+=p*w+f*(e-a-w)}let I=p+f*b.length;h(new ao(b.from,b.length,T,I,0)),T+=I,m=b.to+1}}replace(e,s,o){let l=this.length-s;if(l>0){let a=o[o.length-1];a instanceof oi?o[o.length-1]=new oi(a.length+l):o.push(null,new oi(l-1))}if(e>0){let a=o[0];a instanceof oi?o[0]=new oi(e+a.length):o.unshift(new oi(e-1),null)}return Oi.of(o)}decomposeLeft(e,s){s.push(new oi(e-1),null)}decomposeRight(e,s){s.push(null,new oi(this.length-e-1))}updateHeight(e,s=0,o=!1,l){let a=s+this.length;if(l&&l.from<=s+this.length&&l.more){let h=[],d=Math.max(s,l.from),p=-1;for(l.from>s&&h.push(new oi(l.from-s-1).updateHeight(e,s));d<=a&&l.more;){let m=e.doc.lineAt(d).length;h.length&&h.push(null);let T=l.heights[l.index++];p==-1?p=T:Math.abs(T-p)>=Gd&&(p=-2);let b=new ji(m,T);b.outdated=!1,h.push(b),d+=m+1}d<=a&&h.push(null,new oi(a-d).updateHeight(e,d));let f=Oi.of(h);return(p<0||Math.abs(f.height-this.height)>=Gd||Math.abs(p-this.heightMetrics(e,s).perLine)>=Gd)&&(e.heightChanged=!0),f}else(o||this.outdated)&&(this.setHeight(e,e.heightForGap(s,s+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ix extends Oi{constructor(e,s,o){super(e.length+s+o.length,e.height+o.height,s|(e.outdated||o.outdated?2:0)),this.left=e,this.right=o,this.size=e.size+o.size}get break(){return this.flags&1}blockAt(e,s,o,l){let a=o+this.left.height;return e<a?this.left.blockAt(e,s,o,l):this.right.blockAt(e,s,a,l+this.left.length+this.break)}lineAt(e,s,o,l,a){let h=l+this.left.height,d=a+this.left.length+this.break,p=s==Ae.ByHeight?e<h:e<d,f=p?this.left.lineAt(e,s,o,l,a):this.right.lineAt(e,s,o,h,d);if(this.break||(p?f.to<d:f.from>d))return f;let m=s==Ae.ByPosNoHeight?Ae.ByPosNoHeight:Ae.ByPos;return p?f.join(this.right.lineAt(d,m,o,h,d)):this.left.lineAt(d,m,o,l,a).join(f)}forEachLine(e,s,o,l,a,h){let d=l+this.left.height,p=a+this.left.length+this.break;if(this.break)e<p&&this.left.forEachLine(e,s,o,l,a,h),s>=p&&this.right.forEachLine(e,s,o,d,p,h);else{let f=this.lineAt(p,Ae.ByPos,o,l,a);e<f.from&&this.left.forEachLine(e,f.from-1,o,l,a,h),f.to>=e&&f.from<=s&&h(f),s>f.to&&this.right.forEachLine(f.to+1,s,o,d,p,h)}}replace(e,s,o){let l=this.left.length+this.break;if(s<l)return this.balanced(this.left.replace(e,s,o),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-l,s-l,o));let a=[];e>0&&this.decomposeLeft(e,a);let h=a.length;for(let d of o)a.push(d);if(e>0&&CC(a,h-1),s<this.length){let d=a.length;this.decomposeRight(s,a),CC(a,d)}return Oi.of(a)}decomposeLeft(e,s){let o=this.left.length;if(e<=o)return this.left.decomposeLeft(e,s);s.push(this.left),this.break&&(o++,e>=o&&s.push(null)),e>o&&this.right.decomposeLeft(e-o,s)}decomposeRight(e,s){let o=this.left.length,l=o+this.break;if(e>=l)return this.right.decomposeRight(e-l,s);e<o&&this.left.decomposeRight(e,s),this.break&&e<l&&s.push(null),s.push(this.right)}balanced(e,s){return e.size>2*s.size||s.size>2*e.size?Oi.of(this.break?[e,null,s]:[e,s]):(this.left=e,this.right=s,this.height=e.height+s.height,this.outdated=e.outdated||s.outdated,this.size=e.size+s.size,this.length=e.length+this.break+s.length,this)}updateHeight(e,s=0,o=!1,l){let{left:a,right:h}=this,d=s+a.length+this.break,p=null;return l&&l.from<=s+a.length&&l.more?p=a=a.updateHeight(e,s,o,l):a.updateHeight(e,s,o),l&&l.from<=d+h.length&&l.more?p=h=h.updateHeight(e,d,o,l):h.updateHeight(e,d,o),p?this.balanced(a,h):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function CC(r,e){let s,o;r[e]==null&&(s=r[e-1])instanceof oi&&(o=r[e+1])instanceof oi&&r.splice(e-1,3,new oi(s.length+1+o.length))}const sx=5;class mb{constructor(e,s){this.pos=e,this.oracle=s,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,s){if(this.lineStart>-1){let o=Math.min(s,this.lineEnd),l=this.nodes[this.nodes.length-1];l instanceof ji?l.length+=o-this.pos:(o>this.pos||!this.isCovered)&&this.nodes.push(new ji(o-this.pos,-1)),this.writtenTo=o,s>o&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=s}point(e,s,o){if(e<s||o.heightRelevant){let l=o.widget?o.widget.estimatedHeight:0,a=o.widget?o.widget.lineBreaks:0;l<0&&(l=this.oracle.lineHeight);let h=s-e;o.block?this.addBlock(new V0(h,l,o)):(h||a||l>=sx)&&this.addLineDeco(l,a,h)}else s>e&&this.span(e,s);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:s}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=s,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new ji(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,s){let o=new oi(s-e);return this.oracle.doc.lineAt(e).to==s&&(o.flags|=4),o}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof ji)return e;let s=new ji(0,-1);return this.nodes.push(s),s}addBlock(e){this.enterLine();let s=e.deco;s&&s.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,s&&s.endSide>0&&(this.covering=e)}addLineDeco(e,s,o){let l=this.ensureLine();l.length+=o,l.collapsed+=o,l.widgetHeight=Math.max(l.widgetHeight,e),l.breaks+=s,this.writtenTo=this.pos=this.pos+o}finish(e){let s=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(s instanceof ji)&&!this.isCovered?this.nodes.push(new ji(0,-1)):(this.writtenTo<this.pos||s==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let o=e;for(let l of this.nodes)l instanceof ji&&l.updateHeight(this.oracle,o),o+=l?l.length:1;return this.nodes}static build(e,s,o,l){let a=new mb(o,e);return _e.spans(s,o,l,a,0),a.finish(o)}}function ox(r,e,s){let o=new nx;return _e.compare(r,e,s,o,0),o.changes}class nx{constructor(){this.changes=[]}compareRange(){}comparePoint(e,s,o,l){(e<s||o&&o.heightRelevant||l&&l.heightRelevant)&&uT(e,s,this.changes,5)}}function rx(r,e){let s=r.getBoundingClientRect(),o=r.ownerDocument,l=o.defaultView||window,a=Math.max(0,s.left),h=Math.min(l.innerWidth,s.right),d=Math.max(0,s.top),p=Math.min(l.innerHeight,s.bottom);for(let f=r.parentNode;f&&f!=o.body;)if(f.nodeType==1){let m=f,T=window.getComputedStyle(m);if((m.scrollHeight>m.clientHeight||m.scrollWidth>m.clientWidth)&&T.overflow!="visible"){let b=m.getBoundingClientRect();a=Math.max(a,b.left),h=Math.min(h,b.right),d=Math.max(d,b.top),p=f==r.parentNode?b.bottom:Math.min(p,b.bottom)}f=T.position=="absolute"||T.position=="fixed"?m.offsetParent:m.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:a-s.left,right:Math.max(a,h)-s.left,top:d-(s.top+e),bottom:Math.max(d,p)-(s.top+e)}}function lx(r,e){let s=r.getBoundingClientRect();return{left:0,right:s.right-s.left,top:e,bottom:s.bottom-(s.top+e)}}class X${constructor(e,s,o){this.from=e,this.to=s,this.size=o}static same(e,s){if(e.length!=s.length)return!1;for(let o=0;o<e.length;o++){let l=e[o],a=s[o];if(l.from!=a.from||l.to!=a.to||l.size!=a.size)return!1}return!0}draw(e,s){return Zi.replace({widget:new cx(this.size*(s?e.scaleY:e.scaleX),s)}).range(this.from,this.to)}}class cx extends pb{constructor(e,s){super(),this.size=e,this.vertical=s}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class wC{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=kC,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=$i.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let s=e.facet(gb).some(o=>typeof o!="function"&&o.class=="cm-lineWrapping");this.heightOracle=new tx(s),this.stateDeco=e.facet(_h).filter(o=>typeof o!="function"),this.heightMap=Oi.empty().applyChanges(this.stateDeco,pe.empty,this.heightOracle.setDoc(e.doc),[new hs(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Zi.set(this.lineGaps.map(o=>o.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:s}=this.state.selection;for(let o=0;o<=1;o++){let l=o?s.head:s.anchor;if(!e.some(({from:a,to:h})=>l>=a&&l<=h)){let{from:a,to:h}=this.lineBlockAt(l);e.push(new $d(a,h))}}this.viewports=e.sort((o,l)=>o.from-l.from),this.scaler=this.heightMap.height<=7e6?kC:new ux(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Aa(e,this.scaler))})}update(e,s=null){this.state=e.state;let o=this.stateDeco;this.stateDeco=this.state.facet(_h).filter(m=>typeof m!="function");let l=e.changedRanges,a=hs.extendWithRanges(l,ox(o,this.stateDeco,e?e.changes:Qe.empty(this.state.doc.length))),h=this.heightMap.height,d=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),this.heightMap.height!=h&&(e.flags|=2),d?(this.scrollAnchorPos=e.changes.mapPos(d.from,-1),this.scrollAnchorHeight=d.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let p=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(s&&(s.range.head<p.from||s.range.head>p.to)||!this.viewportIsAppropriate(p))&&(p=this.getViewport(0,s));let f=!e.changes.empty||e.flags&2||p.from!=this.viewport.from||p.to!=this.viewport.to;this.viewport=p,this.updateForViewport(),f&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),s&&(this.scrollTarget=s),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(aD)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let s=e.contentDOM,o=window.getComputedStyle(s),l=this.heightOracle,a=o.whiteSpace;this.defaultTextDirection=o.direction=="rtl"?$i.RTL:$i.LTR;let h=this.heightOracle.mustRefreshForWrapping(a),d=s.getBoundingClientRect(),p=h||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let f=0,m=0;if(d.width&&d.height){let F=d.width/s.offsetWidth,st=d.height/s.offsetHeight;(F>.995&&F<1.005||!isFinite(F)||Math.abs(d.width-s.offsetWidth)<1)&&(F=1),(st>.995&&st<1.005||!isFinite(st)||Math.abs(d.height-s.offsetHeight)<1)&&(st=1),(this.scaleX!=F||this.scaleY!=st)&&(this.scaleX=F,this.scaleY=st,f|=8,h=p=!0)}let T=(parseInt(o.paddingTop)||0)*this.scaleY,b=(parseInt(o.paddingBottom)||0)*this.scaleY;(this.paddingTop!=T||this.paddingBottom!=b)&&(this.paddingTop=T,this.paddingBottom=b,f|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(l.lineWrapping&&(p=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=8);let I=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=I&&(this.scrollAnchorHeight=-1,this.scrollTop=I),this.scrolledToBottom=n0(e.scrollDOM);let w=(this.printing?lx:rx)(s,this.paddingTop),M=w.top-this.pixelViewport.top,N=w.bottom-this.pixelViewport.bottom;this.pixelViewport=w;let U=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(U!=this.inView&&(this.inView=U,U&&(p=!0)),!this.inView&&!this.scrollTarget)return 0;let W=d.width;if((this.contentDOMWidth!=W||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=e.scrollDOM.clientHeight,f|=8),p){let F=e.docView.measureVisibleLineHeights(this.viewport);if(l.mustRefreshForHeights(F)&&(h=!0),h||l.lineWrapping&&Math.abs(W-this.contentDOMWidth)>l.charWidth){let{lineHeight:st,charWidth:it,textHeight:Tt}=e.docView.measureTextSize();h=st>0&&l.refresh(a,st,it,Tt,W/it,F),h&&(e.docView.minWidth=0,f|=8)}M>0&&N>0?m=Math.max(M,N):M<0&&N<0&&(m=Math.min(M,N)),l.heightChanged=!1;for(let st of this.viewports){let it=st.from==this.viewport.from?F:e.docView.measureVisibleLineHeights(st);this.heightMap=(h?Oi.empty().applyChanges(this.stateDeco,pe.empty,this.heightOracle,[new hs(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(l,0,h,new ex(st.from,it))}l.heightChanged&&(f|=2)}let tt=!this.viewportIsAppropriate(this.viewport,m)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return tt&&(this.viewport=this.getViewport(m,this.scrollTarget)),this.updateForViewport(),(f&2||tt)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(h?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,s){let o=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),l=this.heightMap,a=this.heightOracle,{visibleTop:h,visibleBottom:d}=this,p=new $d(l.lineAt(h-o*1e3,Ae.ByHeight,a,0,0).from,l.lineAt(d+(1-o)*1e3,Ae.ByHeight,a,0,0).to);if(s){let{head:f}=s.range;if(f<p.from||f>p.to){let m=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),T=l.lineAt(f,Ae.ByPos,a,0,0),b;s.y=="center"?b=(T.top+T.bottom)/2-m/2:s.y=="start"||s.y=="nearest"&&f<p.from?b=T.top:b=T.bottom-m,p=new $d(l.lineAt(b-1e3/2,Ae.ByHeight,a,0,0).from,l.lineAt(b+m+1e3/2,Ae.ByHeight,a,0,0).to)}}return p}mapViewport(e,s){let o=s.mapPos(e.from,-1),l=s.mapPos(e.to,1);return new $d(this.heightMap.lineAt(o,Ae.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(l,Ae.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:s},o=0){if(!this.inView)return!0;let{top:l}=this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(s,Ae.ByPos,this.heightOracle,0,0),{visibleTop:h,visibleBottom:d}=this;return(e==0||l<=h-Math.max(10,Math.min(-o,250)))&&(s==this.state.doc.length||a>=d+Math.max(10,Math.min(o,250)))&&l>h-2*1e3&&a<d+2*1e3}mapLineGaps(e,s){if(!e.length||s.empty)return e;let o=[];for(let l of e)s.touchesRange(l.from,l.to)||o.push(new X$(s.mapPos(l.from),s.mapPos(l.to),l.size));return o}ensureLineGaps(e,s){let o=this.heightOracle.lineWrapping,l=o?1e4:2e3,a=l>>1,h=l<<1;if(this.defaultTextDirection!=$i.LTR&&!o)return[];let d=[],p=(f,m,T,b)=>{if(m-f<a)return;let I=this.state.selection.main,w=[I.from];I.empty||w.push(I.to);for(let N of w)if(N>f&&N<m){p(f,N-10,T,b),p(N+10,m,T,b);return}let M=hx(e,N=>N.from>=T.from&&N.to<=T.to&&Math.abs(N.from-f)<a&&Math.abs(N.to-m)<a&&!w.some(U=>N.from<U&&N.to>U));if(!M){if(m<T.to&&s&&o&&s.visibleRanges.some(N=>N.from<=m&&N.to>=m)){let N=s.moveToLineBoundary(wt.cursor(m),!1,!0).head;N>f&&(m=N)}M=new X$(f,m,this.gapSize(T,f,m,b))}d.push(M)};for(let f of this.viewportLines){if(f.length<h)continue;let m=ax(f.from,f.to,this.stateDeco);if(m.total<h)continue;let T=this.scrollTarget?this.scrollTarget.range.head:null,b,I;if(o){let w=l/this.heightOracle.lineLength*this.heightOracle.lineHeight,M,N;if(T!=null){let U=Td(m,T),W=((this.visibleBottom-this.visibleTop)/2+w)/f.height;M=U-W,N=U+W}else M=(this.visibleTop-f.top-w)/f.height,N=(this.visibleBottom-f.top+w)/f.height;b=_d(m,M),I=_d(m,N)}else{let w=m.total*this.heightOracle.charWidth,M=l*this.heightOracle.charWidth,N,U;if(T!=null){let W=Td(m,T),tt=((this.pixelViewport.right-this.pixelViewport.left)/2+M)/w;N=W-tt,U=W+tt}else N=(this.pixelViewport.left-M)/w,U=(this.pixelViewport.right+M)/w;b=_d(m,N),I=_d(m,U)}b>f.from&&p(f.from,b,f,m),I<f.to&&p(I,f.to,f,m)}return d}gapSize(e,s,o,l){let a=Td(l,o)-Td(l,s);return this.heightOracle.lineWrapping?e.height*a:l.total*this.heightOracle.charWidth*a}updateLineGaps(e){X$.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Zi.set(e.map(s=>s.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let s=[];_e.spans(e,this.viewport.from,this.viewport.to,{span(l,a){s.push({from:l,to:a})},point(){}},20);let o=s.length!=this.visibleRanges.length||this.visibleRanges.some((l,a)=>l.from!=s[a].from||l.to!=s[a].to);return this.visibleRanges=s,o?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(s=>s.from<=e&&s.to>=e)||Aa(this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Aa(this.heightMap.lineAt(this.scaler.fromDOM(e),Ae.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let s=this.lineBlockAtHeight(e+8);return s.from>=this.viewport.from||this.viewportLines[0].top-e>200?s:this.viewportLines[0]}elementAtHeight(e){return Aa(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class $d{constructor(e,s){this.from=e,this.to=s}}function ax(r,e,s){let o=[],l=r,a=0;return _e.spans(s,r,e,{span(){},point(h,d){h>l&&(o.push({from:l,to:h}),a+=h-l),l=d}},20),l<e&&(o.push({from:l,to:e}),a+=e-l),{total:a,ranges:o}}function _d({total:r,ranges:e},s){if(s<=0)return e[0].from;if(s>=1)return e[e.length-1].to;let o=Math.floor(r*s);for(let l=0;;l++){let{from:a,to:h}=e[l],d=h-a;if(o<=d)return a+o;o-=d}}function Td(r,e){let s=0;for(let{from:o,to:l}of r.ranges){if(e<=l){s+=e-o;break}s+=l-o}return s/r.total}function hx(r,e){for(let s of r)if(e(s))return s}const kC={toDOM(r){return r},fromDOM(r){return r},scale:1};class ux{constructor(e,s,o){let l=0,a=0,h=0;this.viewports=o.map(({from:d,to:p})=>{let f=s.lineAt(d,Ae.ByPos,e,0,0).top,m=s.lineAt(p,Ae.ByPos,e,0,0).bottom;return l+=m-f,{from:d,to:p,top:f,bottom:m,domTop:0,domBottom:0}}),this.scale=(7e6-l)/(s.height-l);for(let d of this.viewports)d.domTop=h+(d.top-a)*this.scale,h=d.domBottom=d.domTop+(d.bottom-d.top),a=d.bottom}toDOM(e){for(let s=0,o=0,l=0;;s++){let a=s<this.viewports.length?this.viewports[s]:null;if(!a||e<a.top)return l+(e-o)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);o=a.bottom,l=a.domBottom}}fromDOM(e){for(let s=0,o=0,l=0;;s++){let a=s<this.viewports.length?this.viewports[s]:null;if(!a||e<a.domTop)return o+(e-l)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);o=a.bottom,l=a.domBottom}}}function Aa(r,e){if(e.scale==1)return r;let s=e.toDOM(r.top),o=e.toDOM(r.bottom);return new ao(r.from,r.length,s,o-s,Array.isArray(r._content)?r._content.map(l=>Aa(l,e)):r._content)}const bd=Vt.define({combine:r=>r.join(" ")}),_T=Vt.define({combine:r=>r.indexOf(!0)>-1}),TT=Ln.newName(),G0=Ln.newName(),W0=Ln.newName(),X0={"&light":"."+G0,"&dark":"."+W0};function bT(r,e,s){return new Ln(e,{finish(o){return/&/.test(o)?o.replace(/&\w*/,l=>{if(l=="&")return r;if(!s||!s[l])throw new RangeError(`Unsupported selector: ${l}`);return s[l]}):r+" "+o}})}const dx=bT("."+TT,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},X0),Ra="￿";class px{constructor(e,s){this.points=e,this.text="",this.lineSeparator=s.facet(de.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ra}readRange(e,s){if(!e)return this;let o=e.parentNode;for(let l=e;;){this.findPointBefore(o,l);let a=this.text.length;this.readNode(l);let h=l.nextSibling;if(h==s)break;let d=Re.get(l),p=Re.get(h);(d&&p?d.breakAfter:(d?d.breakAfter:OC(l))||OC(h)&&(l.nodeName!="BR"||l.cmIgnore)&&this.text.length>a)&&this.lineBreak(),l=h}return this.findPointBefore(o,s),this}readTextNode(e){let s=e.nodeValue;for(let o of this.points)o.node==e&&(o.pos=this.text.length+Math.min(o.offset,s.length));for(let o=0,l=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,h=1,d;if(this.lineSeparator?(a=s.indexOf(this.lineSeparator,o),h=this.lineSeparator.length):(d=l.exec(s))&&(a=d.index,h=d[0].length),this.append(s.slice(o,a<0?s.length:a)),a<0)break;if(this.lineBreak(),h>1)for(let p of this.points)p.node==e&&p.pos>this.text.length&&(p.pos-=h-1);o=a+h}}readNode(e){if(e.cmIgnore)return;let s=Re.get(e),o=s&&s.overrideDOMText;if(o!=null){this.findPointInside(e,o.length);for(let l=o.iter();!l.next().done;)l.lineBreak?this.lineBreak():this.append(l.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,s){for(let o of this.points)o.node==e&&e.childNodes[o.offset]==s&&(o.pos=this.text.length)}findPointInside(e,s){for(let o of this.points)(e.nodeType==3?o.node==e:e.contains(o.node))&&(o.pos=this.text.length+(gx(e,o.node,o.offset)?s:0))}}function gx(r,e,s){for(;;){if(!e||s<Wo(e))return!1;if(e==r)return!0;s=$h(e)+1,e=e.parentNode}}function OC(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}class AC{constructor(e,s){this.node=e,this.offset=s,this.pos=-1}}class fx{constructor(e,s,o,l){this.typeOver=l,this.bounds=null,this.text="";let{impreciseHead:a,impreciseAnchor:h}=e.docView;if(e.state.readOnly&&s>-1)this.newSel=null;else if(s>-1&&(this.bounds=e.docView.domBoundsAround(s,o,0))){let d=a||h?[]:_x(e),p=new px(d,e.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=Tx(d,this.bounds.from)}else{let d=e.observer.selectionRange,p=a&&a.node==d.focusNode&&a.offset==d.focusOffset||!nT(e.contentDOM,d.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(d.focusNode,d.focusOffset),f=h&&h.node==d.anchorNode&&h.offset==d.anchorOffset||!nT(e.contentDOM,d.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(d.anchorNode,d.anchorOffset);this.newSel=wt.single(f,p)}}}function z0(r,e){let s,{newSel:o}=e,l=r.state.selection.main,a=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:h,to:d}=e.bounds,p=l.from,f=null;(a===8||Ot.android&&e.text.length<d-h)&&(p=l.to,f="end");let m=$x(r.state.doc.sliceString(h,d,Ra),e.text,p-h,f);m&&(Ot.chrome&&a==13&&m.toB==m.from+2&&e.text.slice(m.from,m.toB)==Ra+Ra&&m.toB--,s={from:h+m.from,to:h+m.toA,insert:pe.of(e.text.slice(m.from,m.toB).split(Ra))})}else o&&(!r.hasFocus&&r.state.facet(Lp)||o.main.eq(l))&&(o=null);if(!s&&!o)return!1;if(!s&&e.typeOver&&!l.empty&&o&&o.main.empty?s={from:l.from,to:l.to,insert:r.state.doc.slice(l.from,l.to)}:s&&s.from>=l.from&&s.to<=l.to&&(s.from!=l.from||s.to!=l.to)&&l.to-l.from-(s.to-s.from)<=4?s={from:l.from,to:l.to,insert:r.state.doc.slice(l.from,s.from).append(s.insert).append(r.state.doc.slice(s.to,l.to))}:(Ot.mac||Ot.android)&&s&&s.from==s.to&&s.from==l.head-1&&/^\. ?$/.test(s.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(o&&s.insert.length==2&&(o=wt.single(o.main.anchor-1,o.main.head-1)),s={from:l.from,to:l.to,insert:pe.of([" "])}):Ot.chrome&&s&&s.from==s.to&&s.from==l.head&&s.insert.toString()==`
 `&&r.lineWrapping&&(o&&(o=wt.single(o.main.anchor-1,o.main.head-1)),s={from:l.from,to:l.to,insert:pe.of([" "])}),s){if(Ot.ios&&r.inputState.flushIOSKey()||Ot.android&&(s.from==l.from&&s.to==l.to&&s.insert.length==1&&s.insert.lines==2&&oc(r.contentDOM,"Enter",13)||(s.from==l.from-1&&s.to==l.to&&s.insert.length==0||a==8&&s.insert.length<s.to-s.from&&s.to>l.head)&&oc(r.contentDOM,"Backspace",8)||s.from==l.from&&s.to==l.to+1&&s.insert.length==0&&oc(r.contentDOM,"Delete",46)))return!0;let h=s.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let d,p=()=>d||(d=mx(r,s,o));return r.state.facet(T0).some(f=>f(r,s.from,s.to,h,p))||r.dispatch(p()),!0}else if(o&&!o.main.eq(l)){let h=!1,d="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(h=!0),d=r.inputState.lastSelectionOrigin),r.dispatch({selection:o,scrollIntoView:h,userEvent:d}),!0}else return!1}function mx(r,e,s){let o,l=r.state,a=l.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!s||s.main.empty&&s.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let d=a.from<e.from?l.sliceDoc(a.from,e.from):"",p=a.to>e.to?l.sliceDoc(e.to,a.to):"";o=l.replaceSelection(r.state.toText(d+e.insert.sliceString(0,void 0,r.state.lineBreak)+p))}else{let d=l.changes(e),p=s&&s.main.to<=d.newLength?s.main:void 0;if(l.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let f=r.state.sliceDoc(e.from,e.to),m,T=s&&R0(r,s.main.head);if(T){let w=e.insert.length-(e.to-e.from);m={from:T.from,to:T.to-w}}else m=r.state.doc.lineAt(a.head);let b=a.to-e.to,I=a.to-a.from;o=l.changeByRange(w=>{if(w.from==a.from&&w.to==a.to)return{changes:d,range:p||w.map(d)};let M=w.to-b,N=M-f.length;if(w.to-w.from!=I||r.state.sliceDoc(N,M)!=f||w.to>=m.from&&w.from<=m.to)return{range:w};let U=l.changes({from:N,to:M,insert:e.insert}),W=w.to-a.to;return{changes:U,range:p?wt.range(Math.max(0,p.anchor+W),Math.max(0,p.head+W)):w.map(U)}})}else o={changes:d,selection:p&&l.selection.replaceRange(p)}}let h="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,h+=".compose",r.inputState.compositionFirstChange&&(h+=".start",r.inputState.compositionFirstChange=!1)),l.update(o,{userEvent:h,scrollIntoView:!0})}function $x(r,e,s,o){let l=Math.min(r.length,e.length),a=0;for(;a<l&&r.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==l&&r.length==e.length)return null;let h=r.length,d=e.length;for(;h>0&&d>0&&r.charCodeAt(h-1)==e.charCodeAt(d-1);)h--,d--;if(o=="end"){let p=Math.max(0,a-Math.min(h,d));s-=h+p-a}if(h<a&&r.length<e.length){let p=s<=a&&s>=h?a-s:0;a-=p,d=a+(d-h),h=a}else if(d<a){let p=s<=a&&s>=d?a-s:0;a-=p,h=a+(h-d),d=a}return{from:a,toA:h,toB:d}}function _x(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:a}=r.observer.selectionRange;return s&&(e.push(new AC(s,o)),(l!=s||a!=o)&&e.push(new AC(l,a))),e}function Tx(r,e){if(r.length==0)return null;let s=r[0].pos,o=r.length==2?r[1].pos:s;return s>-1&&o>-1?wt.single(s+e,o+e):null}const bx={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},z$=Ot.ie&&Ot.ie_version<=11;class Ex{constructor(e){this.view=e,this.active=!1,this.selectionRange=new eD,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(s=>{for(let o of s)this.queue.push(o);(Ot.ie&&Ot.ie_version<=11||Ot.ios&&e.composing)&&s.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),z$&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var s;((s=this.view.docView)===null||s===void 0?void 0:s.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(s=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),s.length>0&&s[s.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(s=>{s.length>0&&s[s.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((s,o)=>s!=e[o]))){this.gapIntersection.disconnect();for(let s of e)this.gapIntersection.observe(s);this.gaps=e}}onSelectionChange(e){let s=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:o}=this,l=this.selectionRange;if(o.state.facet(Lp)?o.root.activeElement!=this.dom:!Ud(o.dom,l))return;let a=l.anchorNode&&o.docView.nearest(l.anchorNode);if(a&&a.ignoreEvent(e)){s||(this.selectionChanged=!1);return}(Ot.ie&&Ot.ie_version<=11||Ot.android&&Ot.chrome)&&!o.state.selection.main.empty&&l.focusNode&&np(l.focusNode,l.focusOffset,l.anchorNode,l.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,s=Ot.safari&&e.root.nodeType==11&&qM(this.dom.ownerDocument)==this.dom&&vx(this.view)||op(e.root);if(!s||this.selectionRange.eq(s))return!1;let o=Ud(this.dom,s);return o&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&sD(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),o&&(this.selectionChanged=!0),!0)}setSelectionRange(e,s){this.selectionRange.set(e.node,e.offset,s.node,s.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,s=null;for(let o=this.dom;o;)if(o.nodeType==1)!s&&e<this.scrollTargets.length&&this.scrollTargets[e]==o?e++:s||(s=this.scrollTargets.slice(0,e)),s&&s.push(o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;if(e<this.scrollTargets.length&&!s&&(s=this.scrollTargets.slice(0,e)),s){for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);for(let o of this.scrollTargets=s)o.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,bx),z$&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),z$&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,s){var o;if(!this.delayedAndroidKey){let l=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&oc(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(l)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:s,force:this.lastChange<Date.now()-50||!!(!((o=this.delayedAndroidKey)===null||o===void 0)&&o.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let s=-1,o=-1,l=!1;for(let a of e){let h=this.readMutation(a);h&&(h.typeOver&&(l=!0),s==-1?{from:s,to:o}=h:(s=Math.min(h.from,s),o=Math.max(h.to,o)))}return{from:s,to:o,typeOver:l}}readChange(){let{from:e,to:s,typeOver:o}=this.processRecords(),l=this.selectionChanged&&Ud(this.dom,this.selectionRange);if(e<0&&!l)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new fx(this.view,e,s,o);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let s=this.readChange();if(!s)return this.view.requestMeasure(),!1;let o=this.view.state,l=z0(this.view,s);return this.view.state==o&&this.view.update([]),l}readMutation(e){let s=this.view.docView.nearest(e.target);if(!s||s.ignoreMutation(e))return null;if(s.markDirty(e.type=="attributes"),e.type=="attributes"&&(s.flags|=4),e.type=="childList"){let o=RC(s,e.previousSibling||e.target.previousSibling,-1),l=RC(s,e.nextSibling||e.target.nextSibling,1);return{from:o?s.posAfter(o):s.posAtStart,to:l?s.posBefore(l):s.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:s.posAtStart,to:s.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,s,o;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(s=this.gapIntersection)===null||s===void 0||s.disconnect(),(o=this.resizeScroll)===null||o===void 0||o.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function RC(r,e,s){for(;e;){let o=Re.get(e);if(o&&o.parent==r)return o;let l=e.parentNode;e=l!=r.dom?l:s>0?e.nextSibling:e.previousSibling}return null}function vx(r){let e=null;function s(p){p.preventDefault(),p.stopImmediatePropagation(),e=p.getTargetRanges()[0]}if(r.contentDOM.addEventListener("beforeinput",s,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",s,!0),!e)return null;let o=e.startContainer,l=e.startOffset,a=e.endContainer,h=e.endOffset,d=r.docView.domAtPos(r.state.selection.main.anchor);return np(d.node,d.offset,a,h)&&([o,l,a,h]=[a,h,o,l]),{anchorNode:o,anchorOffset:l,focusNode:a,focusOffset:h}}class oe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(o=>o.forEach(l=>s(l,this)))||(o=>this.update(o)),this.dispatch=this.dispatch.bind(this),this._root=e.root||iD(e.parent)||document,this.viewState=new wC(e.state||de.create(e)),this.plugins=this.state.facet(ka).map(o=>new V$(o));for(let o of this.plugins)o.update(this);this.observer=new Ex(this),this.inputState=new xD(this),this.inputState.ensureHandlers(this.plugins),this.docView=new aC(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}dispatch(...e){let s=e.length==1&&e[0]instanceof mi?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(s,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let s=!1,o=!1,l,a=this.state;for(let b of e){if(b.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=b.state}if(this.destroyed){this.viewState.state=a;return}let h=this.hasFocus,d=0,p=null;e.some(b=>b.annotation(F0))?(this.inputState.notifiedFocused=h,d=1):h!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=h,p=H0(a,h),p||(d=1));let f=this.observer.delayedAndroidKey,m=null;if(f?(this.observer.clearDelayedAndroidKey(),m=this.observer.readChange(),(m&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(m=null)):this.observer.clear(),a.facet(de.phrases)!=this.state.facet(de.phrases))return this.setState(a);l=lp.create(this,a,e),l.flags|=d;let T=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(T&&(T=T.map(b.changes)),b.scrollIntoView){let{main:I}=b.state.selection;T=new rp(I.empty?I:wt.cursor(I.head,I.head>I.anchor?-1:1))}for(let I of b.effects)I.is(lC)&&(T=I.value)}this.viewState.update(l,T),this.bidiCache=cp.update(this.bidiCache,l.changes),l.empty||(this.updatePlugins(l),this.inputState.update(l)),s=this.docView.update(l),this.state.facet(Oa)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(s,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(l.startState.facet(bd)!=l.state.facet(bd)&&(this.viewState.mustMeasureContent=!0),(s||o||T||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!l.empty)for(let b of this.state.facet(dT))b(l);(p||m)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),m&&!z0(this,m)&&f.force&&oc(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let s=this.hasFocus;try{for(let o of this.plugins)o.destroy(this);this.viewState=new wC(e),this.plugins=e.facet(ka).map(o=>new V$(o)),this.pluginMap.clear();for(let o of this.plugins)o.update(this);this.docView=new aC(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}s&&this.focus(),this.requestMeasure()}updatePlugins(e){let s=e.startState.facet(ka),o=e.state.facet(ka);if(s!=o){let l=[];for(let a of o){let h=s.indexOf(a);if(h<0)l.push(new V$(a));else{let d=this.plugins[h];d.mustUpdate=e,l.push(d)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=l,this.pluginMap.clear()}else for(let l of this.plugins)l.mustUpdate=e;for(let l=0;l<this.plugins.length;l++)this.plugins[l].update(this);s!=o&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let s=null,o=this.scrollDOM,l=o.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:h}=this.viewState;Math.abs(l-this.viewState.scrollTop)>1&&(h=-1),this.viewState.scrollAnchorHeight=-1;try{for(let d=0;;d++){if(h<0)if(n0(o))a=-1,h=this.viewState.heightMap.height;else{let I=this.viewState.scrollAnchorAt(l);a=I.from,h=I.top}this.updateState=1;let p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];p&4||([this.measureRequests,f]=[f,this.measureRequests]);let m=f.map(I=>{try{return I.read(this)}catch(w){return Mr(this.state,w),NC}}),T=lp.create(this,this.state,[]),b=!1;T.flags|=p,s?s.flags|=p:s=T,this.updateState=2,T.empty||(this.updatePlugins(T),this.inputState.update(T),this.updateAttrs(),b=this.docView.update(T));for(let I=0;I<f.length;I++)if(m[I]!=NC)try{let w=f[I];w.write&&w.write(m[I],this)}catch(w){Mr(this.state,w)}if(b&&this.docView.updateSelection(!0),!T.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let w=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-h;if(w>1||w<-1){l=l+w,o.scrollTop=l/this.scaleY,h=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(s&&!s.empty)for(let d of this.state.facet(dT))d(s)}get themeClasses(){return TT+" "+(this.state.facet(_T)?W0:G0)+" "+this.state.facet(bd)}updateAttrs(){let e=LC(this,v0,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),s={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Lp)?"true":"false",class:"cm-content",style:`${Ot.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(s["aria-readonly"]="true"),LC(this,gb,s);let o=this.observer.ignore(()=>{let l=hT(this.contentDOM,this.contentAttrs,s),a=hT(this.dom,this.editorAttrs,e);return l||a});return this.editorAttrs=e,this.contentAttrs=s,o}showAnnouncements(e){let s=!0;for(let o of e)for(let l of o.effects)if(l.is(oe.announce)){s&&(this.announceDOM.textContent=""),s=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=l.value}}mountStyles(){this.styleModules=this.state.facet(Oa);let e=this.state.facet(oe.cspNonce);Ln.mount(this.root,this.styleModules.concat(dx).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let s=0;s<this.measureRequests.length;s++)if(this.measureRequests[s].key===e.key){this.measureRequests[s]=e;return}}this.measureRequests.push(e)}}plugin(e){let s=this.pluginMap.get(e);return(s===void 0||s&&s.spec!=e)&&this.pluginMap.set(e,s=this.plugins.find(o=>o.spec==e)||null),s&&s.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,s,o){return W$(this,e,fC(this,e,s,o))}moveByGroup(e,s){return W$(this,e,fC(this,e,s,o=>MD(this,e.head,o)))}moveToLineBoundary(e,s,o=!0){return LD(this,e,s,o)}moveVertically(e,s,o){return W$(this,e,DD(this,e,s,o))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,s=0){return this.docView.posFromDOM(e,s)}posAtCoords(e,s=!0){return this.readMeasured(),L0(this,e,s)}coordsAtPos(e,s=1){this.readMeasured();let o=this.docView.coordsAt(e,s);if(!o||o.left==o.right)return o;let l=this.state.doc.lineAt(e),a=this.bidiSpans(l),h=a[yn.find(a,e-l.from,-1,s)];return hb(o,h.dir==$i.LTR==s>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(E0)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ix)return O0(e.length);let s=this.textDirectionAt(e.from),o;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==s&&(a.fresh||k0(a.isolates,o=cC(this,e.from,e.to))))return a.order;o||(o=cC(this,e.from,e.to));let l=_D(e.text,s,o);return this.bidiCache.push(new cp(e.from,e.to,s,o,!0,l)),l}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Ot.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{s0(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,s={}){return lC.of(new rp(typeof e=="number"?wt.cursor(e):e,s.y,s.x,s.yMargin,s.xMargin))}static domEventHandlers(e){return Yo.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Yo.define(()=>({}),{eventObservers:e})}static theme(e,s){let o=Ln.newName(),l=[bd.of(o),Oa.of(bT(`.${o}`,e))];return s&&s.dark&&l.push(_T.of(!0)),l}static baseTheme(e){return Wk.lowest(Oa.of(bT("."+TT,e,X0)))}static findFromDOM(e){var s;let o=e.querySelector(".cm-content"),l=o&&Re.get(o)||Re.get(e);return((s=l==null?void 0:l.rootView)===null||s===void 0?void 0:s.view)||null}}oe.styleModule=Oa;oe.inputHandler=T0;oe.focusChangeEffect=b0;oe.perLineTextDirection=E0;oe.exceptionSink=_0;oe.updateListener=dT;oe.editable=Lp;oe.mouseSelectionStyle=$0;oe.dragMovesSelection=m0;oe.clickAddsSelectionRange=f0;oe.decorations=_h;oe.atomicRanges=fb;oe.bidiIsolatedRanges=I0;oe.scrollMargins=S0;oe.darkTheme=_T;oe.cspNonce=Vt.define({combine:r=>r.length?r[0]:""});oe.contentAttributes=gb;oe.editorAttributes=v0;oe.lineWrapping=oe.contentAttributes.of({class:"cm-lineWrapping"});oe.announce=Je.define();const Ix=4096,NC={};class cp{constructor(e,s,o,l,a,h){this.from=e,this.to=s,this.dir=o,this.isolates=l,this.fresh=a,this.order=h}static update(e,s){if(s.empty&&!e.some(a=>a.fresh))return e;let o=[],l=e.length?e[e.length-1].dir:$i.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let h=e[a];h.dir==l&&!s.touchesRange(h.from,h.to)&&o.push(new cp(s.mapPos(h.from,1),s.mapPos(h.to,-1),h.dir,h.isolates,!1,h.order))}return o}}function LC(r,e,s){for(let o=r.state.facet(e),l=o.length-1;l>=0;l--){let a=o[l],h=typeof a=="function"?a(r):a;h&&aT(h,s)}return s}const Sx=!Ot.ios,yx={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Sx&&(yx[".cm-line"].caretColor="transparent !important");class Fr extends cc{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Fr.prototype.elementClass="";Fr.prototype.toDOM=void 0;Fr.prototype.mapMode=Ji.TrackBefore;Fr.prototype.startSide=Fr.prototype.endSide=-1;Fr.prototype.point=!0;const Y$=Vt.define(),Wd=Vt.define(),ET=Vt.define({combine:r=>r.some(e=>e)});function Cx(r){let e=[wx];return r&&r.fixed===!1&&e.push(ET.of(!0)),e}const wx=Yo.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(Wd).map(e=>new DC(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(ET),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,s=r.view.viewport,o=Math.min(e.to,s.to)-Math.max(e.from,s.from);this.syncGutters(o<(s.to-s.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(ET)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let s=_e.iter(this.view.state.facet(Y$),this.view.viewport.from),o=[],l=this.gutters.map(a=>new kx(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(o.length&&(o=[]),Array.isArray(a.type)){let h=!0;for(let d of a.type)if(d.type==Ns.Text&&h){vT(s,o,d.from);for(let p of l)p.line(this.view,d,o);h=!1}else if(d.widget)for(let p of l)p.widget(this.view,d)}else if(a.type==Ns.Text){vT(s,o,a.from);for(let h of l)h.line(this.view,a,o)}else if(a.widget)for(let h of l)h.widget(this.view,a);for(let a of l)a.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(Wd),s=r.state.facet(Wd),o=r.docChanged||r.heightChanged||r.viewportChanged||!_e.eq(r.startState.facet(Y$),r.state.facet(Y$),r.view.viewport.from,r.view.viewport.to);if(e==s)for(let l of this.gutters)l.update(r)&&(o=!0);else{o=!0;let l=[];for(let a of s){let h=e.indexOf(a);h<0?l.push(new DC(this.view,a)):(this.gutters[h].update(r),l.push(this.gutters[h]))}for(let a of this.gutters)a.dom.remove(),l.indexOf(a)<0&&a.destroy();for(let a of l)this.dom.appendChild(a.dom);this.gutters=l}return o}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>oe.scrollMargins.of(e=>{let s=e.plugin(r);return!s||s.gutters.length==0||!s.fixed?null:e.textDirection==$i.LTR?{left:s.dom.offsetWidth*e.scaleX}:{right:s.dom.offsetWidth*e.scaleX}})});function MC(r){return Array.isArray(r)?r:[r]}function vT(r,e,s){for(;r.value&&r.from<=s;)r.from==s&&e.push(r.value),r.next()}class kx{constructor(e,s,o){this.gutter=e,this.height=o,this.i=0,this.cursor=_e.iter(e.markers,s.from)}addElement(e,s,o){let{gutter:l}=this,a=(s.top-this.height)/e.scaleY,h=s.height/e.scaleY;if(this.i==l.elements.length){let d=new Y0(e,h,a,o);l.elements.push(d),l.dom.appendChild(d.dom)}else l.elements[this.i].update(e,h,a,o);this.height=s.bottom,this.i++}line(e,s,o){let l=[];vT(this.cursor,l,s.from),o.length&&(l=l.concat(o));let a=this.gutter.config.lineMarker(e,s,l);a&&l.unshift(a);let h=this.gutter;l.length==0&&!h.config.renderEmptyElements||this.addElement(e,s,l)}widget(e,s){let o=this.gutter.config.widgetMarker(e,s.widget,s);o&&this.addElement(e,s,[o])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let s=e.elements.pop();e.dom.removeChild(s.dom),s.destroy()}}}class DC{constructor(e,s){this.view=e,this.config=s,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let o in s.domEventHandlers)this.dom.addEventListener(o,l=>{let a=l.target,h;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let p=a.getBoundingClientRect();h=(p.top+p.bottom)/2}else h=l.clientY;let d=e.lineBlockAtHeight(h-e.documentTop);s.domEventHandlers[o](e,d,l)&&l.preventDefault()});this.markers=MC(s.markers(e)),s.initialSpacer&&(this.spacer=new Y0(e,0,0,[s.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let s=this.markers;if(this.markers=MC(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let l=this.config.updateSpacer(this.spacer.markers[0],e);l!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[l])}let o=e.view.viewport;return!_e.eq(this.markers,s,o.from,o.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Y0{constructor(e,s,o,l){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,s,o,l)}update(e,s,o,l){this.height!=s&&(this.height=s,this.dom.style.height=s+"px"),this.above!=o&&(this.dom.style.marginTop=(this.above=o)?o+"px":""),Ox(this.markers,l)||this.setMarkers(e,l)}setMarkers(e,s){let o="cm-gutterElement",l=this.dom.firstChild;for(let a=0,h=0;;){let d=h,p=a<s.length?s[a++]:null,f=!1;if(p){let m=p.elementClass;m&&(o+=" "+m);for(let T=h;T<this.markers.length;T++)if(this.markers[T].compare(p)){d=T,f=!0;break}}else d=this.markers.length;for(;h<d;){let m=this.markers[h++];if(m.toDOM){m.destroy(l);let T=l.nextSibling;l.remove(),l=T}}if(!p)break;p.toDOM&&(f?l=l.nextSibling:this.dom.insertBefore(p.toDOM(e),l)),f&&h++}this.dom.className=o,this.markers=s}destroy(){this.setMarkers(null,[])}}function Ox(r,e){if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++)if(!r[s].compare(e[s]))return!1;return!0}const Ax=Vt.define(),Jl=Vt.define({combine(r){return YM(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,s){let o=Object.assign({},e);for(let l in s){let a=o[l],h=s[l];o[l]=a?(d,p,f)=>a(d,p,f)||h(d,p,f):h}return o}})}});class K$ extends Fr{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function j$(r,e){return r.state.facet(Jl).formatNumber(e,r.state)}const Rx=Wd.compute([Jl],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Ax)},lineMarker(e,s,o){return o.some(l=>l.toDOM)?null:new K$(j$(e,e.state.doc.lineAt(s.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(Jl)!=e.state.facet(Jl),initialSpacer(e){return new K$(j$(e,xC(e.state.doc.lines)))},updateSpacer(e,s){let o=j$(s.view,xC(s.view.state.doc.lines));return o==e.number?e:new K$(o)},domEventHandlers:r.facet(Jl).domEventHandlers}));function Nx(r={}){return[Jl.of(r),Cx(),Rx]}function xC(r){let e=9;for(;e<r;)e=e*10+9;return e}const Lx=1024;let Mx=0;class J${constructor(e,s){this.from=e,this.to=s}}class De{constructor(e={}){this.id=Mx++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ps.match(e)),s=>{let o=e(s);return o===void 0?null:[this,o]}}}De.closedBy=new De({deserialize:r=>r.split(" ")});De.openedBy=new De({deserialize:r=>r.split(" ")});De.group=new De({deserialize:r=>r.split(" ")});De.contextHash=new De({perNode:!0});De.lookAhead=new De({perNode:!0});De.mounted=new De({perNode:!0});class ap{constructor(e,s,o){this.tree=e,this.overlay=s,this.parser=o}static get(e){return e&&e.props&&e.props[De.mounted.id]}}const Dx=Object.create(null);class ps{constructor(e,s,o,l=0){this.name=e,this.props=s,this.id=o,this.flags=l}static define(e){let s=e.props&&e.props.length?Object.create(null):Dx,o=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),l=new ps(e.name||"",s,e.id,o);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(l)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");s[a[0].id]=a[1]}}return l}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let s=this.prop(De.group);return s?s.indexOf(e)>-1:!1}return this.id==e}static match(e){let s=Object.create(null);for(let o in e)for(let l of o.split(" "))s[l]=e[o];return o=>{for(let l=o.prop(De.group),a=-1;a<(l?l.length:0);a++){let h=s[a<0?o.name:l[a]];if(h)return h}}}}ps.none=new ps("",Object.create(null),0,8);const Ed=new WeakMap,PC=new WeakMap;var li;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(li||(li={}));class _i{constructor(e,s,o,l,a){if(this.type=e,this.children=s,this.positions=o,this.length=l,this.props=null,a&&a.length){this.props=Object.create(null);for(let[h,d]of a)this.props[typeof h=="number"?h:h.id]=d}}toString(){let e=ap.get(this);if(e&&!e.overlay)return e.tree.toString();let s="";for(let o of this.children){let l=o.toString();l&&(s&&(s+=","),s+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(s.length?"("+s+")":""):s}cursor(e=0){return new ST(this.topNode,e)}cursorAt(e,s=0,o=0){let l=Ed.get(this)||this.topNode,a=new ST(l);return a.moveTo(e,s),Ed.set(this,a._tree),a}get topNode(){return new us(this,0,0,null)}resolve(e,s=0){let o=bh(Ed.get(this)||this.topNode,e,s,!1);return Ed.set(this,o),o}resolveInner(e,s=0){let o=bh(PC.get(this)||this.topNode,e,s,!0);return PC.set(this,o),o}resolveStack(e,s=0){return Bx(this,e,s)}iterate(e){let{enter:s,leave:o,from:l=0,to:a=this.length}=e,h=e.mode||0,d=(h&li.IncludeAnonymous)>0;for(let p=this.cursor(h|li.IncludeAnonymous);;){let f=!1;if(p.from<=a&&p.to>=l&&(!d&&p.type.isAnonymous||s(p)!==!1)){if(p.firstChild())continue;f=!0}for(;f&&o&&(d||!p.type.isAnonymous)&&o(p),!p.nextSibling();){if(!p.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let s in this.props)e.push([+s,this.props[s]]);return e}balance(e={}){return this.children.length<=8?this:Tb(ps.none,this.children,this.positions,0,this.children.length,0,this.length,(s,o,l)=>new _i(this.type,s,o,l,this.propValues),e.makeTree||((s,o,l)=>new _i(ps.none,s,o,l)))}static build(e){return Fx(e)}}_i.empty=new _i(ps.none,[],[],0);class $b{constructor(e,s){this.buffer=e,this.index=s}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new $b(this.buffer,this.index)}}class Vr{constructor(e,s,o){this.buffer=e,this.length=s,this.set=o}get type(){return ps.none}toString(){let e=[];for(let s=0;s<this.buffer.length;)e.push(this.childString(s)),s=this.buffer[s+3];return e.join(",")}childString(e){let s=this.buffer[e],o=this.buffer[e+3],l=this.set.types[s],a=l.name;if(/\W/.test(a)&&!l.isError&&(a=JSON.stringify(a)),e+=4,o==e)return a;let h=[];for(;e<o;)h.push(this.childString(e)),e=this.buffer[e+3];return a+"("+h.join(",")+")"}findChild(e,s,o,l,a){let{buffer:h}=this,d=-1;for(let p=e;p!=s&&!(K0(a,l,h[p+1],h[p+2])&&(d=p,o>0));p=h[p+3]);return d}slice(e,s,o){let l=this.buffer,a=new Uint16Array(s-e),h=0;for(let d=e,p=0;d<s;){a[p++]=l[d++],a[p++]=l[d++]-o;let f=a[p++]=l[d++]-o;a[p++]=l[d++]-e,h=Math.max(h,f)}return new Vr(a,h,this.set)}}function K0(r,e,s,o){switch(r){case-2:return s<e;case-1:return o>=e&&s<e;case 0:return s<e&&o>e;case 1:return s<=e&&o>e;case 2:return o>e;case 4:return!0}}function bh(r,e,s,o){for(var l;r.from==r.to||(s<1?r.from>=e:r.from>e)||(s>-1?r.to<=e:r.to<e);){let h=!o&&r instanceof us&&r.index<0?null:r.parent;if(!h)return r;r=h}let a=o?0:li.IgnoreOverlays;if(o)for(let h=r,d=h.parent;d;h=d,d=h.parent)h instanceof us&&h.index<0&&((l=d.enter(e,s,a))===null||l===void 0?void 0:l.from)!=h.from&&(r=d);for(;;){let h=r.enter(e,s,a);if(!h)return r;r=h}}class j0{cursor(e=0){return new ST(this,e)}getChild(e,s=null,o=null){let l=BC(this,e,s,o);return l.length?l[0]:null}getChildren(e,s=null,o=null){return BC(this,e,s,o)}resolve(e,s=0){return bh(this,e,s,!1)}resolveInner(e,s=0){return bh(this,e,s,!0)}matchContext(e){return IT(this,e)}enterUnfinishedNodesBefore(e){let s=this.childBefore(e),o=this;for(;s;){let l=s.lastChild;if(!l||l.to!=s.to)break;l.type.isError&&l.from==l.to?(o=s,s=l.prevSibling):s=l}return o}get node(){return this}get next(){return this.parent}}class us extends j0{constructor(e,s,o,l){super(),this._tree=e,this.from=s,this.index=o,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,s,o,l,a=0){for(let h=this;;){for(let{children:d,positions:p}=h._tree,f=s>0?d.length:-1;e!=f;e+=s){let m=d[e],T=p[e]+h.from;if(K0(l,o,T,T+m.length)){if(m instanceof Vr){if(a&li.ExcludeBuffers)continue;let b=m.findChild(0,m.buffer.length,s,o-T,l);if(b>-1)return new Cn(new xx(h,m,e,T),null,b)}else if(a&li.IncludeAnonymous||!m.type.isAnonymous||_b(m)){let b;if(!(a&li.IgnoreMounts)&&(b=ap.get(m))&&!b.overlay)return new us(b.tree,T,e,h);let I=new us(m,T,e,h);return a&li.IncludeAnonymous||!I.type.isAnonymous?I:I.nextChild(s<0?m.children.length-1:0,s,o,l)}}}if(a&li.IncludeAnonymous||!h.type.isAnonymous||(h.index>=0?e=h.index+s:e=s<0?-1:h._parent._tree.children.length,h=h._parent,!h))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,s,o=0){let l;if(!(o&li.IgnoreOverlays)&&(l=ap.get(this._tree))&&l.overlay){let a=e-this.from;for(let{from:h,to:d}of l.overlay)if((s>0?h<=a:h<a)&&(s<0?d>=a:d>a))return new us(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,s,o)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function BC(r,e,s,o){let l=r.cursor(),a=[];if(!l.firstChild())return a;if(s!=null){for(;!l.type.is(s);)if(!l.nextSibling())return a}for(;;){if(o!=null&&l.type.is(o))return a;if(l.type.is(e)&&a.push(l.node),!l.nextSibling())return o==null?a:[]}}function IT(r,e,s=e.length-1){for(let o=r.parent;s>=0;o=o.parent){if(!o)return!1;if(!o.type.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}class xx{constructor(e,s,o,l){this.parent=e,this.buffer=s,this.index=o,this.start=l}}class Cn extends j0{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,s,o){super(),this.context=e,this._parent=s,this.index=o,this.type=e.buffer.set.types[e.buffer.buffer[o]]}child(e,s,o){let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.context.start,o);return a<0?null:new Cn(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,s,o=0){if(o&li.ExcludeBuffers)return null;let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],s>0?1:-1,e-this.context.start,s);return a<0?null:new Cn(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,s=e.buffer[this.index+3];return s<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Cn(this.context,this._parent,s):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,s=this._parent?this._parent.index+4:0;return this.index==s?this.externalSibling(-1):new Cn(this.context,this._parent,e.findChild(s,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],s=[],{buffer:o}=this.context,l=this.index+4,a=o.buffer[this.index+3];if(a>l){let h=o.buffer[this.index+1];e.push(o.slice(l,a,h)),s.push(0)}return new _i(this.type,e,s,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function J0(r){if(!r.length)return null;if(r.length==1)return r[0];let e=0,s=r[0];for(let a=1;a<r.length;a++){let h=r[a];(h.from>s.from||h.to<s.to)&&(s=h,e=a)}let o=s instanceof us&&s.index<0?null:s.parent,l=r.slice();return o?l[e]=o:l.splice(e,1),new Px(l,s)}class Px{constructor(e,s){this.heads=e,this.node=s}get next(){return J0(this.heads)}}function Bx(r,e,s){let o=r.resolveInner(e,s),l=null;for(let a=o instanceof us?o:o.context.parent;a;a=a.parent)if(a.index<0){let h=a.parent;(l||(l=[o])).push(h.resolve(e,s)),a=h}else{let h=ap.get(a.tree);if(h&&h.overlay&&h.overlay[0].from<=e&&h.overlay[h.overlay.length-1].to>=e){let d=new us(h.tree,h.overlay[0].from+a.from,0,null);(l||(l=[o])).push(bh(d,e,s,!1))}}return l?J0(l):o}class ST{get name(){return this.type.name}constructor(e,s=0){if(this.mode=s,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof us)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let o=e._parent;o;o=o._parent)this.stack.unshift(o.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,s){this.index=e;let{start:o,buffer:l}=this.buffer;return this.type=s||l.set.types[l.buffer[e]],this.from=o+l.buffer[e+1],this.to=o+l.buffer[e+2],!0}yield(e){return e?e instanceof us?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,s,o){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,s,o,this.mode));let{buffer:l}=this.buffer,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.buffer.start,o);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,s,o=this.mode){return this.buffer?o&li.ExcludeBuffers?!1:this.enterChild(1,e,s):this.yield(this._tree.enter(e,s,o))}parent(){if(!this.buffer)return this.yieldNode(this.mode&li.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&li.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:s}=this.buffer,o=this.stack.length-1;if(e<0){let l=o<0?0:this.stack[o]+4;if(this.index!=l)return this.yieldBuf(s.findChild(l,this.index,-1,0,4))}else{let l=s.buffer[this.index+3];if(l<(o<0?s.buffer.length:s.buffer[this.stack[o]+3]))return this.yieldBuf(l)}return o<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let s,o,{buffer:l}=this;if(l){if(e>0){if(this.index<l.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(l.buffer.buffer[a+3]<this.index)return!1;({index:s,parent:o}=l)}else({index:s,_parent:o}=this._tree);for(;o;{index:s,_parent:o}=o)if(s>-1)for(let a=s+e,h=e<0?-1:o._tree.children.length;a!=h;a+=e){let d=o._tree.children[a];if(this.mode&li.IncludeAnonymous||d instanceof Vr||!d.type.isAnonymous||_b(d))return!1}return!0}move(e,s){if(s&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,s=0){for(;(this.from==this.to||(s<1?this.from>=e:this.from>e)||(s>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,s););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,s=null,o=0;if(e&&e.context==this.buffer)t:for(let l=this.index,a=this.stack.length;a>=0;){for(let h=e;h;h=h._parent)if(h.index==l){if(l==this.index)return h;s=h,o=a+1;break t}l=this.stack[--a]}for(let l=o;l<this.stack.length;l++)s=new Cn(this.buffer,s,this.stack[l]);return this.bufferNode=new Cn(this.buffer,s,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,s){for(let o=0;;){let l=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){o++;continue}this.type.isAnonymous||(l=!0)}for(;l&&s&&s(this),l=this.type.isAnonymous,!this.nextSibling();){if(!o)return;this.parent(),o--,l=!0}}}matchContext(e){if(!this.buffer)return IT(this.node,e);let{buffer:s}=this.buffer,{types:o}=s.set;for(let l=e.length-1,a=this.stack.length-1;l>=0;a--){if(a<0)return IT(this.node,e,l);let h=o[s.buffer[this.stack[a]]];if(!h.isAnonymous){if(e[l]&&e[l]!=h.name)return!1;l--}}return!0}}function _b(r){return r.children.some(e=>e instanceof Vr||!e.type.isAnonymous||_b(e))}function Fx(r){var e;let{buffer:s,nodeSet:o,maxBufferLength:l=Lx,reused:a=[],minRepeatType:h=o.types.length}=r,d=Array.isArray(s)?new $b(s,s.length):s,p=o.types,f=0,m=0;function T(F,st,it,Tt,Lt){let{id:It,start:mt,end:Ct,size:Ft}=d,Nt=m;for(;Ft<0;)if(d.next(),Ft==-1){let At=a[It];it.push(At),Tt.push(mt-F);return}else if(Ft==-3){f=It;return}else if(Ft==-4){m=It;return}else throw new RangeError(`Unrecognized record size: ${Ft}`);let qt=p[It],at,Bt,xt=mt-F;if(Ct-mt<=l&&(Bt=M(d.pos-st,Lt))){let At=new Uint16Array(Bt.size-Bt.skip),Zt=d.pos-Bt.size,Dt=At.length;for(;d.pos>Zt;)Dt=N(Bt.start,At,Dt);at=new Vr(At,Ct-Bt.start,o),xt=Bt.start-F}else{let At=d.pos-Ft;d.next();let Zt=[],Dt=[],Ce=It>=h?It:-1,ne=0,We=Ct;for(;d.pos>At;)Ce>=0&&d.id==Ce&&d.size>=0?(d.end<=We-l&&(I(Zt,Dt,mt,ne,d.end,We,Ce,Nt),ne=Zt.length,We=d.end),d.next()):T(mt,At,Zt,Dt,Ce);if(Ce>=0&&ne>0&&ne<Zt.length&&I(Zt,Dt,mt,ne,mt,We,Ce,Nt),Zt.reverse(),Dt.reverse(),Ce>-1&&ne>0){let pt=b(qt);at=Tb(qt,Zt,Dt,0,Zt.length,0,Ct-mt,pt,pt)}else at=w(qt,Zt,Dt,Ct-mt,Nt-Ct)}it.push(at),Tt.push(xt)}function b(F){return(st,it,Tt)=>{let Lt=0,It=st.length-1,mt,Ct;if(It>=0&&(mt=st[It])instanceof _i){if(!It&&mt.type==F&&mt.length==Tt)return mt;(Ct=mt.prop(De.lookAhead))&&(Lt=it[It]+mt.length+Ct)}return w(F,st,it,Tt,Lt)}}function I(F,st,it,Tt,Lt,It,mt,Ct){let Ft=[],Nt=[];for(;F.length>Tt;)Ft.push(F.pop()),Nt.push(st.pop()+it-Lt);F.push(w(o.types[mt],Ft,Nt,It-Lt,Ct-It)),st.push(Lt-it)}function w(F,st,it,Tt,Lt=0,It){if(f){let mt=[De.contextHash,f];It=It?[mt].concat(It):[mt]}if(Lt>25){let mt=[De.lookAhead,Lt];It=It?[mt].concat(It):[mt]}return new _i(F,st,it,Tt,It)}function M(F,st){let it=d.fork(),Tt=0,Lt=0,It=0,mt=it.end-l,Ct={size:0,start:0,skip:0};t:for(let Ft=it.pos-F;it.pos>Ft;){let Nt=it.size;if(it.id==st&&Nt>=0){Ct.size=Tt,Ct.start=Lt,Ct.skip=It,It+=4,Tt+=4,it.next();continue}let qt=it.pos-Nt;if(Nt<0||qt<Ft||it.start<mt)break;let at=it.id>=h?4:0,Bt=it.start;for(it.next();it.pos>qt;){if(it.size<0)if(it.size==-3)at+=4;else break t;else it.id>=h&&(at+=4);it.next()}Lt=Bt,Tt+=Nt,It+=at}return(st<0||Tt==F)&&(Ct.size=Tt,Ct.start=Lt,Ct.skip=It),Ct.size>4?Ct:void 0}function N(F,st,it){let{id:Tt,start:Lt,end:It,size:mt}=d;if(d.next(),mt>=0&&Tt<h){let Ct=it;if(mt>4){let Ft=d.pos-(mt-4);for(;d.pos>Ft;)it=N(F,st,it)}st[--it]=Ct,st[--it]=It-F,st[--it]=Lt-F,st[--it]=Tt}else mt==-3?f=Tt:mt==-4&&(m=Tt);return it}let U=[],W=[];for(;d.pos>0;)T(r.start||0,r.bufferStart||0,U,W,-1);let tt=(e=r.length)!==null&&e!==void 0?e:U.length?W[0]+U[0].length:0;return new _i(p[r.topID],U.reverse(),W.reverse(),tt)}const FC=new WeakMap;function Xd(r,e){if(!r.isAnonymous||e instanceof Vr||e.type!=r)return 1;let s=FC.get(e);if(s==null){s=1;for(let o of e.children){if(o.type!=r||!(o instanceof _i)){s=1;break}s+=Xd(r,o)}FC.set(e,s)}return s}function Tb(r,e,s,o,l,a,h,d,p){let f=0;for(let w=o;w<l;w++)f+=Xd(r,e[w]);let m=Math.ceil(f*1.5/8),T=[],b=[];function I(w,M,N,U,W){for(let tt=N;tt<U;){let F=tt,st=M[tt],it=Xd(r,w[tt]);for(tt++;tt<U;tt++){let Tt=Xd(r,w[tt]);if(it+Tt>=m)break;it+=Tt}if(tt==F+1){if(it>m){let Tt=w[F];I(Tt.children,Tt.positions,0,Tt.children.length,M[F]+W);continue}T.push(w[F])}else{let Tt=M[tt-1]+w[tt-1].length-st;T.push(Tb(r,w,M,F,tt,st,Tt,null,p))}b.push(st+W-a)}}return I(e,s,o,l,0),(d||p)(T,b,h)}class Dr{constructor(e,s,o,l,a=!1,h=!1){this.from=e,this.to=s,this.tree=o,this.offset=l,this.open=(a?1:0)|(h?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,s=[],o=!1){let l=[new Dr(0,e.length,e,0,!1,o)];for(let a of s)a.to>e.length&&l.push(a);return l}static applyChanges(e,s,o=128){if(!s.length)return e;let l=[],a=1,h=e.length?e[0]:null;for(let d=0,p=0,f=0;;d++){let m=d<s.length?s[d]:null,T=m?m.fromA:1e9;if(T-p>=o)for(;h&&h.from<T;){let b=h;if(p>=b.from||T<=b.to||f){let I=Math.max(b.from,p)-f,w=Math.min(b.to,T)-f;b=I>=w?null:new Dr(I,w,b.tree,b.offset+f,d>0,!!m)}if(b&&l.push(b),h.to>T)break;h=a<e.length?e[a++]:null}if(!m)break;p=m.toA,f=m.toA-m.toB}return l}}class Hx{startParse(e,s,o){return typeof e=="string"&&(e=new Ux(e)),o=o?o.length?o.map(l=>new J$(l.from,l.to)):[new J$(0,0)]:[new J$(0,e.length)],this.createParse(e,s||[],o)}parse(e,s,o){let l=this.startParse(e,s,o);for(;;){let a=l.advance();if(a)return a}}}class Ux{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,s){return this.string.slice(e,s)}}new De({perNode:!0});let Vx=0;class ro{constructor(e,s,o){this.set=e,this.base=s,this.modified=o,this.id=Vx++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let s=new ro([],null,[]);if(s.set.push(s),e)for(let o of e.set)s.set.push(o);return s}static defineModifier(){let e=new hp;return s=>s.modified.indexOf(e)>-1?s:hp.get(s.base||s,s.modified.concat(e).sort((o,l)=>o.id-l.id))}}let Gx=0;class hp{constructor(){this.instances=[],this.id=Gx++}static get(e,s){if(!s.length)return e;let o=s[0].instances.find(d=>d.base==e&&Wx(s,d.modified));if(o)return o;let l=[],a=new ro(l,e,s);for(let d of s)d.instances.push(a);let h=Xx(s);for(let d of e.set)if(!d.modified.length)for(let p of h)l.push(hp.get(d,p));return a}}function Wx(r,e){return r.length==e.length&&r.every((s,o)=>s==e[o])}function Xx(r){let e=[[]];for(let s=0;s<r.length;s++)for(let o=0,l=e.length;o<l;o++)e.push(e[o].concat(r[s]));return e.sort((s,o)=>o.length-s.length)}function zx(r){let e=Object.create(null);for(let s in r){let o=r[s];Array.isArray(o)||(o=[o]);for(let l of s.split(" "))if(l){let a=[],h=2,d=l;for(let T=0;;){if(d=="..."&&T>0&&T+3==l.length){h=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!b)throw new RangeError("Invalid path: "+l);if(a.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),T+=b[0].length,T==l.length)break;let I=l[T++];if(T==l.length&&I=="!"){h=0;break}if(I!="/")throw new RangeError("Invalid path: "+l);d=l.slice(T)}let p=a.length-1,f=a[p];if(!f)throw new RangeError("Invalid path: "+l);let m=new up(o,h,p>0?a.slice(0,p):null);e[f]=m.sort(e[f])}}return q0.add(e)}const q0=new De;class up{constructor(e,s,o,l){this.tags=e,this.mode=s,this.context=o,this.next=l}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}up.empty=new up([],2,null);function Z0(r,e){let s=Object.create(null);for(let a of r)if(!Array.isArray(a.tag))s[a.tag.id]=a.class;else for(let h of a.tag)s[h.id]=a.class;let{scope:o,all:l=null}=e||{};return{style:a=>{let h=l;for(let d of a)for(let p of d.set){let f=s[p.id];if(f){h=h?h+" "+f:f;break}}return h},scope:o}}function Yx(r,e){let s=null;for(let o of r){let l=o.style(e);l&&(s=s?s+" "+l:l)}return s}function Kx(r,e,s,o=0,l=r.length){let a=new jx(o,Array.isArray(e)?e:[e],s);a.highlightRange(r.cursor(),o,l,"",a.highlighters),a.flush(l)}class jx{constructor(e,s,o){this.at=e,this.highlighters=s,this.span=o,this.class=""}startSpan(e,s){s!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=s)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,s,o,l,a){let{type:h,from:d,to:p}=e;if(d>=o||p<=s)return;h.isTop&&(a=this.highlighters.filter(I=>!I.scope||I.scope(h)));let f=l,m=Jx(e)||up.empty,T=Yx(a,m.tags);if(T&&(f&&(f+=" "),f+=T,m.mode==1&&(l+=(l?" ":"")+T)),this.startSpan(Math.max(s,d),f),m.opaque)return;let b=e.tree&&e.tree.prop(De.mounted);if(b&&b.overlay){let I=e.node.enter(b.overlay[0].from+d,1),w=this.highlighters.filter(N=>!N.scope||N.scope(b.tree.type)),M=e.firstChild();for(let N=0,U=d;;N++){let W=N<b.overlay.length?b.overlay[N]:null,tt=W?W.from+d:p,F=Math.max(s,U),st=Math.min(o,tt);if(F<st&&M)for(;e.from<st&&(this.highlightRange(e,F,st,l,a),this.startSpan(Math.min(st,e.to),f),!(e.to>=tt||!e.nextSibling())););if(!W||tt>o)break;U=W.to+d,U>s&&(this.highlightRange(I.cursor(),Math.max(s,W.from+d),Math.min(o,U),"",w),this.startSpan(Math.min(o,U),f))}M&&e.parent()}else if(e.firstChild()){b&&(l="");do if(!(e.to<=s)){if(e.from>=o)break;this.highlightRange(e,s,o,l,a),this.startSpan(Math.min(o,e.to),f)}while(e.nextSibling());e.parent()}}}function Jx(r){let e=r.type.prop(q0);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const gt=ro.define,vd=gt(),vn=gt(),HC=gt(vn),UC=gt(vn),In=gt(),Id=gt(In),q$=gt(In),oo=gt(),Sr=gt(oo),io=gt(),so=gt(),yT=gt(),Ea=gt(yT),Sd=gt(),ct={comment:vd,lineComment:gt(vd),blockComment:gt(vd),docComment:gt(vd),name:vn,variableName:gt(vn),typeName:HC,tagName:gt(HC),propertyName:UC,attributeName:gt(UC),className:gt(vn),labelName:gt(vn),namespace:gt(vn),macroName:gt(vn),literal:In,string:Id,docString:gt(Id),character:gt(Id),attributeValue:gt(Id),number:q$,integer:gt(q$),float:gt(q$),bool:gt(In),regexp:gt(In),escape:gt(In),color:gt(In),url:gt(In),keyword:io,self:gt(io),null:gt(io),atom:gt(io),unit:gt(io),modifier:gt(io),operatorKeyword:gt(io),controlKeyword:gt(io),definitionKeyword:gt(io),moduleKeyword:gt(io),operator:so,derefOperator:gt(so),arithmeticOperator:gt(so),logicOperator:gt(so),bitwiseOperator:gt(so),compareOperator:gt(so),updateOperator:gt(so),definitionOperator:gt(so),typeOperator:gt(so),controlOperator:gt(so),punctuation:yT,separator:gt(yT),bracket:Ea,angleBracket:gt(Ea),squareBracket:gt(Ea),paren:gt(Ea),brace:gt(Ea),content:oo,heading:Sr,heading1:gt(Sr),heading2:gt(Sr),heading3:gt(Sr),heading4:gt(Sr),heading5:gt(Sr),heading6:gt(Sr),contentSeparator:gt(oo),list:gt(oo),quote:gt(oo),emphasis:gt(oo),strong:gt(oo),link:gt(oo),monospace:gt(oo),strikethrough:gt(oo),inserted:gt(),deleted:gt(),changed:gt(),invalid:gt(),meta:Sd,documentMeta:gt(Sd),annotation:gt(Sd),processingInstruction:gt(Sd),definition:ro.defineModifier(),constant:ro.defineModifier(),function:ro.defineModifier(),standard:ro.defineModifier(),local:ro.defineModifier(),special:ro.defineModifier()};Z0([{tag:ct.link,class:"tok-link"},{tag:ct.heading,class:"tok-heading"},{tag:ct.emphasis,class:"tok-emphasis"},{tag:ct.strong,class:"tok-strong"},{tag:ct.keyword,class:"tok-keyword"},{tag:ct.atom,class:"tok-atom"},{tag:ct.bool,class:"tok-bool"},{tag:ct.url,class:"tok-url"},{tag:ct.labelName,class:"tok-labelName"},{tag:ct.inserted,class:"tok-inserted"},{tag:ct.deleted,class:"tok-deleted"},{tag:ct.literal,class:"tok-literal"},{tag:ct.string,class:"tok-string"},{tag:ct.number,class:"tok-number"},{tag:[ct.regexp,ct.escape,ct.special(ct.string)],class:"tok-string2"},{tag:ct.variableName,class:"tok-variableName"},{tag:ct.local(ct.variableName),class:"tok-variableName tok-local"},{tag:ct.definition(ct.variableName),class:"tok-variableName tok-definition"},{tag:ct.special(ct.variableName),class:"tok-variableName2"},{tag:ct.definition(ct.propertyName),class:"tok-propertyName tok-definition"},{tag:ct.typeName,class:"tok-typeName"},{tag:ct.namespace,class:"tok-namespace"},{tag:ct.className,class:"tok-className"},{tag:ct.macroName,class:"tok-macroName"},{tag:ct.propertyName,class:"tok-propertyName"},{tag:ct.operator,class:"tok-operator"},{tag:ct.comment,class:"tok-comment"},{tag:ct.meta,class:"tok-meta"},{tag:ct.invalid,class:"tok-invalid"},{tag:ct.punctuation,class:"tok-punctuation"}]);var Z$;const Na=new De,qx=new De;class ho{constructor(e,s,o=[],l=""){this.data=e,this.name=l,de.prototype.hasOwnProperty("tree")||Object.defineProperty(de.prototype,"tree",{get(){return Eh(this)}}),this.parser=s,this.extension=[dc.of(this),de.languageData.of((a,h,d)=>{let p=VC(a,h,d),f=p.type.prop(Na);if(!f)return[];let m=a.facet(f),T=p.type.prop(qx);if(T){let b=p.resolve(h-p.from,d);for(let I of T)if(I.test(b,a)){let w=a.facet(I.facet);return I.type=="replace"?w:w.concat(m)}}return m})].concat(o)}isActiveAt(e,s,o=-1){return VC(e,s,o).type.prop(Na)==this.data}findRegions(e){let s=e.facet(dc);if((s==null?void 0:s.data)==this.data)return[{from:0,to:e.doc.length}];if(!s||!s.allowsNesting)return[];let o=[],l=(a,h)=>{if(a.prop(Na)==this.data){o.push({from:h,to:h+a.length});return}let d=a.prop(De.mounted);if(d){if(d.tree.prop(Na)==this.data){if(d.overlay)for(let p of d.overlay)o.push({from:p.from+h,to:p.to+h});else o.push({from:h,to:h+a.length});return}else if(d.overlay){let p=o.length;if(l(d.tree,d.overlay[0].from+h),o.length>p)return}}for(let p=0;p<a.children.length;p++){let f=a.children[p];f instanceof _i&&l(f,a.positions[p]+h)}};return l(Eh(e),0),o}get allowsNesting(){return!0}}ho.setState=Je.define();function VC(r,e,s){let o=r.facet(dc),l=Eh(r).topNode;if(!o||o.allowsNesting)for(let a=l;a;a=a.enter(e,s,li.ExcludeBuffers))a.type.isTop&&(l=a);return l}function Eh(r){let e=r.field(ho.state,!1);return e?e.tree:_i.empty}class Zx{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,s){let o=this.cursorPos-this.string.length;return e<o||s>=this.cursorPos?this.doc.sliceString(e,s):this.string.slice(e-o,s-o)}}let va=null;class dp{constructor(e,s,o=[],l,a,h,d,p){this.parser=e,this.state=s,this.fragments=o,this.tree=l,this.treeLen=a,this.viewport=h,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(e,s,o){return new dp(e,s,[],_i.empty,0,o,[],null)}startParse(){return this.parser.startParse(new Zx(this.state.doc),this.fragments)}work(e,s){return s!=null&&s>=this.state.doc.length&&(s=void 0),this.tree!=_i.empty&&this.isDone(s??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var o;if(typeof e=="number"){let l=Date.now()+e;e=()=>Date.now()>l}for(this.parse||(this.parse=this.startParse()),s!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>s)&&s<this.state.doc.length&&this.parse.stopAt(s);;){let l=this.parse.advance();if(l)if(this.fragments=this.withoutTempSkipped(Dr.addTree(l,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(o=this.parse.stoppedAt)!==null&&o!==void 0?o:this.state.doc.length,this.tree=l,this.parse=null,this.treeLen<(s??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,s;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(s=this.parse.advance()););}),this.treeLen=e,this.tree=s,this.fragments=this.withoutTempSkipped(Dr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let s=va;va=this;try{return e()}finally{va=s}}withoutTempSkipped(e){for(let s;s=this.tempSkipped.pop();)e=GC(e,s.from,s.to);return e}changes(e,s){let{fragments:o,tree:l,treeLen:a,viewport:h,skipped:d}=this;if(this.takeTree(),!e.empty){let p=[];if(e.iterChangedRanges((f,m,T,b)=>p.push({fromA:f,toA:m,fromB:T,toB:b})),o=Dr.applyChanges(o,p),l=_i.empty,a=0,h={from:e.mapPos(h.from,-1),to:e.mapPos(h.to,1)},this.skipped.length){d=[];for(let f of this.skipped){let m=e.mapPos(f.from,1),T=e.mapPos(f.to,-1);m<T&&d.push({from:m,to:T})}}}return new dp(this.parser,s,o,l,a,h,d,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let s=this.skipped.length;for(let o=0;o<this.skipped.length;o++){let{from:l,to:a}=this.skipped[o];l<e.to&&a>e.from&&(this.fragments=GC(this.fragments,l,a),this.skipped.splice(o--,1))}return this.skipped.length>=s?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,s){this.skipped.push({from:e,to:s})}static getSkippingParser(e){return new class extends Hx{createParse(s,o,l){let a=l[0].from,h=l[l.length-1].to;return{parsedPos:a,advance(){let p=va;if(p){for(let f of l)p.tempSkipped.push(f);e&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,e]):e)}return this.parsedPos=h,new _i(ps.none,[],[],h-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let s=this.fragments;return this.treeLen>=e&&s.length&&s[0].from==0&&s[0].to>=e}static get(){return va}}function GC(r,e,s){return Dr.applyChanges(r,[{fromA:e,toA:s,fromB:e,toB:s}])}class uc{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let s=this.context.changes(e.changes,e.state),o=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),s.viewport.to);return s.work(20,o)||s.takeTree(),new uc(s)}static init(e){let s=Math.min(3e3,e.doc.length),o=dp.create(e.facet(dc).parser,e,{from:0,to:s});return o.work(20,s)||o.takeTree(),new uc(o)}}ho.state=Bn.define({create:uc.init,update(r,e){for(let s of e.effects)if(s.is(ho.setState))return s.value;return e.startState.facet(dc)!=e.state.facet(dc)?uc.init(e.state):r.apply(e)}});let Q0=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Q0=r=>{let e=-1,s=setTimeout(()=>{e=requestIdleCallback(r,{timeout:500-100})},100);return()=>e<0?clearTimeout(s):cancelIdleCallback(e)});const Q$=typeof navigator<"u"&&(!((Z$=navigator.scheduling)===null||Z$===void 0)&&Z$.isInputPending)?()=>navigator.scheduling.isInputPending():null,Qx=Yo.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let s=this.view.state.field(ho.state).context;(s.updateViewport(e.view.viewport)||this.view.viewport.to>s.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(s)}scheduleWork(){if(this.working)return;let{state:e}=this.view,s=e.field(ho.state);(s.tree!=s.context.tree||!s.context.isDone(e.doc.length))&&(this.working=Q0(this.work))}work(e){this.working=null;let s=Date.now();if(this.chunkEnd<s&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=s+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:o,viewport:{to:l}}=this.view,a=o.field(ho.state);if(a.tree==a.context.tree&&a.context.isDone(l+1e5))return;let h=Date.now()+Math.min(this.chunkBudget,100,e&&!Q$?Math.max(25,e.timeRemaining()-5):1e9),d=a.context.treeLen<l&&o.doc.length>l+1e3,p=a.context.work(()=>Q$&&Q$()||Date.now()>h,l+(d?0:1e5));this.chunkBudget-=Date.now()-s,(p||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:ho.setState.of(new uc(a.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(s=>Mr(this.view.state,s)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),dc=Vt.define({combine(r){return r.length?r[0]:null},enables:r=>[ho.state,Qx,oe.contentAttributes.compute([r],e=>{let s=e.facet(r);return s&&s.name?{"data-language":s.name}:{}})]});class Mp{constructor(e,s){this.specs=e;let o;function l(d){let p=Ln.newName();return(o||(o=Object.create(null)))["."+p]=d,p}const a=typeof s.all=="string"?s.all:s.all?l(s.all):void 0,h=s.scope;this.scope=h instanceof ho?d=>d.prop(Na)==h.data:h?d=>d==h:void 0,this.style=Z0(e.map(d=>({tag:d.tag,class:d.class||l(Object.assign({},d,{tag:null}))})),{all:a}).style,this.module=o?new Ln(o):null,this.themeType=s.themeType}static define(e,s){return new Mp(e,s||{})}}const CT=Vt.define(),tO=Vt.define({combine(r){return r.length?[r[0]]:null}});function t_(r){let e=r.facet(CT);return e.length?e:r.facet(tO)}function t1(r,e){let s=[i1],o;return r instanceof Mp&&(r.module&&s.push(oe.styleModule.of(r.module)),o=r.themeType),e!=null&&e.fallback?s.push(tO.of(r)):o?s.push(CT.computeN([oe.darkTheme],l=>l.facet(oe.darkTheme)==(o=="dark")?[r]:[])):s.push(CT.of(r)),s}class e1{constructor(e){this.markCache=Object.create(null),this.tree=Eh(e.state),this.decorations=this.buildDeco(e,t_(e.state))}update(e){let s=Eh(e.state),o=t_(e.state),l=o!=t_(e.startState);s.length<e.view.viewport.to&&!l&&s.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(s!=this.tree||e.viewportChanged||l)&&(this.tree=s,this.decorations=this.buildDeco(e.view,o))}buildDeco(e,s){if(!s||!this.tree.length)return Zi.none;let o=new gh;for(let{from:l,to:a}of e.visibleRanges)Kx(this.tree,s,(h,d,p)=>{o.add(h,d,this.markCache[p]||(this.markCache[p]=Zi.mark({class:p})))},l,a);return o.finish()}}const i1=Wk.high(Yo.fromClass(e1,{decorations:r=>r.decorations})),s1=Object.create(null),WC=[ps.none],XC=[],o1=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])o1[r]=n1(s1,e);function e_(r,e){XC.indexOf(r)>-1||(XC.push(r),console.warn(e))}function n1(r,e){let s=[];for(let a of e.split(" ")){let h=[];for(let d of a.split(".")){let p=r[d]||ct[d];p?typeof p=="function"?h.length?h=h.map(p):e_(d,`Modifier ${d} used at start of tag`):h.length?e_(d,`Tag ${d} used as modifier`):h=Array.isArray(p)?p:[p]:e_(d,`Unknown highlighting tag ${d}`)}for(let d of h)s.push(d)}if(!s.length)return 0;let o=e.replace(/ /g,"_"),l=ps.define({id:WC.length,name:o,props:[zx({[o]:s})]});return WC.push(l),l.id}const r1="#e5c07b",zC="#e06c75",l1="#56b6c2",c1="#ffffff",zd="#abb2bf",wT="#7d8799",a1="#61afef",h1="#98c379",YC="#d19a66",u1="#c678dd",d1="#21252b",KC="#2c313a",jC="#282c34",i_="#353a42",p1="#3E4451",JC="#528bff",g1=oe.theme({"&":{color:zd,backgroundColor:jC},".cm-content":{caretColor:JC},".cm-cursor, .cm-dropCursor":{borderLeftColor:JC},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:p1},".cm-panels":{backgroundColor:d1,color:zd},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:jC,color:wT,border:"none"},".cm-activeLineGutter":{backgroundColor:KC},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:i_},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:i_,borderBottomColor:i_},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:KC,color:zd}}},{dark:!0}),f1=Mp.define([{tag:ct.keyword,color:u1},{tag:[ct.name,ct.deleted,ct.character,ct.propertyName,ct.macroName],color:zC},{tag:[ct.function(ct.variableName),ct.labelName],color:a1},{tag:[ct.color,ct.constant(ct.name),ct.standard(ct.name)],color:YC},{tag:[ct.definition(ct.name),ct.separator],color:zd},{tag:[ct.typeName,ct.className,ct.number,ct.changed,ct.annotation,ct.modifier,ct.self,ct.namespace],color:r1},{tag:[ct.operator,ct.operatorKeyword,ct.url,ct.escape,ct.regexp,ct.link,ct.special(ct.string)],color:l1},{tag:[ct.meta,ct.comment],color:wT},{tag:ct.strong,fontWeight:"bold"},{tag:ct.emphasis,fontStyle:"italic"},{tag:ct.strikethrough,textDecoration:"line-through"},{tag:ct.link,color:wT,textDecoration:"underline"},{tag:ct.heading,fontWeight:"bold",color:zC},{tag:[ct.atom,ct.bool,ct.special(ct.variableName)],color:YC},{tag:[ct.processingInstruction,ct.string,ct.inserted],color:h1},{tag:ct.invalid,color:c1}]),m1=[g1,t1(f1)],$1=oe.baseTheme({".active":{backgroundColor:"yellow",color:"black"}});let kT=Bn.define({create(){return _e.of([],!0)},update(r,e){for(let s of e.effects)if(s.is(OT))return s.value;return r}});const _1=Yo.fromClass(class{constructor(r){this.decorations=r.state.field(kT)}update(r){this.decorations=r.view.state.field(kT)}},{decorations:r=>r.decorations});function T1(){return[$1,kT,_1]}const OT=Je.define();function qC(r,e){if(e>0&&e<=r.state.doc.lines){let s=r.state.doc.line(e).from;r.dispatch({effects:OT.of(_e.of([Zi.line({class:"active"}).range(s)],!0))})}else r.dispatch({effects:OT.of(_e.of([],!0))})}const b1={__name:"BaseCodeMirrorEditor",props:{highlightedLine:Number},setup(r){let e=Ls(),s=Ls(),o=r;qT(()=>{let h=de.create({doc:Ba.value,extensions:[m1,T1(),Nx(),oe.editable.of(!1),de.readOnly.of(!0),oe.theme({"&":{minHeight:"calc(100vh - 80px)",height:"100%",width:"100%"}})]});s.value=new oe({state:h,parent:e.value}),qC(s.value,o.highlightedLine)}),La(Ba,()=>{s.value.dispatch({changes:{from:0,to:s.value.state.doc.length,insert:Ba.value}}),a()});const a=()=>{qC(s.value,o.highlightedLine)};return La(()=>o.highlightedLine,a),(h,d)=>(jt(),te("div",{id:"assemblerEditor",ref_key:"codemirrorTextarea",ref:e},null,512))}},eO=Sh(b1,[["__scopeId","data-v-4df2b784"]]),E1={class:"container-fluid"},v1={class:"row"},I1={class:"col-8 p-0"},S1={class:"col-4 p-0"},ZC={__name:"BlocksamblerCodingView",setup(r){let e=Ls({toolbox:lM,collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!1,toolboxPosition:"start",css:!0,rtl:!1,scrollbars:!1,sounds:!0,oneBasedIndex:!0});return(s,o)=>(jt(),te("div",E1,[ht("div",v1,[ht("div",I1,[ye(RM,{options:Go(e)},null,8,["options"])]),ht("div",S1,[ye(eO,{highlightedLine:0})])])]))}},y1=["id"],C1={class:"modal-dialog"},w1={class:"modal-content"},k1=ht("div",{class:"modal-header"},[ht("h4",null,"Console Output"),ht("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O1={class:"modal-body"},A1={class:"form-control",id:"output",rows:"10",wrap:"off",readonly:""},R1=ht("div",{class:"modal-footer"},[ht("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1),N1={__name:"DebuggerConsoleModal",props:{id:String},setup(r){let e=r;const s=Ls(wi.output);return(o,l)=>(jt(),te("div",{id:Go(e).id,class:"modal",tabindex:"-1"},[ht("div",C1,[ht("div",w1,[k1,ht("div",O1,[ht("textarea",A1,cs(s.value.join(`
`)),1)]),R1])])],8,y1))}},L1={class:"btn btn-secondary position-relative me-2"},M1={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},yd={__name:"BaseButton",props:{iconName:String,notificationCount:Number},setup(r){let e=r;return(s,o)=>(jt(),te("button",L1,[ye(Nk,{name:Go(e).iconName},null,8,["name"]),_N(s.$slots,"default"),r.notificationCount>0?(jt(),te("span",M1,cs(Go(e).notificationCount),1)):Pa("",!0)]))}},D1={class:"py-3 m-0 navbar sticky-top background-white",style:{"background-color":"white"}},x1={__name:"DebuggerControlPanel",props:{consoleModalId:String},setup(r){const e=fo(wi.output),s=r,o=Ih(()=>`#${s.consoleModalId}`),l=()=>{console.log("start parsing...");let d=xk.parseCode(Ba.value);console.log("load program to memory..."),wi.loadProgramm(d),console.log("assemble & load finished")},a=()=>{wi.executeNextInstruction()},h=()=>{for(console.log("reset registers"),wi.resetRegisters(),console.log("reset memory"),wi.resetMemory(),console.log("reset output");wi.output.length>0;)wi.output.pop()};return(d,p)=>(jt(),te("div",D1,[ht("div",null,[ye(yd,{onClick:l,"icon-name":"play-circle"},{default:Ca(()=>[jl(" Assemble & Load to Memory ")]),_:1}),ye(yd,{onClick:a,"icon-name":"arrow-right-square"},{default:Ca(()=>[jl(" Execute & Fetch Next ")]),_:1}),ye(yd,{onClick:h,"icon-name":"reply"},{default:Ca(()=>[jl(" Reset ")]),_:1}),ye(yd,{"icon-name":"terminal","notification-count":e.length,"data-bs-toggle":"modal","data-bs-target":o.value},{default:Ca(()=>[jl(" Output Console ")]),_:1},8,["notification-count","data-bs-target"])])]))}},P1={class:"card"},B1=ht("div",{class:"card-header"},[ht("h4",null,"Machine Instructions")],-1),F1={class:"card-body"},H1={key:0,class:"table"},U1=ht("thead",null,[ht("tr",null,[ht("th",{scope:"col",style:{width:"10%"}},"PC"),ht("th",{scope:"col",style:{width:"15%"}},"Address"),ht("th",{scope:"col",style:{width:"30%"}},"Machine Code"),ht("th",{scope:"col",style:{width:"45%"}},"Source")])],-1),V1={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-right-square",viewBox:"0 0 16 16"},G1=ht("path",{"fill-rule":"evenodd",d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"},null,-1),W1=[G1],X1={key:1},z1={__name:"DebuggerOpCodeList",setup(r){const e=Ih(()=>wi.memory.slice(0,wi.loadedProgramSize).map((o,l)=>{let a=xk.instructionFactory.createFromOpCode(o.toBitString());return{address:l,inst:a}}));return(s,o)=>(jt(),te("div",P1,[B1,ht("div",F1,[e.value.length!=0?(jt(),te("table",H1,[U1,ht("tbody",null,[(jt(!0),te(ni,null,wp(e.value,l=>(jt(),te("tr",null,[ht("td",null,[l.address==Go(wi).registers.pc.toUnsignedIntValue()?(jt(),te("svg",V1,W1)):Pa("",!0)]),ht("td",null,"0x"+cs(Go(On)(l.address.toString(16),4)),1),ht("td",null,[ht("pre",null,cs(l.inst.toMachineCode()),1)]),ht("td",null,cs(l.inst.toString()),1)]))),256))])])):Pa("",!0),e.value.length==0?(jt(),te("span",X1," No machine instructions loaded yet! ")):Pa("",!0)])]))}},Y1={class:"card"},K1=ht("div",{class:"card-header"},[ht("h4",null,"Registers")],-1),j1={class:"card-body"},J1={class:"table"},q1=ht("thead",null,[ht("tr",null,[ht("th",{scope:"col",style:{width:"15%"}},"Name"),ht("th",{scope:"col",style:{width:"85%"}},"Value")])],-1),Z1={__name:"DebuggerRegisterSpy",setup(r){const e=fo(wi.registers);return(s,o)=>(jt(),te("div",Y1,[K1,ht("div",j1,[ht("table",J1,[q1,ht("tbody",null,[(jt(!0),te(ni,null,wp(e,(l,a)=>(jt(),te("tr",null,[ht("td",null,cs(a),1),ht("td",null,[ht("pre",null,cs(l.toBitString())+" ("+cs(l)+")",1)])]))),256))])])])]))}},Q1={class:"card"},tP=ht("div",{class:"card-header"},[ht("h4",null,"Memory")],-1),eP={class:"card-body overflow-auto"},iP={class:"table"},sP=ht("thead",null,[ht("tr",null,[ht("th",{scope:"col",style:{width:"50%"}},"Address"),ht("th",{scope:"col",style:{width:"50%"}},"Value")])],-1),oP={__name:"DebuggerMemorySpy",setup(r){const e=Ls(9),s=Ls(0),o=Ih(()=>wi.getMemoryFragment(s.value*e.value,s.value*e.value+e.value));return(l,a)=>(jt(),te("div",Q1,[tP,ht("div",eP,[ht("table",iP,[sP,ht("tbody",null,[(jt(!0),te(ni,null,wp(o.value,h=>(jt(),te("tr",{key:h.address},[ht("td",null,"0x"+cs(Go(On)(h.address.toString(16),4)),1),ht("td",null,[ht("pre",null,cs(h.word.toBitString())+" ("+cs(h.word)+")",1)])]))),128))])])])]))}},nP={class:"row my-3"},rP={class:"col-5"},lP={class:"col-7"},cP={__name:"DebuggerPanel",setup(r){const e=Ls("consoleOutput");return fo(wi.registers),(s,o)=>(jt(),te(ni,null,[ye(N1,{id:e.value},null,8,["id"]),ye(x1,{consoleModalId:e.value},null,8,["consoleModalId"]),ye(z1),ht("div",nP,[ht("div",rP,[ye(Z1)]),ht("div",lP,[ye(oP)])])],64))}},aP={class:"container-fluid"},hP={class:"row"},uP={class:"col-8 px-3"},dP={class:"col-4 p-0"},pP={__name:"BlocksamblerDebugView",setup(r){return(e,s)=>(jt(),te("div",aP,[ht("div",hP,[ht("div",uP,[ye(cP)]),ht("div",dP,[ye(eO,{highlightedLine:0})])])]))}};const gP={},fP=r=>(ak("data-v-e6033ac7"),r=r(),hk(),r),mP={class:"container my-5"},$P=fP(()=>ht("div",{class:"card"},[ht("div",{class:"card-header"},"404 Page Not Found"),ht("div",{class:"card-body"},[ht("p",null," Oops! It looks like you've ventured into uncharted territory. The page you were looking for seems to have gone on an adventure of its own and couldn't be found. Don't worry; it happens to the best of us. ")])],-1)),_P=[$P];function TP(r,e){return jt(),te("div",mP,_P)}const bP=Sh(gP,[["render",TP],["__scopeId","data-v-e6033ac7"]]),EP={},vP={class:"container"},IP=UN('<div class="card my-5"><div class="card-header"><h4>Settings</h4></div><div class="card-body"><form><div class="row mb-3"><label for="inputEmail3" class="col-sm-2 col-form-label">Email</label><div class="col-sm-10"><input type="email" class="form-control" id="inputEmail3"></div></div><div class="row mb-3"><label for="inputPassword3" class="col-sm-2 col-form-label">Password</label><div class="col-sm-10"><input type="password" class="form-control" id="inputPassword3"></div></div><fieldset class="row mb-3"><legend class="col-form-label col-sm-2 pt-0">Radios</legend><div class="col-sm-10"><div class="form-check"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1" value="option1" checked><label class="form-check-label" for="gridRadios1"> First radio </label></div><div class="form-check"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="option2"><label class="form-check-label" for="gridRadios2"> Second radio </label></div><div class="form-check disabled"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios3" value="option3" disabled><label class="form-check-label" for="gridRadios3"> Third disabled radio </label></div></div></fieldset><div class="row mb-3"><div class="col-sm-10 offset-sm-2"><div class="form-check"><input class="form-check-input" type="checkbox" id="gridCheck1"><label class="form-check-label" for="gridCheck1"> Example checkbox </label></div></div></div><button type="submit" class="btn btn-primary">Sign in</button></form></div></div>',1),SP=[IP];function yP(r,e){return jt(),te("div",vP,SP)}const CP=Sh(EP,[["render",yP]]),wP={__name:"App",setup(r){const e={"/":ZC,"/editor":ZC,"/debugger":pP,"/settings":CP},s=Ls(window.location.hash);window.addEventListener("hashchange",()=>{s.value=window.location.hash});const o=Ih(()=>e[s.value.slice(1)||"/"]||bP);return(l,a)=>(jt(),te(ni,null,[ye(rM),(jt(),tb(mN(o.value)))],64))}};var Ai="top",Qi="bottom",ts="right",Ri="left",Dp="auto",Sc=[Ai,Qi,ts,Ri],Hr="start",pc="end",iO="clippingParents",bb="viewport",Xl="popper",sO="reference",AT=Sc.reduce(function(r,e){return r.concat([e+"-"+Hr,e+"-"+pc])},[]),Eb=[].concat(Sc,[Dp]).reduce(function(r,e){return r.concat([e,e+"-"+Hr,e+"-"+pc])},[]),oO="beforeRead",nO="read",rO="afterRead",lO="beforeMain",cO="main",aO="afterMain",hO="beforeWrite",uO="write",dO="afterWrite",pO=[oO,nO,rO,lO,cO,aO,hO,uO,dO];function $o(r){return r?(r.nodeName||"").toLowerCase():null}function es(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var e=r.ownerDocument;return e&&e.defaultView||window}return r}function Ur(r){var e=es(r).Element;return r instanceof e||r instanceof Element}function ds(r){var e=es(r).HTMLElement;return r instanceof e||r instanceof HTMLElement}function vb(r){if(typeof ShadowRoot>"u")return!1;var e=es(r).ShadowRoot;return r instanceof e||r instanceof ShadowRoot}function kP(r){var e=r.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},l=e.attributes[s]||{},a=e.elements[s];!ds(a)||!$o(a)||(Object.assign(a.style,o),Object.keys(l).forEach(function(h){var d=l[h];d===!1?a.removeAttribute(h):a.setAttribute(h,d===!0?"":d)}))})}function OP(r){var e=r.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var l=e.elements[o],a=e.attributes[o]||{},h=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=h.reduce(function(p,f){return p[f]="",p},{});!ds(l)||!$o(l)||(Object.assign(l.style,d),Object.keys(a).forEach(function(p){l.removeAttribute(p)}))})}}const Ib={name:"applyStyles",enabled:!0,phase:"write",fn:kP,effect:OP,requires:["computeStyles"]};function uo(r){return r.split("-")[0]}var xr=Math.max,pp=Math.min,gc=Math.round;function RT(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function gO(){return!/^((?!chrome|android).)*safari/i.test(RT())}function fc(r,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=r.getBoundingClientRect(),l=1,a=1;e&&ds(r)&&(l=r.offsetWidth>0&&gc(o.width)/r.offsetWidth||1,a=r.offsetHeight>0&&gc(o.height)/r.offsetHeight||1);var h=Ur(r)?es(r):window,d=h.visualViewport,p=!gO()&&s,f=(o.left+(p&&d?d.offsetLeft:0))/l,m=(o.top+(p&&d?d.offsetTop:0))/a,T=o.width/l,b=o.height/a;return{width:T,height:b,top:m,right:f+T,bottom:m+b,left:f,x:f,y:m}}function Sb(r){var e=fc(r),s=r.offsetWidth,o=r.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:r.offsetLeft,y:r.offsetTop,width:s,height:o}}function fO(r,e){var s=e.getRootNode&&e.getRootNode();if(r.contains(e))return!0;if(s&&vb(s)){var o=e;do{if(o&&r.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ko(r){return es(r).getComputedStyle(r)}function AP(r){return["table","td","th"].indexOf($o(r))>=0}function Fn(r){return((Ur(r)?r.ownerDocument:r.document)||window.document).documentElement}function xp(r){return $o(r)==="html"?r:r.assignedSlot||r.parentNode||(vb(r)?r.host:null)||Fn(r)}function QC(r){return!ds(r)||Ko(r).position==="fixed"?null:r.offsetParent}function RP(r){var e=/firefox/i.test(RT()),s=/Trident/i.test(RT());if(s&&ds(r)){var o=Ko(r);if(o.position==="fixed")return null}var l=xp(r);for(vb(l)&&(l=l.host);ds(l)&&["html","body"].indexOf($o(l))<0;){var a=Ko(l);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return l;l=l.parentNode}return null}function wh(r){for(var e=es(r),s=QC(r);s&&AP(s)&&Ko(s).position==="static";)s=QC(s);return s&&($o(s)==="html"||$o(s)==="body"&&Ko(s).position==="static")?e:s||RP(r)||e}function yb(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Va(r,e,s){return xr(r,pp(e,s))}function NP(r,e,s){var o=Va(r,e,s);return o>s?s:o}function mO(){return{top:0,right:0,bottom:0,left:0}}function $O(r){return Object.assign({},mO(),r)}function _O(r,e){return e.reduce(function(s,o){return s[o]=r,s},{})}var LP=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,$O(typeof e!="number"?e:_O(e,Sc))};function MP(r){var e,s=r.state,o=r.name,l=r.options,a=s.elements.arrow,h=s.modifiersData.popperOffsets,d=uo(s.placement),p=yb(d),f=[Ri,ts].indexOf(d)>=0,m=f?"height":"width";if(!(!a||!h)){var T=LP(l.padding,s),b=Sb(a),I=p==="y"?Ai:Ri,w=p==="y"?Qi:ts,M=s.rects.reference[m]+s.rects.reference[p]-h[p]-s.rects.popper[m],N=h[p]-s.rects.reference[p],U=wh(a),W=U?p==="y"?U.clientHeight||0:U.clientWidth||0:0,tt=M/2-N/2,F=T[I],st=W-b[m]-T[w],it=W/2-b[m]/2+tt,Tt=Va(F,it,st),Lt=p;s.modifiersData[o]=(e={},e[Lt]=Tt,e.centerOffset=Tt-it,e)}}function DP(r){var e=r.state,s=r.options,o=s.element,l=o===void 0?"[data-popper-arrow]":o;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||fO(e.elements.popper,l)&&(e.elements.arrow=l))}const TO={name:"arrow",enabled:!0,phase:"main",fn:MP,effect:DP,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function mc(r){return r.split("-")[1]}var xP={top:"auto",right:"auto",bottom:"auto",left:"auto"};function PP(r,e){var s=r.x,o=r.y,l=e.devicePixelRatio||1;return{x:gc(s*l)/l||0,y:gc(o*l)/l||0}}function tw(r){var e,s=r.popper,o=r.popperRect,l=r.placement,a=r.variation,h=r.offsets,d=r.position,p=r.gpuAcceleration,f=r.adaptive,m=r.roundOffsets,T=r.isFixed,b=h.x,I=b===void 0?0:b,w=h.y,M=w===void 0?0:w,N=typeof m=="function"?m({x:I,y:M}):{x:I,y:M};I=N.x,M=N.y;var U=h.hasOwnProperty("x"),W=h.hasOwnProperty("y"),tt=Ri,F=Ai,st=window;if(f){var it=wh(s),Tt="clientHeight",Lt="clientWidth";if(it===es(s)&&(it=Fn(s),Ko(it).position!=="static"&&d==="absolute"&&(Tt="scrollHeight",Lt="scrollWidth")),it=it,l===Ai||(l===Ri||l===ts)&&a===pc){F=Qi;var It=T&&it===st&&st.visualViewport?st.visualViewport.height:it[Tt];M-=It-o.height,M*=p?1:-1}if(l===Ri||(l===Ai||l===Qi)&&a===pc){tt=ts;var mt=T&&it===st&&st.visualViewport?st.visualViewport.width:it[Lt];I-=mt-o.width,I*=p?1:-1}}var Ct=Object.assign({position:d},f&&xP),Ft=m===!0?PP({x:I,y:M},es(s)):{x:I,y:M};if(I=Ft.x,M=Ft.y,p){var Nt;return Object.assign({},Ct,(Nt={},Nt[F]=W?"0":"",Nt[tt]=U?"0":"",Nt.transform=(st.devicePixelRatio||1)<=1?"translate("+I+"px, "+M+"px)":"translate3d("+I+"px, "+M+"px, 0)",Nt))}return Object.assign({},Ct,(e={},e[F]=W?M+"px":"",e[tt]=U?I+"px":"",e.transform="",e))}function BP(r){var e=r.state,s=r.options,o=s.gpuAcceleration,l=o===void 0?!0:o,a=s.adaptive,h=a===void 0?!0:a,d=s.roundOffsets,p=d===void 0?!0:d,f={placement:uo(e.placement),variation:mc(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,tw(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,tw(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Cb={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:BP,data:{}};var Cd={passive:!0};function FP(r){var e=r.state,s=r.instance,o=r.options,l=o.scroll,a=l===void 0?!0:l,h=o.resize,d=h===void 0?!0:h,p=es(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(m){m.addEventListener("scroll",s.update,Cd)}),d&&p.addEventListener("resize",s.update,Cd),function(){a&&f.forEach(function(m){m.removeEventListener("scroll",s.update,Cd)}),d&&p.removeEventListener("resize",s.update,Cd)}}const wb={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:FP,data:{}};var HP={left:"right",right:"left",bottom:"top",top:"bottom"};function Yd(r){return r.replace(/left|right|bottom|top/g,function(e){return HP[e]})}var UP={start:"end",end:"start"};function ew(r){return r.replace(/start|end/g,function(e){return UP[e]})}function kb(r){var e=es(r),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Ob(r){return fc(Fn(r)).left+kb(r).scrollLeft}function VP(r,e){var s=es(r),o=Fn(r),l=s.visualViewport,a=o.clientWidth,h=o.clientHeight,d=0,p=0;if(l){a=l.width,h=l.height;var f=gO();(f||!f&&e==="fixed")&&(d=l.offsetLeft,p=l.offsetTop)}return{width:a,height:h,x:d+Ob(r),y:p}}function GP(r){var e,s=Fn(r),o=kb(r),l=(e=r.ownerDocument)==null?void 0:e.body,a=xr(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),h=xr(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),d=-o.scrollLeft+Ob(r),p=-o.scrollTop;return Ko(l||s).direction==="rtl"&&(d+=xr(s.clientWidth,l?l.clientWidth:0)-a),{width:a,height:h,x:d,y:p}}function Ab(r){var e=Ko(r),s=e.overflow,o=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+l+o)}function bO(r){return["html","body","#document"].indexOf($o(r))>=0?r.ownerDocument.body:ds(r)&&Ab(r)?r:bO(xp(r))}function Ga(r,e){var s;e===void 0&&(e=[]);var o=bO(r),l=o===((s=r.ownerDocument)==null?void 0:s.body),a=es(o),h=l?[a].concat(a.visualViewport||[],Ab(o)?o:[]):o,d=e.concat(h);return l?d:d.concat(Ga(xp(h)))}function NT(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function WP(r,e){var s=fc(r,!1,e==="fixed");return s.top=s.top+r.clientTop,s.left=s.left+r.clientLeft,s.bottom=s.top+r.clientHeight,s.right=s.left+r.clientWidth,s.width=r.clientWidth,s.height=r.clientHeight,s.x=s.left,s.y=s.top,s}function iw(r,e,s){return e===bb?NT(VP(r,s)):Ur(e)?WP(e,s):NT(GP(Fn(r)))}function XP(r){var e=Ga(xp(r)),s=["absolute","fixed"].indexOf(Ko(r).position)>=0,o=s&&ds(r)?wh(r):r;return Ur(o)?e.filter(function(l){return Ur(l)&&fO(l,o)&&$o(l)!=="body"}):[]}function zP(r,e,s,o){var l=e==="clippingParents"?XP(r):[].concat(e),a=[].concat(l,[s]),h=a[0],d=a.reduce(function(p,f){var m=iw(r,f,o);return p.top=xr(m.top,p.top),p.right=pp(m.right,p.right),p.bottom=pp(m.bottom,p.bottom),p.left=xr(m.left,p.left),p},iw(r,h,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function EO(r){var e=r.reference,s=r.element,o=r.placement,l=o?uo(o):null,a=o?mc(o):null,h=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,p;switch(l){case Ai:p={x:h,y:e.y-s.height};break;case Qi:p={x:h,y:e.y+e.height};break;case ts:p={x:e.x+e.width,y:d};break;case Ri:p={x:e.x-s.width,y:d};break;default:p={x:e.x,y:e.y}}var f=l?yb(l):null;if(f!=null){var m=f==="y"?"height":"width";switch(a){case Hr:p[f]=p[f]-(e[m]/2-s[m]/2);break;case pc:p[f]=p[f]+(e[m]/2-s[m]/2);break}}return p}function $c(r,e){e===void 0&&(e={});var s=e,o=s.placement,l=o===void 0?r.placement:o,a=s.strategy,h=a===void 0?r.strategy:a,d=s.boundary,p=d===void 0?iO:d,f=s.rootBoundary,m=f===void 0?bb:f,T=s.elementContext,b=T===void 0?Xl:T,I=s.altBoundary,w=I===void 0?!1:I,M=s.padding,N=M===void 0?0:M,U=$O(typeof N!="number"?N:_O(N,Sc)),W=b===Xl?sO:Xl,tt=r.rects.popper,F=r.elements[w?W:b],st=zP(Ur(F)?F:F.contextElement||Fn(r.elements.popper),p,m,h),it=fc(r.elements.reference),Tt=EO({reference:it,element:tt,strategy:"absolute",placement:l}),Lt=NT(Object.assign({},tt,Tt)),It=b===Xl?Lt:it,mt={top:st.top-It.top+U.top,bottom:It.bottom-st.bottom+U.bottom,left:st.left-It.left+U.left,right:It.right-st.right+U.right},Ct=r.modifiersData.offset;if(b===Xl&&Ct){var Ft=Ct[l];Object.keys(mt).forEach(function(Nt){var qt=[ts,Qi].indexOf(Nt)>=0?1:-1,at=[Ai,Qi].indexOf(Nt)>=0?"y":"x";mt[Nt]+=Ft[at]*qt})}return mt}function YP(r,e){e===void 0&&(e={});var s=e,o=s.placement,l=s.boundary,a=s.rootBoundary,h=s.padding,d=s.flipVariations,p=s.allowedAutoPlacements,f=p===void 0?Eb:p,m=mc(o),T=m?d?AT:AT.filter(function(w){return mc(w)===m}):Sc,b=T.filter(function(w){return f.indexOf(w)>=0});b.length===0&&(b=T);var I=b.reduce(function(w,M){return w[M]=$c(r,{placement:M,boundary:l,rootBoundary:a,padding:h})[uo(M)],w},{});return Object.keys(I).sort(function(w,M){return I[w]-I[M]})}function KP(r){if(uo(r)===Dp)return[];var e=Yd(r);return[ew(r),e,ew(e)]}function jP(r){var e=r.state,s=r.options,o=r.name;if(!e.modifiersData[o]._skip){for(var l=s.mainAxis,a=l===void 0?!0:l,h=s.altAxis,d=h===void 0?!0:h,p=s.fallbackPlacements,f=s.padding,m=s.boundary,T=s.rootBoundary,b=s.altBoundary,I=s.flipVariations,w=I===void 0?!0:I,M=s.allowedAutoPlacements,N=e.options.placement,U=uo(N),W=U===N,tt=p||(W||!w?[Yd(N)]:KP(N)),F=[N].concat(tt).reduce(function(pt,qe){return pt.concat(uo(qe)===Dp?YP(e,{placement:qe,boundary:m,rootBoundary:T,padding:f,flipVariations:w,allowedAutoPlacements:M}):qe)},[]),st=e.rects.reference,it=e.rects.popper,Tt=new Map,Lt=!0,It=F[0],mt=0;mt<F.length;mt++){var Ct=F[mt],Ft=uo(Ct),Nt=mc(Ct)===Hr,qt=[Ai,Qi].indexOf(Ft)>=0,at=qt?"width":"height",Bt=$c(e,{placement:Ct,boundary:m,rootBoundary:T,altBoundary:b,padding:f}),xt=qt?Nt?ts:Ri:Nt?Qi:Ai;st[at]>it[at]&&(xt=Yd(xt));var At=Yd(xt),Zt=[];if(a&&Zt.push(Bt[Ft]<=0),d&&Zt.push(Bt[xt]<=0,Bt[At]<=0),Zt.every(function(pt){return pt})){It=Ct,Lt=!1;break}Tt.set(Ct,Zt)}if(Lt)for(var Dt=w?3:1,Ce=function(qe){var xe=F.find(function(Ne){var Te=Tt.get(Ne);if(Te)return Te.slice(0,qe).every(function(Xe){return Xe})});if(xe)return It=xe,"break"},ne=Dt;ne>0;ne--){var We=Ce(ne);if(We==="break")break}e.placement!==It&&(e.modifiersData[o]._skip=!0,e.placement=It,e.reset=!0)}}const vO={name:"flip",enabled:!0,phase:"main",fn:jP,requiresIfExists:["offset"],data:{_skip:!1}};function sw(r,e,s){return s===void 0&&(s={x:0,y:0}),{top:r.top-e.height-s.y,right:r.right-e.width+s.x,bottom:r.bottom-e.height+s.y,left:r.left-e.width-s.x}}function ow(r){return[Ai,ts,Qi,Ri].some(function(e){return r[e]>=0})}function JP(r){var e=r.state,s=r.name,o=e.rects.reference,l=e.rects.popper,a=e.modifiersData.preventOverflow,h=$c(e,{elementContext:"reference"}),d=$c(e,{altBoundary:!0}),p=sw(h,o),f=sw(d,l,a),m=ow(p),T=ow(f);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:m,hasPopperEscaped:T},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":T})}const IO={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:JP};function qP(r,e,s){var o=uo(r),l=[Ri,Ai].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:r})):s,h=a[0],d=a[1];return h=h||0,d=(d||0)*l,[Ri,ts].indexOf(o)>=0?{x:d,y:h}:{x:h,y:d}}function ZP(r){var e=r.state,s=r.options,o=r.name,l=s.offset,a=l===void 0?[0,0]:l,h=Eb.reduce(function(m,T){return m[T]=qP(T,e.rects,a),m},{}),d=h[e.placement],p=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=h}const SO={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ZP};function QP(r){var e=r.state,s=r.name;e.modifiersData[s]=EO({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Rb={name:"popperOffsets",enabled:!0,phase:"read",fn:QP,data:{}};function tB(r){return r==="x"?"y":"x"}function eB(r){var e=r.state,s=r.options,o=r.name,l=s.mainAxis,a=l===void 0?!0:l,h=s.altAxis,d=h===void 0?!1:h,p=s.boundary,f=s.rootBoundary,m=s.altBoundary,T=s.padding,b=s.tether,I=b===void 0?!0:b,w=s.tetherOffset,M=w===void 0?0:w,N=$c(e,{boundary:p,rootBoundary:f,padding:T,altBoundary:m}),U=uo(e.placement),W=mc(e.placement),tt=!W,F=yb(U),st=tB(F),it=e.modifiersData.popperOffsets,Tt=e.rects.reference,Lt=e.rects.popper,It=typeof M=="function"?M(Object.assign({},e.rects,{placement:e.placement})):M,mt=typeof It=="number"?{mainAxis:It,altAxis:It}:Object.assign({mainAxis:0,altAxis:0},It),Ct=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ft={x:0,y:0};if(it){if(a){var Nt,qt=F==="y"?Ai:Ri,at=F==="y"?Qi:ts,Bt=F==="y"?"height":"width",xt=it[F],At=xt+N[qt],Zt=xt-N[at],Dt=I?-Lt[Bt]/2:0,Ce=W===Hr?Tt[Bt]:Lt[Bt],ne=W===Hr?-Lt[Bt]:-Tt[Bt],We=e.elements.arrow,pt=I&&We?Sb(We):{width:0,height:0},qe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:mO(),xe=qe[qt],Ne=qe[at],Te=Va(0,Tt[Bt],pt[Bt]),Xe=tt?Tt[Bt]/2-Dt-Te-xe-mt.mainAxis:Ce-Te-xe-mt.mainAxis,ai=tt?-Tt[Bt]/2+Dt+Te+Ne+mt.mainAxis:ne+Te+Ne+mt.mainAxis,hi=e.elements.arrow&&wh(e.elements.arrow),y=hi?F==="y"?hi.clientTop||0:hi.clientLeft||0:0,D=(Nt=Ct==null?void 0:Ct[F])!=null?Nt:0,H=xt+Xe-D-y,j=xt+ai-D,z=Va(I?pp(At,H):At,xt,I?xr(Zt,j):Zt);it[F]=z,Ft[F]=z-xt}if(d){var nt,rt=F==="x"?Ai:Ri,Z=F==="x"?Qi:ts,et=it[st],q=st==="y"?"height":"width",ut=et+N[rt],A=et-N[Z],X=[Ai,Ri].indexOf(U)!==-1,kt=(nt=Ct==null?void 0:Ct[st])!=null?nt:0,ft=X?ut:et-Tt[q]-Lt[q]-kt+mt.altAxis,Yt=X?et+Tt[q]+Lt[q]-kt-mt.altAxis:A,bt=I&&X?NP(ft,et,Yt):Va(I?ft:ut,et,I?Yt:A);it[st]=bt,Ft[st]=bt-et}e.modifiersData[o]=Ft}}const yO={name:"preventOverflow",enabled:!0,phase:"main",fn:eB,requiresIfExists:["offset"]};function iB(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function sB(r){return r===es(r)||!ds(r)?kb(r):iB(r)}function oB(r){var e=r.getBoundingClientRect(),s=gc(e.width)/r.offsetWidth||1,o=gc(e.height)/r.offsetHeight||1;return s!==1||o!==1}function nB(r,e,s){s===void 0&&(s=!1);var o=ds(e),l=ds(e)&&oB(e),a=Fn(e),h=fc(r,l,s),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&(($o(e)!=="body"||Ab(a))&&(d=sB(e)),ds(e)?(p=fc(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Ob(a))),{x:h.left+d.scrollLeft-p.x,y:h.top+d.scrollTop-p.y,width:h.width,height:h.height}}function rB(r){var e=new Map,s=new Set,o=[];r.forEach(function(a){e.set(a.name,a)});function l(a){s.add(a.name);var h=[].concat(a.requires||[],a.requiresIfExists||[]);h.forEach(function(d){if(!s.has(d)){var p=e.get(d);p&&l(p)}}),o.push(a)}return r.forEach(function(a){s.has(a.name)||l(a)}),o}function lB(r){var e=rB(r);return pO.reduce(function(s,o){return s.concat(e.filter(function(l){return l.phase===o}))},[])}function cB(r){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(r())})})),e}}function aB(r){var e=r.reduce(function(s,o){var l=s[o.name];return s[o.name]=l?Object.assign({},l,o,{options:Object.assign({},l.options,o.options),data:Object.assign({},l.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var nw={placement:"bottom",modifiers:[],strategy:"absolute"};function rw(){for(var r=arguments.length,e=new Array(r),s=0;s<r;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Pp(r){r===void 0&&(r={});var e=r,s=e.defaultModifiers,o=s===void 0?[]:s,l=e.defaultOptions,a=l===void 0?nw:l;return function(d,p,f){f===void 0&&(f=a);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},nw,a),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},T=[],b=!1,I={state:m,setOptions:function(U){var W=typeof U=="function"?U(m.options):U;M(),m.options=Object.assign({},a,m.options,W),m.scrollParents={reference:Ur(d)?Ga(d):d.contextElement?Ga(d.contextElement):[],popper:Ga(p)};var tt=lB(aB([].concat(o,m.options.modifiers)));return m.orderedModifiers=tt.filter(function(F){return F.enabled}),w(),I.update()},forceUpdate:function(){if(!b){var U=m.elements,W=U.reference,tt=U.popper;if(rw(W,tt)){m.rects={reference:nB(W,wh(tt),m.options.strategy==="fixed"),popper:Sb(tt)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(mt){return m.modifiersData[mt.name]=Object.assign({},mt.data)});for(var F=0;F<m.orderedModifiers.length;F++){if(m.reset===!0){m.reset=!1,F=-1;continue}var st=m.orderedModifiers[F],it=st.fn,Tt=st.options,Lt=Tt===void 0?{}:Tt,It=st.name;typeof it=="function"&&(m=it({state:m,options:Lt,name:It,instance:I})||m)}}}},update:cB(function(){return new Promise(function(N){I.forceUpdate(),N(m)})}),destroy:function(){M(),b=!0}};if(!rw(d,p))return I;I.setOptions(f).then(function(N){!b&&f.onFirstUpdate&&f.onFirstUpdate(N)});function w(){m.orderedModifiers.forEach(function(N){var U=N.name,W=N.options,tt=W===void 0?{}:W,F=N.effect;if(typeof F=="function"){var st=F({state:m,name:U,instance:I,options:tt}),it=function(){};T.push(st||it)}})}function M(){T.forEach(function(N){return N()}),T=[]}return I}}var hB=Pp(),uB=[wb,Rb,Cb,Ib],dB=Pp({defaultModifiers:uB}),pB=[wb,Rb,Cb,Ib,SO,vO,yO,TO,IO],Nb=Pp({defaultModifiers:pB});const CO=Object.freeze(Object.defineProperty({__proto__:null,afterMain:aO,afterRead:rO,afterWrite:dO,applyStyles:Ib,arrow:TO,auto:Dp,basePlacements:Sc,beforeMain:lO,beforeRead:oO,beforeWrite:hO,bottom:Qi,clippingParents:iO,computeStyles:Cb,createPopper:Nb,createPopperBase:hB,createPopperLite:dB,detectOverflow:$c,end:pc,eventListeners:wb,flip:vO,hide:IO,left:Ri,main:cO,modifierPhases:pO,offset:SO,placements:Eb,popper:Xl,popperGenerator:Pp,popperOffsets:Rb,preventOverflow:yO,read:nO,reference:sO,right:ts,start:Hr,top:Ai,variationPlacements:AT,viewport:bb,write:uO},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const bn=new Map,s_={set(r,e,s){bn.has(r)||bn.set(r,new Map);const o=bn.get(r);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(r,e){return bn.has(r)&&bn.get(r).get(e)||null},remove(r,e){if(!bn.has(r))return;const s=bn.get(r);s.delete(e),s.size===0&&bn.delete(r)}},gB=1e6,fB=1e3,LT="transitionend",wO=r=>(r&&window.CSS&&window.CSS.escape&&(r=r.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),r),mB=r=>r==null?`${r}`:Object.prototype.toString.call(r).match(/\s([a-z]+)/i)[1].toLowerCase(),$B=r=>{do r+=Math.floor(Math.random()*gB);while(document.getElementById(r));return r},_B=r=>{if(!r)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(r);const o=Number.parseFloat(e),l=Number.parseFloat(s);return!o&&!l?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*fB)},kO=r=>{r.dispatchEvent(new Event(LT))},Uo=r=>!r||typeof r!="object"?!1:(typeof r.jquery<"u"&&(r=r[0]),typeof r.nodeType<"u"),Dn=r=>Uo(r)?r.jquery?r[0]:r:typeof r=="string"&&r.length>0?document.querySelector(wO(r)):null,yc=r=>{if(!Uo(r)||r.getClientRects().length===0)return!1;const e=getComputedStyle(r).getPropertyValue("visibility")==="visible",s=r.closest("details:not([open])");if(!s)return e;if(s!==r){const o=r.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},xn=r=>!r||r.nodeType!==Node.ELEMENT_NODE||r.classList.contains("disabled")?!0:typeof r.disabled<"u"?r.disabled:r.hasAttribute("disabled")&&r.getAttribute("disabled")!=="false",OO=r=>{if(!document.documentElement.attachShadow)return null;if(typeof r.getRootNode=="function"){const e=r.getRootNode();return e instanceof ShadowRoot?e:null}return r instanceof ShadowRoot?r:r.parentNode?OO(r.parentNode):null},gp=()=>{},kh=r=>{r.offsetHeight},AO=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,o_=[],TB=r=>{document.readyState==="loading"?(o_.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of o_)e()}),o_.push(r)):r()},gs=()=>document.documentElement.dir==="rtl",ms=r=>{TB(()=>{const e=AO();if(e){const s=r.NAME,o=e.fn[s];e.fn[s]=r.jQueryInterface,e.fn[s].Constructor=r,e.fn[s].noConflict=()=>(e.fn[s]=o,r.jQueryInterface)}})},Fi=(r,e=[],s=r)=>typeof r=="function"?r(...e):s,RO=(r,e,s=!0)=>{if(!s){Fi(r);return}const o=5,l=_B(e)+o;let a=!1;const h=({target:d})=>{d===e&&(a=!0,e.removeEventListener(LT,h),Fi(r))};e.addEventListener(LT,h),setTimeout(()=>{a||kO(e)},l)},Lb=(r,e,s,o)=>{const l=r.length;let a=r.indexOf(e);return a===-1?!s&&o?r[l-1]:r[0]:(a+=s?1:-1,o&&(a=(a+l)%l),r[Math.max(0,Math.min(a,l-1))])},bB=/[^.]*(?=\..*)\.|.*/,EB=/\..*/,vB=/::\d+$/,n_={};let lw=1;const NO={mouseenter:"mouseover",mouseleave:"mouseout"},IB=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function LO(r,e){return e&&`${e}::${lw++}`||r.uidEvent||lw++}function MO(r){const e=LO(r);return r.uidEvent=e,n_[e]=n_[e]||{},n_[e]}function SB(r,e){return function s(o){return Mb(o,{delegateTarget:r}),s.oneOff&&ot.off(r,o.type,e),e.apply(r,[o])}}function yB(r,e,s){return function o(l){const a=r.querySelectorAll(e);for(let{target:h}=l;h&&h!==this;h=h.parentNode)for(const d of a)if(d===h)return Mb(l,{delegateTarget:h}),o.oneOff&&ot.off(r,l.type,e,s),s.apply(h,[l])}}function DO(r,e,s=null){return Object.values(r).find(o=>o.callable===e&&o.delegationSelector===s)}function xO(r,e,s){const o=typeof e=="string",l=o?s:e||s;let a=PO(r);return IB.has(a)||(a=r),[o,l,a]}function cw(r,e,s,o,l){if(typeof e!="string"||!r)return;let[a,h,d]=xO(e,s,o);e in NO&&(h=(w=>function(M){if(!M.relatedTarget||M.relatedTarget!==M.delegateTarget&&!M.delegateTarget.contains(M.relatedTarget))return w.call(this,M)})(h));const p=MO(r),f=p[d]||(p[d]={}),m=DO(f,h,a?s:null);if(m){m.oneOff=m.oneOff&&l;return}const T=LO(h,e.replace(bB,"")),b=a?yB(r,s,h):SB(r,h);b.delegationSelector=a?s:null,b.callable=h,b.oneOff=l,b.uidEvent=T,f[T]=b,r.addEventListener(d,b,a)}function MT(r,e,s,o,l){const a=DO(e[s],o,l);a&&(r.removeEventListener(s,a,!!l),delete e[s][a.uidEvent])}function CB(r,e,s,o){const l=e[s]||{};for(const[a,h]of Object.entries(l))a.includes(o)&&MT(r,e,s,h.callable,h.delegationSelector)}function PO(r){return r=r.replace(EB,""),NO[r]||r}const ot={on(r,e,s,o){cw(r,e,s,o,!1)},one(r,e,s,o){cw(r,e,s,o,!0)},off(r,e,s,o){if(typeof e!="string"||!r)return;const[l,a,h]=xO(e,s,o),d=h!==e,p=MO(r),f=p[h]||{},m=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(f).length)return;MT(r,p,h,a,l?s:null);return}if(m)for(const T of Object.keys(p))CB(r,p,T,e.slice(1));for(const[T,b]of Object.entries(f)){const I=T.replace(vB,"");(!d||e.includes(I))&&MT(r,p,h,b.callable,b.delegationSelector)}},trigger(r,e,s){if(typeof e!="string"||!r)return null;const o=AO(),l=PO(e),a=e!==l;let h=null,d=!0,p=!0,f=!1;a&&o&&(h=o.Event(e,s),o(r).trigger(h),d=!h.isPropagationStopped(),p=!h.isImmediatePropagationStopped(),f=h.isDefaultPrevented());const m=Mb(new Event(e,{bubbles:d,cancelable:!0}),s);return f&&m.preventDefault(),p&&r.dispatchEvent(m),m.defaultPrevented&&h&&h.preventDefault(),m}};function Mb(r,e={}){for(const[s,o]of Object.entries(e))try{r[s]=o}catch{Object.defineProperty(r,s,{configurable:!0,get(){return o}})}return r}function aw(r){if(r==="true")return!0;if(r==="false")return!1;if(r===Number(r).toString())return Number(r);if(r===""||r==="null")return null;if(typeof r!="string")return r;try{return JSON.parse(decodeURIComponent(r))}catch{return r}}function r_(r){return r.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Vo={setDataAttribute(r,e,s){r.setAttribute(`data-bs-${r_(e)}`,s)},removeDataAttribute(r,e){r.removeAttribute(`data-bs-${r_(e)}`)},getDataAttributes(r){if(!r)return{};const e={},s=Object.keys(r.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let l=o.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),e[l]=aw(r.dataset[o])}return e},getDataAttribute(r,e){return aw(r.getAttribute(`data-bs-${r_(e)}`))}};class Oh{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Uo(s)?Vo.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Uo(s)?Vo.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,l]of Object.entries(s)){const a=e[o],h=Uo(a)?"element":mB(a);if(!new RegExp(l).test(h))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${h}" but expected type "${l}".`)}}}const wB="5.3.2";class Ds extends Oh{constructor(e,s){super(),e=Dn(e),e&&(this._element=e,this._config=this._getConfig(s),s_.set(this._element,this.constructor.DATA_KEY,this))}dispose(){s_.remove(this._element,this.constructor.DATA_KEY),ot.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){RO(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return s_.get(Dn(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return wB}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const l_=r=>{let e=r.getAttribute("data-bs-target");if(!e||e==="#"){let s=r.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?wO(s.trim()):null}return e},Rt={find(r,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,r))},findOne(r,e=document.documentElement){return Element.prototype.querySelector.call(e,r)},children(r,e){return[].concat(...r.children).filter(s=>s.matches(e))},parents(r,e){const s=[];let o=r.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(r,e){let s=r.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(r,e){let s=r.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(r){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,r).filter(s=>!xn(s)&&yc(s))},getSelectorFromElement(r){const e=l_(r);return e&&Rt.findOne(e)?e:null},getElementFromSelector(r){const e=l_(r);return e?Rt.findOne(e):null},getMultipleElementsFromSelector(r){const e=l_(r);return e?Rt.find(e):[]}},Bp=(r,e="hide")=>{const s=`click.dismiss${r.EVENT_KEY}`,o=r.NAME;ot.on(document,s,`[data-bs-dismiss="${o}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),xn(this))return;const a=Rt.getElementFromSelector(this)||this.closest(`.${o}`);r.getOrCreateInstance(a)[e]()})},kB="alert",OB="bs.alert",BO=`.${OB}`,AB=`close${BO}`,RB=`closed${BO}`,NB="fade",LB="show";class Fp extends Ds{static get NAME(){return kB}close(){if(ot.trigger(this._element,AB).defaultPrevented)return;this._element.classList.remove(LB);const s=this._element.classList.contains(NB);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),ot.trigger(this._element,RB),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Fp.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Bp(Fp,"close");ms(Fp);const MB="button",DB="bs.button",xB=`.${DB}`,PB=".data-api",BB="active",hw='[data-bs-toggle="button"]',FB=`click${xB}${PB}`;class Hp extends Ds{static get NAME(){return MB}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(BB))}static jQueryInterface(e){return this.each(function(){const s=Hp.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}ot.on(document,FB,hw,r=>{r.preventDefault();const e=r.target.closest(hw);Hp.getOrCreateInstance(e).toggle()});ms(Hp);const HB="swipe",Cc=".bs.swipe",UB=`touchstart${Cc}`,VB=`touchmove${Cc}`,GB=`touchend${Cc}`,WB=`pointerdown${Cc}`,XB=`pointerup${Cc}`,zB="touch",YB="pen",KB="pointer-event",jB=40,JB={endCallback:null,leftCallback:null,rightCallback:null},qB={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class fp extends Oh{constructor(e,s){super(),this._element=e,!(!e||!fp.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return JB}static get DefaultType(){return qB}static get NAME(){return HB}dispose(){ot.off(this._element,Cc)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Fi(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=jB)return;const s=e/this._deltaX;this._deltaX=0,s&&Fi(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(ot.on(this._element,WB,e=>this._start(e)),ot.on(this._element,XB,e=>this._end(e)),this._element.classList.add(KB)):(ot.on(this._element,UB,e=>this._start(e)),ot.on(this._element,VB,e=>this._move(e)),ot.on(this._element,GB,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===YB||e.pointerType===zB)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ZB="carousel",QB="bs.carousel",Hn=`.${QB}`,FO=".data-api",tF="ArrowLeft",eF="ArrowRight",iF=500,Ia="next",Gl="prev",zl="left",Kd="right",sF=`slide${Hn}`,c_=`slid${Hn}`,oF=`keydown${Hn}`,nF=`mouseenter${Hn}`,rF=`mouseleave${Hn}`,lF=`dragstart${Hn}`,cF=`load${Hn}${FO}`,aF=`click${Hn}${FO}`,HO="carousel",wd="active",hF="slide",uF="carousel-item-end",dF="carousel-item-start",pF="carousel-item-next",gF="carousel-item-prev",UO=".active",VO=".carousel-item",fF=UO+VO,mF=".carousel-item img",$F=".carousel-indicators",_F="[data-bs-slide], [data-bs-slide-to]",TF='[data-bs-ride="carousel"]',bF={[tF]:Kd,[eF]:zl},EF={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},vF={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ah extends Ds{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Rt.findOne($F,this._element),this._addEventListeners(),this._config.ride===HO&&this.cycle()}static get Default(){return EF}static get DefaultType(){return vF}static get NAME(){return ZB}next(){this._slide(Ia)}nextWhenVisible(){!document.hidden&&yc(this._element)&&this.next()}prev(){this._slide(Gl)}pause(){this._isSliding&&kO(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){ot.one(this._element,c_,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){ot.one(this._element,c_,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const l=e>o?Ia:Gl;this._slide(l,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&ot.on(this._element,oF,e=>this._keydown(e)),this._config.pause==="hover"&&(ot.on(this._element,nF,()=>this.pause()),ot.on(this._element,rF,()=>this._maybeEnableCycle())),this._config.touch&&fp.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of Rt.find(mF,this._element))ot.on(o,lF,l=>l.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(zl)),rightCallback:()=>this._slide(this._directionToOrder(Kd)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),iF+this._config.interval))}};this._swipeHelper=new fp(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=bF[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=Rt.findOne(UO,this._indicatorsElement);s.classList.remove(wd),s.removeAttribute("aria-current");const o=Rt.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(wd),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),l=e===Ia,a=s||Lb(this._getItems(),o,l,this._config.wrap);if(a===o)return;const h=this._getItemIndex(a),d=I=>ot.trigger(this._element,I,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:h});if(d(sF).defaultPrevented||!o||!a)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(h),this._activeElement=a;const m=l?dF:uF,T=l?pF:gF;a.classList.add(T),kh(a),o.classList.add(m),a.classList.add(m);const b=()=>{a.classList.remove(m,T),a.classList.add(wd),o.classList.remove(wd,T,m),this._isSliding=!1,d(c_)};this._queueCallback(b,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(hF)}_getActive(){return Rt.findOne(fF,this._element)}_getItems(){return Rt.find(VO,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return gs()?e===zl?Gl:Ia:e===zl?Ia:Gl}_orderToDirection(e){return gs()?e===Gl?zl:Kd:e===Gl?Kd:zl}static jQueryInterface(e){return this.each(function(){const s=Ah.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ot.on(document,aF,_F,function(r){const e=Rt.getElementFromSelector(this);if(!e||!e.classList.contains(HO))return;r.preventDefault();const s=Ah.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Vo.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});ot.on(window,cF,()=>{const r=Rt.find(TF);for(const e of r)Ah.getOrCreateInstance(e)});ms(Ah);const IF="collapse",SF="bs.collapse",Rh=`.${SF}`,yF=".data-api",CF=`show${Rh}`,wF=`shown${Rh}`,kF=`hide${Rh}`,OF=`hidden${Rh}`,AF=`click${Rh}${yF}`,a_="show",ql="collapse",kd="collapsing",RF="collapsed",NF=`:scope .${ql} .${ql}`,LF="collapse-horizontal",MF="width",DF="height",xF=".collapse.show, .collapse.collapsing",DT='[data-bs-toggle="collapse"]',PF={parent:null,toggle:!0},BF={parent:"(null|element)",toggle:"boolean"};class vh extends Ds{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=Rt.find(DT);for(const l of o){const a=Rt.getSelectorFromElement(l),h=Rt.find(a).filter(d=>d===this._element);a!==null&&h.length&&this._triggerArray.push(l)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return PF}static get DefaultType(){return BF}static get NAME(){return IF}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(xF).filter(d=>d!==this._element).map(d=>vh.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||ot.trigger(this._element,CF).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(ql),this._element.classList.add(kd),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(kd),this._element.classList.add(ql,a_),this._element.style[o]="",ot.trigger(this._element,wF)},h=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(l,this._element,!0),this._element.style[o]=`${this._element[h]}px`}hide(){if(this._isTransitioning||!this._isShown()||ot.trigger(this._element,kF).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,kh(this._element),this._element.classList.add(kd),this._element.classList.remove(ql,a_);for(const l of this._triggerArray){const a=Rt.getElementFromSelector(l);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([l],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(kd),this._element.classList.add(ql),ot.trigger(this._element,OF)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(a_)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Dn(e.parent),e}_getDimension(){return this._element.classList.contains(LF)?MF:DF}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(DT);for(const s of e){const o=Rt.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=Rt.find(NF,this._config.parent);return Rt.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(RF,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=vh.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}ot.on(document,AF,DT,function(r){(r.target.tagName==="A"||r.delegateTarget&&r.delegateTarget.tagName==="A")&&r.preventDefault();for(const e of Rt.getMultipleElementsFromSelector(this))vh.getOrCreateInstance(e,{toggle:!1}).toggle()});ms(vh);const uw="dropdown",FF="bs.dropdown",Gr=`.${FF}`,Db=".data-api",HF="Escape",dw="Tab",UF="ArrowUp",pw="ArrowDown",VF=2,GF=`hide${Gr}`,WF=`hidden${Gr}`,XF=`show${Gr}`,zF=`shown${Gr}`,GO=`click${Gr}${Db}`,WO=`keydown${Gr}${Db}`,YF=`keyup${Gr}${Db}`,Yl="show",KF="dropup",jF="dropend",JF="dropstart",qF="dropup-center",ZF="dropdown-center",Ar='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',QF=`${Ar}.${Yl}`,jd=".dropdown-menu",tH=".navbar",eH=".navbar-nav",iH=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",sH=gs()?"top-end":"top-start",oH=gs()?"top-start":"top-end",nH=gs()?"bottom-end":"bottom-start",rH=gs()?"bottom-start":"bottom-end",lH=gs()?"left-start":"right-start",cH=gs()?"right-start":"left-start",aH="top",hH="bottom",uH={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},dH={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class po extends Ds{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=Rt.next(this._element,jd)[0]||Rt.prev(this._element,jd)[0]||Rt.findOne(jd,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return uH}static get DefaultType(){return dH}static get NAME(){return uw}toggle(){return this._isShown()?this.hide():this.show()}show(){if(xn(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!ot.trigger(this._element,XF,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(eH))for(const o of[].concat(...document.body.children))ot.on(o,"mouseover",gp);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Yl),this._element.classList.add(Yl),ot.trigger(this._element,zF,e)}}hide(){if(xn(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!ot.trigger(this._element,GF,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))ot.off(o,"mouseover",gp);this._popper&&this._popper.destroy(),this._menu.classList.remove(Yl),this._element.classList.remove(Yl),this._element.setAttribute("aria-expanded","false"),Vo.removeDataAttribute(this._menu,"popper"),ot.trigger(this._element,WF,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Uo(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${uw.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof CO>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:Uo(this._config.reference)?e=Dn(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Nb(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Yl)}_getPlacement(){const e=this._parent;if(e.classList.contains(jF))return lH;if(e.classList.contains(JF))return cH;if(e.classList.contains(qF))return aH;if(e.classList.contains(ZF))return hH;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(KF)?s?oH:sH:s?rH:nH}_detectNavbar(){return this._element.closest(tH)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Vo.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Fi(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:s}){const o=Rt.find(iH,this._menu).filter(l=>yc(l));o.length&&Lb(o,s,e===pw,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=po.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===VF||e.type==="keyup"&&e.key!==dw)return;const s=Rt.find(QF);for(const o of s){const l=po.getInstance(o);if(!l||l._config.autoClose===!1)continue;const a=e.composedPath(),h=a.includes(l._menu);if(a.includes(l._element)||l._config.autoClose==="inside"&&!h||l._config.autoClose==="outside"&&h||l._menu.contains(e.target)&&(e.type==="keyup"&&e.key===dw||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:l._element};e.type==="click"&&(d.clickEvent=e),l._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===HF,l=[UF,pw].includes(e.key);if(!l&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Ar)?this:Rt.prev(this,Ar)[0]||Rt.next(this,Ar)[0]||Rt.findOne(Ar,e.delegateTarget.parentNode),h=po.getOrCreateInstance(a);if(l){e.stopPropagation(),h.show(),h._selectMenuItem(e);return}h._isShown()&&(e.stopPropagation(),h.hide(),a.focus())}}ot.on(document,WO,Ar,po.dataApiKeydownHandler);ot.on(document,WO,jd,po.dataApiKeydownHandler);ot.on(document,GO,po.clearMenus);ot.on(document,YF,po.clearMenus);ot.on(document,GO,Ar,function(r){r.preventDefault(),po.getOrCreateInstance(this).toggle()});ms(po);const XO="backdrop",pH="fade",gw="show",fw=`mousedown.bs.${XO}`,gH={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},fH={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class zO extends Oh{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return gH}static get DefaultType(){return fH}static get NAME(){return XO}show(e){if(!this._config.isVisible){Fi(e);return}this._append();const s=this._getElement();this._config.isAnimated&&kh(s),s.classList.add(gw),this._emulateAnimation(()=>{Fi(e)})}hide(e){if(!this._config.isVisible){Fi(e);return}this._getElement().classList.remove(gw),this._emulateAnimation(()=>{this.dispose(),Fi(e)})}dispose(){this._isAppended&&(ot.off(this._element,fw),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(pH),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Dn(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),ot.on(e,fw,()=>{Fi(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){RO(e,this._getElement(),this._config.isAnimated)}}const mH="focustrap",$H="bs.focustrap",mp=`.${$H}`,_H=`focusin${mp}`,TH=`keydown.tab${mp}`,bH="Tab",EH="forward",mw="backward",vH={autofocus:!0,trapElement:null},IH={autofocus:"boolean",trapElement:"element"};class YO extends Oh{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return vH}static get DefaultType(){return IH}static get NAME(){return mH}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),ot.off(document,mp),ot.on(document,_H,e=>this._handleFocusin(e)),ot.on(document,TH,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ot.off(document,mp))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=Rt.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===mw?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===bH&&(this._lastTabNavDirection=e.shiftKey?mw:EH)}}const $w=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",_w=".sticky-top",Od="padding-right",Tw="margin-right";class xT{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Od,s=>s+e),this._setElementAttributes($w,Od,s=>s+e),this._setElementAttributes(_w,Tw,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Od),this._resetElementAttributes($w,Od),this._resetElementAttributes(_w,Tw)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const l=this.getWidth(),a=h=>{if(h!==this._element&&window.innerWidth>h.clientWidth+l)return;this._saveInitialAttribute(h,s);const d=window.getComputedStyle(h).getPropertyValue(s);h.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Vo.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=l=>{const a=Vo.getDataAttribute(l,s);if(a===null){l.style.removeProperty(s);return}Vo.removeDataAttribute(l,s),l.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Uo(e)){s(e);return}for(const o of Rt.find(e,this._element))s(o)}}const SH="modal",yH="bs.modal",fs=`.${yH}`,CH=".data-api",wH="Escape",kH=`hide${fs}`,OH=`hidePrevented${fs}`,KO=`hidden${fs}`,jO=`show${fs}`,AH=`shown${fs}`,RH=`resize${fs}`,NH=`click.dismiss${fs}`,LH=`mousedown.dismiss${fs}`,MH=`keydown.dismiss${fs}`,DH=`click${fs}${CH}`,bw="modal-open",xH="fade",Ew="show",h_="modal-static",PH=".modal.show",BH=".modal-dialog",FH=".modal-body",HH='[data-bs-toggle="modal"]',UH={backdrop:!0,focus:!0,keyboard:!0},VH={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class _c extends Ds{constructor(e,s){super(e,s),this._dialog=Rt.findOne(BH,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new xT,this._addEventListeners()}static get Default(){return UH}static get DefaultType(){return VH}static get NAME(){return SH}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||ot.trigger(this._element,jO,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(bw),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||ot.trigger(this._element,kH).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ew),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){ot.off(window,fs),ot.off(this._dialog,fs),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new zO({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new YO({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=Rt.findOne(FH,this._dialog);s&&(s.scrollTop=0),kh(this._element),this._element.classList.add(Ew);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,ot.trigger(this._element,AH,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){ot.on(this._element,MH,e=>{if(e.key===wH){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),ot.on(window,RH,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),ot.on(this._element,LH,e=>{ot.one(this._element,NH,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(bw),this._resetAdjustments(),this._scrollBar.reset(),ot.trigger(this._element,KO)})}_isAnimated(){return this._element.classList.contains(xH)}_triggerBackdropTransition(){if(ot.trigger(this._element,OH).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(h_)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(h_),this._queueCallback(()=>{this._element.classList.remove(h_),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const l=gs()?"paddingLeft":"paddingRight";this._element.style[l]=`${s}px`}if(!o&&e){const l=gs()?"paddingRight":"paddingLeft";this._element.style[l]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=_c.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}ot.on(document,DH,HH,function(r){const e=Rt.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&r.preventDefault(),ot.one(e,jO,l=>{l.defaultPrevented||ot.one(e,KO,()=>{yc(this)&&this.focus()})});const s=Rt.findOne(PH);s&&_c.getInstance(s).hide(),_c.getOrCreateInstance(e).toggle(this)});Bp(_c);ms(_c);const GH="offcanvas",WH="bs.offcanvas",qo=`.${WH}`,JO=".data-api",XH=`load${qo}${JO}`,zH="Escape",vw="show",Iw="showing",Sw="hiding",YH="offcanvas-backdrop",qO=".offcanvas.show",KH=`show${qo}`,jH=`shown${qo}`,JH=`hide${qo}`,yw=`hidePrevented${qo}`,ZO=`hidden${qo}`,qH=`resize${qo}`,ZH=`click${qo}${JO}`,QH=`keydown.dismiss${qo}`,tU='[data-bs-toggle="offcanvas"]',eU={backdrop:!0,keyboard:!0,scroll:!1},iU={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Pn extends Ds{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return eU}static get DefaultType(){return iU}static get NAME(){return GH}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||ot.trigger(this._element,KH,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new xT().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Iw);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(vw),this._element.classList.remove(Iw),ot.trigger(this._element,jH,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||ot.trigger(this._element,JH).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Sw),this._backdrop.hide();const s=()=>{this._element.classList.remove(vw,Sw),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new xT().reset(),ot.trigger(this._element,ZO)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){ot.trigger(this._element,yw);return}this.hide()},s=!!this._config.backdrop;return new zO({className:YH,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new YO({trapElement:this._element})}_addEventListeners(){ot.on(this._element,QH,e=>{if(e.key===zH){if(this._config.keyboard){this.hide();return}ot.trigger(this._element,yw)}})}static jQueryInterface(e){return this.each(function(){const s=Pn.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ot.on(document,ZH,tU,function(r){const e=Rt.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),xn(this))return;ot.one(e,ZO,()=>{yc(this)&&this.focus()});const s=Rt.findOne(qO);s&&s!==e&&Pn.getInstance(s).hide(),Pn.getOrCreateInstance(e).toggle(this)});ot.on(window,XH,()=>{for(const r of Rt.find(qO))Pn.getOrCreateInstance(r).show()});ot.on(window,qH,()=>{for(const r of Rt.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(r).position!=="fixed"&&Pn.getOrCreateInstance(r).hide()});Bp(Pn);ms(Pn);const sU=/^aria-[\w-]*$/i,QO={"*":["class","dir","id","lang","role",sU],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},oU=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),nU=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,rU=(r,e)=>{const s=r.nodeName.toLowerCase();return e.includes(s)?oU.has(s)?!!nU.test(r.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function lU(r,e,s){if(!r.length)return r;if(s&&typeof s=="function")return s(r);const l=new window.DOMParser().parseFromString(r,"text/html"),a=[].concat(...l.body.querySelectorAll("*"));for(const h of a){const d=h.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){h.remove();continue}const p=[].concat(...h.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const m of p)rU(m,f)||h.removeAttribute(m.nodeName)}return l.body.innerHTML}const cU="TemplateFactory",aU={allowList:QO,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},hU={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},uU={entry:"(string|element|function|null)",selector:"(string|element)"};class dU extends Oh{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return aU}static get DefaultType(){return hU}static get NAME(){return cU}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[l,a]of Object.entries(this._config.content))this._setContent(e,a,l);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},uU)}_setContent(e,s,o){const l=Rt.findOne(o,e);if(l){if(s=this._resolvePossibleFunction(s),!s){l.remove();return}if(Uo(s)){this._putElementInTemplate(Dn(s),l);return}if(this._config.html){l.innerHTML=this._maybeSanitize(s);return}l.textContent=s}}_maybeSanitize(e){return this._config.sanitize?lU(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Fi(e,[this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const pU="tooltip",gU=new Set(["sanitize","allowList","sanitizeFn"]),u_="fade",fU="modal",Ad="show",mU=".tooltip-inner",Cw=`.${fU}`,ww="hide.bs.modal",Sa="hover",d_="focus",$U="click",_U="manual",TU="hide",bU="hidden",EU="show",vU="shown",IU="inserted",SU="click",yU="focusin",CU="focusout",wU="mouseenter",kU="mouseleave",OU={AUTO:"auto",TOP:"top",RIGHT:gs()?"left":"right",BOTTOM:"bottom",LEFT:gs()?"right":"left"},AU={allowList:QO,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},RU={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class wc extends Ds{constructor(e,s){if(typeof CO>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return AU}static get DefaultType(){return RU}static get NAME(){return pU}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),ot.off(this._element.closest(Cw),ww,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=ot.trigger(this._element,this.constructor.eventName(EU)),o=(OO(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const l=this._getTipElement();this._element.setAttribute("aria-describedby",l.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(l),ot.trigger(this._element,this.constructor.eventName(IU))),this._popper=this._createPopper(l),l.classList.add(Ad),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))ot.on(d,"mouseover",gp);const h=()=>{ot.trigger(this._element,this.constructor.eventName(vU)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(h,this.tip,this._isAnimated())}hide(){if(!this._isShown()||ot.trigger(this._element,this.constructor.eventName(TU)).defaultPrevented)return;if(this._getTipElement().classList.remove(Ad),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))ot.off(l,"mouseover",gp);this._activeTrigger[$U]=!1,this._activeTrigger[d_]=!1,this._activeTrigger[Sa]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),ot.trigger(this._element,this.constructor.eventName(bU)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(u_,Ad),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=$B(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(u_),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new dU({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[mU]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(u_)}_isShown(){return this.tip&&this.tip.classList.contains(Ad)}_createPopper(e){const s=Fi(this._config.placement,[this,e,this._element]),o=OU[s.toUpperCase()];return Nb(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Fi(e,[this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Fi(this._config.popperConfig,[s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")ot.on(this._element,this.constructor.eventName(SU),this._config.selector,o=>{this._initializeOnDelegatedTarget(o).toggle()});else if(s!==_U){const o=s===Sa?this.constructor.eventName(wU):this.constructor.eventName(yU),l=s===Sa?this.constructor.eventName(kU):this.constructor.eventName(CU);ot.on(this._element,o,this._config.selector,a=>{const h=this._initializeOnDelegatedTarget(a);h._activeTrigger[a.type==="focusin"?d_:Sa]=!0,h._enter()}),ot.on(this._element,l,this._config.selector,a=>{const h=this._initializeOnDelegatedTarget(a);h._activeTrigger[a.type==="focusout"?d_:Sa]=h._element.contains(a.relatedTarget),h._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},ot.on(this._element.closest(Cw),ww,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Vo.getDataAttributes(this._element);for(const o of Object.keys(s))gU.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Dn(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=wc.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ms(wc);const NU="popover",LU=".popover-header",MU=".popover-body",DU={...wc.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},xU={...wc.DefaultType,content:"(null|string|element|function)"};class xb extends wc{static get Default(){return DU}static get DefaultType(){return xU}static get NAME(){return NU}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[LU]:this._getTitle(),[MU]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=xb.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ms(xb);const PU="scrollspy",BU="bs.scrollspy",Pb=`.${BU}`,FU=".data-api",HU=`activate${Pb}`,kw=`click${Pb}`,UU=`load${Pb}${FU}`,VU="dropdown-item",Wl="active",GU='[data-bs-spy="scroll"]',p_="[href]",WU=".nav, .list-group",Ow=".nav-link",XU=".nav-item",zU=".list-group-item",YU=`${Ow}, ${XU} > ${Ow}, ${zU}`,KU=".dropdown",jU=".dropdown-toggle",JU={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},qU={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Up extends Ds{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return JU}static get DefaultType(){return qU}static get NAME(){return PU}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Dn(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(ot.off(this._config.target,kw),ot.on(this._config.target,kw,p_,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,l=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:l,behavior:"smooth"});return}o.scrollTop=l}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=h=>this._targetLinks.get(`#${h.target.id}`),o=h=>{this._previousScrollData.visibleEntryTop=h.target.offsetTop,this._process(s(h))},l=(this._rootElement||document.documentElement).scrollTop,a=l>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=l;for(const h of e){if(!h.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(h));continue}const d=h.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&d){if(o(h),!l)return;continue}!a&&!d&&o(h)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Rt.find(p_,this._config.target);for(const s of e){if(!s.hash||xn(s))continue;const o=Rt.findOne(decodeURI(s.hash),this._element);yc(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Wl),this._activateParents(e),ot.trigger(this._element,HU,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(VU)){Rt.findOne(jU,e.closest(KU)).classList.add(Wl);return}for(const s of Rt.parents(e,WU))for(const o of Rt.prev(s,YU))o.classList.add(Wl)}_clearActiveClass(e){e.classList.remove(Wl);const s=Rt.find(`${p_}.${Wl}`,e);for(const o of s)o.classList.remove(Wl)}static jQueryInterface(e){return this.each(function(){const s=Up.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ot.on(window,UU,()=>{for(const r of Rt.find(GU))Up.getOrCreateInstance(r)});ms(Up);const ZU="tab",QU="bs.tab",Wr=`.${QU}`,tV=`hide${Wr}`,eV=`hidden${Wr}`,iV=`show${Wr}`,sV=`shown${Wr}`,oV=`click${Wr}`,nV=`keydown${Wr}`,rV=`load${Wr}`,lV="ArrowLeft",Aw="ArrowRight",cV="ArrowUp",Rw="ArrowDown",g_="Home",Nw="End",Rr="active",Lw="fade",f_="show",aV="dropdown",tA=".dropdown-toggle",hV=".dropdown-menu",m_=`:not(${tA})`,uV='.list-group, .nav, [role="tablist"]',dV=".nav-item, .list-group-item",pV=`.nav-link${m_}, .list-group-item${m_}, [role="tab"]${m_}`,eA='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',$_=`${pV}, ${eA}`,gV=`.${Rr}[data-bs-toggle="tab"], .${Rr}[data-bs-toggle="pill"], .${Rr}[data-bs-toggle="list"]`;class Tc extends Ds{constructor(e){super(e),this._parent=this._element.closest(uV),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),ot.on(this._element,nV,s=>this._keydown(s)))}static get NAME(){return ZU}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?ot.trigger(s,tV,{relatedTarget:e}):null;ot.trigger(e,iV,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(Rr),this._activate(Rt.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(f_);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),ot.trigger(e,sV,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Lw))}_deactivate(e,s){if(!e)return;e.classList.remove(Rr),e.blur(),this._deactivate(Rt.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(f_);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),ot.trigger(e,eV,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Lw))}_keydown(e){if(![lV,Aw,cV,Rw,g_,Nw].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(l=>!xn(l));let o;if([g_,Nw].includes(e.key))o=s[e.key===g_?0:s.length-1];else{const l=[Aw,Rw].includes(e.key);o=Lb(s,e.target,l,!0)}o&&(o.focus({preventScroll:!0}),Tc.getOrCreateInstance(o).show())}_getChildren(){return Rt.find($_,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=Rt.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(aV))return;const l=(a,h)=>{const d=Rt.findOne(a,o);d&&d.classList.toggle(h,s)};l(tA,Rr),l(hV,f_),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(Rr)}_getInnerElement(e){return e.matches($_)?e:Rt.findOne($_,e)}_getOuterElement(e){return e.closest(dV)||e}static jQueryInterface(e){return this.each(function(){const s=Tc.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ot.on(document,oV,eA,function(r){["A","AREA"].includes(this.tagName)&&r.preventDefault(),!xn(this)&&Tc.getOrCreateInstance(this).show()});ot.on(window,rV,()=>{for(const r of Rt.find(gV))Tc.getOrCreateInstance(r)});ms(Tc);const fV="toast",mV="bs.toast",Un=`.${mV}`,$V=`mouseover${Un}`,_V=`mouseout${Un}`,TV=`focusin${Un}`,bV=`focusout${Un}`,EV=`hide${Un}`,vV=`hidden${Un}`,IV=`show${Un}`,SV=`shown${Un}`,yV="fade",Mw="hide",Rd="show",Nd="showing",CV={animation:"boolean",autohide:"boolean",delay:"number"},wV={animation:!0,autohide:!0,delay:5e3};class Vp extends Ds{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return wV}static get DefaultType(){return CV}static get NAME(){return fV}show(){if(ot.trigger(this._element,IV).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(yV);const s=()=>{this._element.classList.remove(Nd),ot.trigger(this._element,SV),this._maybeScheduleHide()};this._element.classList.remove(Mw),kh(this._element),this._element.classList.add(Rd,Nd),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||ot.trigger(this._element,EV).defaultPrevented)return;const s=()=>{this._element.classList.add(Mw),this._element.classList.remove(Nd,Rd),ot.trigger(this._element,vV)};this._element.classList.add(Nd),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Rd),super.dispose()}isShown(){return this._element.classList.contains(Rd)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){ot.on(this._element,$V,e=>this._onInteraction(e,!0)),ot.on(this._element,_V,e=>this._onInteraction(e,!1)),ot.on(this._element,TV,e=>this._onInteraction(e,!0)),ot.on(this._element,bV,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Vp.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Bp(Vp);ms(Vp);vL(wP).mount("#app");
